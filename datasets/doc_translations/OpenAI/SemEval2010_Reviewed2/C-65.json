{
    "id": "C-65",
    "original_text": "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system. A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA. A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface. The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors. The system estimates the trajectory, the range, the caliber and the weapon type. The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center. The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested. Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1. INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East. In October 2006 CNN reported on a new tactic employed by insurgents. A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic. By the time the soldiers can react, they are gone. A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers. Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003. The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network. The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot. PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots. The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time. This capability is due to the widely distributed sensing and the unique sensor fusion approach [8]. The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities. The obvious disadvantage of such a system is its static nature. Once the sensors are distributed, they cover a certain area. Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance. It is not practical to gather and reuse the sensors, especially under combat conditions. Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place. As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves. While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers. A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges. The sensor positions and orientation need to be constantly monitored. As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before. Moreover, the system should be useful to even a single soldier. Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization. The paper presents the design and evaluation of our soldierwearable mobile countersniper system. It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12]. Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously. The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2. APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena. The muzzle blast is generated at the muzzle of the gun and travels at the speed sound. The supersonic projectile generates an acoustic shockwave, a kind of sonic boom. The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound. The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec. The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor. It is typically a few hundred μsec. Once a trajectory estimate is available, the shockwave length can be used for caliber estimation. Our system is based on four microphones connected to a sensorboard. The board detects shockwaves and muzzle blasts and measures their ToA. If at least three acoustic channels detect the same event, its AoA is also computed. If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6. As the microphones are close to each other, typically 2-4, we cannot expect very high precision. Also, this method does not estimate a trajectory. In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations. However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9]. A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations. The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer. A wired USB connection is also available. The sensorfusion algorithm and the user interface get their data through one of these channels. The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass. Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself. However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system. Refer to Section 7 for an analysis. The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7]. However, we leave the integration of the two technologies for future work. 3. HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11]. Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate. Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1). The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2). The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line. Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA. The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds). These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables. This partitioning enables the use of truly different audio channels (eg.: slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths. The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways. An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs. The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote). The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station. The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC. The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities. The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events. Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote. We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements). The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator. The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio. The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power. The first prototype of our system employed 10 sensor nodes. Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a). The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4. SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4. Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration. The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java. The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels. The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module. Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses. Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch. Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm. Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram. The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link. Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link. Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network. The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard. The results of the sensor fusion are displayed on the PDA screen with low latency. Since, the application is implemented in pure Java, it is portable across different PDA platforms. The border between software and hardware is considerably blurred on the sensor board. The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks. However, some of them-most notably the soft processor cores-execute true software programs. The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces. As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals. Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces. This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface). The same set of registers are also accessible through a UART link with a terminal emulation program. Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg.: the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs). The most important results are the time stamps of the detected events. These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA. The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface. Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains. The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it. The maximum effective bandwidth is 100 Kbps through this interface. The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector. The control, status and data registers of the UART modules are available through the register file. The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs. One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings. By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel). Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block. The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller. The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM. These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example. The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently. The signal paths meet only just before the register file. Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain. Each channel has its own shockwave and muzzle blast detector, which are described in Section 5. The detectors fetch run-time parameter values from the register file and store their results there as well. The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection. The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources. This component receives the samples from all channels and stores them in circular buffers in the PSRAM device. If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link. The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file. Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line. The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly. The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz). The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node. Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal. The messages need to be propagated in the ad-hoc multihop network using a routing service. We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application. Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies. Routing policies are state machines that govern how received messages are stored, resent or discarded. Example policies include spanning tree routing, broadcast, geographic routing, etc. Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg.: because of the changing RF environment or power budget). In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field. Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network. The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself. That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node. Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference. The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application. Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier. The mote application is implemented in nesC [5] and is running on top of TinyOS [6]. With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5. DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications. Both events are transient by their nature and present very intense stimuli to the microphones. This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music. Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects. The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations. Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event. Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection. Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware). These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections. Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic. The detectors are implemented as independent IP cores within the FPGA-one pair for each channel. The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors. Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote. At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards. The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal. Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs). The shockwave detection core is continuously looking for two rising edges within a given interval. The state machine of the algorithm is shown in Figure 5(b). The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax). The only feature calculated by the core is the length of the observed shockwave signal. In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4]. Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a). Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly. The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder. After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain. After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period. If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise. Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently. The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one. The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections). The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b). The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities. Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite. The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6. SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon. The algorithm consists of well separated computational tasks outlined below: 1. Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2. Compute range estimates. This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3. Compute a single trajectory from all shockwave measurements (see 6.3). 4. If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5. If trajectory available compute caliber (see 6.5). 6. If caliber available compute weapon type (see 6.6). We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard. Each sensorboard has four microphones that measure the ToA-s. Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption). Let us formalize the problem for 3 microphones first. Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3. First we apply a simple geometry validation step. The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error. If this condition does not hold, the corresponding detections are discarded. Let v(x, y, z) be the normal vector of the unknown direction of arrival. We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3. Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c). This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long. There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide). We use the fourth microphones measurement-if there is one-to eliminate one of them. Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2). One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals. Consider the situation in Figure 7. A shot was fired from P at time t. Both P and t are unknown. We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available. The muzzle blast detection is at position P1 with time t1 and AoA u. The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors. It is shown below that these measurements are sufficient to compute the position of the shooter (P). Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface. Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2). The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t). P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 . From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA). In this case: t = uvt1−t2 uv−1 . Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range. Here we assumed that the shockwave is a cone which is only true for constant projectile speeds. In reality, the angle of the cone slowly grows; the surface resembles one half of an American football. The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet. A smaller time difference results in a smaller range, so the above formula underestimates the true range. However, it can still be used with a proper deceleration correction function. We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2]. The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other. In the special case when both directions are the same, the trajectory cannot be computed. In a real world application, the sensors are typically deployed on a plane approximately. In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA. To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold. We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave). Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold. We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory. Assume that we have N individual shockwave AoA measurements. Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each. This gives us at most N(N−1) 2 trajectories. A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index). We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter. The largest neighbor set is considered to be the core set C, all other trajectories are outliers. The core set can be found in O(N2 ) time. The trajectories in the core set are then averaged to get the final trajectory. It can happen that we cannot form any sensor pairs because of the direction difference threshold. It means all sensors are on the same side of the trajectory. In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown. To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions. We have made experiments to utilize the measured shockwave length in the trajectory estimation. There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available). Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor. For an example, refer to Figure 8. Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave. Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm. All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes. It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8]. The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes. For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box. The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes. The box with the maximum consistency is divided until the desired precision is reached. Backtracking is possible to avoid getting stuck in a local maximum. This approach has been shown to be fast enough for online processing. Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster. Next let us describe how the consistency function is calculated in detail. Consider B, a three dimensional box, we would like to compute the consistency value of. First we consider only the ToA information. If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate. For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B. Since it is a box and not a single point, this gives us an interval for the shot time. The maximum number of overlapping time intervals gives us the value of the consistency function for B. For a detailed description of the consistency function and search algorithm, refer to [8]. Here we extend the approach the following way. We modify the consistency function based on the bearing and range data from individual sensors. A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box. A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B. Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error. The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20]. He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship. Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels. Three different caliber projectiles have been tested (196 shots, 10 sensors). To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length. For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance. This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors. The experimental data is shown in Figure 9. Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent). Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings. This method has less than 1% caliber estimation error when an accurate trajectory estimate is available. In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information. Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes. The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself. Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements. Both weapons have the same caliber. Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements. All weapons have the same caliber. Data is approximated using simple linear regression. However, the measured speed of the projectile and its caliber showed good correlation with the weapon type. This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant. In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons. In the supersonic speed range, the bullet deceleration can be approximated with a linear function. In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10). Unfortunately, this is not necessarily true for the 5.56 mm caliber. The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11). However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began. More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat. The system carries out weapon classification in the following manner. Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry. To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7. RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19]. The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects. Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area. There were five fixed targets behind the sensor network. Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters. These positions were known to the evaluators, but not to the operators of the system. Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107. Note that the sensors remained static during the test. The primary reason for this is that nobody is allowed downrange during live fire tests. Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test. The experiment, therefore, did not test the mobility aspect of the system. During the one day test, there were 196 shots fired. The results are summarized in Table 1. The system detected all shots successfully. Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust. There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range. Shooter Local- Caliber Trajectory Trajectory Distance No. Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations. All shots were successfully detected, so the detection rate is omitted. Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of. The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory. The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory. The distance error shows the distance between the real shooter position and the estimated shooter position. As such, it includes the error caused by both the trajectory and that of the range estimation. Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup. The 10 sensor nodes are labeled by their ID and marked by dark circles. The targets are black squares marked T-1 through T-5. The long white arrows point to the shooter position estimated by each sensor. Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both. The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network. This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network. The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone. Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case. The localization rate characterizes the systems ability to successfully estimate the trajectory of shots. Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either. There were 7 shots out of 196 that were not localized. The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors. In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3). Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all. It is better not to give an answer other than a shot alarm than misleading the soldier. Localization accuracy is broken down to trajectory accuracy and range estimation precision. The angle of the estimated trajectory was better than 1 degree except for the 300 m range. Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day. This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots. As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer. Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory. These indicate an error which is about 1-2% of the range. To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at. Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming. As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system. We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term. The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances. We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts. These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges. This resulted in underestimating the range, since the system measured shorter times than the real ones. Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem. Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results. The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range. Note that the difference is small; there were 189 shots localized out of the total 196. The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized. Note that there was a single shot that was falsely classified by the caliber estimator. The 73% overall weapon classification accuracy does not seem impressive. But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2. For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%. There were only two shots out of approximately 140 that were missed. The M4 and M249 proved to be too similar and they were mistaken for each other most of the time. One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function. Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x. If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%. Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm). That is, the system is able to differentiate between weapons of the same caliber. We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels. While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation. Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor. Table 3 summarizes the results broken down by the ten sensors utilized. Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided. Note that many of the common error sources of the networked system do not play a role here. Time synchronization is not applicable. The sensors absolute location is irrelevant (just as the relative location of multiple sensors). The sensors orientation is still important though. There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon. Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters. Localization rate refers to the percentage of shots the given sensor alone was able to localize. The bearing and range values are average errors. They characterize the accuracy of localization from the given sensors perspective. The data indicates that the performance of the sensors varied significantly especially considering the localization rate. One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was. Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting. In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent. We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error). Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look. The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%. Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines. Hence, not all sensors had line-of-sight to all shooting positions. We estimate that 10% of the sensors had obstructed view to the shooter on average. Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor. The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections. Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network. It would be misleading to interpret these results as the system missing half the shots. As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot. Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system. In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference. Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds. As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system. On the other hand, node location and orientation can have a direct effect on the overall system performance. Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen. But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion. This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations. Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors. Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes. The following experiment was carried out. The number of sensors were varied from 2 to 10 in increments of 2. Each run picked the sensors randomly using a uniform distribution. At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution. Finally, the node orientations were perturbed using a zeromean Gaussian distribution. Each combination of parameters were generated 100 times and utilized for all 196 shots. The results are summarized in Figure 14. There is one 3D barchart for each of the experiment sets with the given fixed number of sensors. The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters. The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees. The z-axis is the resulting trajectory azimuth error. Note that the elevation angles showed somewhat larger errors than the azimuth. Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system. There are many interesting observation one can make by analyzing these charts. Node location errors in this range have a small effect on accuracy. Node orientation errors, on the other hand, noticeably degrade the performance. Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good. Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate. See Table 4 for a summary. Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors. This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes. If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network. See Section 6.3.) As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased. This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes. Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer. However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors. A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm. This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors. Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors. One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors. This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned. The speed of sound depends on the ambient temperature. The current prototype considers it constant that is typically set before a test. It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation. Note also that wind may adversely affect the accuracy of the system. The sensor fusion, however, could incorporate wind speed into its calculations. It would be more complicated than temperature compensation, but could be done. Other practical issues also need to be looked at before a real world deployment. Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at. However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately. The range and weapon type could not be estimated without muzzle blast detections. Subsonic weapons do not produce a shockwave. However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality. Hence, their use is not widespread and they pose less danger in any case. Another issue is the type of ammunition used. Irregular armies may use substandard, even hand manufactured bullets. This effects the muzzle velocity of the weapon. For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8. RELATED WORK Acoustic detection and recognition has been under research since the early fifties. The area has a close relevance to the topic of supersonic flow mechanics [20]. Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast. Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4]. Experiments with greater distances from the muzzle were conducted by Stoughton [18]. The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made. Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger. Another area of research is the signal processing of gunfire acoustics. The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts. Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT). Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency. Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10]. The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics. A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector. It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile. Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform. A related topic is the research and development of experimental and prototype shooter location systems. Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers. The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing. The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other. The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet. There is a low speed RF connection from the helmet to the processing body. An extensive test has been conducted to measure the performance of both type of systems. The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched. The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one. The range accuracy was around 5 percent for both of the systems. The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter. A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8]. This is especially important for operation in acoustically reverberant urban areas. Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1]. The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds. The goal of the system is significantly different than that of military systems. Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond. They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9. CONCLUSIONS The main contribution of this work is twofold. First, the performance of the overall distributed networked system is excellent. Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested. The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple. The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements. It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons. We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test. Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good. While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes. Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode. We believe that the technology is mature enough that a next revision of the system could be a commercial one. However, important aspects of the system would still need to be worked on. We have not addresses power management yet. A current node runs on 4 AA batteries for about 12 hours of continuous operation. A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs. An analog trigger circuit could solve this problem, however, the system would miss the first shot. Instead, the acoustic channels would need to be sampled and stored in a circular buffer. The rest of the board could be turned off. When a trigger wakes up the board, the acoustic data would be immediately available. Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life. Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10. REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki. Acoustic sniper localization. Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al. Fixed and wearable acoustic counter-sniper systems for law enforcement. In E. M. Carapezza and D. B. Law, editors, Proc. SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler. Description of muzzle blast by modified scaling models. Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler. The nesC language: a holistic approach to networked embedded systems. Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A. Woo, S. Hollar, D. Culler, and K. Pister. System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens. Node-density independent localization. Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon. Countersniper system for urban warfare. ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti. Directed flood-routing framework for wireless sensor networks. In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004. Springer-Verlag New York, Inc. [10] B. Mays. Shockwave and muzzle blast classification via joint time frequency and wavelet analysis. Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler. Optimal and wavelet-based shock wave detection and estimation. Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta. On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton. Sensor network-based countersniper system. In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004. ACM Press. [18] R. Stoughton. Measurements of small-caliber ballistic shock waves in air. Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B. A. Weiss, C. Schlenoff, M. Shneier, and A. Virts. Technology evaluations and performance metrics for soldier-worn sensors for assist. In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham. Flow pattern of a supersonic projectile. Communications on pure and applied mathematics, 5(3):301, 1952. 126",
    "original_translation": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo. La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él. El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz. El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado. Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros. Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes. Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula. Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth). Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador. El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R. El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa. Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo. Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente. Las rutas de señal se encuentran justo antes del archivo de registros. Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida. Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5. Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí. El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial. El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas. Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM. Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB. La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros. Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea. Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador. La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz). Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo. Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo. Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento. Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación. Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas. Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos. Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc. Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía). De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo. La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores. El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje. Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual. Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local. El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación. Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente. La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6]. Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz. ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares. Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos. Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular. Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios. Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias. Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento. Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos. Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente). Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque. En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples. Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal. Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento. Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote. En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente. Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal. Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs). El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado. La máquina de estados del algoritmo se muestra en la Figura 5(b). Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax). La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada. A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4]. Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a). Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad. La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC). Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC. Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período. Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido. Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente. El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente. El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca). El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b). Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes. Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE. La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6. La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma. El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1. Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2. Calcular estimaciones de rango. Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3. Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4. Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5. Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6. Si el calibre está disponible, calcular el tipo de arma (ver 6.6). Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor. Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s. Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano). Formalicemos primero el problema para 3 micrófonos. Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3. Primero aplicamos un paso de validación de geometría simple. La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición. Si esta condición no se cumple, las detecciones correspondientes son descartadas. Sea v(x, y, z) el vector normal de la dirección de llegada desconocida. También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3. Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c). Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos. Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden). Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos. De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2). Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque. Considera la situación en la Figura 7. Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos. Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible. La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u. La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales. Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P). Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie. Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2). La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t). P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1. Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón). En este caso: t = uvt1−t2 uv−1. Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango. Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil. En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano. La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala. Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango. Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada. Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2]. El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí. En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular. En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente. En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque. Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico. Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque). Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral. Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria. Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque. Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno. Esto nos da como máximo N(N−1) 2 trayectorias. Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria). Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio. El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos. El conjunto central se puede encontrar en tiempo O(N2). Las trayectorias en el conjunto central se promedian para obtener la trayectoria final. Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección. Significa que todos los sensores están en el mismo lado de la trayectoria. En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido. Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque. Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria. Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles). Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor. Para un ejemplo, consulte la Figura 8. Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque. Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador. Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos. Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8]. La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales. Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja. La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas. La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada. El retroceso es posible para evitar quedarse atascado en un máximo local. Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea. Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida. A continuación, describamos detalladamente cómo se calcula la función de consistencia. Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular. Primero consideramos solo la información de ToA. Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA. Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B. Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo. El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B. Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8]. Aquí extendemos el enfoque de la siguiente manera. Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales. Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B. Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B. En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores. El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 Estimación de calibre Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20]. Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error. Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos. Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores). Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque. Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos. Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes. Los datos experimentales se muestran en la Figura 9. La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4). Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas. Este método tiene menos del 1% de error en la estimación del calibre cuando se dispone de una estimación precisa de la trayectoria. En otras palabras, la estimación del calibre solo funciona si se realizan suficientes detecciones de ondas de choque por el sistema para calcular una trayectoria. 120 6.6 Estimación de armas Analizamos todas las características de la señal medida para encontrar información específica de la arma. Lamentablemente, concluimos que la firma observada de la explosión del cañón no es lo suficientemente característica del arma para fines de clasificación. Las reflexiones de la explosión de alta energía del freno de boca tienen un impacto mucho mayor en la forma de la señal de la explosión del freno de boca que el arma en sí misma. Disparar la misma arma desde diferentes lugares causó diferencias más grandes en la señal registrada que disparar diferentes armas desde el mismo lugar. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 rango (m) velocidad (m/s) AK-47 M240 Figura 10: Mediciones de desaceleración de balas de AK47 y M240. Ambas armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 rango (m) velocidad (m/s) M16 M249 M4 Figura 11: Mediciones de desaceleración de balas M16, M249 y M4. Todas las armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el tipo de arma. Esto se debe a que, para un tipo de arma y par de municiones dados, la velocidad inicial es casi constante. En las Figuras 10 y 11 podemos ver la relación entre el alcance y la velocidad de bala medida para diferentes calibres y armas. En el rango de velocidad supersónica, la desaceleración de la bala se puede aproximar con una función lineal. En el caso del calibre 7.62 mm, las dos armas probadas (AK47, M240) pueden ser claramente diferenciadas (Figura 10). Desafortunadamente, esto no es necesariamente cierto para el calibre 5.56 mm. El M16 con su mayor velocidad de boca aún puede ser bien clasificado, pero las armas M4 y M249 parecen prácticamente indistinguibles (Figura 11). Sin embargo, esto puede deberse en parte al número limitado de disparos de práctica que pudimos realizar antes de que comenzaran las pruebas reales. Más datos de entrenamiento pueden revelar una mejor separación entre las dos armas, ya que sus velocidades de boca publicadas difieren ligeramente. El sistema lleva a cabo la clasificación de armas de la siguiente manera. Una vez que se conoce la trayectoria, la velocidad se puede calcular para cada sensor basándose en la geometría de la onda de choque. Para evaluar un disparo, elegimos el tipo de arma cuya función de desaceleración resulta en el menor error cuadrático medio de los pares estimados de rango-velocidad para la clase de calibre estimada. 7. RESULTADOS Una evaluación independiente del sistema fue realizada por un equipo de NIST en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen en abril de 2006 [19]. El experimento se llevó a cabo en un campo de tiro con edificios y paredes de madera simulados para soportar posiciones elevadas de tiradores y generar efectos de trayectorias múltiples. La Figura 12 muestra la interfaz de usuario con una fotografía aérea del sitio. Se desplegaron 10 nodos sensores en puntos relevados en un área de aproximadamente 30×30 m. Había cinco objetivos fijos detrás de la red de sensores. Varias posiciones de disparo se ubicaron en cada una de las líneas de tiro a 50, 100, 200 y 300 metros. Estas posiciones eran conocidas por los evaluadores, pero no por los operadores del sistema. Se utilizaron seis armas diferentes: AK47 y M240 disparando proyectiles de 7.62 mm, M16, M4 y M249 con munición de 5.56 mm y el M107 de calibre .50. Ten en cuenta que los sensores permanecieron estáticos durante la prueba. La razón principal de esto es que a nadie se le permite estar en la zona de tiro durante las pruebas con fuego real. Utilizar algún tipo de plataforma de control remoto habría sido demasiado complicado dada la limitada disponibilidad de tiempo para la prueba. Por lo tanto, el experimento no probó el aspecto de movilidad del sistema. Durante la prueba de un día, se realizaron 196 disparos. Los resultados se resumen en la Tabla 1. El sistema detectó todos los disparos exitosamente. Dado que una onda de choque balística es un fenómeno acústico único, hace que la detección sea muy robusta. No hubo falsos positivos para las ondas de choque, pero hubo un puñado de detecciones falsas de explosiones de boca de fuego debido a pruebas paralelas de artillería en un campo cercano. Tirador Local- Calibre Trayectoria Trayectoria Distancia No. Tabla 1: Resumen de resultados fusionando todas las observaciones de sensores disponibles. Todas las tomas fueron detectadas con éxito, por lo que la tasa de detección se omite. La tasa de localización significa el porcentaje de disparos cuya trayectoria el sensor de fusión pudo estimar. La tasa de precisión del calibre es relativa a los disparos localizados y no a todos los disparos, ya que la estimación del calibre requiere la trayectoria. El error de trayectoria se descompone en azimut en grados y la distancia real del tirador a la trayectoria. El error de distancia muestra la distancia entre la posición real del tirador y la posición estimada del tirador. Por lo tanto, incluye el error causado tanto por la trayectoria como por la estimación del alcance. Ten en cuenta que las medidas tradicionales de rumbo y alcance no son adecuadas para un sistema distribuido como el nuestro debido a la falta de un único punto de referencia. Figura 12: La interfaz de usuario del sistema mostrando la configuración experimental. Los 10 nodos sensores están etiquetados por su ID y marcados con círculos oscuros. Los objetivos son cuadrados negros marcados como T-1 a T-5. Las flechas largas y blancas señalan la posición del tirador estimada por cada sensor. Donde faltaba, el sensor correspondiente no tuvo suficientes detecciones para medir el AoA de la explosión del cañón, la onda de choque o ambas. La línea negra gruesa y el círculo grande indican la trayectoria estimada y la posición del tirador según lo estimado al fusionar todas las detecciones disponibles de la red. Este disparo desde la línea de los 100 metros en el blanco T-3 fue localizado casi perfectamente por la red de sensores. El calibre y el arma también fueron identificados correctamente. 6 de cada 10 nodos pudieron estimar la ubicación por sí solos. Su precisión de orientación está dentro de un grado, mientras que el alcance tiene un margen de error de menos del 10% en el peor de los casos. La tasa de localización caracteriza la capacidad del sistema para estimar con éxito la trayectoria de los disparos. Dado que la estimación del calibre y la clasificación de armas dependen de la trayectoria, los disparos no localizados tampoco son clasificados. Hubo 7 disparos de 196 que no fueron localizados. La razón de los tiros fallados es el problema de ambigüedad de trayectoria que ocurre cuando el proyectil pasa por un lado de todos los sensores. En este caso, dos trayectorias significativamente diferentes pueden generar el mismo conjunto de observaciones (ver [8] y también la Sección 6.3). En lugar de estimar cuál es más probable o mostrar ambas posibilidades, decidimos no proporcionar una trayectoria en absoluto. Es mejor no dar una respuesta que no sea una alarma de disparo que confundir al soldado. La precisión de la localización se desglosa en la precisión de la trayectoria y la precisión de la estimación de rango. El ángulo de la trayectoria estimada fue mejor que 1 grado, excepto para el rango de 300 m. Dado que el alcance no debería afectar la estimación de la trayectoria siempre y cuando el proyectil pase sobre la red, sospechamos que la ligera disminución en la precisión del ángulo para 300 m se debe a los disparos apresurados que presenciamos que los soldados realizaron cerca del final del día. Esto también se indica por otro dato: la distancia estimada de trayectoria desde los objetivos reales tiene un error promedio de 1.3 m para disparos de 300 m, 0.75 m para disparos de 200 m y 0.6 m para todos menos los disparos de 300 m. Dado que la distancia entre los objetivos y la red de sensores estaba fija, este número no debería mostrar una mejora de 2× solo porque el tirador está más cerca. Dado que el ángulo de la trayectoria en sí no caracteriza el error general, también puede haber una traducción. La Tabla 1 también proporciona la distancia del tirador desde la trayectoria estimada. Estos indican un error que es aproximadamente del 1-2% del rango. Para poner esto en perspectiva, es muy probable que una estimación de trayectoria para un disparo de 100 m pase por o muy cerca de la ventana en la que se encuentra el tirador. Una vez más, creemos que los errores desproporcionadamente mayores a 300 m se deben a errores humanos en la puntería. Dado que la verdad de referencia se obtuvo al conocer la ubicación precisa del tirador y del objetivo, cualquier inexactitud en la trayectoria real se suma directamente al error percibido del sistema. Llamamos estimación de la posición del tirador en la estimación del alcance de la trayectoria calculada debido a la falta de un término mejor. Las estimaciones de alcance son más precisas que el 5% a 50 m y el 10% a 100 m. Sin embargo, esto empeora a un 20% o más para distancias más largas. No teníamos una instalación para probar el sistema antes de la evaluación para rangos superiores a 100 m. Durante la evaluación, nos encontramos con el problema de confundir los ecos de ondas de choque con los disparos de la boca del cañón. Estos ecos llegaron a los sensores antes de la verdadera explosión del cañón solo para disparos a larga distancia, ya que el proyectil viaja 2-3 veces más rápido que la velocidad del sonido, por lo que el tiempo entre la onda de choque (y su posible eco de objetos cercanos) y la explosión del cañón aumenta con el aumento de las distancias. Esto resultó en subestimar el alcance, ya que el sistema medía tiempos más cortos que los reales. Desde la evaluación, ajustamos el algoritmo de detección de explosiones de boca para evitar este problema. Distancia M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% Todos 96% 100% 97% 100% 23% 23% 93% Tabla 2: Resultados de clasificación de armas. Los porcentajes son relativos al número de disparos localizados y no a todos los disparos, ya que el algoritmo de clasificación necesita conocer la trayectoria y el alcance. Ten en cuenta que la diferencia es pequeña; se localizaron 189 disparos de un total de 196. Las tasas de precisión de estimación del calibre y del arma se basan en los 189 disparos que fueron localizados con éxito. Se debe tener en cuenta que hubo un único disparo que fue clasificado erróneamente por el estimador de calibre. La precisión general de clasificación de armas del 73% no parece impresionante. Pero si lo desglosamos en las seis armas diferentes probadas, la imagen cambia drásticamente como se muestra en la Tabla 2. Para cuatro de las armas (AK14, M16, M240 y M107), la tasa de clasificación es casi del 100%. Solo hubo dos tiros de aproximadamente 140 que fallaron. El M4 y el M249 resultaron ser demasiado similares y la mayoría de las veces se confundían entre sí. Una posible explicación es que solo tuvimos un número limitado de disparos de prueba tomados con estas armas justo antes de la evaluación y utilizamos la función de aproximación de desaceleración incorrecta. Cualquier error similar a este fue cometido 122 veces, ya que si simplemente usáramos lo opuesto a la respuesta del sistema donde se indicaba que una de estas armas estaba presente, la precisión habría mejorado 3 veces. Si consideramos estas dos armas como una sola clase de arma, entonces la precisión de clasificación para ella es del 93%. Ten en cuenta que el AK47 y el M240 tienen el mismo calibre (7.62 mm), al igual que el M16, M4 y M249 (5.56 mm). Es decir, el sistema es capaz de diferenciar entre armas del mismo calibre. No tenemos conocimiento de ningún sistema que clasifique armas con tanta precisión. 7.1 Rendimiento de un solo sensor Como se mostró anteriormente, un solo sensor por sí solo es capaz de localizar al tirador si puede determinar tanto la explosión del cañón como el ángulo de llegada de la onda de choque, es decir, necesita medir el tiempo de llegada de ambos en al menos tres canales acústicos. Si bien la detección de ondas de choque es independiente del alcance, a menos que el proyectil se vuelva subsónico, la probabilidad de detectar la explosión del cañón más allá de 150 metros no es suficiente para obtener de manera consistente al menos tres por nodo sensor para la estimación del ángulo de llegada. Por lo tanto, solo evaluamos el rendimiento del sensor único para las 104 tomas que se tomaron desde 50 y 100 m. Tenga en cuenta que utilizamos los mismos datos de prueba que en la sección anterior, pero evaluamos individualmente para cada sensor. La Tabla 3 resume los resultados desglosados por los diez sensores utilizados. Dado que esto ya no es un sistema distribuido, los resultados se dan en relación a la posición del sensor dado, es decir, se proporciona una estimación de rumbo y alcance. Ten en cuenta que muchas de las fuentes comunes de error del sistema en red no tienen relevancia aquí. La sincronización de tiempo no es aplicable. La ubicación absoluta de los sensores es irrelevante (al igual que la ubicación relativa de varios sensores). La orientación de los sensores sigue siendo importante. Existen varias desventajas del caso del sensor único en comparación con el sistema en red: no hay redundancia para compensar otros errores y realizar el rechazo de valores atípicos, la tasa de localización es notablemente más baja, y un solo sensor por sí solo no es capaz de estimar el calibre o clasificar el arma. Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Tabla 3: Precisión de un solo sensor para 108 disparos realizados desde 50 y 100 metros. La tasa de localización se refiere al porcentaje de disparos que el sensor dado pudo localizar por sí solo. Los valores de rumbo y alcance son errores promedio. Caracterizan la precisión de la localización desde la perspectiva de los sensores dados. Los datos indican que el rendimiento de los sensores varió significativamente, especialmente considerando la tasa de localización. Un factor a considerar es la ubicación del sensor dado, incluyendo qué tan lejos estaba de las líneas de disparo y qué tan obstruida estaba su vista. Además, los sensores eran prototipos construidos a mano que no utilizaban ni de cerca empaques/montajes de calidad de producción. A la luz de estos factores, el error promedio general de orientación de 0.9 grados y el error de alcance de 5 m con un espaciado de micrófono de menos de 10 cm son excelentes. Creemos que la fabricación profesional y mejores micrófonos podrían lograr fácilmente un mejor rendimiento que el mejor sensor en nuestro experimento (>60% de tasa de localización y un error de rango de 3 m). Curiosamente, el mayor error en el rango fue de enormes 90 m, claramente debido a alguna detección errónea, sin embargo, el mayor error en la dirección fue de menos de 12 grados, lo cual sigue siendo una buena indicación para el soldado de hacia dónde mirar. La tasa de localización general de todos los sensores individuales fue del 42%, mientras que para disparos de 50 m solamente, esto aumentó al 61%. Se debe tener en cuenta que el campo de tiro fue preparado para simular en cierta medida un área urbana: había algunas estructuras de madera de uno y dos pisos construidas tanto dentro como alrededor del área de despliegue de sensores y las líneas de tiro. Por lo tanto, no todos los sensores tenían línea de visión a todas las posiciones de disparo. Estimamos que en promedio el 10% de los sensores tenían la vista obstruida hacia el tirador. Por lo tanto, podemos afirmar que un sensor dado tenía aproximadamente un 50% de probabilidad de localizar un disparo dentro de 130 m. (Dado que el área de despliegue del sensor era de 30 m de profundidad, los disparos de 100 m corresponden a distancias reales entre 100 y 130 m). Nuevamente, enfatizamos que la localización requiere al menos tres detecciones de explosión de boca de fuego y tres de onda de choque de un posible total de cuatro para cada sensor. La tasa de detección para sensores individuales, correspondiente a al menos una detección de onda de choque por sensor, fue prácticamente del 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 número de sensores porcentaje de disparos Figura 13: Histograma que muestra qué fracción de los 104 disparos tomados desde 50 y 100 metros fueron localizados por al menos cuántos sensores individuales solamente. El 13% de los disparos no fueron detectados por ningún sensor, es decir, ninguno de ellos tuvo detecciones tanto de la explosión del cañón como de la onda de choque. Cabe destacar que casi todos estos disparos fueron localizados con precisión por el sistema en red, es decir, la fusión de sensores utilizando todas las observaciones disponibles en la red de sensores. Sería engañoso interpretar estos resultados como si el sistema estuviera perdiendo la mitad de los disparos. Dado que los soldados nunca trabajan solos y el nodo sensor es relativamente económico para equipar a cada soldado con uno, también necesitamos analizar las tasas de detección globales para cada disparo. La Figura 13 muestra el histograma del porcentaje de disparos vs. el número de sensores individuales que lo localizaron. El 13% de los disparos no fueron localizados por ningún sensor por sí solo, pero el 87% fue localizado por al menos un sensor de diez. 7.2 Fuentes de error En esta sección, analizamos las fuentes de error más significativas que afectan el rendimiento del sistema de localización de tiradores en red y clasificación de armas. Para correlacionar las observaciones distribuidas de los eventos acústicos, los nodos necesitan tener una referencia común de tiempo y espacio. Por lo tanto, los errores en la sincronización del tiempo, la localización de nodos y la orientación de nodos degradan la precisión general del sistema. Nuestro enfoque de sincronización del tiempo produce errores significativamente inferiores a 100 microsegundos. Dado que el sonido viaja aproximadamente 3 cm en ese tiempo, los errores de sincronización temporal tienen un efecto insignificante en el sistema. Por otro lado, la ubicación y orientación del nodo pueden tener un efecto directo en el rendimiento general del sistema. Observa que para analizar esto, no tenemos que recurrir a la simulación, en su lugar podemos utilizar los datos reales de prueba recopilados en Aberdeen. Pero en lugar de utilizar las ubicaciones reales de los sensores conocidas con gran precisión y las orientaciones de los nodos medidas y calibradas casi perfectamente, podemos agregar términos de error a ellas y ejecutar la fusión de sensores. Esto replica exactamente cómo el sistema habría funcionado durante la prueba utilizando las ubicaciones y orientaciones imprecisamente conocidas. Otro aspecto del rendimiento del sistema que se puede evaluar de esta manera es el efecto del número de sensores disponibles. En lugar de utilizar los diez sensores en la fusión de datos, podemos elegir cualquier subconjunto de los nodos para ver cómo disminuye la precisión a medida que reducimos el número de nodos. El siguiente experimento fue llevado a cabo. El número de sensores varió de 2 a 10 en incrementos de 2. Cada ejecución seleccionó los sensores al azar utilizando una distribución uniforme. En cada ejecución, cada nodo fue movido aleatoriamente a una nueva ubicación dentro de un círculo alrededor de su posición real, con un radio determinado por una distribución gaussiana de media cero. Finalmente, las orientaciones de los nodos fueron perturbadas utilizando una distribución gaussiana con media cero. Cada combinación de parámetros se generó 100 veces y se utilizó para los 196 disparos. Los resultados se resumen en la Figura 14. Hay un gráfico de barras en 3D para cada uno de los conjuntos de experimentos con el número fijo de sensores dado. El eje x muestra el error de ubicación del nodo, es decir, la desviación estándar de la distribución gaussiana correspondiente que varió entre 0 y 6 metros. El eje y muestra la desviación estándar del error de orientación del nodo que varió entre 0 y 6 grados. El eje z es el error de azimut de la trayectoria resultante. Se observó que los ángulos de elevación presentaron errores algo mayores que los de azimut. Dado que todos los sensores estaban aproximadamente en un plano horizontal y solo unas pocas posiciones de tirador estaban fuera del mismo plano y solo por unos 2 m, la prueba no fue suficiente para evaluar este aspecto del sistema. Se pueden hacer muchas observaciones interesantes al analizar estos gráficos. Los errores de ubicación del nodo en este rango tienen un efecto pequeño en la precisión. Los errores de orientación de los nodos, por otro lado, degradan notablemente el rendimiento. Aún así, los errores más grandes en este experimento de 3.5 grados para 6 sensores y 5 grados para 2 sensores siguen siendo muy buenos. Ten en cuenta que a medida que aumentan los errores de ubicación y orientación y disminuye el número de sensores, la métrica de rendimiento más afectada de manera significativa es la tasa de localización. Consulta la Tabla 4 para un resumen. La localización exitosa disminuye de casi el 100% a un 50% cuando pasamos de 10 sensores a 2, incluso sin errores adicionales. Esto es causado principalmente por la geometría: para una localización exitosa, la bala necesita pasar sobre la red de sensores, es decir, al menos un sensor debe estar en el lado de la trayectoria distinto al resto de los nodos. (Esta es una simplificación con fines ilustrativos). Si todos los sensores y la trayectoria no son coplanares, la localización puede ser exitosa incluso si el proyectil pasa por un lado de la red. Ver la Sección 6.3. A medida que disminuyeron los números de sensores en el experimento al seleccionar aleatoriamente un subconjunto, la probabilidad de que las trayectorias cumplieran con esta regla disminuyó. Esto también significa que incluso si hay 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 2 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 4 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 6 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 8 sensores Figura 14: El efecto de los errores de localización y orientación del nodo en la precisión del azimut con 2, 4, 6 y 8 nodos. Ten en cuenta que el gráfico para 10 nodos es casi idéntico al caso de 8 nodos, por lo tanto, se omite. Si hay demasiados sensores (es decir, soldados), pero todos están uno al lado del otro, la tasa de localización se verá afectada. Sin embargo, cuando la fusión de sensores proporciona un resultado, sigue siendo preciso incluso con pocos sensores disponibles y errores individuales relativamente grandes. Unas pocas observaciones consistentes llevan a una buena precisión, ya que las inconsistentes son descartadas por el algoritmo. Esto también se ve respaldado por la observación de que, para los casos con un mayor número de sensores (8 o 10), la tasa de localización apenas se ve afectada incluso por errores grandes. Errores/Sensores 2 4 6 8 10 0 m, 0 grados 54% 87% 94% 95% 96% 2 m, 2 grados 53% 80% 91% 96% 96% 6 m, 0 grados 43% 79% 88% 94% 94% 0 m, 6 grados 44% 78% 90% 93% 94% 6 m, 6 grados 41% 73% 85% 89% 92% Tabla 4: Tasa de localización en función del número de sensores utilizados, los errores de ubicación y orientación del nodo sensor. Una de las observaciones más significativas en la Figura 14 y la Tabla 4 es que apenas hay diferencia en los datos para 6, 8 y 10 sensores. Esto significa que hay poco beneficio en agregar más nodos más allá de 6 sensores en cuanto a la precisión se refiere. La velocidad del sonido depende de la temperatura ambiente. El prototipo actual considera constante lo que normalmente se establece antes de una prueba. Sería sencillo emplear un sensor de temperatura para actualizar periódicamente el valor de la velocidad del sonido durante la operación. Tenga en cuenta también que el viento puede afectar negativamente la precisión del sistema. La fusión de sensores, sin embargo, podría incorporar la velocidad del viento en sus cálculos. Sería más complicado que la compensación de temperatura, pero se podría hacer. Otros problemas prácticos también deben ser considerados antes de implementar en el mundo real. Los silenciadores reducen la energía de la explosión en la boca del cañón y, por lo tanto, el alcance efectivo en el que el sistema puede detectarla. Sin embargo, los silenciadores no afectan la onda de choque y el sistema seguiría detectando con precisión la trayectoria y el calibre. El alcance y el tipo de arma no se pudieron estimar sin detectar la explosión en la boca del cañón. Las armas subsónicas no producen una onda de choque. Sin embargo, esto no es de gran importancia, ya que tienen un alcance más corto, menor precisión y mucha menos letalidad. Por lo tanto, su uso no es generalizado y representan menos peligro en cualquier caso. Otro problema es el tipo de munición utilizada. Los ejércitos irregulares pueden usar balas de calidad inferior, incluso fabricadas a mano. Esto afecta la velocidad inicial del proyectil del arma. Para que la clasificación de armas funcione con precisión, el sistema debería ser calibrado con la munición típica utilizada por el adversario dado. TRABAJO RELACIONADO La detección y reconocimiento acústico ha sido objeto de investigación desde principios de los años cincuenta. La zona tiene una estrecha relevancia con el tema de la mecánica del flujo supersónico [20]. Fansler analizó las complejas ondas de presión de campo cercano que ocurren dentro de un pie de la explosión del cañón. El trabajo de Fansler proporciona una buena idea de la onda de presión ideal del estallido del cañón sin contaminación de ecos o efectos de propagación [4]. Los experimentos con distancias mayores desde la boca del cañón fueron realizados por Stoughton [18]. Las mediciones de las ondas de choque balísticas utilizando transductores de presión calibrados en ubicaciones conocidas, velocidades de bala medidas y distancias de error de 355 metros para proyectiles de 5.56 mm y 7.62 mm fueron realizadas. Los resultados indican que la interacción con el suelo se convierte en un problema para distancias de error de 30 metros o más grandes. Otra área de investigación es el procesamiento de señales de la acústica de disparos. El enfoque se centra en la detección robusta y estimación de la longitud de ondas de choque acústicas de pequeño calibre y explosiones de boca de fuego. Posibles técnicas para clasificar señales como ondas de choque o explosiones de boca de fuego incluyen la Transformada de Fourier de tiempo corto (STFT), la distribución de Wigner-Ville pseudo suavizada (SPWVD) y una transformación discreta de wavelet (DWT). Los espectrogramas de tiempo-frecuencia conjunta (JTF) se utilizan para analizar la separación típica de los transitorios de la onda de choque y la explosión del cañón tanto en tiempo como en frecuencia. Mays concluye que la DWT es el mejor método para clasificar señales como ondas de choque o explosiones de boca de fuego porque funciona bien y es menos costoso de calcular que el SPWVD [10]. Los bordes de la onda de choque suelen estar bien definidos y la longitud de la onda de choque está directamente relacionada con las características de la bala. Un artículo de Sadler [14] compara dos métodos de detección de bordes de onda de choque: un detector simple basado en gradientes y un detector de ondaleta de múltiples escalas. También demuestra cómo la longitud de la onda de choque, determinada por los detectores de borde, puede ser utilizada junto con las ecuaciones de Whitham [20] para estimar el calibre de un proyectil. Ten en cuenta que el rendimiento computacional disponible en los nodos sensores, el ancho de banda inalámbrico limitado y los requisitos en tiempo real hacen que estos enfoques sean inviables en nuestra plataforma. Un tema relacionado es la investigación y desarrollo de sistemas experimentales y prototipos de localización de disparos. Los investigadores de BBN han desarrollado el sistema Bullet Ears [3], el cual tiene la capacidad de ser instalado en una posición fija o usado por soldados. El sistema fijo tiene matrices de micrófonos con forma de tetraedro con un espaciado de 1.5 metros. El sistema en general consiste en dos o tres de estos conjuntos espaciados de 20 a 100 metros entre sí. El sistema usado por los soldados cuenta con 12 micrófonos, así como una antena GPS y sensores de orientación montados en un casco. Hay una conexión de RF de baja velocidad desde el casco hasta el cuerpo de procesamiento. Se ha realizado una prueba extensa para medir el rendimiento de ambos tipos de sistemas. El rendimiento de los sistemas fijos fue una orden de magnitud mejor en los cálculos de ángulo, mientras que su rendimiento en alcance fue igualado. La precisión del ángulo del sistema fijo era predominantemente inferior a un grado, mientras que era de alrededor de cinco grados para el montado en el casco. La precisión del rango fue de alrededor del 5 por ciento para ambos sistemas. El problema con este y otros sistemas centralizados similares es la necesidad de que uno o un puñado de matrices de micrófonos estén a la vista del tirador. Una solución basada en redes de sensores tiene la ventaja de un amplio alcance de detección para una mejor cobertura, compensación de efectos de múltiples trayectorias y resolución de múltiples disparos simultáneos [8]. Esto es especialmente importante para operar en áreas urbanas con reverberación acústica. Ten en cuenta que el sistema actual montado en vehículos de BBN llamado BOOMERANG, una versión modificada de Bullet Ears, se utiliza actualmente en Iraq [1]. La empresa ShotSpotter se especializa en sistemas de aplicación de la ley que informan la ubicación de disparos a la policía en cuestión de segundos. El objetivo del sistema es significativamente diferente al de los sistemas militares. Shotspotter informa una precisión típica de 25 m, lo cual es más que suficiente para que la policía responda a 125. También están fabricando sistemas experimentales portátiles para soldados y montados en UAV para uso militar [16], pero no hay especificaciones ni resultados de evaluación disponibles públicamente. 9. CONCLUSIONES La principal contribución de este trabajo es doble. Primero, el rendimiento del sistema distribuido en red en general es excelente. Lo más destacado es la precisión de la trayectoria de un grado, la tasa de estimación de calibre correcta de más del 90% y la tasa de clasificación de armas cercana al 100% para 4 de las 6 armas probadas. El sistema demostró ser muy robusto al aumentar los errores de ubicación y orientación de los nodos y al disminuir el número de sensores disponibles hasta llegar a solo un par. El factor clave detrás de esto es la capacidad de los algoritmos de fusión de sensores para rechazar mediciones erróneas. También vale la pena mencionar que los resultados presentados aquí corresponden al primer y único test del sistema más allá de los 100 m y con seis armas diferentes. Creemos que con las lecciones aprendidas en la prueba, un experimento de campo consecutivo podría haber mostrado resultados significativamente mejorados, especialmente en la estimación de alcance más allá de los 100 m y la clasificación de armas para las dos armas restantes que se confundieron la mayoría de las veces durante la prueba. Segundo, el rendimiento del sistema cuando se utilizaba en modo independiente, es decir, cuando solo los sensores proporcionaban la localización, también fue muy bueno. Si bien la tasa de localización general del 42% por sensor para disparos de hasta 130 m podría mejorarse, la precisión del rumbo de menos de un grado y el error promedio de rango del 5% son notables utilizando los prototipos hechos a mano de los nodos de bajo costo. Se observó que el 87% de los disparos fueron localizados con éxito por al menos uno de los diez sensores utilizados en modo independiente. Creemos que la tecnología está suficientemente madura como para que una próxima revisión del sistema pueda ser comercial. Sin embargo, todavía sería necesario trabajar en aspectos importantes del sistema. Todavía no hemos abordado el manejo de energía. Un nodo actual funciona con 4 pilas AA durante aproximadamente 12 horas de operación continua. Una versión desplegable del nodo sensor debería estar en modo de reposo durante la operación normal y solo despertarse cuando ocurre un evento interesante. Un circuito de disparo analógico podría resolver este problema, sin embargo, el sistema se perdería el primer disparo. En cambio, los canales acústicos deberían ser muestreados y almacenados en un búfer circular. El resto del tablero podría apagarse. Cuando un disparador despierta la placa, los datos acústicos estarían disponibles de inmediato. Los experimentos con una placa de sensores de generación anterior indicaron que esto podría proporcionar un aumento de 10 veces en la vida útil de la batería. Otros problemas pendientes incluyen el empaquetado resistente a la intemperie y la robustez, así como la integración con la infraestructura militar actual. 10. REFERENCIAS [1] Sitio web de BBN Technologies. http://www.bbn.com. [2] E. Danicki. Localización acústica de francotiradores. Archivos de Acústica, 30(2):233-245, 2005. [3] G. L. Duckworth y col. Sistemas acústicos fijos y portátiles para la detección de francotiradores para las fuerzas del orden. En E. M. Carapezza y D. B. Ley, editores, Proc. SPIE Vol. 3577, p. 210-230, páginas 210-230, enero de 1999. [4] K. Fansler. Descripción de la explosión de la boca de fuego mediante modelos de escala modificados. Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.\n\nImpacto y Vibración, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer y D. Culler. El lenguaje nesC: un enfoque holístico para sistemas embebidos en red. Actas del Diseño e Implementación de Lenguajes de Programación (PLDI), junio de 2003. [6] J. Hill, R. Szewczyk, A. Woo, S. Hollar, D. Culler y K. Pister. Direcciones de arquitectura del sistema para sensores en red. en Proc. de ASPLOS 2000, noviembre de 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti y L. Meertens. Localización independiente de la densidad de nodos. Procesamiento de información en redes de sensores (IPSN 06) SPOTS Track, abril de 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti y G. Simon. Sistema contratirador para la guerra urbana. ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Maróti. Marco de enrutamiento de inundaciones dirigidas para redes de sensores inalámbricos. En Actas de la 5ta Conferencia Internacional de Middleware ACM/IFIP/USENIX, páginas 99-114, Nueva York, NY, EE. UU., 2004. Springer-Verlag New York, Inc. [10] B. Mays. \n\nSpringer-Verlag New York, Inc. [10] B. Mays. Clasificación de la onda de choque y la explosión de la boca del cañón mediante análisis conjunto de tiempo-frecuencia y wavelet. Informe técnico, Laboratorio de Investigación del Ejército, Adelphi MD 20783-1197, septiembre de 2001. [11] Plataformas de hardware de TinyOS. http://tinyos.net/scoop/special/hardware. [12] Módulo de radio Crossbow MICAz (MPR2400). http://www.xbow.com/Products/productsdetails.aspx?sid=101. [13] Recursos para usuarios de PicoBlaze. http://www.xilinx.com/ipcenter/processor_central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham y L. C. Sadler. Detección y estimación óptima basada en wavelets de onda de choque. Revista de la Sociedad Acústica de América, 104:955-963, agosto de 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi y P. Dutta. Sobre la escalabilidad de la sincronización de tiempo integrada en enrutamiento. 3er Taller Europeo sobre Redes de Sensores Inalámbricos (EWSN 2006), febrero de 2006. [16] Sitio web de ShotSpotter. http://www.shotspotter.com/products/military.html. [17] G. Simon, M. Maróti, A. Lédeczi, G. Balogh, B. Kušy, A. Nádas, G. Pap, J. Sallai y K. Frampton. Sistema de contratirador basado en redes de sensores. En SenSys 04: Actas de la 2ª conferencia internacional sobre sistemas de sensores en red integrados, páginas 1-12, Nueva York, NY, EE. UU., 2004. ACM Press. [18] R. Stoughton. \n\nACM Press. [18] R. Stoughton. Mediciones de ondas de choque balísticas de pequeño calibre en el aire. Revista de la Sociedad Acústica de América, 102:781-787, agosto de 1997. [19] B. A. Weiss, C. Schlenoff, M. Shneier y A. Virts. Evaluaciones de tecnología y métricas de rendimiento para sensores llevados por soldados para asistencia. En el taller de Métricas de Rendimiento para Sistemas Inteligentes, agosto de 2006. [20] G. Whitham. Patrón de flujo de un proyectil supersónico. Comunicaciones en matemáticas puras y aplicadas, 5(3):301, 1952. 126",
    "original_sentences": [
        "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
        "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
        "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
        "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
        "The system estimates the trajectory, the range, the caliber and the weapon type.",
        "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
        "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
        "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
        "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
        "In October 2006 CNN reported on a new tactic employed by insurgents.",
        "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
        "By the time the soldiers can react, they are gone.",
        "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
        "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
        "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
        "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
        "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
        "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
        "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
        "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
        "The obvious disadvantage of such a system is its static nature.",
        "Once the sensors are distributed, they cover a certain area.",
        "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
        "It is not practical to gather and reuse the sensors, especially under combat conditions.",
        "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
        "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
        "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
        "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
        "The sensor positions and orientation need to be constantly monitored.",
        "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
        "Moreover, the system should be useful to even a single soldier.",
        "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
        "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
        "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
        "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
        "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
        "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
        "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
        "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
        "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
        "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
        "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
        "It is typically a few hundred μsec.",
        "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
        "Our system is based on four microphones connected to a sensorboard.",
        "The board detects shockwaves and muzzle blasts and measures their ToA.",
        "If at least three acoustic channels detect the same event, its AoA is also computed.",
        "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
        "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
        "Also, this method does not estimate a trajectory.",
        "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
        "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
        "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
        "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
        "A wired USB connection is also available.",
        "The sensorfusion algorithm and the user interface get their data through one of these channels.",
        "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
        "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
        "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
        "Refer to Section 7 for an analysis.",
        "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
        "However, we leave the integration of the two technologies for future work. 3.",
        "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
        "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
        "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
        "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
        "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
        "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
        "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
        "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
        "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
        "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
        "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
        "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
        "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
        "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
        "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
        "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
        "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
        "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
        "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
        "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
        "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
        "The first prototype of our system employed 10 sensor nodes.",
        "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
        "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
        "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
        "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
        "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
        "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
        "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
        "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
        "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
        "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
        "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
        "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
        "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
        "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
        "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
        "The results of the sensor fusion are displayed on the PDA screen with low latency.",
        "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
        "The border between software and hardware is considerably blurred on the sensor board.",
        "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
        "However, some of them-most notably the soft processor cores-execute true software programs.",
        "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
        "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
        "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
        "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
        "The same set of registers are also accessible through a UART link with a terminal emulation program.",
        "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
        "The most important results are the time stamps of the detected events.",
        "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
        "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
        "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
        "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
        "The maximum effective bandwidth is 100 Kbps through this interface.",
        "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
        "The control, status and data registers of the UART modules are available through the register file.",
        "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
        "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
        "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
        "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
        "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
        "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
        "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
        "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
        "The signal paths meet only just before the register file.",
        "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
        "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
        "The detectors fetch run-time parameter values from the register file and store their results there as well.",
        "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
        "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
        "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
        "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
        "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
        "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
        "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
        "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
        "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
        "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
        "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
        "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
        "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
        "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
        "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
        "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
        "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
        "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
        "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
        "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
        "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
        "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
        "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
        "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
        "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
        "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
        "Both events are transient by their nature and present very intense stimuli to the microphones.",
        "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
        "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
        "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
        "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
        "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
        "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
        "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
        "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
        "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
        "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
        "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
        "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
        "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
        "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
        "The shockwave detection core is continuously looking for two rising edges within a given interval.",
        "The state machine of the algorithm is shown in Figure 5(b).",
        "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
        "The only feature calculated by the core is the length of the observed shockwave signal.",
        "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
        "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
        "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
        "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
        "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
        "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
        "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
        "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
        "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
        "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
        "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
        "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
        "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
        "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
        "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
        "The algorithm consists of well separated computational tasks outlined below: 1.",
        "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
        "Compute range estimates.",
        "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
        "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
        "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
        "If trajectory available compute caliber (see 6.5). 6.",
        "If caliber available compute weapon type (see 6.6).",
        "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
        "Each sensorboard has four microphones that measure the ToA-s.",
        "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
        "Let us formalize the problem for 3 microphones first.",
        "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
        "First we apply a simple geometry validation step.",
        "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
        "If this condition does not hold, the corresponding detections are discarded.",
        "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
        "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
        "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
        "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
        "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
        "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
        "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
        "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
        "Consider the situation in Figure 7.",
        "A shot was fired from P at time t. Both P and t are unknown.",
        "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
        "The muzzle blast detection is at position P1 with time t1 and AoA u.",
        "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
        "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
        "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
        "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
        "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
        "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
        "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
        "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
        "In this case: t = uvt1−t2 uv−1 .",
        "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
        "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
        "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
        "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
        "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
        "However, it can still be used with a proper deceleration correction function.",
        "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
        "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
        "In the special case when both directions are the same, the trajectory cannot be computed.",
        "In a real world application, the sensors are typically deployed on a plane approximately.",
        "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
        "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
        "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
        "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
        "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
        "Assume that we have N individual shockwave AoA measurements.",
        "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
        "This gives us at most N(N−1) 2 trajectories.",
        "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
        "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
        "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
        "The core set can be found in O(N2 ) time.",
        "The trajectories in the core set are then averaged to get the final trajectory.",
        "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
        "It means all sensors are on the same side of the trajectory.",
        "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
        "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
        "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
        "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
        "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
        "For an example, refer to Figure 8.",
        "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
        "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
        "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
        "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
        "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
        "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
        "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
        "The box with the maximum consistency is divided until the desired precision is reached.",
        "Backtracking is possible to avoid getting stuck in a local maximum.",
        "This approach has been shown to be fast enough for online processing.",
        "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
        "Next let us describe how the consistency function is calculated in detail.",
        "Consider B, a three dimensional box, we would like to compute the consistency value of.",
        "First we consider only the ToA information.",
        "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
        "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
        "Since it is a box and not a single point, this gives us an interval for the shot time.",
        "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
        "For a detailed description of the consistency function and search algorithm, refer to [8].",
        "Here we extend the approach the following way.",
        "We modify the consistency function based on the bearing and range data from individual sensors.",
        "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
        "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
        "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
        "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
        "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
        "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
        "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
        "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
        "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
        "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
        "The experimental data is shown in Figure 9.",
        "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
        "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
        "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
        "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
        "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
        "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
        "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
        "Both weapons have the same caliber.",
        "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
        "All weapons have the same caliber.",
        "Data is approximated using simple linear regression.",
        "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
        "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
        "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
        "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
        "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
        "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
        "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
        "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
        "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
        "The system carries out weapon classification in the following manner.",
        "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
        "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
        "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
        "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
        "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
        "There were five fixed targets behind the sensor network.",
        "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
        "These positions were known to the evaluators, but not to the operators of the system.",
        "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
        "Note that the sensors remained static during the test.",
        "The primary reason for this is that nobody is allowed downrange during live fire tests.",
        "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
        "The experiment, therefore, did not test the mobility aspect of the system.",
        "During the one day test, there were 196 shots fired.",
        "The results are summarized in Table 1.",
        "The system detected all shots successfully.",
        "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
        "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
        "Shooter Local- Caliber Trajectory Trajectory Distance No.",
        "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
        "All shots were successfully detected, so the detection rate is omitted.",
        "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
        "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
        "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
        "The distance error shows the distance between the real shooter position and the estimated shooter position.",
        "As such, it includes the error caused by both the trajectory and that of the range estimation.",
        "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
        "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
        "The targets are black squares marked T-1 through T-5.",
        "The long white arrows point to the shooter position estimated by each sensor.",
        "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
        "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
        "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
        "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
        "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
        "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
        "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
        "There were 7 shots out of 196 that were not localized.",
        "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
        "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
        "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
        "It is better not to give an answer other than a shot alarm than misleading the soldier.",
        "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
        "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
        "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
        "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
        "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
        "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
        "These indicate an error which is about 1-2% of the range.",
        "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
        "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
        "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
        "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
        "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
        "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
        "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
        "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
        "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
        "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
        "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
        "Note that the difference is small; there were 189 shots localized out of the total 196.",
        "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
        "Note that there was a single shot that was falsely classified by the caliber estimator.",
        "The 73% overall weapon classification accuracy does not seem impressive.",
        "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
        "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
        "There were only two shots out of approximately 140 that were missed.",
        "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
        "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
        "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
        "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
        "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
        "That is, the system is able to differentiate between weapons of the same caliber.",
        "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
        "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
        "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
        "Table 3 summarizes the results broken down by the ten sensors utilized.",
        "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
        "Note that many of the common error sources of the networked system do not play a role here.",
        "Time synchronization is not applicable.",
        "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
        "The sensors orientation is still important though.",
        "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
        "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
        "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
        "The bearing and range values are average errors.",
        "They characterize the accuracy of localization from the given sensors perspective.",
        "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
        "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
        "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
        "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
        "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
        "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
        "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
        "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
        "Hence, not all sensors had line-of-sight to all shooting positions.",
        "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
        "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
        "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
        "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
        "It would be misleading to interpret these results as the system missing half the shots.",
        "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
        "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
        "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
        "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
        "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
        "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
        "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
        "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
        "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
        "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
        "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
        "The following experiment was carried out.",
        "The number of sensors were varied from 2 to 10 in increments of 2.",
        "Each run picked the sensors randomly using a uniform distribution.",
        "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
        "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
        "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
        "The results are summarized in Figure 14.",
        "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
        "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
        "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
        "The z-axis is the resulting trajectory azimuth error.",
        "Note that the elevation angles showed somewhat larger errors than the azimuth.",
        "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
        "There are many interesting observation one can make by analyzing these charts.",
        "Node location errors in this range have a small effect on accuracy.",
        "Node orientation errors, on the other hand, noticeably degrade the performance.",
        "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
        "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
        "See Table 4 for a summary.",
        "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
        "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
        "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
        "See Section 6.3.)",
        "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
        "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
        "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
        "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
        "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
        "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
        "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
        "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
        "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
        "The speed of sound depends on the ambient temperature.",
        "The current prototype considers it constant that is typically set before a test.",
        "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
        "Note also that wind may adversely affect the accuracy of the system.",
        "The sensor fusion, however, could incorporate wind speed into its calculations.",
        "It would be more complicated than temperature compensation, but could be done.",
        "Other practical issues also need to be looked at before a real world deployment.",
        "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
        "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
        "The range and weapon type could not be estimated without muzzle blast detections.",
        "Subsonic weapons do not produce a shockwave.",
        "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
        "Hence, their use is not widespread and they pose less danger in any case.",
        "Another issue is the type of ammunition used.",
        "Irregular armies may use substandard, even hand manufactured bullets.",
        "This effects the muzzle velocity of the weapon.",
        "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
        "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
        "The area has a close relevance to the topic of supersonic flow mechanics [20].",
        "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
        "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
        "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
        "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
        "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
        "Another area of research is the signal processing of gunfire acoustics.",
        "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
        "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
        "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
        "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
        "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
        "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
        "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
        "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
        "A related topic is the research and development of experimental and prototype shooter location systems.",
        "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
        "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
        "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
        "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
        "There is a low speed RF connection from the helmet to the processing body.",
        "An extensive test has been conducted to measure the performance of both type of systems.",
        "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
        "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
        "The range accuracy was around 5 percent for both of the systems.",
        "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
        "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
        "This is especially important for operation in acoustically reverberant urban areas.",
        "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
        "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
        "The goal of the system is significantly different than that of military systems.",
        "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
        "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
        "CONCLUSIONS The main contribution of this work is twofold.",
        "First, the performance of the overall distributed networked system is excellent.",
        "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
        "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
        "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
        "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
        "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
        "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
        "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
        "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
        "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
        "However, important aspects of the system would still need to be worked on.",
        "We have not addresses power management yet.",
        "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
        "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
        "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
        "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
        "The rest of the board could be turned off.",
        "When a trigger wakes up the board, the acoustic data would be immediately available.",
        "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
        "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
        "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
        "Acoustic sniper localization.",
        "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
        "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
        "In E. M. Carapezza and D. B.",
        "Law, editors, Proc.",
        "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
        "Description of muzzle blast by modified scaling models.",
        "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
        "The nesC language: a holistic approach to networked embedded systems.",
        "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
        "Woo, S. Hollar, D. Culler, and K. Pister.",
        "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
        "Node-density independent localization.",
        "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
        "Countersniper system for urban warfare.",
        "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
        "Directed flood-routing framework for wireless sensor networks.",
        "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
        "Springer-Verlag New York, Inc. [10] B. Mays.",
        "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
        "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
        "Optimal and wavelet-based shock wave detection and estimation.",
        "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
        "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
        "Sensor network-based countersniper system.",
        "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
        "ACM Press. [18] R. Stoughton.",
        "Measurements of small-caliber ballistic shock waves in air.",
        "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
        "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
        "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
        "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
        "Flow pattern of a supersonic projectile.",
        "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
    ],
    "translated_text_sentences": [
        "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos.",
        "Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA.",
        "Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario.",
        "El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores.",
        "El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma.",
        "El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen.",
        "El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas.",
        "Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1.",
        "INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio.",
        "En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes.",
        "Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad.",
        "Para cuando los soldados pueden reaccionar, ya se han ido.",
        "Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes.",
        "Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003.",
        "El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos.",
        "Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo.",
        "PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia.",
        "La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo.",
        "Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8].",
        "El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos.",
        "La desventaja obvia de un sistema así es su naturaleza estática.",
        "Una vez que los sensores están distribuidos, cubren cierta área.",
        "Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia.",
        "No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate.",
        "Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro.",
        "Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados.",
        "Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie.",
        "Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos.",
        "Las posiciones y la orientación del sensor deben ser monitoreadas constantemente.",
        "Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes.",
        "Además, el sistema debería ser útil incluso para un solo soldado.",
        "Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente.",
        "El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados.",
        "Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12].",
        "Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente.",
        "Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2.",
        "El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos.",
        "La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido.",
        "El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica.",
        "La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido.",
        "La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg.",
        "La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor.",
        "Normalmente son unos pocos cientos de μseg.",
        "Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre.",
        "Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores.",
        "El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada.",
        "Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA.",
        "Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6.",
        "Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta.",
        "Además, este método no estima una trayectoria.",
        "De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones.",
        "Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9].",
        "Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles.",
        "La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados.",
        "Una conexión USB por cable también está disponible.",
        "El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales.",
        "La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes.",
        "Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo.",
        "Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema.",
        "Consulte la Sección 7 para un análisis.",
        "La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7].",
        "Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3.",
        "HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11].",
        "Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo.",
        "Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1).",
        "La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2).",
        "Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea.",
        "Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA.",
        "La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo).",
        "Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta.",
        "Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica.",
        "La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas.",
        "Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs.",
        "La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote).",
        "Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base.",
        "La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC.",
        "La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema.",
        "El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados.",
        "Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo.",
        "Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable).",
        "Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente.",
        "La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth.",
        "Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía.",
        "El primer prototipo de nuestro sistema empleó 10 nodos sensores.",
        "Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a).",
        "El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4.",
        "La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4.",
        "Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas.",
        "El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java.",
        "Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos.",
        "La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador.",
        "De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales.",
        "Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores.",
        "Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación.",
        "Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software.",
        "El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth.",
        "Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace.",
        "Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores.",
        "El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor.",
        "Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia.",
        "Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA.",
        "La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor.",
        "Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware.",
        "Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales.",
        "Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces.",
        "Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos.",
        "Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación.",
        "Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote).",
        "El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal.",
        "Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores).",
        "Los resultados más importantes son los sellos de tiempo de los eventos detectados.",
        "Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA.",
        "La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C.",
        "Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo.",
        "La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él.",
        "El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz.",
        "El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado.",
        "Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros.",
        "Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes.",
        "Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula.",
        "Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth).",
        "Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador.",
        "El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R.",
        "El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa.",
        "Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo.",
        "Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente.",
        "Las rutas de señal se encuentran justo antes del archivo de registros.",
        "Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida.",
        "Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5.",
        "Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí.",
        "El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial.",
        "El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas.",
        "Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM.",
        "Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB.",
        "La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros.",
        "Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea.",
        "Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador.",
        "La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz).",
        "Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo.",
        "Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo.",
        "Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento.",
        "Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación.",
        "Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas.",
        "Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos.",
        "Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc.",
        "Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía).",
        "De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo.",
        "La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores.",
        "El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje.",
        "Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual.",
        "Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local.",
        "El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación.",
        "Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente.",
        "La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6].",
        "Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz.",
        "ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares.",
        "Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos.",
        "Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular.",
        "Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios.",
        "Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias.",
        "Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento.",
        "Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos.",
        "Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente).",
        "Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque.",
        "En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples.",
        "Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal.",
        "Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento.",
        "Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote.",
        "En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente.",
        "Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal.",
        "Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs).",
        "El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado.",
        "La máquina de estados del algoritmo se muestra en la Figura 5(b).",
        "Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax).",
        "La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada.",
        "A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4].",
        "Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a).",
        "Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad.",
        "La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC).",
        "Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC.",
        "Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período.",
        "Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido.",
        "Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente.",
        "El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente.",
        "El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca).",
        "El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b).",
        "Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes.",
        "Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE.",
        "La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6.",
        "La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma.",
        "El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1.",
        "Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2.",
        "Calcular estimaciones de rango.",
        "Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3.",
        "Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4.",
        "Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5.",
        "Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6.",
        "Si el calibre está disponible, calcular el tipo de arma (ver 6.6).",
        "Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor.",
        "Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s.",
        "Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano).",
        "Formalicemos primero el problema para 3 micrófonos.",
        "Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3.",
        "Primero aplicamos un paso de validación de geometría simple.",
        "La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición.",
        "Si esta condición no se cumple, las detecciones correspondientes son descartadas.",
        "Sea v(x, y, z) el vector normal de la dirección de llegada desconocida.",
        "También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3.",
        "Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c).",
        "Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos.",
        "Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden).",
        "Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos.",
        "De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2).",
        "Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque.",
        "Considera la situación en la Figura 7.",
        "Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos.",
        "Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible.",
        "La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u.",
        "La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales.",
        "Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P).",
        "Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie.",
        "Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2).",
        "La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t).",
        "P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t).",
        "P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1.",
        "Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón).",
        "En este caso: t = uvt1−t2 uv−1.",
        "Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango.",
        "Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil.",
        "En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano.",
        "La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala.",
        "Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango.",
        "Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada.",
        "Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2].",
        "El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí.",
        "En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular.",
        "En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente.",
        "En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque.",
        "Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico.",
        "Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque).",
        "Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral.",
        "Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria.",
        "Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque.",
        "Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno.",
        "Esto nos da como máximo N(N−1) 2 trayectorias.",
        "Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria).",
        "Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio.",
        "El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos.",
        "El conjunto central se puede encontrar en tiempo O(N2).",
        "Las trayectorias en el conjunto central se promedian para obtener la trayectoria final.",
        "Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección.",
        "Significa que todos los sensores están en el mismo lado de la trayectoria.",
        "En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido.",
        "Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque.",
        "Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria.",
        "Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles).",
        "Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor.",
        "Para un ejemplo, consulte la Figura 8.",
        "Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque.",
        "Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador.",
        "Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos.",
        "Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8].",
        "La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales.",
        "Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja.",
        "La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas.",
        "La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada.",
        "El retroceso es posible para evitar quedarse atascado en un máximo local.",
        "Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea.",
        "Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida.",
        "A continuación, describamos detalladamente cómo se calcula la función de consistencia.",
        "Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular.",
        "Primero consideramos solo la información de ToA.",
        "Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA.",
        "Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B.",
        "Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo.",
        "El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B.",
        "Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8].",
        "Aquí extendemos el enfoque de la siguiente manera.",
        "Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales.",
        "Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B.",
        "Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B.",
        "En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores.",
        "El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 Estimación de calibre Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20].",
        "Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error.",
        "Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos.",
        "Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores).",
        "Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque.",
        "Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos.",
        "Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes.",
        "Los datos experimentales se muestran en la Figura 9.",
        "La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4).",
        "Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas.",
        "Este método tiene menos del 1% de error en la estimación del calibre cuando se dispone de una estimación precisa de la trayectoria.",
        "En otras palabras, la estimación del calibre solo funciona si se realizan suficientes detecciones de ondas de choque por el sistema para calcular una trayectoria. 120 6.6 Estimación de armas Analizamos todas las características de la señal medida para encontrar información específica de la arma.",
        "Lamentablemente, concluimos que la firma observada de la explosión del cañón no es lo suficientemente característica del arma para fines de clasificación.",
        "Las reflexiones de la explosión de alta energía del freno de boca tienen un impacto mucho mayor en la forma de la señal de la explosión del freno de boca que el arma en sí misma.",
        "Disparar la misma arma desde diferentes lugares causó diferencias más grandes en la señal registrada que disparar diferentes armas desde el mismo lugar. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 rango (m) velocidad (m/s) AK-47 M240 Figura 10: Mediciones de desaceleración de balas de AK47 y M240.",
        "Ambas armas tienen el mismo calibre.",
        "Los datos se aproximan utilizando regresión lineal simple. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 rango (m) velocidad (m/s) M16 M249 M4 Figura 11: Mediciones de desaceleración de balas M16, M249 y M4.",
        "Todas las armas tienen el mismo calibre.",
        "Los datos se aproximan utilizando regresión lineal simple.",
        "Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el tipo de arma.",
        "Esto se debe a que, para un tipo de arma y par de municiones dados, la velocidad inicial es casi constante.",
        "En las Figuras 10 y 11 podemos ver la relación entre el alcance y la velocidad de bala medida para diferentes calibres y armas.",
        "En el rango de velocidad supersónica, la desaceleración de la bala se puede aproximar con una función lineal.",
        "En el caso del calibre 7.62 mm, las dos armas probadas (AK47, M240) pueden ser claramente diferenciadas (Figura 10).",
        "Desafortunadamente, esto no es necesariamente cierto para el calibre 5.56 mm.",
        "El M16 con su mayor velocidad de boca aún puede ser bien clasificado, pero las armas M4 y M249 parecen prácticamente indistinguibles (Figura 11).",
        "Sin embargo, esto puede deberse en parte al número limitado de disparos de práctica que pudimos realizar antes de que comenzaran las pruebas reales.",
        "Más datos de entrenamiento pueden revelar una mejor separación entre las dos armas, ya que sus velocidades de boca publicadas difieren ligeramente.",
        "El sistema lleva a cabo la clasificación de armas de la siguiente manera.",
        "Una vez que se conoce la trayectoria, la velocidad se puede calcular para cada sensor basándose en la geometría de la onda de choque.",
        "Para evaluar un disparo, elegimos el tipo de arma cuya función de desaceleración resulta en el menor error cuadrático medio de los pares estimados de rango-velocidad para la clase de calibre estimada. 7.",
        "RESULTADOS Una evaluación independiente del sistema fue realizada por un equipo de NIST en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen en abril de 2006 [19].",
        "El experimento se llevó a cabo en un campo de tiro con edificios y paredes de madera simulados para soportar posiciones elevadas de tiradores y generar efectos de trayectorias múltiples.",
        "La Figura 12 muestra la interfaz de usuario con una fotografía aérea del sitio. Se desplegaron 10 nodos sensores en puntos relevados en un área de aproximadamente 30×30 m.",
        "Había cinco objetivos fijos detrás de la red de sensores.",
        "Varias posiciones de disparo se ubicaron en cada una de las líneas de tiro a 50, 100, 200 y 300 metros.",
        "Estas posiciones eran conocidas por los evaluadores, pero no por los operadores del sistema.",
        "Se utilizaron seis armas diferentes: AK47 y M240 disparando proyectiles de 7.62 mm, M16, M4 y M249 con munición de 5.56 mm y el M107 de calibre .50.",
        "Ten en cuenta que los sensores permanecieron estáticos durante la prueba.",
        "La razón principal de esto es que a nadie se le permite estar en la zona de tiro durante las pruebas con fuego real.",
        "Utilizar algún tipo de plataforma de control remoto habría sido demasiado complicado dada la limitada disponibilidad de tiempo para la prueba.",
        "Por lo tanto, el experimento no probó el aspecto de movilidad del sistema.",
        "Durante la prueba de un día, se realizaron 196 disparos.",
        "Los resultados se resumen en la Tabla 1.",
        "El sistema detectó todos los disparos exitosamente.",
        "Dado que una onda de choque balística es un fenómeno acústico único, hace que la detección sea muy robusta.",
        "No hubo falsos positivos para las ondas de choque, pero hubo un puñado de detecciones falsas de explosiones de boca de fuego debido a pruebas paralelas de artillería en un campo cercano.",
        "Tirador Local- Calibre Trayectoria Trayectoria Distancia No.",
        "Tabla 1: Resumen de resultados fusionando todas las observaciones de sensores disponibles.",
        "Todas las tomas fueron detectadas con éxito, por lo que la tasa de detección se omite.",
        "La tasa de localización significa el porcentaje de disparos cuya trayectoria el sensor de fusión pudo estimar.",
        "La tasa de precisión del calibre es relativa a los disparos localizados y no a todos los disparos, ya que la estimación del calibre requiere la trayectoria.",
        "El error de trayectoria se descompone en azimut en grados y la distancia real del tirador a la trayectoria.",
        "El error de distancia muestra la distancia entre la posición real del tirador y la posición estimada del tirador.",
        "Por lo tanto, incluye el error causado tanto por la trayectoria como por la estimación del alcance.",
        "Ten en cuenta que las medidas tradicionales de rumbo y alcance no son adecuadas para un sistema distribuido como el nuestro debido a la falta de un único punto de referencia. Figura 12: La interfaz de usuario del sistema mostrando la configuración experimental.",
        "Los 10 nodos sensores están etiquetados por su ID y marcados con círculos oscuros.",
        "Los objetivos son cuadrados negros marcados como T-1 a T-5.",
        "Las flechas largas y blancas señalan la posición del tirador estimada por cada sensor.",
        "Donde faltaba, el sensor correspondiente no tuvo suficientes detecciones para medir el AoA de la explosión del cañón, la onda de choque o ambas.",
        "La línea negra gruesa y el círculo grande indican la trayectoria estimada y la posición del tirador según lo estimado al fusionar todas las detecciones disponibles de la red.",
        "Este disparo desde la línea de los 100 metros en el blanco T-3 fue localizado casi perfectamente por la red de sensores.",
        "El calibre y el arma también fueron identificados correctamente. 6 de cada 10 nodos pudieron estimar la ubicación por sí solos.",
        "Su precisión de orientación está dentro de un grado, mientras que el alcance tiene un margen de error de menos del 10% en el peor de los casos.",
        "La tasa de localización caracteriza la capacidad del sistema para estimar con éxito la trayectoria de los disparos.",
        "Dado que la estimación del calibre y la clasificación de armas dependen de la trayectoria, los disparos no localizados tampoco son clasificados.",
        "Hubo 7 disparos de 196 que no fueron localizados.",
        "La razón de los tiros fallados es el problema de ambigüedad de trayectoria que ocurre cuando el proyectil pasa por un lado de todos los sensores.",
        "En este caso, dos trayectorias significativamente diferentes pueden generar el mismo conjunto de observaciones (ver [8] y también la Sección 6.3).",
        "En lugar de estimar cuál es más probable o mostrar ambas posibilidades, decidimos no proporcionar una trayectoria en absoluto.",
        "Es mejor no dar una respuesta que no sea una alarma de disparo que confundir al soldado.",
        "La precisión de la localización se desglosa en la precisión de la trayectoria y la precisión de la estimación de rango.",
        "El ángulo de la trayectoria estimada fue mejor que 1 grado, excepto para el rango de 300 m.",
        "Dado que el alcance no debería afectar la estimación de la trayectoria siempre y cuando el proyectil pase sobre la red, sospechamos que la ligera disminución en la precisión del ángulo para 300 m se debe a los disparos apresurados que presenciamos que los soldados realizaron cerca del final del día.",
        "Esto también se indica por otro dato: la distancia estimada de trayectoria desde los objetivos reales tiene un error promedio de 1.3 m para disparos de 300 m, 0.75 m para disparos de 200 m y 0.6 m para todos menos los disparos de 300 m.",
        "Dado que la distancia entre los objetivos y la red de sensores estaba fija, este número no debería mostrar una mejora de 2× solo porque el tirador está más cerca.",
        "Dado que el ángulo de la trayectoria en sí no caracteriza el error general, también puede haber una traducción. La Tabla 1 también proporciona la distancia del tirador desde la trayectoria estimada.",
        "Estos indican un error que es aproximadamente del 1-2% del rango.",
        "Para poner esto en perspectiva, es muy probable que una estimación de trayectoria para un disparo de 100 m pase por o muy cerca de la ventana en la que se encuentra el tirador.",
        "Una vez más, creemos que los errores desproporcionadamente mayores a 300 m se deben a errores humanos en la puntería.",
        "Dado que la verdad de referencia se obtuvo al conocer la ubicación precisa del tirador y del objetivo, cualquier inexactitud en la trayectoria real se suma directamente al error percibido del sistema.",
        "Llamamos estimación de la posición del tirador en la estimación del alcance de la trayectoria calculada debido a la falta de un término mejor.",
        "Las estimaciones de alcance son más precisas que el 5% a 50 m y el 10% a 100 m. Sin embargo, esto empeora a un 20% o más para distancias más largas.",
        "No teníamos una instalación para probar el sistema antes de la evaluación para rangos superiores a 100 m. Durante la evaluación, nos encontramos con el problema de confundir los ecos de ondas de choque con los disparos de la boca del cañón.",
        "Estos ecos llegaron a los sensores antes de la verdadera explosión del cañón solo para disparos a larga distancia, ya que el proyectil viaja 2-3 veces más rápido que la velocidad del sonido, por lo que el tiempo entre la onda de choque (y su posible eco de objetos cercanos) y la explosión del cañón aumenta con el aumento de las distancias.",
        "Esto resultó en subestimar el alcance, ya que el sistema medía tiempos más cortos que los reales.",
        "Desde la evaluación, ajustamos el algoritmo de detección de explosiones de boca para evitar este problema.",
        "Distancia M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% Todos 96% 100% 97% 100% 23% 23% 93% Tabla 2: Resultados de clasificación de armas.",
        "Los porcentajes son relativos al número de disparos localizados y no a todos los disparos, ya que el algoritmo de clasificación necesita conocer la trayectoria y el alcance.",
        "Ten en cuenta que la diferencia es pequeña; se localizaron 189 disparos de un total de 196.",
        "Las tasas de precisión de estimación del calibre y del arma se basan en los 189 disparos que fueron localizados con éxito.",
        "Se debe tener en cuenta que hubo un único disparo que fue clasificado erróneamente por el estimador de calibre.",
        "La precisión general de clasificación de armas del 73% no parece impresionante.",
        "Pero si lo desglosamos en las seis armas diferentes probadas, la imagen cambia drásticamente como se muestra en la Tabla 2.",
        "Para cuatro de las armas (AK14, M16, M240 y M107), la tasa de clasificación es casi del 100%.",
        "Solo hubo dos tiros de aproximadamente 140 que fallaron.",
        "El M4 y el M249 resultaron ser demasiado similares y la mayoría de las veces se confundían entre sí.",
        "Una posible explicación es que solo tuvimos un número limitado de disparos de prueba tomados con estas armas justo antes de la evaluación y utilizamos la función de aproximación de desaceleración incorrecta.",
        "Cualquier error similar a este fue cometido 122 veces, ya que si simplemente usáramos lo opuesto a la respuesta del sistema donde se indicaba que una de estas armas estaba presente, la precisión habría mejorado 3 veces.",
        "Si consideramos estas dos armas como una sola clase de arma, entonces la precisión de clasificación para ella es del 93%.",
        "Ten en cuenta que el AK47 y el M240 tienen el mismo calibre (7.62 mm), al igual que el M16, M4 y M249 (5.56 mm).",
        "Es decir, el sistema es capaz de diferenciar entre armas del mismo calibre.",
        "No tenemos conocimiento de ningún sistema que clasifique armas con tanta precisión. 7.1 Rendimiento de un solo sensor Como se mostró anteriormente, un solo sensor por sí solo es capaz de localizar al tirador si puede determinar tanto la explosión del cañón como el ángulo de llegada de la onda de choque, es decir, necesita medir el tiempo de llegada de ambos en al menos tres canales acústicos.",
        "Si bien la detección de ondas de choque es independiente del alcance, a menos que el proyectil se vuelva subsónico, la probabilidad de detectar la explosión del cañón más allá de 150 metros no es suficiente para obtener de manera consistente al menos tres por nodo sensor para la estimación del ángulo de llegada.",
        "Por lo tanto, solo evaluamos el rendimiento del sensor único para las 104 tomas que se tomaron desde 50 y 100 m. Tenga en cuenta que utilizamos los mismos datos de prueba que en la sección anterior, pero evaluamos individualmente para cada sensor.",
        "La Tabla 3 resume los resultados desglosados por los diez sensores utilizados.",
        "Dado que esto ya no es un sistema distribuido, los resultados se dan en relación a la posición del sensor dado, es decir, se proporciona una estimación de rumbo y alcance.",
        "Ten en cuenta que muchas de las fuentes comunes de error del sistema en red no tienen relevancia aquí.",
        "La sincronización de tiempo no es aplicable.",
        "La ubicación absoluta de los sensores es irrelevante (al igual que la ubicación relativa de varios sensores).",
        "La orientación de los sensores sigue siendo importante.",
        "Existen varias desventajas del caso del sensor único en comparación con el sistema en red: no hay redundancia para compensar otros errores y realizar el rechazo de valores atípicos, la tasa de localización es notablemente más baja, y un solo sensor por sí solo no es capaz de estimar el calibre o clasificar el arma.",
        "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Tabla 3: Precisión de un solo sensor para 108 disparos realizados desde 50 y 100 metros.",
        "La tasa de localización se refiere al porcentaje de disparos que el sensor dado pudo localizar por sí solo.",
        "Los valores de rumbo y alcance son errores promedio.",
        "Caracterizan la precisión de la localización desde la perspectiva de los sensores dados.",
        "Los datos indican que el rendimiento de los sensores varió significativamente, especialmente considerando la tasa de localización.",
        "Un factor a considerar es la ubicación del sensor dado, incluyendo qué tan lejos estaba de las líneas de disparo y qué tan obstruida estaba su vista.",
        "Además, los sensores eran prototipos construidos a mano que no utilizaban ni de cerca empaques/montajes de calidad de producción.",
        "A la luz de estos factores, el error promedio general de orientación de 0.9 grados y el error de alcance de 5 m con un espaciado de micrófono de menos de 10 cm son excelentes.",
        "Creemos que la fabricación profesional y mejores micrófonos podrían lograr fácilmente un mejor rendimiento que el mejor sensor en nuestro experimento (>60% de tasa de localización y un error de rango de 3 m).",
        "Curiosamente, el mayor error en el rango fue de enormes 90 m, claramente debido a alguna detección errónea, sin embargo, el mayor error en la dirección fue de menos de 12 grados, lo cual sigue siendo una buena indicación para el soldado de hacia dónde mirar.",
        "La tasa de localización general de todos los sensores individuales fue del 42%, mientras que para disparos de 50 m solamente, esto aumentó al 61%.",
        "Se debe tener en cuenta que el campo de tiro fue preparado para simular en cierta medida un área urbana: había algunas estructuras de madera de uno y dos pisos construidas tanto dentro como alrededor del área de despliegue de sensores y las líneas de tiro.",
        "Por lo tanto, no todos los sensores tenían línea de visión a todas las posiciones de disparo.",
        "Estimamos que en promedio el 10% de los sensores tenían la vista obstruida hacia el tirador.",
        "Por lo tanto, podemos afirmar que un sensor dado tenía aproximadamente un 50% de probabilidad de localizar un disparo dentro de 130 m. (Dado que el área de despliegue del sensor era de 30 m de profundidad, los disparos de 100 m corresponden a distancias reales entre 100 y 130 m). Nuevamente, enfatizamos que la localización requiere al menos tres detecciones de explosión de boca de fuego y tres de onda de choque de un posible total de cuatro para cada sensor.",
        "La tasa de detección para sensores individuales, correspondiente a al menos una detección de onda de choque por sensor, fue prácticamente del 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 número de sensores porcentaje de disparos Figura 13: Histograma que muestra qué fracción de los 104 disparos tomados desde 50 y 100 metros fueron localizados por al menos cuántos sensores individuales solamente. El 13% de los disparos no fueron detectados por ningún sensor, es decir, ninguno de ellos tuvo detecciones tanto de la explosión del cañón como de la onda de choque.",
        "Cabe destacar que casi todos estos disparos fueron localizados con precisión por el sistema en red, es decir, la fusión de sensores utilizando todas las observaciones disponibles en la red de sensores.",
        "Sería engañoso interpretar estos resultados como si el sistema estuviera perdiendo la mitad de los disparos.",
        "Dado que los soldados nunca trabajan solos y el nodo sensor es relativamente económico para equipar a cada soldado con uno, también necesitamos analizar las tasas de detección globales para cada disparo.",
        "La Figura 13 muestra el histograma del porcentaje de disparos vs. el número de sensores individuales que lo localizaron. El 13% de los disparos no fueron localizados por ningún sensor por sí solo, pero el 87% fue localizado por al menos un sensor de diez. 7.2 Fuentes de error En esta sección, analizamos las fuentes de error más significativas que afectan el rendimiento del sistema de localización de tiradores en red y clasificación de armas.",
        "Para correlacionar las observaciones distribuidas de los eventos acústicos, los nodos necesitan tener una referencia común de tiempo y espacio.",
        "Por lo tanto, los errores en la sincronización del tiempo, la localización de nodos y la orientación de nodos degradan la precisión general del sistema. Nuestro enfoque de sincronización del tiempo produce errores significativamente inferiores a 100 microsegundos.",
        "Dado que el sonido viaja aproximadamente 3 cm en ese tiempo, los errores de sincronización temporal tienen un efecto insignificante en el sistema.",
        "Por otro lado, la ubicación y orientación del nodo pueden tener un efecto directo en el rendimiento general del sistema.",
        "Observa que para analizar esto, no tenemos que recurrir a la simulación, en su lugar podemos utilizar los datos reales de prueba recopilados en Aberdeen.",
        "Pero en lugar de utilizar las ubicaciones reales de los sensores conocidas con gran precisión y las orientaciones de los nodos medidas y calibradas casi perfectamente, podemos agregar términos de error a ellas y ejecutar la fusión de sensores.",
        "Esto replica exactamente cómo el sistema habría funcionado durante la prueba utilizando las ubicaciones y orientaciones imprecisamente conocidas.",
        "Otro aspecto del rendimiento del sistema que se puede evaluar de esta manera es el efecto del número de sensores disponibles.",
        "En lugar de utilizar los diez sensores en la fusión de datos, podemos elegir cualquier subconjunto de los nodos para ver cómo disminuye la precisión a medida que reducimos el número de nodos.",
        "El siguiente experimento fue llevado a cabo.",
        "El número de sensores varió de 2 a 10 en incrementos de 2.",
        "Cada ejecución seleccionó los sensores al azar utilizando una distribución uniforme.",
        "En cada ejecución, cada nodo fue movido aleatoriamente a una nueva ubicación dentro de un círculo alrededor de su posición real, con un radio determinado por una distribución gaussiana de media cero.",
        "Finalmente, las orientaciones de los nodos fueron perturbadas utilizando una distribución gaussiana con media cero.",
        "Cada combinación de parámetros se generó 100 veces y se utilizó para los 196 disparos.",
        "Los resultados se resumen en la Figura 14.",
        "Hay un gráfico de barras en 3D para cada uno de los conjuntos de experimentos con el número fijo de sensores dado.",
        "El eje x muestra el error de ubicación del nodo, es decir, la desviación estándar de la distribución gaussiana correspondiente que varió entre 0 y 6 metros.",
        "El eje y muestra la desviación estándar del error de orientación del nodo que varió entre 0 y 6 grados.",
        "El eje z es el error de azimut de la trayectoria resultante.",
        "Se observó que los ángulos de elevación presentaron errores algo mayores que los de azimut.",
        "Dado que todos los sensores estaban aproximadamente en un plano horizontal y solo unas pocas posiciones de tirador estaban fuera del mismo plano y solo por unos 2 m, la prueba no fue suficiente para evaluar este aspecto del sistema.",
        "Se pueden hacer muchas observaciones interesantes al analizar estos gráficos.",
        "Los errores de ubicación del nodo en este rango tienen un efecto pequeño en la precisión.",
        "Los errores de orientación de los nodos, por otro lado, degradan notablemente el rendimiento.",
        "Aún así, los errores más grandes en este experimento de 3.5 grados para 6 sensores y 5 grados para 2 sensores siguen siendo muy buenos.",
        "Ten en cuenta que a medida que aumentan los errores de ubicación y orientación y disminuye el número de sensores, la métrica de rendimiento más afectada de manera significativa es la tasa de localización.",
        "Consulta la Tabla 4 para un resumen.",
        "La localización exitosa disminuye de casi el 100% a un 50% cuando pasamos de 10 sensores a 2, incluso sin errores adicionales.",
        "Esto es causado principalmente por la geometría: para una localización exitosa, la bala necesita pasar sobre la red de sensores, es decir, al menos un sensor debe estar en el lado de la trayectoria distinto al resto de los nodos. (Esta es una simplificación con fines ilustrativos).",
        "Si todos los sensores y la trayectoria no son coplanares, la localización puede ser exitosa incluso si el proyectil pasa por un lado de la red.",
        "Ver la Sección 6.3.",
        "A medida que disminuyeron los números de sensores en el experimento al seleccionar aleatoriamente un subconjunto, la probabilidad de que las trayectorias cumplieran con esta regla disminuyó.",
        "Esto también significa que incluso si hay 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 2 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 4 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 6 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 8 sensores Figura 14: El efecto de los errores de localización y orientación del nodo en la precisión del azimut con 2, 4, 6 y 8 nodos.",
        "Ten en cuenta que el gráfico para 10 nodos es casi idéntico al caso de 8 nodos, por lo tanto, se omite. Si hay demasiados sensores (es decir, soldados), pero todos están uno al lado del otro, la tasa de localización se verá afectada.",
        "Sin embargo, cuando la fusión de sensores proporciona un resultado, sigue siendo preciso incluso con pocos sensores disponibles y errores individuales relativamente grandes.",
        "Unas pocas observaciones consistentes llevan a una buena precisión, ya que las inconsistentes son descartadas por el algoritmo.",
        "Esto también se ve respaldado por la observación de que, para los casos con un mayor número de sensores (8 o 10), la tasa de localización apenas se ve afectada incluso por errores grandes.",
        "Errores/Sensores 2 4 6 8 10 0 m, 0 grados 54% 87% 94% 95% 96% 2 m, 2 grados 53% 80% 91% 96% 96% 6 m, 0 grados 43% 79% 88% 94% 94% 0 m, 6 grados 44% 78% 90% 93% 94% 6 m, 6 grados 41% 73% 85% 89% 92% Tabla 4: Tasa de localización en función del número de sensores utilizados, los errores de ubicación y orientación del nodo sensor.",
        "Una de las observaciones más significativas en la Figura 14 y la Tabla 4 es que apenas hay diferencia en los datos para 6, 8 y 10 sensores.",
        "Esto significa que hay poco beneficio en agregar más nodos más allá de 6 sensores en cuanto a la precisión se refiere.",
        "La velocidad del sonido depende de la temperatura ambiente.",
        "El prototipo actual considera constante lo que normalmente se establece antes de una prueba.",
        "Sería sencillo emplear un sensor de temperatura para actualizar periódicamente el valor de la velocidad del sonido durante la operación.",
        "Tenga en cuenta también que el viento puede afectar negativamente la precisión del sistema.",
        "La fusión de sensores, sin embargo, podría incorporar la velocidad del viento en sus cálculos.",
        "Sería más complicado que la compensación de temperatura, pero se podría hacer.",
        "Otros problemas prácticos también deben ser considerados antes de implementar en el mundo real.",
        "Los silenciadores reducen la energía de la explosión en la boca del cañón y, por lo tanto, el alcance efectivo en el que el sistema puede detectarla.",
        "Sin embargo, los silenciadores no afectan la onda de choque y el sistema seguiría detectando con precisión la trayectoria y el calibre.",
        "El alcance y el tipo de arma no se pudieron estimar sin detectar la explosión en la boca del cañón.",
        "Las armas subsónicas no producen una onda de choque.",
        "Sin embargo, esto no es de gran importancia, ya que tienen un alcance más corto, menor precisión y mucha menos letalidad.",
        "Por lo tanto, su uso no es generalizado y representan menos peligro en cualquier caso.",
        "Otro problema es el tipo de munición utilizada.",
        "Los ejércitos irregulares pueden usar balas de calidad inferior, incluso fabricadas a mano.",
        "Esto afecta la velocidad inicial del proyectil del arma.",
        "Para que la clasificación de armas funcione con precisión, el sistema debería ser calibrado con la munición típica utilizada por el adversario dado.",
        "TRABAJO RELACIONADO La detección y reconocimiento acústico ha sido objeto de investigación desde principios de los años cincuenta.",
        "La zona tiene una estrecha relevancia con el tema de la mecánica del flujo supersónico [20].",
        "Fansler analizó las complejas ondas de presión de campo cercano que ocurren dentro de un pie de la explosión del cañón.",
        "El trabajo de Fansler proporciona una buena idea de la onda de presión ideal del estallido del cañón sin contaminación de ecos o efectos de propagación [4].",
        "Los experimentos con distancias mayores desde la boca del cañón fueron realizados por Stoughton [18].",
        "Las mediciones de las ondas de choque balísticas utilizando transductores de presión calibrados en ubicaciones conocidas, velocidades de bala medidas y distancias de error de 355 metros para proyectiles de 5.56 mm y 7.62 mm fueron realizadas.",
        "Los resultados indican que la interacción con el suelo se convierte en un problema para distancias de error de 30 metros o más grandes.",
        "Otra área de investigación es el procesamiento de señales de la acústica de disparos.",
        "El enfoque se centra en la detección robusta y estimación de la longitud de ondas de choque acústicas de pequeño calibre y explosiones de boca de fuego.",
        "Posibles técnicas para clasificar señales como ondas de choque o explosiones de boca de fuego incluyen la Transformada de Fourier de tiempo corto (STFT), la distribución de Wigner-Ville pseudo suavizada (SPWVD) y una transformación discreta de wavelet (DWT).",
        "Los espectrogramas de tiempo-frecuencia conjunta (JTF) se utilizan para analizar la separación típica de los transitorios de la onda de choque y la explosión del cañón tanto en tiempo como en frecuencia.",
        "Mays concluye que la DWT es el mejor método para clasificar señales como ondas de choque o explosiones de boca de fuego porque funciona bien y es menos costoso de calcular que el SPWVD [10].",
        "Los bordes de la onda de choque suelen estar bien definidos y la longitud de la onda de choque está directamente relacionada con las características de la bala.",
        "Un artículo de Sadler [14] compara dos métodos de detección de bordes de onda de choque: un detector simple basado en gradientes y un detector de ondaleta de múltiples escalas.",
        "También demuestra cómo la longitud de la onda de choque, determinada por los detectores de borde, puede ser utilizada junto con las ecuaciones de Whitham [20] para estimar el calibre de un proyectil.",
        "Ten en cuenta que el rendimiento computacional disponible en los nodos sensores, el ancho de banda inalámbrico limitado y los requisitos en tiempo real hacen que estos enfoques sean inviables en nuestra plataforma.",
        "Un tema relacionado es la investigación y desarrollo de sistemas experimentales y prototipos de localización de disparos.",
        "Los investigadores de BBN han desarrollado el sistema Bullet Ears [3], el cual tiene la capacidad de ser instalado en una posición fija o usado por soldados.",
        "El sistema fijo tiene matrices de micrófonos con forma de tetraedro con un espaciado de 1.5 metros.",
        "El sistema en general consiste en dos o tres de estos conjuntos espaciados de 20 a 100 metros entre sí.",
        "El sistema usado por los soldados cuenta con 12 micrófonos, así como una antena GPS y sensores de orientación montados en un casco.",
        "Hay una conexión de RF de baja velocidad desde el casco hasta el cuerpo de procesamiento.",
        "Se ha realizado una prueba extensa para medir el rendimiento de ambos tipos de sistemas.",
        "El rendimiento de los sistemas fijos fue una orden de magnitud mejor en los cálculos de ángulo, mientras que su rendimiento en alcance fue igualado.",
        "La precisión del ángulo del sistema fijo era predominantemente inferior a un grado, mientras que era de alrededor de cinco grados para el montado en el casco.",
        "La precisión del rango fue de alrededor del 5 por ciento para ambos sistemas.",
        "El problema con este y otros sistemas centralizados similares es la necesidad de que uno o un puñado de matrices de micrófonos estén a la vista del tirador.",
        "Una solución basada en redes de sensores tiene la ventaja de un amplio alcance de detección para una mejor cobertura, compensación de efectos de múltiples trayectorias y resolución de múltiples disparos simultáneos [8].",
        "Esto es especialmente importante para operar en áreas urbanas con reverberación acústica.",
        "Ten en cuenta que el sistema actual montado en vehículos de BBN llamado BOOMERANG, una versión modificada de Bullet Ears, se utiliza actualmente en Iraq [1].",
        "La empresa ShotSpotter se especializa en sistemas de aplicación de la ley que informan la ubicación de disparos a la policía en cuestión de segundos.",
        "El objetivo del sistema es significativamente diferente al de los sistemas militares.",
        "Shotspotter informa una precisión típica de 25 m, lo cual es más que suficiente para que la policía responda a 125.",
        "También están fabricando sistemas experimentales portátiles para soldados y montados en UAV para uso militar [16], pero no hay especificaciones ni resultados de evaluación disponibles públicamente. 9.",
        "CONCLUSIONES La principal contribución de este trabajo es doble.",
        "Primero, el rendimiento del sistema distribuido en red en general es excelente.",
        "Lo más destacado es la precisión de la trayectoria de un grado, la tasa de estimación de calibre correcta de más del 90% y la tasa de clasificación de armas cercana al 100% para 4 de las 6 armas probadas.",
        "El sistema demostró ser muy robusto al aumentar los errores de ubicación y orientación de los nodos y al disminuir el número de sensores disponibles hasta llegar a solo un par.",
        "El factor clave detrás de esto es la capacidad de los algoritmos de fusión de sensores para rechazar mediciones erróneas.",
        "También vale la pena mencionar que los resultados presentados aquí corresponden al primer y único test del sistema más allá de los 100 m y con seis armas diferentes.",
        "Creemos que con las lecciones aprendidas en la prueba, un experimento de campo consecutivo podría haber mostrado resultados significativamente mejorados, especialmente en la estimación de alcance más allá de los 100 m y la clasificación de armas para las dos armas restantes que se confundieron la mayoría de las veces durante la prueba.",
        "Segundo, el rendimiento del sistema cuando se utilizaba en modo independiente, es decir, cuando solo los sensores proporcionaban la localización, también fue muy bueno.",
        "Si bien la tasa de localización general del 42% por sensor para disparos de hasta 130 m podría mejorarse, la precisión del rumbo de menos de un grado y el error promedio de rango del 5% son notables utilizando los prototipos hechos a mano de los nodos de bajo costo.",
        "Se observó que el 87% de los disparos fueron localizados con éxito por al menos uno de los diez sensores utilizados en modo independiente.",
        "Creemos que la tecnología está suficientemente madura como para que una próxima revisión del sistema pueda ser comercial.",
        "Sin embargo, todavía sería necesario trabajar en aspectos importantes del sistema.",
        "Todavía no hemos abordado el manejo de energía.",
        "Un nodo actual funciona con 4 pilas AA durante aproximadamente 12 horas de operación continua.",
        "Una versión desplegable del nodo sensor debería estar en modo de reposo durante la operación normal y solo despertarse cuando ocurre un evento interesante.",
        "Un circuito de disparo analógico podría resolver este problema, sin embargo, el sistema se perdería el primer disparo.",
        "En cambio, los canales acústicos deberían ser muestreados y almacenados en un búfer circular.",
        "El resto del tablero podría apagarse.",
        "Cuando un disparador despierta la placa, los datos acústicos estarían disponibles de inmediato.",
        "Los experimentos con una placa de sensores de generación anterior indicaron que esto podría proporcionar un aumento de 10 veces en la vida útil de la batería.",
        "Otros problemas pendientes incluyen el empaquetado resistente a la intemperie y la robustez, así como la integración con la infraestructura militar actual. 10.",
        "REFERENCIAS [1] Sitio web de BBN Technologies. http://www.bbn.com. [2] E. Danicki.",
        "Localización acústica de francotiradores.",
        "Archivos de Acústica, 30(2):233-245, 2005. [3] G. L. Duckworth y col.",
        "Sistemas acústicos fijos y portátiles para la detección de francotiradores para las fuerzas del orden.",
        "En E. M. Carapezza y D. B.",
        "Ley, editores, Proc.",
        "SPIE Vol. 3577, p. 210-230, páginas 210-230, enero de 1999. [4] K. Fansler.",
        "Descripción de la explosión de la boca de fuego mediante modelos de escala modificados.",
        "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.\n\nImpacto y Vibración, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer y D. Culler.",
        "El lenguaje nesC: un enfoque holístico para sistemas embebidos en red.",
        "Actas del Diseño e Implementación de Lenguajes de Programación (PLDI), junio de 2003. [6] J. Hill, R. Szewczyk, A.",
        "Woo, S. Hollar, D. Culler y K. Pister.",
        "Direcciones de arquitectura del sistema para sensores en red. en Proc. de ASPLOS 2000, noviembre de 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti y L. Meertens.",
        "Localización independiente de la densidad de nodos.",
        "Procesamiento de información en redes de sensores (IPSN 06) SPOTS Track, abril de 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti y G. Simon.",
        "Sistema contratirador para la guerra urbana.",
        "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Maróti.",
        "Marco de enrutamiento de inundaciones dirigidas para redes de sensores inalámbricos.",
        "En Actas de la 5ta Conferencia Internacional de Middleware ACM/IFIP/USENIX, páginas 99-114, Nueva York, NY, EE. UU., 2004.",
        "Springer-Verlag New York, Inc. [10] B. Mays. \n\nSpringer-Verlag New York, Inc. [10] B. Mays.",
        "Clasificación de la onda de choque y la explosión de la boca del cañón mediante análisis conjunto de tiempo-frecuencia y wavelet.",
        "Informe técnico, Laboratorio de Investigación del Ejército, Adelphi MD 20783-1197, septiembre de 2001. [11] Plataformas de hardware de TinyOS. http://tinyos.net/scoop/special/hardware. [12] Módulo de radio Crossbow MICAz (MPR2400). http://www.xbow.com/Products/productsdetails.aspx?sid=101. [13] Recursos para usuarios de PicoBlaze. http://www.xilinx.com/ipcenter/processor_central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham y L. C. Sadler.",
        "Detección y estimación óptima basada en wavelets de onda de choque.",
        "Revista de la Sociedad Acústica de América, 104:955-963, agosto de 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi y P. Dutta.",
        "Sobre la escalabilidad de la sincronización de tiempo integrada en enrutamiento. 3er Taller Europeo sobre Redes de Sensores Inalámbricos (EWSN 2006), febrero de 2006. [16] Sitio web de ShotSpotter. http://www.shotspotter.com/products/military.html. [17] G. Simon, M. Maróti, A. Lédeczi, G. Balogh, B. Kušy, A. Nádas, G. Pap, J. Sallai y K. Frampton.",
        "Sistema de contratirador basado en redes de sensores.",
        "En SenSys 04: Actas de la 2ª conferencia internacional sobre sistemas de sensores en red integrados, páginas 1-12, Nueva York, NY, EE. UU., 2004.",
        "ACM Press. [18] R. Stoughton. \n\nACM Press. [18] R. Stoughton.",
        "Mediciones de ondas de choque balísticas de pequeño calibre en el aire.",
        "Revista de la Sociedad Acústica de América, 102:781-787, agosto de 1997. [19] B.",
        "A. Weiss, C. Schlenoff, M. Shneier y A. Virts.",
        "Evaluaciones de tecnología y métricas de rendimiento para sensores llevados por soldados para asistencia.",
        "En el taller de Métricas de Rendimiento para Sistemas Inteligentes, agosto de 2006. [20] G. Whitham.",
        "Patrón de flujo de un proyectil supersónico.",
        "Comunicaciones en matemáticas puras y aplicadas, 5(3):301, 1952. 126"
    ],
    "error_count": 2,
    "keys": {
        "wireless sensor network-based mobile countersniper system": {
            "translated_key": "sistema móvil contra francotiradores basado en una red de sensores inalámbricos",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a <br>wireless sensor network-based mobile countersniper system</br>.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a <br>wireless sensor network-based mobile countersniper system</br>."
            ],
            "translated_annotated_samples": [
                "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un <br>sistema móvil contra francotiradores basado en una red de sensores inalámbricos</br>."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un <br>sistema móvil contra francotiradores basado en una red de sensores inalámbricos</br>. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo. La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él. El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz. El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado. Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros. Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes. Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula. Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth). Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador. El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R. El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa. Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo. Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente. Las rutas de señal se encuentran justo antes del archivo de registros. Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida. Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5. Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí. El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial. El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas. Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM. Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB. La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros. Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea. Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador. La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz). Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo. Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo. Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento. Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación. Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas. Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos. Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc. Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía). De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo. La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores. El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje. Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual. Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local. El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación. Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente. La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6]. Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz. ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares. Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos. Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular. Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios. Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias. Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento. Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos. Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente). Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque. En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples. Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal. Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento. Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote. En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente. Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal. Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs). El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado. La máquina de estados del algoritmo se muestra en la Figura 5(b). Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax). La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada. A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4]. Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a). Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad. La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC). Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC. Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período. Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido. Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente. El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente. El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca). El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b). Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes. Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE. La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6. La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma. El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1. Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2. Calcular estimaciones de rango. Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3. Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4. Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5. Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6. Si el calibre está disponible, calcular el tipo de arma (ver 6.6). Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor. Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s. Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano). Formalicemos primero el problema para 3 micrófonos. Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3. Primero aplicamos un paso de validación de geometría simple. La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición. Si esta condición no se cumple, las detecciones correspondientes son descartadas. Sea v(x, y, z) el vector normal de la dirección de llegada desconocida. También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3. Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c). Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos. Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden). Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos. De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2). Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque. Considera la situación en la Figura 7. Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos. Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible. La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u. La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales. Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P). Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie. Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2). La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t). P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1. Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón). En este caso: t = uvt1−t2 uv−1. Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango. Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil. En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano. La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala. Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango. Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada. Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2]. El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí. En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular. En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente. En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque. Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico. Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque). Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral. Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria. Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque. Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno. Esto nos da como máximo N(N−1) 2 trayectorias. Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria). Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio. El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos. El conjunto central se puede encontrar en tiempo O(N2). Las trayectorias en el conjunto central se promedian para obtener la trayectoria final. Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección. Significa que todos los sensores están en el mismo lado de la trayectoria. En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido. Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque. Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria. Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles). Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor. Para un ejemplo, consulte la Figura 8. Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque. Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador. Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos. Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8]. La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales. Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja. La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas. La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada. El retroceso es posible para evitar quedarse atascado en un máximo local. Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea. Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida. A continuación, describamos detalladamente cómo se calcula la función de consistencia. Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular. Primero consideramos solo la información de ToA. Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA. Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B. Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo. El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B. Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8]. Aquí extendemos el enfoque de la siguiente manera. Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales. Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B. Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B. En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores. El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 Estimación de calibre Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20]. Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error. Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos. Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores). Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque. Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos. Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes. Los datos experimentales se muestran en la Figura 9. La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4). Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas. Este método tiene menos del 1% de error en la estimación del calibre cuando se dispone de una estimación precisa de la trayectoria. En otras palabras, la estimación del calibre solo funciona si se realizan suficientes detecciones de ondas de choque por el sistema para calcular una trayectoria. 120 6.6 Estimación de armas Analizamos todas las características de la señal medida para encontrar información específica de la arma. Lamentablemente, concluimos que la firma observada de la explosión del cañón no es lo suficientemente característica del arma para fines de clasificación. Las reflexiones de la explosión de alta energía del freno de boca tienen un impacto mucho mayor en la forma de la señal de la explosión del freno de boca que el arma en sí misma. Disparar la misma arma desde diferentes lugares causó diferencias más grandes en la señal registrada que disparar diferentes armas desde el mismo lugar. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 rango (m) velocidad (m/s) AK-47 M240 Figura 10: Mediciones de desaceleración de balas de AK47 y M240. Ambas armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 rango (m) velocidad (m/s) M16 M249 M4 Figura 11: Mediciones de desaceleración de balas M16, M249 y M4. Todas las armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el tipo de arma. Esto se debe a que, para un tipo de arma y par de municiones dados, la velocidad inicial es casi constante. En las Figuras 10 y 11 podemos ver la relación entre el alcance y la velocidad de bala medida para diferentes calibres y armas. En el rango de velocidad supersónica, la desaceleración de la bala se puede aproximar con una función lineal. En el caso del calibre 7.62 mm, las dos armas probadas (AK47, M240) pueden ser claramente diferenciadas (Figura 10). Desafortunadamente, esto no es necesariamente cierto para el calibre 5.56 mm. El M16 con su mayor velocidad de boca aún puede ser bien clasificado, pero las armas M4 y M249 parecen prácticamente indistinguibles (Figura 11). Sin embargo, esto puede deberse en parte al número limitado de disparos de práctica que pudimos realizar antes de que comenzaran las pruebas reales. Más datos de entrenamiento pueden revelar una mejor separación entre las dos armas, ya que sus velocidades de boca publicadas difieren ligeramente. El sistema lleva a cabo la clasificación de armas de la siguiente manera. Una vez que se conoce la trayectoria, la velocidad se puede calcular para cada sensor basándose en la geometría de la onda de choque. Para evaluar un disparo, elegimos el tipo de arma cuya función de desaceleración resulta en el menor error cuadrático medio de los pares estimados de rango-velocidad para la clase de calibre estimada. 7. RESULTADOS Una evaluación independiente del sistema fue realizada por un equipo de NIST en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen en abril de 2006 [19]. El experimento se llevó a cabo en un campo de tiro con edificios y paredes de madera simulados para soportar posiciones elevadas de tiradores y generar efectos de trayectorias múltiples. La Figura 12 muestra la interfaz de usuario con una fotografía aérea del sitio. Se desplegaron 10 nodos sensores en puntos relevados en un área de aproximadamente 30×30 m. Había cinco objetivos fijos detrás de la red de sensores. Varias posiciones de disparo se ubicaron en cada una de las líneas de tiro a 50, 100, 200 y 300 metros. Estas posiciones eran conocidas por los evaluadores, pero no por los operadores del sistema. Se utilizaron seis armas diferentes: AK47 y M240 disparando proyectiles de 7.62 mm, M16, M4 y M249 con munición de 5.56 mm y el M107 de calibre .50. Ten en cuenta que los sensores permanecieron estáticos durante la prueba. La razón principal de esto es que a nadie se le permite estar en la zona de tiro durante las pruebas con fuego real. Utilizar algún tipo de plataforma de control remoto habría sido demasiado complicado dada la limitada disponibilidad de tiempo para la prueba. Por lo tanto, el experimento no probó el aspecto de movilidad del sistema. Durante la prueba de un día, se realizaron 196 disparos. Los resultados se resumen en la Tabla 1. El sistema detectó todos los disparos exitosamente. Dado que una onda de choque balística es un fenómeno acústico único, hace que la detección sea muy robusta. No hubo falsos positivos para las ondas de choque, pero hubo un puñado de detecciones falsas de explosiones de boca de fuego debido a pruebas paralelas de artillería en un campo cercano. Tirador Local- Calibre Trayectoria Trayectoria Distancia No. Tabla 1: Resumen de resultados fusionando todas las observaciones de sensores disponibles. Todas las tomas fueron detectadas con éxito, por lo que la tasa de detección se omite. La tasa de localización significa el porcentaje de disparos cuya trayectoria el sensor de fusión pudo estimar. La tasa de precisión del calibre es relativa a los disparos localizados y no a todos los disparos, ya que la estimación del calibre requiere la trayectoria. El error de trayectoria se descompone en azimut en grados y la distancia real del tirador a la trayectoria. El error de distancia muestra la distancia entre la posición real del tirador y la posición estimada del tirador. Por lo tanto, incluye el error causado tanto por la trayectoria como por la estimación del alcance. Ten en cuenta que las medidas tradicionales de rumbo y alcance no son adecuadas para un sistema distribuido como el nuestro debido a la falta de un único punto de referencia. Figura 12: La interfaz de usuario del sistema mostrando la configuración experimental. Los 10 nodos sensores están etiquetados por su ID y marcados con círculos oscuros. Los objetivos son cuadrados negros marcados como T-1 a T-5. Las flechas largas y blancas señalan la posición del tirador estimada por cada sensor. Donde faltaba, el sensor correspondiente no tuvo suficientes detecciones para medir el AoA de la explosión del cañón, la onda de choque o ambas. La línea negra gruesa y el círculo grande indican la trayectoria estimada y la posición del tirador según lo estimado al fusionar todas las detecciones disponibles de la red. Este disparo desde la línea de los 100 metros en el blanco T-3 fue localizado casi perfectamente por la red de sensores. El calibre y el arma también fueron identificados correctamente. 6 de cada 10 nodos pudieron estimar la ubicación por sí solos. Su precisión de orientación está dentro de un grado, mientras que el alcance tiene un margen de error de menos del 10% en el peor de los casos. La tasa de localización caracteriza la capacidad del sistema para estimar con éxito la trayectoria de los disparos. Dado que la estimación del calibre y la clasificación de armas dependen de la trayectoria, los disparos no localizados tampoco son clasificados. Hubo 7 disparos de 196 que no fueron localizados. La razón de los tiros fallados es el problema de ambigüedad de trayectoria que ocurre cuando el proyectil pasa por un lado de todos los sensores. En este caso, dos trayectorias significativamente diferentes pueden generar el mismo conjunto de observaciones (ver [8] y también la Sección 6.3). En lugar de estimar cuál es más probable o mostrar ambas posibilidades, decidimos no proporcionar una trayectoria en absoluto. Es mejor no dar una respuesta que no sea una alarma de disparo que confundir al soldado. La precisión de la localización se desglosa en la precisión de la trayectoria y la precisión de la estimación de rango. El ángulo de la trayectoria estimada fue mejor que 1 grado, excepto para el rango de 300 m. Dado que el alcance no debería afectar la estimación de la trayectoria siempre y cuando el proyectil pase sobre la red, sospechamos que la ligera disminución en la precisión del ángulo para 300 m se debe a los disparos apresurados que presenciamos que los soldados realizaron cerca del final del día. Esto también se indica por otro dato: la distancia estimada de trayectoria desde los objetivos reales tiene un error promedio de 1.3 m para disparos de 300 m, 0.75 m para disparos de 200 m y 0.6 m para todos menos los disparos de 300 m. Dado que la distancia entre los objetivos y la red de sensores estaba fija, este número no debería mostrar una mejora de 2× solo porque el tirador está más cerca. Dado que el ángulo de la trayectoria en sí no caracteriza el error general, también puede haber una traducción. La Tabla 1 también proporciona la distancia del tirador desde la trayectoria estimada. Estos indican un error que es aproximadamente del 1-2% del rango. Para poner esto en perspectiva, es muy probable que una estimación de trayectoria para un disparo de 100 m pase por o muy cerca de la ventana en la que se encuentra el tirador. Una vez más, creemos que los errores desproporcionadamente mayores a 300 m se deben a errores humanos en la puntería. Dado que la verdad de referencia se obtuvo al conocer la ubicación precisa del tirador y del objetivo, cualquier inexactitud en la trayectoria real se suma directamente al error percibido del sistema. Llamamos estimación de la posición del tirador en la estimación del alcance de la trayectoria calculada debido a la falta de un término mejor. Las estimaciones de alcance son más precisas que el 5% a 50 m y el 10% a 100 m. Sin embargo, esto empeora a un 20% o más para distancias más largas. No teníamos una instalación para probar el sistema antes de la evaluación para rangos superiores a 100 m. Durante la evaluación, nos encontramos con el problema de confundir los ecos de ondas de choque con los disparos de la boca del cañón. Estos ecos llegaron a los sensores antes de la verdadera explosión del cañón solo para disparos a larga distancia, ya que el proyectil viaja 2-3 veces más rápido que la velocidad del sonido, por lo que el tiempo entre la onda de choque (y su posible eco de objetos cercanos) y la explosión del cañón aumenta con el aumento de las distancias. Esto resultó en subestimar el alcance, ya que el sistema medía tiempos más cortos que los reales. Desde la evaluación, ajustamos el algoritmo de detección de explosiones de boca para evitar este problema. Distancia M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% Todos 96% 100% 97% 100% 23% 23% 93% Tabla 2: Resultados de clasificación de armas. Los porcentajes son relativos al número de disparos localizados y no a todos los disparos, ya que el algoritmo de clasificación necesita conocer la trayectoria y el alcance. Ten en cuenta que la diferencia es pequeña; se localizaron 189 disparos de un total de 196. Las tasas de precisión de estimación del calibre y del arma se basan en los 189 disparos que fueron localizados con éxito. Se debe tener en cuenta que hubo un único disparo que fue clasificado erróneamente por el estimador de calibre. La precisión general de clasificación de armas del 73% no parece impresionante. Pero si lo desglosamos en las seis armas diferentes probadas, la imagen cambia drásticamente como se muestra en la Tabla 2. Para cuatro de las armas (AK14, M16, M240 y M107), la tasa de clasificación es casi del 100%. Solo hubo dos tiros de aproximadamente 140 que fallaron. El M4 y el M249 resultaron ser demasiado similares y la mayoría de las veces se confundían entre sí. Una posible explicación es que solo tuvimos un número limitado de disparos de prueba tomados con estas armas justo antes de la evaluación y utilizamos la función de aproximación de desaceleración incorrecta. Cualquier error similar a este fue cometido 122 veces, ya que si simplemente usáramos lo opuesto a la respuesta del sistema donde se indicaba que una de estas armas estaba presente, la precisión habría mejorado 3 veces. Si consideramos estas dos armas como una sola clase de arma, entonces la precisión de clasificación para ella es del 93%. Ten en cuenta que el AK47 y el M240 tienen el mismo calibre (7.62 mm), al igual que el M16, M4 y M249 (5.56 mm). Es decir, el sistema es capaz de diferenciar entre armas del mismo calibre. No tenemos conocimiento de ningún sistema que clasifique armas con tanta precisión. 7.1 Rendimiento de un solo sensor Como se mostró anteriormente, un solo sensor por sí solo es capaz de localizar al tirador si puede determinar tanto la explosión del cañón como el ángulo de llegada de la onda de choque, es decir, necesita medir el tiempo de llegada de ambos en al menos tres canales acústicos. Si bien la detección de ondas de choque es independiente del alcance, a menos que el proyectil se vuelva subsónico, la probabilidad de detectar la explosión del cañón más allá de 150 metros no es suficiente para obtener de manera consistente al menos tres por nodo sensor para la estimación del ángulo de llegada. Por lo tanto, solo evaluamos el rendimiento del sensor único para las 104 tomas que se tomaron desde 50 y 100 m. Tenga en cuenta que utilizamos los mismos datos de prueba que en la sección anterior, pero evaluamos individualmente para cada sensor. La Tabla 3 resume los resultados desglosados por los diez sensores utilizados. Dado que esto ya no es un sistema distribuido, los resultados se dan en relación a la posición del sensor dado, es decir, se proporciona una estimación de rumbo y alcance. Ten en cuenta que muchas de las fuentes comunes de error del sistema en red no tienen relevancia aquí. La sincronización de tiempo no es aplicable. La ubicación absoluta de los sensores es irrelevante (al igual que la ubicación relativa de varios sensores). La orientación de los sensores sigue siendo importante. Existen varias desventajas del caso del sensor único en comparación con el sistema en red: no hay redundancia para compensar otros errores y realizar el rechazo de valores atípicos, la tasa de localización es notablemente más baja, y un solo sensor por sí solo no es capaz de estimar el calibre o clasificar el arma. Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Tabla 3: Precisión de un solo sensor para 108 disparos realizados desde 50 y 100 metros. La tasa de localización se refiere al porcentaje de disparos que el sensor dado pudo localizar por sí solo. Los valores de rumbo y alcance son errores promedio. Caracterizan la precisión de la localización desde la perspectiva de los sensores dados. Los datos indican que el rendimiento de los sensores varió significativamente, especialmente considerando la tasa de localización. Un factor a considerar es la ubicación del sensor dado, incluyendo qué tan lejos estaba de las líneas de disparo y qué tan obstruida estaba su vista. Además, los sensores eran prototipos construidos a mano que no utilizaban ni de cerca empaques/montajes de calidad de producción. A la luz de estos factores, el error promedio general de orientación de 0.9 grados y el error de alcance de 5 m con un espaciado de micrófono de menos de 10 cm son excelentes. Creemos que la fabricación profesional y mejores micrófonos podrían lograr fácilmente un mejor rendimiento que el mejor sensor en nuestro experimento (>60% de tasa de localización y un error de rango de 3 m). Curiosamente, el mayor error en el rango fue de enormes 90 m, claramente debido a alguna detección errónea, sin embargo, el mayor error en la dirección fue de menos de 12 grados, lo cual sigue siendo una buena indicación para el soldado de hacia dónde mirar. La tasa de localización general de todos los sensores individuales fue del 42%, mientras que para disparos de 50 m solamente, esto aumentó al 61%. Se debe tener en cuenta que el campo de tiro fue preparado para simular en cierta medida un área urbana: había algunas estructuras de madera de uno y dos pisos construidas tanto dentro como alrededor del área de despliegue de sensores y las líneas de tiro. Por lo tanto, no todos los sensores tenían línea de visión a todas las posiciones de disparo. Estimamos que en promedio el 10% de los sensores tenían la vista obstruida hacia el tirador. Por lo tanto, podemos afirmar que un sensor dado tenía aproximadamente un 50% de probabilidad de localizar un disparo dentro de 130 m. (Dado que el área de despliegue del sensor era de 30 m de profundidad, los disparos de 100 m corresponden a distancias reales entre 100 y 130 m). Nuevamente, enfatizamos que la localización requiere al menos tres detecciones de explosión de boca de fuego y tres de onda de choque de un posible total de cuatro para cada sensor. La tasa de detección para sensores individuales, correspondiente a al menos una detección de onda de choque por sensor, fue prácticamente del 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 número de sensores porcentaje de disparos Figura 13: Histograma que muestra qué fracción de los 104 disparos tomados desde 50 y 100 metros fueron localizados por al menos cuántos sensores individuales solamente. El 13% de los disparos no fueron detectados por ningún sensor, es decir, ninguno de ellos tuvo detecciones tanto de la explosión del cañón como de la onda de choque. Cabe destacar que casi todos estos disparos fueron localizados con precisión por el sistema en red, es decir, la fusión de sensores utilizando todas las observaciones disponibles en la red de sensores. Sería engañoso interpretar estos resultados como si el sistema estuviera perdiendo la mitad de los disparos. Dado que los soldados nunca trabajan solos y el nodo sensor es relativamente económico para equipar a cada soldado con uno, también necesitamos analizar las tasas de detección globales para cada disparo. La Figura 13 muestra el histograma del porcentaje de disparos vs. el número de sensores individuales que lo localizaron. El 13% de los disparos no fueron localizados por ningún sensor por sí solo, pero el 87% fue localizado por al menos un sensor de diez. 7.2 Fuentes de error En esta sección, analizamos las fuentes de error más significativas que afectan el rendimiento del sistema de localización de tiradores en red y clasificación de armas. Para correlacionar las observaciones distribuidas de los eventos acústicos, los nodos necesitan tener una referencia común de tiempo y espacio. Por lo tanto, los errores en la sincronización del tiempo, la localización de nodos y la orientación de nodos degradan la precisión general del sistema. Nuestro enfoque de sincronización del tiempo produce errores significativamente inferiores a 100 microsegundos. Dado que el sonido viaja aproximadamente 3 cm en ese tiempo, los errores de sincronización temporal tienen un efecto insignificante en el sistema. Por otro lado, la ubicación y orientación del nodo pueden tener un efecto directo en el rendimiento general del sistema. Observa que para analizar esto, no tenemos que recurrir a la simulación, en su lugar podemos utilizar los datos reales de prueba recopilados en Aberdeen. Pero en lugar de utilizar las ubicaciones reales de los sensores conocidas con gran precisión y las orientaciones de los nodos medidas y calibradas casi perfectamente, podemos agregar términos de error a ellas y ejecutar la fusión de sensores. Esto replica exactamente cómo el sistema habría funcionado durante la prueba utilizando las ubicaciones y orientaciones imprecisamente conocidas. Otro aspecto del rendimiento del sistema que se puede evaluar de esta manera es el efecto del número de sensores disponibles. En lugar de utilizar los diez sensores en la fusión de datos, podemos elegir cualquier subconjunto de los nodos para ver cómo disminuye la precisión a medida que reducimos el número de nodos. El siguiente experimento fue llevado a cabo. El número de sensores varió de 2 a 10 en incrementos de 2. Cada ejecución seleccionó los sensores al azar utilizando una distribución uniforme. En cada ejecución, cada nodo fue movido aleatoriamente a una nueva ubicación dentro de un círculo alrededor de su posición real, con un radio determinado por una distribución gaussiana de media cero. Finalmente, las orientaciones de los nodos fueron perturbadas utilizando una distribución gaussiana con media cero. Cada combinación de parámetros se generó 100 veces y se utilizó para los 196 disparos. Los resultados se resumen en la Figura 14. Hay un gráfico de barras en 3D para cada uno de los conjuntos de experimentos con el número fijo de sensores dado. El eje x muestra el error de ubicación del nodo, es decir, la desviación estándar de la distribución gaussiana correspondiente que varió entre 0 y 6 metros. El eje y muestra la desviación estándar del error de orientación del nodo que varió entre 0 y 6 grados. El eje z es el error de azimut de la trayectoria resultante. Se observó que los ángulos de elevación presentaron errores algo mayores que los de azimut. Dado que todos los sensores estaban aproximadamente en un plano horizontal y solo unas pocas posiciones de tirador estaban fuera del mismo plano y solo por unos 2 m, la prueba no fue suficiente para evaluar este aspecto del sistema. Se pueden hacer muchas observaciones interesantes al analizar estos gráficos. Los errores de ubicación del nodo en este rango tienen un efecto pequeño en la precisión. Los errores de orientación de los nodos, por otro lado, degradan notablemente el rendimiento. Aún así, los errores más grandes en este experimento de 3.5 grados para 6 sensores y 5 grados para 2 sensores siguen siendo muy buenos. Ten en cuenta que a medida que aumentan los errores de ubicación y orientación y disminuye el número de sensores, la métrica de rendimiento más afectada de manera significativa es la tasa de localización. Consulta la Tabla 4 para un resumen. La localización exitosa disminuye de casi el 100% a un 50% cuando pasamos de 10 sensores a 2, incluso sin errores adicionales. Esto es causado principalmente por la geometría: para una localización exitosa, la bala necesita pasar sobre la red de sensores, es decir, al menos un sensor debe estar en el lado de la trayectoria distinto al resto de los nodos. (Esta es una simplificación con fines ilustrativos). Si todos los sensores y la trayectoria no son coplanares, la localización puede ser exitosa incluso si el proyectil pasa por un lado de la red. Ver la Sección 6.3. A medida que disminuyeron los números de sensores en el experimento al seleccionar aleatoriamente un subconjunto, la probabilidad de que las trayectorias cumplieran con esta regla disminuyó. Esto también significa que incluso si hay 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 2 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 4 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 6 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 8 sensores Figura 14: El efecto de los errores de localización y orientación del nodo en la precisión del azimut con 2, 4, 6 y 8 nodos. Ten en cuenta que el gráfico para 10 nodos es casi idéntico al caso de 8 nodos, por lo tanto, se omite. Si hay demasiados sensores (es decir, soldados), pero todos están uno al lado del otro, la tasa de localización se verá afectada. Sin embargo, cuando la fusión de sensores proporciona un resultado, sigue siendo preciso incluso con pocos sensores disponibles y errores individuales relativamente grandes. Unas pocas observaciones consistentes llevan a una buena precisión, ya que las inconsistentes son descartadas por el algoritmo. Esto también se ve respaldado por la observación de que, para los casos con un mayor número de sensores (8 o 10), la tasa de localización apenas se ve afectada incluso por errores grandes. Errores/Sensores 2 4 6 8 10 0 m, 0 grados 54% 87% 94% 95% 96% 2 m, 2 grados 53% 80% 91% 96% 96% 6 m, 0 grados 43% 79% 88% 94% 94% 0 m, 6 grados 44% 78% 90% 93% 94% 6 m, 6 grados 41% 73% 85% 89% 92% Tabla 4: Tasa de localización en función del número de sensores utilizados, los errores de ubicación y orientación del nodo sensor. Una de las observaciones más significativas en la Figura 14 y la Tabla 4 es que apenas hay diferencia en los datos para 6, 8 y 10 sensores. Esto significa que hay poco beneficio en agregar más nodos más allá de 6 sensores en cuanto a la precisión se refiere. La velocidad del sonido depende de la temperatura ambiente. El prototipo actual considera constante lo que normalmente se establece antes de una prueba. Sería sencillo emplear un sensor de temperatura para actualizar periódicamente el valor de la velocidad del sonido durante la operación. Tenga en cuenta también que el viento puede afectar negativamente la precisión del sistema. La fusión de sensores, sin embargo, podría incorporar la velocidad del viento en sus cálculos. Sería más complicado que la compensación de temperatura, pero se podría hacer. Otros problemas prácticos también deben ser considerados antes de implementar en el mundo real. Los silenciadores reducen la energía de la explosión en la boca del cañón y, por lo tanto, el alcance efectivo en el que el sistema puede detectarla. Sin embargo, los silenciadores no afectan la onda de choque y el sistema seguiría detectando con precisión la trayectoria y el calibre. El alcance y el tipo de arma no se pudieron estimar sin detectar la explosión en la boca del cañón. Las armas subsónicas no producen una onda de choque. Sin embargo, esto no es de gran importancia, ya que tienen un alcance más corto, menor precisión y mucha menos letalidad. Por lo tanto, su uso no es generalizado y representan menos peligro en cualquier caso. Otro problema es el tipo de munición utilizada. Los ejércitos irregulares pueden usar balas de calidad inferior, incluso fabricadas a mano. Esto afecta la velocidad inicial del proyectil del arma. Para que la clasificación de armas funcione con precisión, el sistema debería ser calibrado con la munición típica utilizada por el adversario dado. TRABAJO RELACIONADO La detección y reconocimiento acústico ha sido objeto de investigación desde principios de los años cincuenta. La zona tiene una estrecha relevancia con el tema de la mecánica del flujo supersónico [20]. Fansler analizó las complejas ondas de presión de campo cercano que ocurren dentro de un pie de la explosión del cañón. El trabajo de Fansler proporciona una buena idea de la onda de presión ideal del estallido del cañón sin contaminación de ecos o efectos de propagación [4]. Los experimentos con distancias mayores desde la boca del cañón fueron realizados por Stoughton [18]. Las mediciones de las ondas de choque balísticas utilizando transductores de presión calibrados en ubicaciones conocidas, velocidades de bala medidas y distancias de error de 355 metros para proyectiles de 5.56 mm y 7.62 mm fueron realizadas. Los resultados indican que la interacción con el suelo se convierte en un problema para distancias de error de 30 metros o más grandes. Otra área de investigación es el procesamiento de señales de la acústica de disparos. El enfoque se centra en la detección robusta y estimación de la longitud de ondas de choque acústicas de pequeño calibre y explosiones de boca de fuego. Posibles técnicas para clasificar señales como ondas de choque o explosiones de boca de fuego incluyen la Transformada de Fourier de tiempo corto (STFT), la distribución de Wigner-Ville pseudo suavizada (SPWVD) y una transformación discreta de wavelet (DWT). Los espectrogramas de tiempo-frecuencia conjunta (JTF) se utilizan para analizar la separación típica de los transitorios de la onda de choque y la explosión del cañón tanto en tiempo como en frecuencia. Mays concluye que la DWT es el mejor método para clasificar señales como ondas de choque o explosiones de boca de fuego porque funciona bien y es menos costoso de calcular que el SPWVD [10]. Los bordes de la onda de choque suelen estar bien definidos y la longitud de la onda de choque está directamente relacionada con las características de la bala. Un artículo de Sadler [14] compara dos métodos de detección de bordes de onda de choque: un detector simple basado en gradientes y un detector de ondaleta de múltiples escalas. También demuestra cómo la longitud de la onda de choque, determinada por los detectores de borde, puede ser utilizada junto con las ecuaciones de Whitham [20] para estimar el calibre de un proyectil. Ten en cuenta que el rendimiento computacional disponible en los nodos sensores, el ancho de banda inalámbrico limitado y los requisitos en tiempo real hacen que estos enfoques sean inviables en nuestra plataforma. Un tema relacionado es la investigación y desarrollo de sistemas experimentales y prototipos de localización de disparos. Los investigadores de BBN han desarrollado el sistema Bullet Ears [3], el cual tiene la capacidad de ser instalado en una posición fija o usado por soldados. El sistema fijo tiene matrices de micrófonos con forma de tetraedro con un espaciado de 1.5 metros. El sistema en general consiste en dos o tres de estos conjuntos espaciados de 20 a 100 metros entre sí. El sistema usado por los soldados cuenta con 12 micrófonos, así como una antena GPS y sensores de orientación montados en un casco. Hay una conexión de RF de baja velocidad desde el casco hasta el cuerpo de procesamiento. Se ha realizado una prueba extensa para medir el rendimiento de ambos tipos de sistemas. El rendimiento de los sistemas fijos fue una orden de magnitud mejor en los cálculos de ángulo, mientras que su rendimiento en alcance fue igualado. La precisión del ángulo del sistema fijo era predominantemente inferior a un grado, mientras que era de alrededor de cinco grados para el montado en el casco. La precisión del rango fue de alrededor del 5 por ciento para ambos sistemas. El problema con este y otros sistemas centralizados similares es la necesidad de que uno o un puñado de matrices de micrófonos estén a la vista del tirador. Una solución basada en redes de sensores tiene la ventaja de un amplio alcance de detección para una mejor cobertura, compensación de efectos de múltiples trayectorias y resolución de múltiples disparos simultáneos [8]. Esto es especialmente importante para operar en áreas urbanas con reverberación acústica. Ten en cuenta que el sistema actual montado en vehículos de BBN llamado BOOMERANG, una versión modificada de Bullet Ears, se utiliza actualmente en Iraq [1]. La empresa ShotSpotter se especializa en sistemas de aplicación de la ley que informan la ubicación de disparos a la policía en cuestión de segundos. El objetivo del sistema es significativamente diferente al de los sistemas militares. Shotspotter informa una precisión típica de 25 m, lo cual es más que suficiente para que la policía responda a 125. También están fabricando sistemas experimentales portátiles para soldados y montados en UAV para uso militar [16], pero no hay especificaciones ni resultados de evaluación disponibles públicamente. 9. CONCLUSIONES La principal contribución de este trabajo es doble. Primero, el rendimiento del sistema distribuido en red en general es excelente. Lo más destacado es la precisión de la trayectoria de un grado, la tasa de estimación de calibre correcta de más del 90% y la tasa de clasificación de armas cercana al 100% para 4 de las 6 armas probadas. El sistema demostró ser muy robusto al aumentar los errores de ubicación y orientación de los nodos y al disminuir el número de sensores disponibles hasta llegar a solo un par. El factor clave detrás de esto es la capacidad de los algoritmos de fusión de sensores para rechazar mediciones erróneas. También vale la pena mencionar que los resultados presentados aquí corresponden al primer y único test del sistema más allá de los 100 m y con seis armas diferentes. Creemos que con las lecciones aprendidas en la prueba, un experimento de campo consecutivo podría haber mostrado resultados significativamente mejorados, especialmente en la estimación de alcance más allá de los 100 m y la clasificación de armas para las dos armas restantes que se confundieron la mayoría de las veces durante la prueba. Segundo, el rendimiento del sistema cuando se utilizaba en modo independiente, es decir, cuando solo los sensores proporcionaban la localización, también fue muy bueno. Si bien la tasa de localización general del 42% por sensor para disparos de hasta 130 m podría mejorarse, la precisión del rumbo de menos de un grado y el error promedio de rango del 5% son notables utilizando los prototipos hechos a mano de los nodos de bajo costo. Se observó que el 87% de los disparos fueron localizados con éxito por al menos uno de los diez sensores utilizados en modo independiente. Creemos que la tecnología está suficientemente madura como para que una próxima revisión del sistema pueda ser comercial. Sin embargo, todavía sería necesario trabajar en aspectos importantes del sistema. Todavía no hemos abordado el manejo de energía. Un nodo actual funciona con 4 pilas AA durante aproximadamente 12 horas de operación continua. Una versión desplegable del nodo sensor debería estar en modo de reposo durante la operación normal y solo despertarse cuando ocurre un evento interesante. Un circuito de disparo analógico podría resolver este problema, sin embargo, el sistema se perdería el primer disparo. En cambio, los canales acústicos deberían ser muestreados y almacenados en un búfer circular. El resto del tablero podría apagarse. Cuando un disparador despierta la placa, los datos acústicos estarían disponibles de inmediato. Los experimentos con una placa de sensores de generación anterior indicaron que esto podría proporcionar un aumento de 10 veces en la vida útil de la batería. Otros problemas pendientes incluyen el empaquetado resistente a la intemperie y la robustez, así como la integración con la infraestructura militar actual. 10. REFERENCIAS [1] Sitio web de BBN Technologies. http://www.bbn.com. [2] E. Danicki. Localización acústica de francotiradores. Archivos de Acústica, 30(2):233-245, 2005. [3] G. L. Duckworth y col. Sistemas acústicos fijos y portátiles para la detección de francotiradores para las fuerzas del orden. En E. M. Carapezza y D. B. Ley, editores, Proc. SPIE Vol. 3577, p. 210-230, páginas 210-230, enero de 1999. [4] K. Fansler. Descripción de la explosión de la boca de fuego mediante modelos de escala modificados. Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.\n\nImpacto y Vibración, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer y D. Culler. El lenguaje nesC: un enfoque holístico para sistemas embebidos en red. Actas del Diseño e Implementación de Lenguajes de Programación (PLDI), junio de 2003. [6] J. Hill, R. Szewczyk, A. Woo, S. Hollar, D. Culler y K. Pister. Direcciones de arquitectura del sistema para sensores en red. en Proc. de ASPLOS 2000, noviembre de 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti y L. Meertens. Localización independiente de la densidad de nodos. Procesamiento de información en redes de sensores (IPSN 06) SPOTS Track, abril de 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti y G. Simon. Sistema contratirador para la guerra urbana. ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Maróti. Marco de enrutamiento de inundaciones dirigidas para redes de sensores inalámbricos. En Actas de la 5ta Conferencia Internacional de Middleware ACM/IFIP/USENIX, páginas 99-114, Nueva York, NY, EE. UU., 2004. Springer-Verlag New York, Inc. [10] B. Mays. \n\nSpringer-Verlag New York, Inc. [10] B. Mays. Clasificación de la onda de choque y la explosión de la boca del cañón mediante análisis conjunto de tiempo-frecuencia y wavelet. Informe técnico, Laboratorio de Investigación del Ejército, Adelphi MD 20783-1197, septiembre de 2001. [11] Plataformas de hardware de TinyOS. http://tinyos.net/scoop/special/hardware. [12] Módulo de radio Crossbow MICAz (MPR2400). http://www.xbow.com/Products/productsdetails.aspx?sid=101. [13] Recursos para usuarios de PicoBlaze. http://www.xilinx.com/ipcenter/processor_central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham y L. C. Sadler. Detección y estimación óptima basada en wavelets de onda de choque. Revista de la Sociedad Acústica de América, 104:955-963, agosto de 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi y P. Dutta. Sobre la escalabilidad de la sincronización de tiempo integrada en enrutamiento. 3er Taller Europeo sobre Redes de Sensores Inalámbricos (EWSN 2006), febrero de 2006. [16] Sitio web de ShotSpotter. http://www.shotspotter.com/products/military.html. [17] G. Simon, M. Maróti, A. Lédeczi, G. Balogh, B. Kušy, A. Nádas, G. Pap, J. Sallai y K. Frampton. Sistema de contratirador basado en redes de sensores. En SenSys 04: Actas de la 2ª conferencia internacional sobre sistemas de sensores en red integrados, páginas 1-12, Nueva York, NY, EE. UU., 2004. ACM Press. [18] R. Stoughton. \n\nACM Press. [18] R. Stoughton. Mediciones de ondas de choque balísticas de pequeño calibre en el aire. Revista de la Sociedad Acústica de América, 102:781-787, agosto de 1997. [19] B. A. Weiss, C. Schlenoff, M. Shneier y A. Virts. Evaluaciones de tecnología y métricas de rendimiento para sensores llevados por soldados para asistencia. En el taller de Métricas de Rendimiento para Sistemas Inteligentes, agosto de 2006. [20] G. Whitham. Patrón de flujo de un proyectil supersónico. Comunicaciones en matemáticas puras y aplicadas, 5(3):301, 1952. 126 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "helmetmounted microphone array": {
            "translated_key": "conjunto de micrófonos montados en un casco",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a <br>helmetmounted microphone array</br>, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "A sensor node consists of a <br>helmetmounted microphone array</br>, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA."
            ],
            "translated_annotated_samples": [
                "Un nodo sensor consta de un <br>conjunto de micrófonos montados en un casco</br>, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un <br>conjunto de micrófonos montados en un casco</br>, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo. La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él. El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz. El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado. Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros. Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes. Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula. Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth). Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador. El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R. El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa. Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo. Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente. Las rutas de señal se encuentran justo antes del archivo de registros. Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida. Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5. Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí. El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial. El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas. Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM. Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB. La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros. Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea. Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador. La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz). Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo. Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo. Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento. Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación. Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas. Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos. Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc. Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía). De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo. La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores. El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje. Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual. Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local. El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación. Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente. La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6]. Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz. ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares. Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos. Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular. Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios. Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias. Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento. Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos. Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente). Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque. En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples. Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal. Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento. Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote. En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente. Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal. Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs). El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado. La máquina de estados del algoritmo se muestra en la Figura 5(b). Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax). La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada. A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4]. Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a). Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad. La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC). Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC. Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período. Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido. Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente. El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente. El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca). El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b). Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes. Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE. La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6. La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma. El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1. Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2. Calcular estimaciones de rango. Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3. Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4. Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5. Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6. Si el calibre está disponible, calcular el tipo de arma (ver 6.6). Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor. Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s. Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano). Formalicemos primero el problema para 3 micrófonos. Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3. Primero aplicamos un paso de validación de geometría simple. La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición. Si esta condición no se cumple, las detecciones correspondientes son descartadas. Sea v(x, y, z) el vector normal de la dirección de llegada desconocida. También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3. Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c). Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos. Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden). Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos. De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2). Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque. Considera la situación en la Figura 7. Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos. Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible. La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u. La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales. Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P). Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie. Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2). La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t). P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1. Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón). En este caso: t = uvt1−t2 uv−1. Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango. Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil. En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano. La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala. Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango. Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada. Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2]. El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí. En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular. En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente. En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque. Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico. Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque). Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral. Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria. Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque. Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno. Esto nos da como máximo N(N−1) 2 trayectorias. Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria). Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio. El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos. El conjunto central se puede encontrar en tiempo O(N2). Las trayectorias en el conjunto central se promedian para obtener la trayectoria final. Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección. Significa que todos los sensores están en el mismo lado de la trayectoria. En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido. Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque. Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria. Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles). Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor. Para un ejemplo, consulte la Figura 8. Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque. Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador. Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos. Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8]. La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales. Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja. La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas. La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada. El retroceso es posible para evitar quedarse atascado en un máximo local. Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea. Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida. A continuación, describamos detalladamente cómo se calcula la función de consistencia. Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular. Primero consideramos solo la información de ToA. Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA. Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B. Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo. El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B. Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8]. Aquí extendemos el enfoque de la siguiente manera. Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales. Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B. Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B. En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores. El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 Estimación de calibre Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20]. Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error. Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos. Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores). Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque. Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos. Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes. Los datos experimentales se muestran en la Figura 9. La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4). Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas. Este método tiene menos del 1% de error en la estimación del calibre cuando se dispone de una estimación precisa de la trayectoria. En otras palabras, la estimación del calibre solo funciona si se realizan suficientes detecciones de ondas de choque por el sistema para calcular una trayectoria. 120 6.6 Estimación de armas Analizamos todas las características de la señal medida para encontrar información específica de la arma. Lamentablemente, concluimos que la firma observada de la explosión del cañón no es lo suficientemente característica del arma para fines de clasificación. Las reflexiones de la explosión de alta energía del freno de boca tienen un impacto mucho mayor en la forma de la señal de la explosión del freno de boca que el arma en sí misma. Disparar la misma arma desde diferentes lugares causó diferencias más grandes en la señal registrada que disparar diferentes armas desde el mismo lugar. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 rango (m) velocidad (m/s) AK-47 M240 Figura 10: Mediciones de desaceleración de balas de AK47 y M240. Ambas armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 rango (m) velocidad (m/s) M16 M249 M4 Figura 11: Mediciones de desaceleración de balas M16, M249 y M4. Todas las armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el tipo de arma. Esto se debe a que, para un tipo de arma y par de municiones dados, la velocidad inicial es casi constante. En las Figuras 10 y 11 podemos ver la relación entre el alcance y la velocidad de bala medida para diferentes calibres y armas. En el rango de velocidad supersónica, la desaceleración de la bala se puede aproximar con una función lineal. En el caso del calibre 7.62 mm, las dos armas probadas (AK47, M240) pueden ser claramente diferenciadas (Figura 10). Desafortunadamente, esto no es necesariamente cierto para el calibre 5.56 mm. El M16 con su mayor velocidad de boca aún puede ser bien clasificado, pero las armas M4 y M249 parecen prácticamente indistinguibles (Figura 11). Sin embargo, esto puede deberse en parte al número limitado de disparos de práctica que pudimos realizar antes de que comenzaran las pruebas reales. Más datos de entrenamiento pueden revelar una mejor separación entre las dos armas, ya que sus velocidades de boca publicadas difieren ligeramente. El sistema lleva a cabo la clasificación de armas de la siguiente manera. Una vez que se conoce la trayectoria, la velocidad se puede calcular para cada sensor basándose en la geometría de la onda de choque. Para evaluar un disparo, elegimos el tipo de arma cuya función de desaceleración resulta en el menor error cuadrático medio de los pares estimados de rango-velocidad para la clase de calibre estimada. 7. RESULTADOS Una evaluación independiente del sistema fue realizada por un equipo de NIST en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen en abril de 2006 [19]. El experimento se llevó a cabo en un campo de tiro con edificios y paredes de madera simulados para soportar posiciones elevadas de tiradores y generar efectos de trayectorias múltiples. La Figura 12 muestra la interfaz de usuario con una fotografía aérea del sitio. Se desplegaron 10 nodos sensores en puntos relevados en un área de aproximadamente 30×30 m. Había cinco objetivos fijos detrás de la red de sensores. Varias posiciones de disparo se ubicaron en cada una de las líneas de tiro a 50, 100, 200 y 300 metros. Estas posiciones eran conocidas por los evaluadores, pero no por los operadores del sistema. Se utilizaron seis armas diferentes: AK47 y M240 disparando proyectiles de 7.62 mm, M16, M4 y M249 con munición de 5.56 mm y el M107 de calibre .50. Ten en cuenta que los sensores permanecieron estáticos durante la prueba. La razón principal de esto es que a nadie se le permite estar en la zona de tiro durante las pruebas con fuego real. Utilizar algún tipo de plataforma de control remoto habría sido demasiado complicado dada la limitada disponibilidad de tiempo para la prueba. Por lo tanto, el experimento no probó el aspecto de movilidad del sistema. Durante la prueba de un día, se realizaron 196 disparos. Los resultados se resumen en la Tabla 1. El sistema detectó todos los disparos exitosamente. Dado que una onda de choque balística es un fenómeno acústico único, hace que la detección sea muy robusta. No hubo falsos positivos para las ondas de choque, pero hubo un puñado de detecciones falsas de explosiones de boca de fuego debido a pruebas paralelas de artillería en un campo cercano. Tirador Local- Calibre Trayectoria Trayectoria Distancia No. Tabla 1: Resumen de resultados fusionando todas las observaciones de sensores disponibles. Todas las tomas fueron detectadas con éxito, por lo que la tasa de detección se omite. La tasa de localización significa el porcentaje de disparos cuya trayectoria el sensor de fusión pudo estimar. La tasa de precisión del calibre es relativa a los disparos localizados y no a todos los disparos, ya que la estimación del calibre requiere la trayectoria. El error de trayectoria se descompone en azimut en grados y la distancia real del tirador a la trayectoria. El error de distancia muestra la distancia entre la posición real del tirador y la posición estimada del tirador. Por lo tanto, incluye el error causado tanto por la trayectoria como por la estimación del alcance. Ten en cuenta que las medidas tradicionales de rumbo y alcance no son adecuadas para un sistema distribuido como el nuestro debido a la falta de un único punto de referencia. Figura 12: La interfaz de usuario del sistema mostrando la configuración experimental. Los 10 nodos sensores están etiquetados por su ID y marcados con círculos oscuros. Los objetivos son cuadrados negros marcados como T-1 a T-5. Las flechas largas y blancas señalan la posición del tirador estimada por cada sensor. Donde faltaba, el sensor correspondiente no tuvo suficientes detecciones para medir el AoA de la explosión del cañón, la onda de choque o ambas. La línea negra gruesa y el círculo grande indican la trayectoria estimada y la posición del tirador según lo estimado al fusionar todas las detecciones disponibles de la red. Este disparo desde la línea de los 100 metros en el blanco T-3 fue localizado casi perfectamente por la red de sensores. El calibre y el arma también fueron identificados correctamente. 6 de cada 10 nodos pudieron estimar la ubicación por sí solos. Su precisión de orientación está dentro de un grado, mientras que el alcance tiene un margen de error de menos del 10% en el peor de los casos. La tasa de localización caracteriza la capacidad del sistema para estimar con éxito la trayectoria de los disparos. Dado que la estimación del calibre y la clasificación de armas dependen de la trayectoria, los disparos no localizados tampoco son clasificados. Hubo 7 disparos de 196 que no fueron localizados. La razón de los tiros fallados es el problema de ambigüedad de trayectoria que ocurre cuando el proyectil pasa por un lado de todos los sensores. En este caso, dos trayectorias significativamente diferentes pueden generar el mismo conjunto de observaciones (ver [8] y también la Sección 6.3). En lugar de estimar cuál es más probable o mostrar ambas posibilidades, decidimos no proporcionar una trayectoria en absoluto. Es mejor no dar una respuesta que no sea una alarma de disparo que confundir al soldado. La precisión de la localización se desglosa en la precisión de la trayectoria y la precisión de la estimación de rango. El ángulo de la trayectoria estimada fue mejor que 1 grado, excepto para el rango de 300 m. Dado que el alcance no debería afectar la estimación de la trayectoria siempre y cuando el proyectil pase sobre la red, sospechamos que la ligera disminución en la precisión del ángulo para 300 m se debe a los disparos apresurados que presenciamos que los soldados realizaron cerca del final del día. Esto también se indica por otro dato: la distancia estimada de trayectoria desde los objetivos reales tiene un error promedio de 1.3 m para disparos de 300 m, 0.75 m para disparos de 200 m y 0.6 m para todos menos los disparos de 300 m. Dado que la distancia entre los objetivos y la red de sensores estaba fija, este número no debería mostrar una mejora de 2× solo porque el tirador está más cerca. Dado que el ángulo de la trayectoria en sí no caracteriza el error general, también puede haber una traducción. La Tabla 1 también proporciona la distancia del tirador desde la trayectoria estimada. Estos indican un error que es aproximadamente del 1-2% del rango. Para poner esto en perspectiva, es muy probable que una estimación de trayectoria para un disparo de 100 m pase por o muy cerca de la ventana en la que se encuentra el tirador. Una vez más, creemos que los errores desproporcionadamente mayores a 300 m se deben a errores humanos en la puntería. Dado que la verdad de referencia se obtuvo al conocer la ubicación precisa del tirador y del objetivo, cualquier inexactitud en la trayectoria real se suma directamente al error percibido del sistema. Llamamos estimación de la posición del tirador en la estimación del alcance de la trayectoria calculada debido a la falta de un término mejor. Las estimaciones de alcance son más precisas que el 5% a 50 m y el 10% a 100 m. Sin embargo, esto empeora a un 20% o más para distancias más largas. No teníamos una instalación para probar el sistema antes de la evaluación para rangos superiores a 100 m. Durante la evaluación, nos encontramos con el problema de confundir los ecos de ondas de choque con los disparos de la boca del cañón. Estos ecos llegaron a los sensores antes de la verdadera explosión del cañón solo para disparos a larga distancia, ya que el proyectil viaja 2-3 veces más rápido que la velocidad del sonido, por lo que el tiempo entre la onda de choque (y su posible eco de objetos cercanos) y la explosión del cañón aumenta con el aumento de las distancias. Esto resultó en subestimar el alcance, ya que el sistema medía tiempos más cortos que los reales. Desde la evaluación, ajustamos el algoritmo de detección de explosiones de boca para evitar este problema. Distancia M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% Todos 96% 100% 97% 100% 23% 23% 93% Tabla 2: Resultados de clasificación de armas. Los porcentajes son relativos al número de disparos localizados y no a todos los disparos, ya que el algoritmo de clasificación necesita conocer la trayectoria y el alcance. Ten en cuenta que la diferencia es pequeña; se localizaron 189 disparos de un total de 196. Las tasas de precisión de estimación del calibre y del arma se basan en los 189 disparos que fueron localizados con éxito. Se debe tener en cuenta que hubo un único disparo que fue clasificado erróneamente por el estimador de calibre. La precisión general de clasificación de armas del 73% no parece impresionante. Pero si lo desglosamos en las seis armas diferentes probadas, la imagen cambia drásticamente como se muestra en la Tabla 2. Para cuatro de las armas (AK14, M16, M240 y M107), la tasa de clasificación es casi del 100%. Solo hubo dos tiros de aproximadamente 140 que fallaron. El M4 y el M249 resultaron ser demasiado similares y la mayoría de las veces se confundían entre sí. Una posible explicación es que solo tuvimos un número limitado de disparos de prueba tomados con estas armas justo antes de la evaluación y utilizamos la función de aproximación de desaceleración incorrecta. Cualquier error similar a este fue cometido 122 veces, ya que si simplemente usáramos lo opuesto a la respuesta del sistema donde se indicaba que una de estas armas estaba presente, la precisión habría mejorado 3 veces. Si consideramos estas dos armas como una sola clase de arma, entonces la precisión de clasificación para ella es del 93%. Ten en cuenta que el AK47 y el M240 tienen el mismo calibre (7.62 mm), al igual que el M16, M4 y M249 (5.56 mm). Es decir, el sistema es capaz de diferenciar entre armas del mismo calibre. No tenemos conocimiento de ningún sistema que clasifique armas con tanta precisión. 7.1 Rendimiento de un solo sensor Como se mostró anteriormente, un solo sensor por sí solo es capaz de localizar al tirador si puede determinar tanto la explosión del cañón como el ángulo de llegada de la onda de choque, es decir, necesita medir el tiempo de llegada de ambos en al menos tres canales acústicos. Si bien la detección de ondas de choque es independiente del alcance, a menos que el proyectil se vuelva subsónico, la probabilidad de detectar la explosión del cañón más allá de 150 metros no es suficiente para obtener de manera consistente al menos tres por nodo sensor para la estimación del ángulo de llegada. Por lo tanto, solo evaluamos el rendimiento del sensor único para las 104 tomas que se tomaron desde 50 y 100 m. Tenga en cuenta que utilizamos los mismos datos de prueba que en la sección anterior, pero evaluamos individualmente para cada sensor. La Tabla 3 resume los resultados desglosados por los diez sensores utilizados. Dado que esto ya no es un sistema distribuido, los resultados se dan en relación a la posición del sensor dado, es decir, se proporciona una estimación de rumbo y alcance. Ten en cuenta que muchas de las fuentes comunes de error del sistema en red no tienen relevancia aquí. La sincronización de tiempo no es aplicable. La ubicación absoluta de los sensores es irrelevante (al igual que la ubicación relativa de varios sensores). La orientación de los sensores sigue siendo importante. Existen varias desventajas del caso del sensor único en comparación con el sistema en red: no hay redundancia para compensar otros errores y realizar el rechazo de valores atípicos, la tasa de localización es notablemente más baja, y un solo sensor por sí solo no es capaz de estimar el calibre o clasificar el arma. Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Tabla 3: Precisión de un solo sensor para 108 disparos realizados desde 50 y 100 metros. La tasa de localización se refiere al porcentaje de disparos que el sensor dado pudo localizar por sí solo. Los valores de rumbo y alcance son errores promedio. Caracterizan la precisión de la localización desde la perspectiva de los sensores dados. Los datos indican que el rendimiento de los sensores varió significativamente, especialmente considerando la tasa de localización. Un factor a considerar es la ubicación del sensor dado, incluyendo qué tan lejos estaba de las líneas de disparo y qué tan obstruida estaba su vista. Además, los sensores eran prototipos construidos a mano que no utilizaban ni de cerca empaques/montajes de calidad de producción. A la luz de estos factores, el error promedio general de orientación de 0.9 grados y el error de alcance de 5 m con un espaciado de micrófono de menos de 10 cm son excelentes. Creemos que la fabricación profesional y mejores micrófonos podrían lograr fácilmente un mejor rendimiento que el mejor sensor en nuestro experimento (>60% de tasa de localización y un error de rango de 3 m). Curiosamente, el mayor error en el rango fue de enormes 90 m, claramente debido a alguna detección errónea, sin embargo, el mayor error en la dirección fue de menos de 12 grados, lo cual sigue siendo una buena indicación para el soldado de hacia dónde mirar. La tasa de localización general de todos los sensores individuales fue del 42%, mientras que para disparos de 50 m solamente, esto aumentó al 61%. Se debe tener en cuenta que el campo de tiro fue preparado para simular en cierta medida un área urbana: había algunas estructuras de madera de uno y dos pisos construidas tanto dentro como alrededor del área de despliegue de sensores y las líneas de tiro. Por lo tanto, no todos los sensores tenían línea de visión a todas las posiciones de disparo. Estimamos que en promedio el 10% de los sensores tenían la vista obstruida hacia el tirador. Por lo tanto, podemos afirmar que un sensor dado tenía aproximadamente un 50% de probabilidad de localizar un disparo dentro de 130 m. (Dado que el área de despliegue del sensor era de 30 m de profundidad, los disparos de 100 m corresponden a distancias reales entre 100 y 130 m). Nuevamente, enfatizamos que la localización requiere al menos tres detecciones de explosión de boca de fuego y tres de onda de choque de un posible total de cuatro para cada sensor. La tasa de detección para sensores individuales, correspondiente a al menos una detección de onda de choque por sensor, fue prácticamente del 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 número de sensores porcentaje de disparos Figura 13: Histograma que muestra qué fracción de los 104 disparos tomados desde 50 y 100 metros fueron localizados por al menos cuántos sensores individuales solamente. El 13% de los disparos no fueron detectados por ningún sensor, es decir, ninguno de ellos tuvo detecciones tanto de la explosión del cañón como de la onda de choque. Cabe destacar que casi todos estos disparos fueron localizados con precisión por el sistema en red, es decir, la fusión de sensores utilizando todas las observaciones disponibles en la red de sensores. Sería engañoso interpretar estos resultados como si el sistema estuviera perdiendo la mitad de los disparos. Dado que los soldados nunca trabajan solos y el nodo sensor es relativamente económico para equipar a cada soldado con uno, también necesitamos analizar las tasas de detección globales para cada disparo. La Figura 13 muestra el histograma del porcentaje de disparos vs. el número de sensores individuales que lo localizaron. El 13% de los disparos no fueron localizados por ningún sensor por sí solo, pero el 87% fue localizado por al menos un sensor de diez. 7.2 Fuentes de error En esta sección, analizamos las fuentes de error más significativas que afectan el rendimiento del sistema de localización de tiradores en red y clasificación de armas. Para correlacionar las observaciones distribuidas de los eventos acústicos, los nodos necesitan tener una referencia común de tiempo y espacio. Por lo tanto, los errores en la sincronización del tiempo, la localización de nodos y la orientación de nodos degradan la precisión general del sistema. Nuestro enfoque de sincronización del tiempo produce errores significativamente inferiores a 100 microsegundos. Dado que el sonido viaja aproximadamente 3 cm en ese tiempo, los errores de sincronización temporal tienen un efecto insignificante en el sistema. Por otro lado, la ubicación y orientación del nodo pueden tener un efecto directo en el rendimiento general del sistema. Observa que para analizar esto, no tenemos que recurrir a la simulación, en su lugar podemos utilizar los datos reales de prueba recopilados en Aberdeen. Pero en lugar de utilizar las ubicaciones reales de los sensores conocidas con gran precisión y las orientaciones de los nodos medidas y calibradas casi perfectamente, podemos agregar términos de error a ellas y ejecutar la fusión de sensores. Esto replica exactamente cómo el sistema habría funcionado durante la prueba utilizando las ubicaciones y orientaciones imprecisamente conocidas. Otro aspecto del rendimiento del sistema que se puede evaluar de esta manera es el efecto del número de sensores disponibles. En lugar de utilizar los diez sensores en la fusión de datos, podemos elegir cualquier subconjunto de los nodos para ver cómo disminuye la precisión a medida que reducimos el número de nodos. El siguiente experimento fue llevado a cabo. El número de sensores varió de 2 a 10 en incrementos de 2. Cada ejecución seleccionó los sensores al azar utilizando una distribución uniforme. En cada ejecución, cada nodo fue movido aleatoriamente a una nueva ubicación dentro de un círculo alrededor de su posición real, con un radio determinado por una distribución gaussiana de media cero. Finalmente, las orientaciones de los nodos fueron perturbadas utilizando una distribución gaussiana con media cero. Cada combinación de parámetros se generó 100 veces y se utilizó para los 196 disparos. Los resultados se resumen en la Figura 14. Hay un gráfico de barras en 3D para cada uno de los conjuntos de experimentos con el número fijo de sensores dado. El eje x muestra el error de ubicación del nodo, es decir, la desviación estándar de la distribución gaussiana correspondiente que varió entre 0 y 6 metros. El eje y muestra la desviación estándar del error de orientación del nodo que varió entre 0 y 6 grados. El eje z es el error de azimut de la trayectoria resultante. Se observó que los ángulos de elevación presentaron errores algo mayores que los de azimut. Dado que todos los sensores estaban aproximadamente en un plano horizontal y solo unas pocas posiciones de tirador estaban fuera del mismo plano y solo por unos 2 m, la prueba no fue suficiente para evaluar este aspecto del sistema. Se pueden hacer muchas observaciones interesantes al analizar estos gráficos. Los errores de ubicación del nodo en este rango tienen un efecto pequeño en la precisión. Los errores de orientación de los nodos, por otro lado, degradan notablemente el rendimiento. Aún así, los errores más grandes en este experimento de 3.5 grados para 6 sensores y 5 grados para 2 sensores siguen siendo muy buenos. Ten en cuenta que a medida que aumentan los errores de ubicación y orientación y disminuye el número de sensores, la métrica de rendimiento más afectada de manera significativa es la tasa de localización. Consulta la Tabla 4 para un resumen. La localización exitosa disminuye de casi el 100% a un 50% cuando pasamos de 10 sensores a 2, incluso sin errores adicionales. Esto es causado principalmente por la geometría: para una localización exitosa, la bala necesita pasar sobre la red de sensores, es decir, al menos un sensor debe estar en el lado de la trayectoria distinto al resto de los nodos. (Esta es una simplificación con fines ilustrativos). Si todos los sensores y la trayectoria no son coplanares, la localización puede ser exitosa incluso si el proyectil pasa por un lado de la red. Ver la Sección 6.3. A medida que disminuyeron los números de sensores en el experimento al seleccionar aleatoriamente un subconjunto, la probabilidad de que las trayectorias cumplieran con esta regla disminuyó. Esto también significa que incluso si hay 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 2 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 4 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 6 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 8 sensores Figura 14: El efecto de los errores de localización y orientación del nodo en la precisión del azimut con 2, 4, 6 y 8 nodos. Ten en cuenta que el gráfico para 10 nodos es casi idéntico al caso de 8 nodos, por lo tanto, se omite. Si hay demasiados sensores (es decir, soldados), pero todos están uno al lado del otro, la tasa de localización se verá afectada. Sin embargo, cuando la fusión de sensores proporciona un resultado, sigue siendo preciso incluso con pocos sensores disponibles y errores individuales relativamente grandes. Unas pocas observaciones consistentes llevan a una buena precisión, ya que las inconsistentes son descartadas por el algoritmo. Esto también se ve respaldado por la observación de que, para los casos con un mayor número de sensores (8 o 10), la tasa de localización apenas se ve afectada incluso por errores grandes. Errores/Sensores 2 4 6 8 10 0 m, 0 grados 54% 87% 94% 95% 96% 2 m, 2 grados 53% 80% 91% 96% 96% 6 m, 0 grados 43% 79% 88% 94% 94% 0 m, 6 grados 44% 78% 90% 93% 94% 6 m, 6 grados 41% 73% 85% 89% 92% Tabla 4: Tasa de localización en función del número de sensores utilizados, los errores de ubicación y orientación del nodo sensor. Una de las observaciones más significativas en la Figura 14 y la Tabla 4 es que apenas hay diferencia en los datos para 6, 8 y 10 sensores. Esto significa que hay poco beneficio en agregar más nodos más allá de 6 sensores en cuanto a la precisión se refiere. La velocidad del sonido depende de la temperatura ambiente. El prototipo actual considera constante lo que normalmente se establece antes de una prueba. Sería sencillo emplear un sensor de temperatura para actualizar periódicamente el valor de la velocidad del sonido durante la operación. Tenga en cuenta también que el viento puede afectar negativamente la precisión del sistema. La fusión de sensores, sin embargo, podría incorporar la velocidad del viento en sus cálculos. Sería más complicado que la compensación de temperatura, pero se podría hacer. Otros problemas prácticos también deben ser considerados antes de implementar en el mundo real. Los silenciadores reducen la energía de la explosión en la boca del cañón y, por lo tanto, el alcance efectivo en el que el sistema puede detectarla. Sin embargo, los silenciadores no afectan la onda de choque y el sistema seguiría detectando con precisión la trayectoria y el calibre. El alcance y el tipo de arma no se pudieron estimar sin detectar la explosión en la boca del cañón. Las armas subsónicas no producen una onda de choque. Sin embargo, esto no es de gran importancia, ya que tienen un alcance más corto, menor precisión y mucha menos letalidad. Por lo tanto, su uso no es generalizado y representan menos peligro en cualquier caso. Otro problema es el tipo de munición utilizada. Los ejércitos irregulares pueden usar balas de calidad inferior, incluso fabricadas a mano. Esto afecta la velocidad inicial del proyectil del arma. Para que la clasificación de armas funcione con precisión, el sistema debería ser calibrado con la munición típica utilizada por el adversario dado. TRABAJO RELACIONADO La detección y reconocimiento acústico ha sido objeto de investigación desde principios de los años cincuenta. La zona tiene una estrecha relevancia con el tema de la mecánica del flujo supersónico [20]. Fansler analizó las complejas ondas de presión de campo cercano que ocurren dentro de un pie de la explosión del cañón. El trabajo de Fansler proporciona una buena idea de la onda de presión ideal del estallido del cañón sin contaminación de ecos o efectos de propagación [4]. Los experimentos con distancias mayores desde la boca del cañón fueron realizados por Stoughton [18]. Las mediciones de las ondas de choque balísticas utilizando transductores de presión calibrados en ubicaciones conocidas, velocidades de bala medidas y distancias de error de 355 metros para proyectiles de 5.56 mm y 7.62 mm fueron realizadas. Los resultados indican que la interacción con el suelo se convierte en un problema para distancias de error de 30 metros o más grandes. Otra área de investigación es el procesamiento de señales de la acústica de disparos. El enfoque se centra en la detección robusta y estimación de la longitud de ondas de choque acústicas de pequeño calibre y explosiones de boca de fuego. Posibles técnicas para clasificar señales como ondas de choque o explosiones de boca de fuego incluyen la Transformada de Fourier de tiempo corto (STFT), la distribución de Wigner-Ville pseudo suavizada (SPWVD) y una transformación discreta de wavelet (DWT). Los espectrogramas de tiempo-frecuencia conjunta (JTF) se utilizan para analizar la separación típica de los transitorios de la onda de choque y la explosión del cañón tanto en tiempo como en frecuencia. Mays concluye que la DWT es el mejor método para clasificar señales como ondas de choque o explosiones de boca de fuego porque funciona bien y es menos costoso de calcular que el SPWVD [10]. Los bordes de la onda de choque suelen estar bien definidos y la longitud de la onda de choque está directamente relacionada con las características de la bala. Un artículo de Sadler [14] compara dos métodos de detección de bordes de onda de choque: un detector simple basado en gradientes y un detector de ondaleta de múltiples escalas. También demuestra cómo la longitud de la onda de choque, determinada por los detectores de borde, puede ser utilizada junto con las ecuaciones de Whitham [20] para estimar el calibre de un proyectil. Ten en cuenta que el rendimiento computacional disponible en los nodos sensores, el ancho de banda inalámbrico limitado y los requisitos en tiempo real hacen que estos enfoques sean inviables en nuestra plataforma. Un tema relacionado es la investigación y desarrollo de sistemas experimentales y prototipos de localización de disparos. Los investigadores de BBN han desarrollado el sistema Bullet Ears [3], el cual tiene la capacidad de ser instalado en una posición fija o usado por soldados. El sistema fijo tiene matrices de micrófonos con forma de tetraedro con un espaciado de 1.5 metros. El sistema en general consiste en dos o tres de estos conjuntos espaciados de 20 a 100 metros entre sí. El sistema usado por los soldados cuenta con 12 micrófonos, así como una antena GPS y sensores de orientación montados en un casco. Hay una conexión de RF de baja velocidad desde el casco hasta el cuerpo de procesamiento. Se ha realizado una prueba extensa para medir el rendimiento de ambos tipos de sistemas. El rendimiento de los sistemas fijos fue una orden de magnitud mejor en los cálculos de ángulo, mientras que su rendimiento en alcance fue igualado. La precisión del ángulo del sistema fijo era predominantemente inferior a un grado, mientras que era de alrededor de cinco grados para el montado en el casco. La precisión del rango fue de alrededor del 5 por ciento para ambos sistemas. El problema con este y otros sistemas centralizados similares es la necesidad de que uno o un puñado de matrices de micrófonos estén a la vista del tirador. Una solución basada en redes de sensores tiene la ventaja de un amplio alcance de detección para una mejor cobertura, compensación de efectos de múltiples trayectorias y resolución de múltiples disparos simultáneos [8]. Esto es especialmente importante para operar en áreas urbanas con reverberación acústica. Ten en cuenta que el sistema actual montado en vehículos de BBN llamado BOOMERANG, una versión modificada de Bullet Ears, se utiliza actualmente en Iraq [1]. La empresa ShotSpotter se especializa en sistemas de aplicación de la ley que informan la ubicación de disparos a la policía en cuestión de segundos. El objetivo del sistema es significativamente diferente al de los sistemas militares. Shotspotter informa una precisión típica de 25 m, lo cual es más que suficiente para que la policía responda a 125. También están fabricando sistemas experimentales portátiles para soldados y montados en UAV para uso militar [16], pero no hay especificaciones ni resultados de evaluación disponibles públicamente. 9. CONCLUSIONES La principal contribución de este trabajo es doble. Primero, el rendimiento del sistema distribuido en red en general es excelente. Lo más destacado es la precisión de la trayectoria de un grado, la tasa de estimación de calibre correcta de más del 90% y la tasa de clasificación de armas cercana al 100% para 4 de las 6 armas probadas. El sistema demostró ser muy robusto al aumentar los errores de ubicación y orientación de los nodos y al disminuir el número de sensores disponibles hasta llegar a solo un par. El factor clave detrás de esto es la capacidad de los algoritmos de fusión de sensores para rechazar mediciones erróneas. También vale la pena mencionar que los resultados presentados aquí corresponden al primer y único test del sistema más allá de los 100 m y con seis armas diferentes. Creemos que con las lecciones aprendidas en la prueba, un experimento de campo consecutivo podría haber mostrado resultados significativamente mejorados, especialmente en la estimación de alcance más allá de los 100 m y la clasificación de armas para las dos armas restantes que se confundieron la mayoría de las veces durante la prueba. Segundo, el rendimiento del sistema cuando se utilizaba en modo independiente, es decir, cuando solo los sensores proporcionaban la localización, también fue muy bueno. Si bien la tasa de localización general del 42% por sensor para disparos de hasta 130 m podría mejorarse, la precisión del rumbo de menos de un grado y el error promedio de rango del 5% son notables utilizando los prototipos hechos a mano de los nodos de bajo costo. Se observó que el 87% de los disparos fueron localizados con éxito por al menos uno de los diez sensores utilizados en modo independiente. Creemos que la tecnología está suficientemente madura como para que una próxima revisión del sistema pueda ser comercial. Sin embargo, todavía sería necesario trabajar en aspectos importantes del sistema. Todavía no hemos abordado el manejo de energía. Un nodo actual funciona con 4 pilas AA durante aproximadamente 12 horas de operación continua. Una versión desplegable del nodo sensor debería estar en modo de reposo durante la operación normal y solo despertarse cuando ocurre un evento interesante. Un circuito de disparo analógico podría resolver este problema, sin embargo, el sistema se perdería el primer disparo. En cambio, los canales acústicos deberían ser muestreados y almacenados en un búfer circular. El resto del tablero podría apagarse. Cuando un disparador despierta la placa, los datos acústicos estarían disponibles de inmediato. Los experimentos con una placa de sensores de generación anterior indicaron que esto podría proporcionar un aumento de 10 veces en la vida útil de la batería. Otros problemas pendientes incluyen el empaquetado resistente a la intemperie y la robustez, así como la integración con la infraestructura militar actual. 10. REFERENCIAS [1] Sitio web de BBN Technologies. http://www.bbn.com. [2] E. Danicki. Localización acústica de francotiradores. Archivos de Acústica, 30(2):233-245, 2005. [3] G. L. Duckworth y col. Sistemas acústicos fijos y portátiles para la detección de francotiradores para las fuerzas del orden. En E. M. Carapezza y D. B. Ley, editores, Proc. SPIE Vol. 3577, p. 210-230, páginas 210-230, enero de 1999. [4] K. Fansler. Descripción de la explosión de la boca de fuego mediante modelos de escala modificados. Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.\n\nImpacto y Vibración, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer y D. Culler. El lenguaje nesC: un enfoque holístico para sistemas embebidos en red. Actas del Diseño e Implementación de Lenguajes de Programación (PLDI), junio de 2003. [6] J. Hill, R. Szewczyk, A. Woo, S. Hollar, D. Culler y K. Pister. Direcciones de arquitectura del sistema para sensores en red. en Proc. de ASPLOS 2000, noviembre de 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti y L. Meertens. Localización independiente de la densidad de nodos. Procesamiento de información en redes de sensores (IPSN 06) SPOTS Track, abril de 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti y G. Simon. Sistema contratirador para la guerra urbana. ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Maróti. Marco de enrutamiento de inundaciones dirigidas para redes de sensores inalámbricos. En Actas de la 5ta Conferencia Internacional de Middleware ACM/IFIP/USENIX, páginas 99-114, Nueva York, NY, EE. UU., 2004. Springer-Verlag New York, Inc. [10] B. Mays. \n\nSpringer-Verlag New York, Inc. [10] B. Mays. Clasificación de la onda de choque y la explosión de la boca del cañón mediante análisis conjunto de tiempo-frecuencia y wavelet. Informe técnico, Laboratorio de Investigación del Ejército, Adelphi MD 20783-1197, septiembre de 2001. [11] Plataformas de hardware de TinyOS. http://tinyos.net/scoop/special/hardware. [12] Módulo de radio Crossbow MICAz (MPR2400). http://www.xbow.com/Products/productsdetails.aspx?sid=101. [13] Recursos para usuarios de PicoBlaze. http://www.xilinx.com/ipcenter/processor_central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham y L. C. Sadler. Detección y estimación óptima basada en wavelets de onda de choque. Revista de la Sociedad Acústica de América, 104:955-963, agosto de 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi y P. Dutta. Sobre la escalabilidad de la sincronización de tiempo integrada en enrutamiento. 3er Taller Europeo sobre Redes de Sensores Inalámbricos (EWSN 2006), febrero de 2006. [16] Sitio web de ShotSpotter. http://www.shotspotter.com/products/military.html. [17] G. Simon, M. Maróti, A. Lédeczi, G. Balogh, B. Kušy, A. Nádas, G. Pap, J. Sallai y K. Frampton. Sistema de contratirador basado en redes de sensores. En SenSys 04: Actas de la 2ª conferencia internacional sobre sistemas de sensores en red integrados, páginas 1-12, Nueva York, NY, EE. UU., 2004. ACM Press. [18] R. Stoughton. \n\nACM Press. [18] R. Stoughton. Mediciones de ondas de choque balísticas de pequeño calibre en el aire. Revista de la Sociedad Acústica de América, 102:781-787, agosto de 1997. [19] B. A. Weiss, C. Schlenoff, M. Shneier y A. Virts. Evaluaciones de tecnología y métricas de rendimiento para sensores llevados por soldados para asistencia. En el taller de Métricas de Rendimiento para Sistemas Inteligentes, agosto de 2006. [20] G. Whitham. Patrón de flujo de un proyectil supersónico. Comunicaciones en matemáticas puras y aplicadas, 5(3):301, 1952. 126 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "internode communication": {
            "translated_key": "comunicación entre nodos",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for <br>internode communication</br> and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc <br>internode communication</br>, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for <br>internode communication</br> and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "The ad-hoc <br>internode communication</br>, time synchronization and data sharing are the responsibilities of a microcontroller based radio module."
            ],
            "translated_annotated_samples": [
                "Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la <br>comunicación entre nodos</br> y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA.",
                "La <br>comunicación entre nodos</br> ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la <br>comunicación entre nodos</br> y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La <br>comunicación entre nodos</br> ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo. La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él. El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz. El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado. Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros. Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes. Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula. Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth). Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador. El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R. El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa. Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo. Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente. Las rutas de señal se encuentran justo antes del archivo de registros. Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida. Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5. Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí. El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial. El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas. Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM. Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB. La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros. Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea. Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador. La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz). Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo. Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo. Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento. Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación. Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas. Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos. Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc. Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía). De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo. La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores. El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje. Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual. Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local. El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación. Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente. La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6]. Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz. ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares. Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos. Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular. Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios. Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias. Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento. Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos. Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente). Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque. En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples. Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal. Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento. Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote. En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente. Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal. Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs). El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado. La máquina de estados del algoritmo se muestra en la Figura 5(b). Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax). La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada. A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4]. Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a). Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad. La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC). Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC. Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período. Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido. Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente. El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente. El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca). El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b). Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes. Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE. La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6. La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma. El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1. Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2. Calcular estimaciones de rango. Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3. Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4. Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5. Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6. Si el calibre está disponible, calcular el tipo de arma (ver 6.6). Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor. Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s. Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano). Formalicemos primero el problema para 3 micrófonos. Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3. Primero aplicamos un paso de validación de geometría simple. La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición. Si esta condición no se cumple, las detecciones correspondientes son descartadas. Sea v(x, y, z) el vector normal de la dirección de llegada desconocida. También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3. Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c). Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos. Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden). Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos. De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2). Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque. Considera la situación en la Figura 7. Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos. Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible. La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u. La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales. Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P). Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie. Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2). La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t). P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1. Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón). En este caso: t = uvt1−t2 uv−1. Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango. Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil. En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano. La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala. Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango. Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada. Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2]. El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí. En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular. En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente. En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque. Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico. Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque). Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral. Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria. Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque. Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno. Esto nos da como máximo N(N−1) 2 trayectorias. Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria). Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio. El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos. El conjunto central se puede encontrar en tiempo O(N2). Las trayectorias en el conjunto central se promedian para obtener la trayectoria final. Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección. Significa que todos los sensores están en el mismo lado de la trayectoria. En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido. Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque. Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria. Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles). Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor. Para un ejemplo, consulte la Figura 8. Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque. Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador. Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos. Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8]. La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales. Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja. La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas. La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada. El retroceso es posible para evitar quedarse atascado en un máximo local. Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea. Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida. A continuación, describamos detalladamente cómo se calcula la función de consistencia. Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular. Primero consideramos solo la información de ToA. Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA. Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B. Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo. El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B. Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8]. Aquí extendemos el enfoque de la siguiente manera. Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales. Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B. Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B. En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores. El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 Estimación de calibre Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20]. Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error. Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos. Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores). Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque. Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos. Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes. Los datos experimentales se muestran en la Figura 9. La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4). Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas. Este método tiene menos del 1% de error en la estimación del calibre cuando se dispone de una estimación precisa de la trayectoria. En otras palabras, la estimación del calibre solo funciona si se realizan suficientes detecciones de ondas de choque por el sistema para calcular una trayectoria. 120 6.6 Estimación de armas Analizamos todas las características de la señal medida para encontrar información específica de la arma. Lamentablemente, concluimos que la firma observada de la explosión del cañón no es lo suficientemente característica del arma para fines de clasificación. Las reflexiones de la explosión de alta energía del freno de boca tienen un impacto mucho mayor en la forma de la señal de la explosión del freno de boca que el arma en sí misma. Disparar la misma arma desde diferentes lugares causó diferencias más grandes en la señal registrada que disparar diferentes armas desde el mismo lugar. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 rango (m) velocidad (m/s) AK-47 M240 Figura 10: Mediciones de desaceleración de balas de AK47 y M240. Ambas armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 rango (m) velocidad (m/s) M16 M249 M4 Figura 11: Mediciones de desaceleración de balas M16, M249 y M4. Todas las armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el tipo de arma. Esto se debe a que, para un tipo de arma y par de municiones dados, la velocidad inicial es casi constante. En las Figuras 10 y 11 podemos ver la relación entre el alcance y la velocidad de bala medida para diferentes calibres y armas. En el rango de velocidad supersónica, la desaceleración de la bala se puede aproximar con una función lineal. En el caso del calibre 7.62 mm, las dos armas probadas (AK47, M240) pueden ser claramente diferenciadas (Figura 10). Desafortunadamente, esto no es necesariamente cierto para el calibre 5.56 mm. El M16 con su mayor velocidad de boca aún puede ser bien clasificado, pero las armas M4 y M249 parecen prácticamente indistinguibles (Figura 11). Sin embargo, esto puede deberse en parte al número limitado de disparos de práctica que pudimos realizar antes de que comenzaran las pruebas reales. Más datos de entrenamiento pueden revelar una mejor separación entre las dos armas, ya que sus velocidades de boca publicadas difieren ligeramente. El sistema lleva a cabo la clasificación de armas de la siguiente manera. Una vez que se conoce la trayectoria, la velocidad se puede calcular para cada sensor basándose en la geometría de la onda de choque. Para evaluar un disparo, elegimos el tipo de arma cuya función de desaceleración resulta en el menor error cuadrático medio de los pares estimados de rango-velocidad para la clase de calibre estimada. 7. RESULTADOS Una evaluación independiente del sistema fue realizada por un equipo de NIST en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen en abril de 2006 [19]. El experimento se llevó a cabo en un campo de tiro con edificios y paredes de madera simulados para soportar posiciones elevadas de tiradores y generar efectos de trayectorias múltiples. La Figura 12 muestra la interfaz de usuario con una fotografía aérea del sitio. Se desplegaron 10 nodos sensores en puntos relevados en un área de aproximadamente 30×30 m. Había cinco objetivos fijos detrás de la red de sensores. Varias posiciones de disparo se ubicaron en cada una de las líneas de tiro a 50, 100, 200 y 300 metros. Estas posiciones eran conocidas por los evaluadores, pero no por los operadores del sistema. Se utilizaron seis armas diferentes: AK47 y M240 disparando proyectiles de 7.62 mm, M16, M4 y M249 con munición de 5.56 mm y el M107 de calibre .50. Ten en cuenta que los sensores permanecieron estáticos durante la prueba. La razón principal de esto es que a nadie se le permite estar en la zona de tiro durante las pruebas con fuego real. Utilizar algún tipo de plataforma de control remoto habría sido demasiado complicado dada la limitada disponibilidad de tiempo para la prueba. Por lo tanto, el experimento no probó el aspecto de movilidad del sistema. Durante la prueba de un día, se realizaron 196 disparos. Los resultados se resumen en la Tabla 1. El sistema detectó todos los disparos exitosamente. Dado que una onda de choque balística es un fenómeno acústico único, hace que la detección sea muy robusta. No hubo falsos positivos para las ondas de choque, pero hubo un puñado de detecciones falsas de explosiones de boca de fuego debido a pruebas paralelas de artillería en un campo cercano. Tirador Local- Calibre Trayectoria Trayectoria Distancia No. Tabla 1: Resumen de resultados fusionando todas las observaciones de sensores disponibles. Todas las tomas fueron detectadas con éxito, por lo que la tasa de detección se omite. La tasa de localización significa el porcentaje de disparos cuya trayectoria el sensor de fusión pudo estimar. La tasa de precisión del calibre es relativa a los disparos localizados y no a todos los disparos, ya que la estimación del calibre requiere la trayectoria. El error de trayectoria se descompone en azimut en grados y la distancia real del tirador a la trayectoria. El error de distancia muestra la distancia entre la posición real del tirador y la posición estimada del tirador. Por lo tanto, incluye el error causado tanto por la trayectoria como por la estimación del alcance. Ten en cuenta que las medidas tradicionales de rumbo y alcance no son adecuadas para un sistema distribuido como el nuestro debido a la falta de un único punto de referencia. Figura 12: La interfaz de usuario del sistema mostrando la configuración experimental. Los 10 nodos sensores están etiquetados por su ID y marcados con círculos oscuros. Los objetivos son cuadrados negros marcados como T-1 a T-5. Las flechas largas y blancas señalan la posición del tirador estimada por cada sensor. Donde faltaba, el sensor correspondiente no tuvo suficientes detecciones para medir el AoA de la explosión del cañón, la onda de choque o ambas. La línea negra gruesa y el círculo grande indican la trayectoria estimada y la posición del tirador según lo estimado al fusionar todas las detecciones disponibles de la red. Este disparo desde la línea de los 100 metros en el blanco T-3 fue localizado casi perfectamente por la red de sensores. El calibre y el arma también fueron identificados correctamente. 6 de cada 10 nodos pudieron estimar la ubicación por sí solos. Su precisión de orientación está dentro de un grado, mientras que el alcance tiene un margen de error de menos del 10% en el peor de los casos. La tasa de localización caracteriza la capacidad del sistema para estimar con éxito la trayectoria de los disparos. Dado que la estimación del calibre y la clasificación de armas dependen de la trayectoria, los disparos no localizados tampoco son clasificados. Hubo 7 disparos de 196 que no fueron localizados. La razón de los tiros fallados es el problema de ambigüedad de trayectoria que ocurre cuando el proyectil pasa por un lado de todos los sensores. En este caso, dos trayectorias significativamente diferentes pueden generar el mismo conjunto de observaciones (ver [8] y también la Sección 6.3). En lugar de estimar cuál es más probable o mostrar ambas posibilidades, decidimos no proporcionar una trayectoria en absoluto. Es mejor no dar una respuesta que no sea una alarma de disparo que confundir al soldado. La precisión de la localización se desglosa en la precisión de la trayectoria y la precisión de la estimación de rango. El ángulo de la trayectoria estimada fue mejor que 1 grado, excepto para el rango de 300 m. Dado que el alcance no debería afectar la estimación de la trayectoria siempre y cuando el proyectil pase sobre la red, sospechamos que la ligera disminución en la precisión del ángulo para 300 m se debe a los disparos apresurados que presenciamos que los soldados realizaron cerca del final del día. Esto también se indica por otro dato: la distancia estimada de trayectoria desde los objetivos reales tiene un error promedio de 1.3 m para disparos de 300 m, 0.75 m para disparos de 200 m y 0.6 m para todos menos los disparos de 300 m. Dado que la distancia entre los objetivos y la red de sensores estaba fija, este número no debería mostrar una mejora de 2× solo porque el tirador está más cerca. Dado que el ángulo de la trayectoria en sí no caracteriza el error general, también puede haber una traducción. La Tabla 1 también proporciona la distancia del tirador desde la trayectoria estimada. Estos indican un error que es aproximadamente del 1-2% del rango. Para poner esto en perspectiva, es muy probable que una estimación de trayectoria para un disparo de 100 m pase por o muy cerca de la ventana en la que se encuentra el tirador. Una vez más, creemos que los errores desproporcionadamente mayores a 300 m se deben a errores humanos en la puntería. Dado que la verdad de referencia se obtuvo al conocer la ubicación precisa del tirador y del objetivo, cualquier inexactitud en la trayectoria real se suma directamente al error percibido del sistema. Llamamos estimación de la posición del tirador en la estimación del alcance de la trayectoria calculada debido a la falta de un término mejor. Las estimaciones de alcance son más precisas que el 5% a 50 m y el 10% a 100 m. Sin embargo, esto empeora a un 20% o más para distancias más largas. No teníamos una instalación para probar el sistema antes de la evaluación para rangos superiores a 100 m. Durante la evaluación, nos encontramos con el problema de confundir los ecos de ondas de choque con los disparos de la boca del cañón. Estos ecos llegaron a los sensores antes de la verdadera explosión del cañón solo para disparos a larga distancia, ya que el proyectil viaja 2-3 veces más rápido que la velocidad del sonido, por lo que el tiempo entre la onda de choque (y su posible eco de objetos cercanos) y la explosión del cañón aumenta con el aumento de las distancias. Esto resultó en subestimar el alcance, ya que el sistema medía tiempos más cortos que los reales. Desde la evaluación, ajustamos el algoritmo de detección de explosiones de boca para evitar este problema. Distancia M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% Todos 96% 100% 97% 100% 23% 23% 93% Tabla 2: Resultados de clasificación de armas. Los porcentajes son relativos al número de disparos localizados y no a todos los disparos, ya que el algoritmo de clasificación necesita conocer la trayectoria y el alcance. Ten en cuenta que la diferencia es pequeña; se localizaron 189 disparos de un total de 196. Las tasas de precisión de estimación del calibre y del arma se basan en los 189 disparos que fueron localizados con éxito. Se debe tener en cuenta que hubo un único disparo que fue clasificado erróneamente por el estimador de calibre. La precisión general de clasificación de armas del 73% no parece impresionante. Pero si lo desglosamos en las seis armas diferentes probadas, la imagen cambia drásticamente como se muestra en la Tabla 2. Para cuatro de las armas (AK14, M16, M240 y M107), la tasa de clasificación es casi del 100%. Solo hubo dos tiros de aproximadamente 140 que fallaron. El M4 y el M249 resultaron ser demasiado similares y la mayoría de las veces se confundían entre sí. Una posible explicación es que solo tuvimos un número limitado de disparos de prueba tomados con estas armas justo antes de la evaluación y utilizamos la función de aproximación de desaceleración incorrecta. Cualquier error similar a este fue cometido 122 veces, ya que si simplemente usáramos lo opuesto a la respuesta del sistema donde se indicaba que una de estas armas estaba presente, la precisión habría mejorado 3 veces. Si consideramos estas dos armas como una sola clase de arma, entonces la precisión de clasificación para ella es del 93%. Ten en cuenta que el AK47 y el M240 tienen el mismo calibre (7.62 mm), al igual que el M16, M4 y M249 (5.56 mm). Es decir, el sistema es capaz de diferenciar entre armas del mismo calibre. No tenemos conocimiento de ningún sistema que clasifique armas con tanta precisión. 7.1 Rendimiento de un solo sensor Como se mostró anteriormente, un solo sensor por sí solo es capaz de localizar al tirador si puede determinar tanto la explosión del cañón como el ángulo de llegada de la onda de choque, es decir, necesita medir el tiempo de llegada de ambos en al menos tres canales acústicos. Si bien la detección de ondas de choque es independiente del alcance, a menos que el proyectil se vuelva subsónico, la probabilidad de detectar la explosión del cañón más allá de 150 metros no es suficiente para obtener de manera consistente al menos tres por nodo sensor para la estimación del ángulo de llegada. Por lo tanto, solo evaluamos el rendimiento del sensor único para las 104 tomas que se tomaron desde 50 y 100 m. Tenga en cuenta que utilizamos los mismos datos de prueba que en la sección anterior, pero evaluamos individualmente para cada sensor. La Tabla 3 resume los resultados desglosados por los diez sensores utilizados. Dado que esto ya no es un sistema distribuido, los resultados se dan en relación a la posición del sensor dado, es decir, se proporciona una estimación de rumbo y alcance. Ten en cuenta que muchas de las fuentes comunes de error del sistema en red no tienen relevancia aquí. La sincronización de tiempo no es aplicable. La ubicación absoluta de los sensores es irrelevante (al igual que la ubicación relativa de varios sensores). La orientación de los sensores sigue siendo importante. Existen varias desventajas del caso del sensor único en comparación con el sistema en red: no hay redundancia para compensar otros errores y realizar el rechazo de valores atípicos, la tasa de localización es notablemente más baja, y un solo sensor por sí solo no es capaz de estimar el calibre o clasificar el arma. Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Tabla 3: Precisión de un solo sensor para 108 disparos realizados desde 50 y 100 metros. La tasa de localización se refiere al porcentaje de disparos que el sensor dado pudo localizar por sí solo. Los valores de rumbo y alcance son errores promedio. Caracterizan la precisión de la localización desde la perspectiva de los sensores dados. Los datos indican que el rendimiento de los sensores varió significativamente, especialmente considerando la tasa de localización. Un factor a considerar es la ubicación del sensor dado, incluyendo qué tan lejos estaba de las líneas de disparo y qué tan obstruida estaba su vista. Además, los sensores eran prototipos construidos a mano que no utilizaban ni de cerca empaques/montajes de calidad de producción. A la luz de estos factores, el error promedio general de orientación de 0.9 grados y el error de alcance de 5 m con un espaciado de micrófono de menos de 10 cm son excelentes. Creemos que la fabricación profesional y mejores micrófonos podrían lograr fácilmente un mejor rendimiento que el mejor sensor en nuestro experimento (>60% de tasa de localización y un error de rango de 3 m). Curiosamente, el mayor error en el rango fue de enormes 90 m, claramente debido a alguna detección errónea, sin embargo, el mayor error en la dirección fue de menos de 12 grados, lo cual sigue siendo una buena indicación para el soldado de hacia dónde mirar. La tasa de localización general de todos los sensores individuales fue del 42%, mientras que para disparos de 50 m solamente, esto aumentó al 61%. Se debe tener en cuenta que el campo de tiro fue preparado para simular en cierta medida un área urbana: había algunas estructuras de madera de uno y dos pisos construidas tanto dentro como alrededor del área de despliegue de sensores y las líneas de tiro. Por lo tanto, no todos los sensores tenían línea de visión a todas las posiciones de disparo. Estimamos que en promedio el 10% de los sensores tenían la vista obstruida hacia el tirador. Por lo tanto, podemos afirmar que un sensor dado tenía aproximadamente un 50% de probabilidad de localizar un disparo dentro de 130 m. (Dado que el área de despliegue del sensor era de 30 m de profundidad, los disparos de 100 m corresponden a distancias reales entre 100 y 130 m). Nuevamente, enfatizamos que la localización requiere al menos tres detecciones de explosión de boca de fuego y tres de onda de choque de un posible total de cuatro para cada sensor. La tasa de detección para sensores individuales, correspondiente a al menos una detección de onda de choque por sensor, fue prácticamente del 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 número de sensores porcentaje de disparos Figura 13: Histograma que muestra qué fracción de los 104 disparos tomados desde 50 y 100 metros fueron localizados por al menos cuántos sensores individuales solamente. El 13% de los disparos no fueron detectados por ningún sensor, es decir, ninguno de ellos tuvo detecciones tanto de la explosión del cañón como de la onda de choque. Cabe destacar que casi todos estos disparos fueron localizados con precisión por el sistema en red, es decir, la fusión de sensores utilizando todas las observaciones disponibles en la red de sensores. Sería engañoso interpretar estos resultados como si el sistema estuviera perdiendo la mitad de los disparos. Dado que los soldados nunca trabajan solos y el nodo sensor es relativamente económico para equipar a cada soldado con uno, también necesitamos analizar las tasas de detección globales para cada disparo. La Figura 13 muestra el histograma del porcentaje de disparos vs. el número de sensores individuales que lo localizaron. El 13% de los disparos no fueron localizados por ningún sensor por sí solo, pero el 87% fue localizado por al menos un sensor de diez. 7.2 Fuentes de error En esta sección, analizamos las fuentes de error más significativas que afectan el rendimiento del sistema de localización de tiradores en red y clasificación de armas. Para correlacionar las observaciones distribuidas de los eventos acústicos, los nodos necesitan tener una referencia común de tiempo y espacio. Por lo tanto, los errores en la sincronización del tiempo, la localización de nodos y la orientación de nodos degradan la precisión general del sistema. Nuestro enfoque de sincronización del tiempo produce errores significativamente inferiores a 100 microsegundos. Dado que el sonido viaja aproximadamente 3 cm en ese tiempo, los errores de sincronización temporal tienen un efecto insignificante en el sistema. Por otro lado, la ubicación y orientación del nodo pueden tener un efecto directo en el rendimiento general del sistema. Observa que para analizar esto, no tenemos que recurrir a la simulación, en su lugar podemos utilizar los datos reales de prueba recopilados en Aberdeen. Pero en lugar de utilizar las ubicaciones reales de los sensores conocidas con gran precisión y las orientaciones de los nodos medidas y calibradas casi perfectamente, podemos agregar términos de error a ellas y ejecutar la fusión de sensores. Esto replica exactamente cómo el sistema habría funcionado durante la prueba utilizando las ubicaciones y orientaciones imprecisamente conocidas. Otro aspecto del rendimiento del sistema que se puede evaluar de esta manera es el efecto del número de sensores disponibles. En lugar de utilizar los diez sensores en la fusión de datos, podemos elegir cualquier subconjunto de los nodos para ver cómo disminuye la precisión a medida que reducimos el número de nodos. El siguiente experimento fue llevado a cabo. El número de sensores varió de 2 a 10 en incrementos de 2. Cada ejecución seleccionó los sensores al azar utilizando una distribución uniforme. En cada ejecución, cada nodo fue movido aleatoriamente a una nueva ubicación dentro de un círculo alrededor de su posición real, con un radio determinado por una distribución gaussiana de media cero. Finalmente, las orientaciones de los nodos fueron perturbadas utilizando una distribución gaussiana con media cero. Cada combinación de parámetros se generó 100 veces y se utilizó para los 196 disparos. Los resultados se resumen en la Figura 14. Hay un gráfico de barras en 3D para cada uno de los conjuntos de experimentos con el número fijo de sensores dado. El eje x muestra el error de ubicación del nodo, es decir, la desviación estándar de la distribución gaussiana correspondiente que varió entre 0 y 6 metros. El eje y muestra la desviación estándar del error de orientación del nodo que varió entre 0 y 6 grados. El eje z es el error de azimut de la trayectoria resultante. Se observó que los ángulos de elevación presentaron errores algo mayores que los de azimut. Dado que todos los sensores estaban aproximadamente en un plano horizontal y solo unas pocas posiciones de tirador estaban fuera del mismo plano y solo por unos 2 m, la prueba no fue suficiente para evaluar este aspecto del sistema. Se pueden hacer muchas observaciones interesantes al analizar estos gráficos. Los errores de ubicación del nodo en este rango tienen un efecto pequeño en la precisión. Los errores de orientación de los nodos, por otro lado, degradan notablemente el rendimiento. Aún así, los errores más grandes en este experimento de 3.5 grados para 6 sensores y 5 grados para 2 sensores siguen siendo muy buenos. Ten en cuenta que a medida que aumentan los errores de ubicación y orientación y disminuye el número de sensores, la métrica de rendimiento más afectada de manera significativa es la tasa de localización. Consulta la Tabla 4 para un resumen. La localización exitosa disminuye de casi el 100% a un 50% cuando pasamos de 10 sensores a 2, incluso sin errores adicionales. Esto es causado principalmente por la geometría: para una localización exitosa, la bala necesita pasar sobre la red de sensores, es decir, al menos un sensor debe estar en el lado de la trayectoria distinto al resto de los nodos. (Esta es una simplificación con fines ilustrativos). Si todos los sensores y la trayectoria no son coplanares, la localización puede ser exitosa incluso si el proyectil pasa por un lado de la red. Ver la Sección 6.3. A medida que disminuyeron los números de sensores en el experimento al seleccionar aleatoriamente un subconjunto, la probabilidad de que las trayectorias cumplieran con esta regla disminuyó. Esto también significa que incluso si hay 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 2 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 4 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 6 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 8 sensores Figura 14: El efecto de los errores de localización y orientación del nodo en la precisión del azimut con 2, 4, 6 y 8 nodos. Ten en cuenta que el gráfico para 10 nodos es casi idéntico al caso de 8 nodos, por lo tanto, se omite. Si hay demasiados sensores (es decir, soldados), pero todos están uno al lado del otro, la tasa de localización se verá afectada. Sin embargo, cuando la fusión de sensores proporciona un resultado, sigue siendo preciso incluso con pocos sensores disponibles y errores individuales relativamente grandes. Unas pocas observaciones consistentes llevan a una buena precisión, ya que las inconsistentes son descartadas por el algoritmo. Esto también se ve respaldado por la observación de que, para los casos con un mayor número de sensores (8 o 10), la tasa de localización apenas se ve afectada incluso por errores grandes. Errores/Sensores 2 4 6 8 10 0 m, 0 grados 54% 87% 94% 95% 96% 2 m, 2 grados 53% 80% 91% 96% 96% 6 m, 0 grados 43% 79% 88% 94% 94% 0 m, 6 grados 44% 78% 90% 93% 94% 6 m, 6 grados 41% 73% 85% 89% 92% Tabla 4: Tasa de localización en función del número de sensores utilizados, los errores de ubicación y orientación del nodo sensor. Una de las observaciones más significativas en la Figura 14 y la Tabla 4 es que apenas hay diferencia en los datos para 6, 8 y 10 sensores. Esto significa que hay poco beneficio en agregar más nodos más allá de 6 sensores en cuanto a la precisión se refiere. La velocidad del sonido depende de la temperatura ambiente. El prototipo actual considera constante lo que normalmente se establece antes de una prueba. Sería sencillo emplear un sensor de temperatura para actualizar periódicamente el valor de la velocidad del sonido durante la operación. Tenga en cuenta también que el viento puede afectar negativamente la precisión del sistema. La fusión de sensores, sin embargo, podría incorporar la velocidad del viento en sus cálculos. Sería más complicado que la compensación de temperatura, pero se podría hacer. Otros problemas prácticos también deben ser considerados antes de implementar en el mundo real. Los silenciadores reducen la energía de la explosión en la boca del cañón y, por lo tanto, el alcance efectivo en el que el sistema puede detectarla. Sin embargo, los silenciadores no afectan la onda de choque y el sistema seguiría detectando con precisión la trayectoria y el calibre. El alcance y el tipo de arma no se pudieron estimar sin detectar la explosión en la boca del cañón. Las armas subsónicas no producen una onda de choque. Sin embargo, esto no es de gran importancia, ya que tienen un alcance más corto, menor precisión y mucha menos letalidad. Por lo tanto, su uso no es generalizado y representan menos peligro en cualquier caso. Otro problema es el tipo de munición utilizada. Los ejércitos irregulares pueden usar balas de calidad inferior, incluso fabricadas a mano. Esto afecta la velocidad inicial del proyectil del arma. Para que la clasificación de armas funcione con precisión, el sistema debería ser calibrado con la munición típica utilizada por el adversario dado. TRABAJO RELACIONADO La detección y reconocimiento acústico ha sido objeto de investigación desde principios de los años cincuenta. La zona tiene una estrecha relevancia con el tema de la mecánica del flujo supersónico [20]. Fansler analizó las complejas ondas de presión de campo cercano que ocurren dentro de un pie de la explosión del cañón. El trabajo de Fansler proporciona una buena idea de la onda de presión ideal del estallido del cañón sin contaminación de ecos o efectos de propagación [4]. Los experimentos con distancias mayores desde la boca del cañón fueron realizados por Stoughton [18]. Las mediciones de las ondas de choque balísticas utilizando transductores de presión calibrados en ubicaciones conocidas, velocidades de bala medidas y distancias de error de 355 metros para proyectiles de 5.56 mm y 7.62 mm fueron realizadas. Los resultados indican que la interacción con el suelo se convierte en un problema para distancias de error de 30 metros o más grandes. Otra área de investigación es el procesamiento de señales de la acústica de disparos. El enfoque se centra en la detección robusta y estimación de la longitud de ondas de choque acústicas de pequeño calibre y explosiones de boca de fuego. Posibles técnicas para clasificar señales como ondas de choque o explosiones de boca de fuego incluyen la Transformada de Fourier de tiempo corto (STFT), la distribución de Wigner-Ville pseudo suavizada (SPWVD) y una transformación discreta de wavelet (DWT). Los espectrogramas de tiempo-frecuencia conjunta (JTF) se utilizan para analizar la separación típica de los transitorios de la onda de choque y la explosión del cañón tanto en tiempo como en frecuencia. Mays concluye que la DWT es el mejor método para clasificar señales como ondas de choque o explosiones de boca de fuego porque funciona bien y es menos costoso de calcular que el SPWVD [10]. Los bordes de la onda de choque suelen estar bien definidos y la longitud de la onda de choque está directamente relacionada con las características de la bala. Un artículo de Sadler [14] compara dos métodos de detección de bordes de onda de choque: un detector simple basado en gradientes y un detector de ondaleta de múltiples escalas. También demuestra cómo la longitud de la onda de choque, determinada por los detectores de borde, puede ser utilizada junto con las ecuaciones de Whitham [20] para estimar el calibre de un proyectil. Ten en cuenta que el rendimiento computacional disponible en los nodos sensores, el ancho de banda inalámbrico limitado y los requisitos en tiempo real hacen que estos enfoques sean inviables en nuestra plataforma. Un tema relacionado es la investigación y desarrollo de sistemas experimentales y prototipos de localización de disparos. Los investigadores de BBN han desarrollado el sistema Bullet Ears [3], el cual tiene la capacidad de ser instalado en una posición fija o usado por soldados. El sistema fijo tiene matrices de micrófonos con forma de tetraedro con un espaciado de 1.5 metros. El sistema en general consiste en dos o tres de estos conjuntos espaciados de 20 a 100 metros entre sí. El sistema usado por los soldados cuenta con 12 micrófonos, así como una antena GPS y sensores de orientación montados en un casco. Hay una conexión de RF de baja velocidad desde el casco hasta el cuerpo de procesamiento. Se ha realizado una prueba extensa para medir el rendimiento de ambos tipos de sistemas. El rendimiento de los sistemas fijos fue una orden de magnitud mejor en los cálculos de ángulo, mientras que su rendimiento en alcance fue igualado. La precisión del ángulo del sistema fijo era predominantemente inferior a un grado, mientras que era de alrededor de cinco grados para el montado en el casco. La precisión del rango fue de alrededor del 5 por ciento para ambos sistemas. El problema con este y otros sistemas centralizados similares es la necesidad de que uno o un puñado de matrices de micrófonos estén a la vista del tirador. Una solución basada en redes de sensores tiene la ventaja de un amplio alcance de detección para una mejor cobertura, compensación de efectos de múltiples trayectorias y resolución de múltiples disparos simultáneos [8]. Esto es especialmente importante para operar en áreas urbanas con reverberación acústica. Ten en cuenta que el sistema actual montado en vehículos de BBN llamado BOOMERANG, una versión modificada de Bullet Ears, se utiliza actualmente en Iraq [1]. La empresa ShotSpotter se especializa en sistemas de aplicación de la ley que informan la ubicación de disparos a la policía en cuestión de segundos. El objetivo del sistema es significativamente diferente al de los sistemas militares. Shotspotter informa una precisión típica de 25 m, lo cual es más que suficiente para que la policía responda a 125. También están fabricando sistemas experimentales portátiles para soldados y montados en UAV para uso militar [16], pero no hay especificaciones ni resultados de evaluación disponibles públicamente. 9. CONCLUSIONES La principal contribución de este trabajo es doble. Primero, el rendimiento del sistema distribuido en red en general es excelente. Lo más destacado es la precisión de la trayectoria de un grado, la tasa de estimación de calibre correcta de más del 90% y la tasa de clasificación de armas cercana al 100% para 4 de las 6 armas probadas. El sistema demostró ser muy robusto al aumentar los errores de ubicación y orientación de los nodos y al disminuir el número de sensores disponibles hasta llegar a solo un par. El factor clave detrás de esto es la capacidad de los algoritmos de fusión de sensores para rechazar mediciones erróneas. También vale la pena mencionar que los resultados presentados aquí corresponden al primer y único test del sistema más allá de los 100 m y con seis armas diferentes. Creemos que con las lecciones aprendidas en la prueba, un experimento de campo consecutivo podría haber mostrado resultados significativamente mejorados, especialmente en la estimación de alcance más allá de los 100 m y la clasificación de armas para las dos armas restantes que se confundieron la mayoría de las veces durante la prueba. Segundo, el rendimiento del sistema cuando se utilizaba en modo independiente, es decir, cuando solo los sensores proporcionaban la localización, también fue muy bueno. Si bien la tasa de localización general del 42% por sensor para disparos de hasta 130 m podría mejorarse, la precisión del rumbo de menos de un grado y el error promedio de rango del 5% son notables utilizando los prototipos hechos a mano de los nodos de bajo costo. Se observó que el 87% de los disparos fueron localizados con éxito por al menos uno de los diez sensores utilizados en modo independiente. Creemos que la tecnología está suficientemente madura como para que una próxima revisión del sistema pueda ser comercial. Sin embargo, todavía sería necesario trabajar en aspectos importantes del sistema. Todavía no hemos abordado el manejo de energía. Un nodo actual funciona con 4 pilas AA durante aproximadamente 12 horas de operación continua. Una versión desplegable del nodo sensor debería estar en modo de reposo durante la operación normal y solo despertarse cuando ocurre un evento interesante. Un circuito de disparo analógico podría resolver este problema, sin embargo, el sistema se perdería el primer disparo. En cambio, los canales acústicos deberían ser muestreados y almacenados en un búfer circular. El resto del tablero podría apagarse. Cuando un disparador despierta la placa, los datos acústicos estarían disponibles de inmediato. Los experimentos con una placa de sensores de generación anterior indicaron que esto podría proporcionar un aumento de 10 veces en la vida útil de la batería. Otros problemas pendientes incluyen el empaquetado resistente a la intemperie y la robustez, así como la integración con la infraestructura militar actual. 10. REFERENCIAS [1] Sitio web de BBN Technologies. http://www.bbn.com. [2] E. Danicki. Localización acústica de francotiradores. Archivos de Acústica, 30(2):233-245, 2005. [3] G. L. Duckworth y col. Sistemas acústicos fijos y portátiles para la detección de francotiradores para las fuerzas del orden. En E. M. Carapezza y D. B. Ley, editores, Proc. SPIE Vol. 3577, p. 210-230, páginas 210-230, enero de 1999. [4] K. Fansler. Descripción de la explosión de la boca de fuego mediante modelos de escala modificados. Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.\n\nImpacto y Vibración, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer y D. Culler. El lenguaje nesC: un enfoque holístico para sistemas embebidos en red. Actas del Diseño e Implementación de Lenguajes de Programación (PLDI), junio de 2003. [6] J. Hill, R. Szewczyk, A. Woo, S. Hollar, D. Culler y K. Pister. Direcciones de arquitectura del sistema para sensores en red. en Proc. de ASPLOS 2000, noviembre de 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti y L. Meertens. Localización independiente de la densidad de nodos. Procesamiento de información en redes de sensores (IPSN 06) SPOTS Track, abril de 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti y G. Simon. Sistema contratirador para la guerra urbana. ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Maróti. Marco de enrutamiento de inundaciones dirigidas para redes de sensores inalámbricos. En Actas de la 5ta Conferencia Internacional de Middleware ACM/IFIP/USENIX, páginas 99-114, Nueva York, NY, EE. UU., 2004. Springer-Verlag New York, Inc. [10] B. Mays. \n\nSpringer-Verlag New York, Inc. [10] B. Mays. Clasificación de la onda de choque y la explosión de la boca del cañón mediante análisis conjunto de tiempo-frecuencia y wavelet. Informe técnico, Laboratorio de Investigación del Ejército, Adelphi MD 20783-1197, septiembre de 2001. [11] Plataformas de hardware de TinyOS. http://tinyos.net/scoop/special/hardware. [12] Módulo de radio Crossbow MICAz (MPR2400). http://www.xbow.com/Products/productsdetails.aspx?sid=101. [13] Recursos para usuarios de PicoBlaze. http://www.xilinx.com/ipcenter/processor_central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham y L. C. Sadler. Detección y estimación óptima basada en wavelets de onda de choque. Revista de la Sociedad Acústica de América, 104:955-963, agosto de 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi y P. Dutta. Sobre la escalabilidad de la sincronización de tiempo integrada en enrutamiento. 3er Taller Europeo sobre Redes de Sensores Inalámbricos (EWSN 2006), febrero de 2006. [16] Sitio web de ShotSpotter. http://www.shotspotter.com/products/military.html. [17] G. Simon, M. Maróti, A. Lédeczi, G. Balogh, B. Kušy, A. Nádas, G. Pap, J. Sallai y K. Frampton. Sistema de contratirador basado en redes de sensores. En SenSys 04: Actas de la 2ª conferencia internacional sobre sistemas de sensores en red integrados, páginas 1-12, Nueva York, NY, EE. UU., 2004. ACM Press. [18] R. Stoughton. \n\nACM Press. [18] R. Stoughton. Mediciones de ondas de choque balísticas de pequeño calibre en el aire. Revista de la Sociedad Acústica de América, 102:781-787, agosto de 1997. [19] B. A. Weiss, C. Schlenoff, M. Shneier y A. Virts. Evaluaciones de tecnología y métricas de rendimiento para sensores llevados por soldados para asistencia. En el taller de Métricas de Rendimiento para Sistemas Inteligentes, agosto de 2006. [20] G. Whitham. Patrón de flujo de un proyectil supersónico. Comunicaciones en matemáticas puras y aplicadas, 5(3):301, 1952. 126 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "sensorboard": {
            "translated_key": "placa de sensores",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom <br>sensorboard</br> that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a <br>sensorboard</br>.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The <br>sensorboard</br> is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic <br>sensorboard</br>/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation <br>sensorboard</br> features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation <br>sensorboard</br> is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main <br>sensorboard</br> with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the <br>sensorboard</br>. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The <br>sensorboard</br> also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the <br>sensorboard</br> and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the <br>sensorboard</br> through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the <br>sensorboard</br> which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the <br>sensorboard</br>.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the <br>sensorboard</br> and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the <br>sensorboard</br> time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each <br>sensorboard</br>.",
                "Each <br>sensorboard</br> has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one <br>sensorboard</br> after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom <br>sensorboard</br> that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "Our system is based on four microphones connected to a <br>sensorboard</br>.",
                "The <br>sensorboard</br> is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic <br>sensorboard</br>/mote assembly . overall accuracy of the system.",
                "The latest generation <br>sensorboard</br> features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7]."
            ],
            "translated_annotated_samples": [
                "Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una <br>placa de sensores</br> personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA.",
                "Nuestro sistema se basa en cuatro micrófonos conectados a una <br>placa de sensores</br>.",
                "La <br>placa de sensores</br> también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados.",
                "Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema.",
                "La <br>placa de sensores</br> de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una <br>placa de sensores</br> personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una <br>placa de sensores</br>. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La <br>placa de sensores</br> también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La <br>placa de sensores</br> de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "self orientation": {
            "translated_key": "auto-orientación",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides <br>self orientation</br> and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "A 3-axis compass provides <br>self orientation</br> and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface."
            ],
            "translated_annotated_samples": [
                "Una brújula de 3 ejes proporciona <br>auto-orientación</br> y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona <br>auto-orientación</br> y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo. La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él. El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz. El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado. Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros. Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes. Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula. Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth). Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador. El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R. El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa. Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo. Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente. Las rutas de señal se encuentran justo antes del archivo de registros. Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida. Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5. Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí. El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial. El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas. Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM. Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB. La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros. Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea. Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador. La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz). Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo. Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo. Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento. Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación. Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas. Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos. Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc. Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía). De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo. La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores. El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje. Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual. Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local. El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación. Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente. La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6]. Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz. ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares. Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos. Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular. Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios. Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias. Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento. Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos. Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente). Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque. En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples. Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal. Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento. Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote. En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente. Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal. Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs). El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado. La máquina de estados del algoritmo se muestra en la Figura 5(b). Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax). La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada. A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4]. Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a). Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad. La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC). Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC. Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período. Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido. Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente. El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente. El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca). El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b). Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes. Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE. La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6. La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma. El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1. Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2. Calcular estimaciones de rango. Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3. Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4. Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5. Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6. Si el calibre está disponible, calcular el tipo de arma (ver 6.6). Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor. Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s. Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano). Formalicemos primero el problema para 3 micrófonos. Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3. Primero aplicamos un paso de validación de geometría simple. La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición. Si esta condición no se cumple, las detecciones correspondientes son descartadas. Sea v(x, y, z) el vector normal de la dirección de llegada desconocida. También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3. Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c). Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos. Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden). Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos. De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2). Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque. Considera la situación en la Figura 7. Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos. Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible. La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u. La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales. Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P). Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie. Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2). La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t). P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1. Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón). En este caso: t = uvt1−t2 uv−1. Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango. Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil. En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano. La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala. Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango. Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada. Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2]. El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí. En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular. En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente. En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque. Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico. Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque). Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral. Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria. Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque. Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno. Esto nos da como máximo N(N−1) 2 trayectorias. Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria). Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio. El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos. El conjunto central se puede encontrar en tiempo O(N2). Las trayectorias en el conjunto central se promedian para obtener la trayectoria final. Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección. Significa que todos los sensores están en el mismo lado de la trayectoria. En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido. Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque. Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria. Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles). Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor. Para un ejemplo, consulte la Figura 8. Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque. Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador. Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos. Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8]. La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales. Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja. La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas. La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada. El retroceso es posible para evitar quedarse atascado en un máximo local. Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea. Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida. A continuación, describamos detalladamente cómo se calcula la función de consistencia. Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular. Primero consideramos solo la información de ToA. Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA. Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B. Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo. El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B. Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8]. Aquí extendemos el enfoque de la siguiente manera. Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales. Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B. Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B. En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores. El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 Estimación de calibre Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20]. Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error. Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos. Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores). Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque. Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos. Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes. Los datos experimentales se muestran en la Figura 9. La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4). Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas. Este método tiene menos del 1% de error en la estimación del calibre cuando se dispone de una estimación precisa de la trayectoria. En otras palabras, la estimación del calibre solo funciona si se realizan suficientes detecciones de ondas de choque por el sistema para calcular una trayectoria. 120 6.6 Estimación de armas Analizamos todas las características de la señal medida para encontrar información específica de la arma. Lamentablemente, concluimos que la firma observada de la explosión del cañón no es lo suficientemente característica del arma para fines de clasificación. Las reflexiones de la explosión de alta energía del freno de boca tienen un impacto mucho mayor en la forma de la señal de la explosión del freno de boca que el arma en sí misma. Disparar la misma arma desde diferentes lugares causó diferencias más grandes en la señal registrada que disparar diferentes armas desde el mismo lugar. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 rango (m) velocidad (m/s) AK-47 M240 Figura 10: Mediciones de desaceleración de balas de AK47 y M240. Ambas armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 rango (m) velocidad (m/s) M16 M249 M4 Figura 11: Mediciones de desaceleración de balas M16, M249 y M4. Todas las armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el tipo de arma. Esto se debe a que, para un tipo de arma y par de municiones dados, la velocidad inicial es casi constante. En las Figuras 10 y 11 podemos ver la relación entre el alcance y la velocidad de bala medida para diferentes calibres y armas. En el rango de velocidad supersónica, la desaceleración de la bala se puede aproximar con una función lineal. En el caso del calibre 7.62 mm, las dos armas probadas (AK47, M240) pueden ser claramente diferenciadas (Figura 10). Desafortunadamente, esto no es necesariamente cierto para el calibre 5.56 mm. El M16 con su mayor velocidad de boca aún puede ser bien clasificado, pero las armas M4 y M249 parecen prácticamente indistinguibles (Figura 11). Sin embargo, esto puede deberse en parte al número limitado de disparos de práctica que pudimos realizar antes de que comenzaran las pruebas reales. Más datos de entrenamiento pueden revelar una mejor separación entre las dos armas, ya que sus velocidades de boca publicadas difieren ligeramente. El sistema lleva a cabo la clasificación de armas de la siguiente manera. Una vez que se conoce la trayectoria, la velocidad se puede calcular para cada sensor basándose en la geometría de la onda de choque. Para evaluar un disparo, elegimos el tipo de arma cuya función de desaceleración resulta en el menor error cuadrático medio de los pares estimados de rango-velocidad para la clase de calibre estimada. 7. RESULTADOS Una evaluación independiente del sistema fue realizada por un equipo de NIST en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen en abril de 2006 [19]. El experimento se llevó a cabo en un campo de tiro con edificios y paredes de madera simulados para soportar posiciones elevadas de tiradores y generar efectos de trayectorias múltiples. La Figura 12 muestra la interfaz de usuario con una fotografía aérea del sitio. Se desplegaron 10 nodos sensores en puntos relevados en un área de aproximadamente 30×30 m. Había cinco objetivos fijos detrás de la red de sensores. Varias posiciones de disparo se ubicaron en cada una de las líneas de tiro a 50, 100, 200 y 300 metros. Estas posiciones eran conocidas por los evaluadores, pero no por los operadores del sistema. Se utilizaron seis armas diferentes: AK47 y M240 disparando proyectiles de 7.62 mm, M16, M4 y M249 con munición de 5.56 mm y el M107 de calibre .50. Ten en cuenta que los sensores permanecieron estáticos durante la prueba. La razón principal de esto es que a nadie se le permite estar en la zona de tiro durante las pruebas con fuego real. Utilizar algún tipo de plataforma de control remoto habría sido demasiado complicado dada la limitada disponibilidad de tiempo para la prueba. Por lo tanto, el experimento no probó el aspecto de movilidad del sistema. Durante la prueba de un día, se realizaron 196 disparos. Los resultados se resumen en la Tabla 1. El sistema detectó todos los disparos exitosamente. Dado que una onda de choque balística es un fenómeno acústico único, hace que la detección sea muy robusta. No hubo falsos positivos para las ondas de choque, pero hubo un puñado de detecciones falsas de explosiones de boca de fuego debido a pruebas paralelas de artillería en un campo cercano. Tirador Local- Calibre Trayectoria Trayectoria Distancia No. Tabla 1: Resumen de resultados fusionando todas las observaciones de sensores disponibles. Todas las tomas fueron detectadas con éxito, por lo que la tasa de detección se omite. La tasa de localización significa el porcentaje de disparos cuya trayectoria el sensor de fusión pudo estimar. La tasa de precisión del calibre es relativa a los disparos localizados y no a todos los disparos, ya que la estimación del calibre requiere la trayectoria. El error de trayectoria se descompone en azimut en grados y la distancia real del tirador a la trayectoria. El error de distancia muestra la distancia entre la posición real del tirador y la posición estimada del tirador. Por lo tanto, incluye el error causado tanto por la trayectoria como por la estimación del alcance. Ten en cuenta que las medidas tradicionales de rumbo y alcance no son adecuadas para un sistema distribuido como el nuestro debido a la falta de un único punto de referencia. Figura 12: La interfaz de usuario del sistema mostrando la configuración experimental. Los 10 nodos sensores están etiquetados por su ID y marcados con círculos oscuros. Los objetivos son cuadrados negros marcados como T-1 a T-5. Las flechas largas y blancas señalan la posición del tirador estimada por cada sensor. Donde faltaba, el sensor correspondiente no tuvo suficientes detecciones para medir el AoA de la explosión del cañón, la onda de choque o ambas. La línea negra gruesa y el círculo grande indican la trayectoria estimada y la posición del tirador según lo estimado al fusionar todas las detecciones disponibles de la red. Este disparo desde la línea de los 100 metros en el blanco T-3 fue localizado casi perfectamente por la red de sensores. El calibre y el arma también fueron identificados correctamente. 6 de cada 10 nodos pudieron estimar la ubicación por sí solos. Su precisión de orientación está dentro de un grado, mientras que el alcance tiene un margen de error de menos del 10% en el peor de los casos. La tasa de localización caracteriza la capacidad del sistema para estimar con éxito la trayectoria de los disparos. Dado que la estimación del calibre y la clasificación de armas dependen de la trayectoria, los disparos no localizados tampoco son clasificados. Hubo 7 disparos de 196 que no fueron localizados. La razón de los tiros fallados es el problema de ambigüedad de trayectoria que ocurre cuando el proyectil pasa por un lado de todos los sensores. En este caso, dos trayectorias significativamente diferentes pueden generar el mismo conjunto de observaciones (ver [8] y también la Sección 6.3). En lugar de estimar cuál es más probable o mostrar ambas posibilidades, decidimos no proporcionar una trayectoria en absoluto. Es mejor no dar una respuesta que no sea una alarma de disparo que confundir al soldado. La precisión de la localización se desglosa en la precisión de la trayectoria y la precisión de la estimación de rango. El ángulo de la trayectoria estimada fue mejor que 1 grado, excepto para el rango de 300 m. Dado que el alcance no debería afectar la estimación de la trayectoria siempre y cuando el proyectil pase sobre la red, sospechamos que la ligera disminución en la precisión del ángulo para 300 m se debe a los disparos apresurados que presenciamos que los soldados realizaron cerca del final del día. Esto también se indica por otro dato: la distancia estimada de trayectoria desde los objetivos reales tiene un error promedio de 1.3 m para disparos de 300 m, 0.75 m para disparos de 200 m y 0.6 m para todos menos los disparos de 300 m. Dado que la distancia entre los objetivos y la red de sensores estaba fija, este número no debería mostrar una mejora de 2× solo porque el tirador está más cerca. Dado que el ángulo de la trayectoria en sí no caracteriza el error general, también puede haber una traducción. La Tabla 1 también proporciona la distancia del tirador desde la trayectoria estimada. Estos indican un error que es aproximadamente del 1-2% del rango. Para poner esto en perspectiva, es muy probable que una estimación de trayectoria para un disparo de 100 m pase por o muy cerca de la ventana en la que se encuentra el tirador. Una vez más, creemos que los errores desproporcionadamente mayores a 300 m se deben a errores humanos en la puntería. Dado que la verdad de referencia se obtuvo al conocer la ubicación precisa del tirador y del objetivo, cualquier inexactitud en la trayectoria real se suma directamente al error percibido del sistema. Llamamos estimación de la posición del tirador en la estimación del alcance de la trayectoria calculada debido a la falta de un término mejor. Las estimaciones de alcance son más precisas que el 5% a 50 m y el 10% a 100 m. Sin embargo, esto empeora a un 20% o más para distancias más largas. No teníamos una instalación para probar el sistema antes de la evaluación para rangos superiores a 100 m. Durante la evaluación, nos encontramos con el problema de confundir los ecos de ondas de choque con los disparos de la boca del cañón. Estos ecos llegaron a los sensores antes de la verdadera explosión del cañón solo para disparos a larga distancia, ya que el proyectil viaja 2-3 veces más rápido que la velocidad del sonido, por lo que el tiempo entre la onda de choque (y su posible eco de objetos cercanos) y la explosión del cañón aumenta con el aumento de las distancias. Esto resultó en subestimar el alcance, ya que el sistema medía tiempos más cortos que los reales. Desde la evaluación, ajustamos el algoritmo de detección de explosiones de boca para evitar este problema. Distancia M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% Todos 96% 100% 97% 100% 23% 23% 93% Tabla 2: Resultados de clasificación de armas. Los porcentajes son relativos al número de disparos localizados y no a todos los disparos, ya que el algoritmo de clasificación necesita conocer la trayectoria y el alcance. Ten en cuenta que la diferencia es pequeña; se localizaron 189 disparos de un total de 196. Las tasas de precisión de estimación del calibre y del arma se basan en los 189 disparos que fueron localizados con éxito. Se debe tener en cuenta que hubo un único disparo que fue clasificado erróneamente por el estimador de calibre. La precisión general de clasificación de armas del 73% no parece impresionante. Pero si lo desglosamos en las seis armas diferentes probadas, la imagen cambia drásticamente como se muestra en la Tabla 2. Para cuatro de las armas (AK14, M16, M240 y M107), la tasa de clasificación es casi del 100%. Solo hubo dos tiros de aproximadamente 140 que fallaron. El M4 y el M249 resultaron ser demasiado similares y la mayoría de las veces se confundían entre sí. Una posible explicación es que solo tuvimos un número limitado de disparos de prueba tomados con estas armas justo antes de la evaluación y utilizamos la función de aproximación de desaceleración incorrecta. Cualquier error similar a este fue cometido 122 veces, ya que si simplemente usáramos lo opuesto a la respuesta del sistema donde se indicaba que una de estas armas estaba presente, la precisión habría mejorado 3 veces. Si consideramos estas dos armas como una sola clase de arma, entonces la precisión de clasificación para ella es del 93%. Ten en cuenta que el AK47 y el M240 tienen el mismo calibre (7.62 mm), al igual que el M16, M4 y M249 (5.56 mm). Es decir, el sistema es capaz de diferenciar entre armas del mismo calibre. No tenemos conocimiento de ningún sistema que clasifique armas con tanta precisión. 7.1 Rendimiento de un solo sensor Como se mostró anteriormente, un solo sensor por sí solo es capaz de localizar al tirador si puede determinar tanto la explosión del cañón como el ángulo de llegada de la onda de choque, es decir, necesita medir el tiempo de llegada de ambos en al menos tres canales acústicos. Si bien la detección de ondas de choque es independiente del alcance, a menos que el proyectil se vuelva subsónico, la probabilidad de detectar la explosión del cañón más allá de 150 metros no es suficiente para obtener de manera consistente al menos tres por nodo sensor para la estimación del ángulo de llegada. Por lo tanto, solo evaluamos el rendimiento del sensor único para las 104 tomas que se tomaron desde 50 y 100 m. Tenga en cuenta que utilizamos los mismos datos de prueba que en la sección anterior, pero evaluamos individualmente para cada sensor. La Tabla 3 resume los resultados desglosados por los diez sensores utilizados. Dado que esto ya no es un sistema distribuido, los resultados se dan en relación a la posición del sensor dado, es decir, se proporciona una estimación de rumbo y alcance. Ten en cuenta que muchas de las fuentes comunes de error del sistema en red no tienen relevancia aquí. La sincronización de tiempo no es aplicable. La ubicación absoluta de los sensores es irrelevante (al igual que la ubicación relativa de varios sensores). La orientación de los sensores sigue siendo importante. Existen varias desventajas del caso del sensor único en comparación con el sistema en red: no hay redundancia para compensar otros errores y realizar el rechazo de valores atípicos, la tasa de localización es notablemente más baja, y un solo sensor por sí solo no es capaz de estimar el calibre o clasificar el arma. Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Tabla 3: Precisión de un solo sensor para 108 disparos realizados desde 50 y 100 metros. La tasa de localización se refiere al porcentaje de disparos que el sensor dado pudo localizar por sí solo. Los valores de rumbo y alcance son errores promedio. Caracterizan la precisión de la localización desde la perspectiva de los sensores dados. Los datos indican que el rendimiento de los sensores varió significativamente, especialmente considerando la tasa de localización. Un factor a considerar es la ubicación del sensor dado, incluyendo qué tan lejos estaba de las líneas de disparo y qué tan obstruida estaba su vista. Además, los sensores eran prototipos construidos a mano que no utilizaban ni de cerca empaques/montajes de calidad de producción. A la luz de estos factores, el error promedio general de orientación de 0.9 grados y el error de alcance de 5 m con un espaciado de micrófono de menos de 10 cm son excelentes. Creemos que la fabricación profesional y mejores micrófonos podrían lograr fácilmente un mejor rendimiento que el mejor sensor en nuestro experimento (>60% de tasa de localización y un error de rango de 3 m). Curiosamente, el mayor error en el rango fue de enormes 90 m, claramente debido a alguna detección errónea, sin embargo, el mayor error en la dirección fue de menos de 12 grados, lo cual sigue siendo una buena indicación para el soldado de hacia dónde mirar. La tasa de localización general de todos los sensores individuales fue del 42%, mientras que para disparos de 50 m solamente, esto aumentó al 61%. Se debe tener en cuenta que el campo de tiro fue preparado para simular en cierta medida un área urbana: había algunas estructuras de madera de uno y dos pisos construidas tanto dentro como alrededor del área de despliegue de sensores y las líneas de tiro. Por lo tanto, no todos los sensores tenían línea de visión a todas las posiciones de disparo. Estimamos que en promedio el 10% de los sensores tenían la vista obstruida hacia el tirador. Por lo tanto, podemos afirmar que un sensor dado tenía aproximadamente un 50% de probabilidad de localizar un disparo dentro de 130 m. (Dado que el área de despliegue del sensor era de 30 m de profundidad, los disparos de 100 m corresponden a distancias reales entre 100 y 130 m). Nuevamente, enfatizamos que la localización requiere al menos tres detecciones de explosión de boca de fuego y tres de onda de choque de un posible total de cuatro para cada sensor. La tasa de detección para sensores individuales, correspondiente a al menos una detección de onda de choque por sensor, fue prácticamente del 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 número de sensores porcentaje de disparos Figura 13: Histograma que muestra qué fracción de los 104 disparos tomados desde 50 y 100 metros fueron localizados por al menos cuántos sensores individuales solamente. El 13% de los disparos no fueron detectados por ningún sensor, es decir, ninguno de ellos tuvo detecciones tanto de la explosión del cañón como de la onda de choque. Cabe destacar que casi todos estos disparos fueron localizados con precisión por el sistema en red, es decir, la fusión de sensores utilizando todas las observaciones disponibles en la red de sensores. Sería engañoso interpretar estos resultados como si el sistema estuviera perdiendo la mitad de los disparos. Dado que los soldados nunca trabajan solos y el nodo sensor es relativamente económico para equipar a cada soldado con uno, también necesitamos analizar las tasas de detección globales para cada disparo. La Figura 13 muestra el histograma del porcentaje de disparos vs. el número de sensores individuales que lo localizaron. El 13% de los disparos no fueron localizados por ningún sensor por sí solo, pero el 87% fue localizado por al menos un sensor de diez. 7.2 Fuentes de error En esta sección, analizamos las fuentes de error más significativas que afectan el rendimiento del sistema de localización de tiradores en red y clasificación de armas. Para correlacionar las observaciones distribuidas de los eventos acústicos, los nodos necesitan tener una referencia común de tiempo y espacio. Por lo tanto, los errores en la sincronización del tiempo, la localización de nodos y la orientación de nodos degradan la precisión general del sistema. Nuestro enfoque de sincronización del tiempo produce errores significativamente inferiores a 100 microsegundos. Dado que el sonido viaja aproximadamente 3 cm en ese tiempo, los errores de sincronización temporal tienen un efecto insignificante en el sistema. Por otro lado, la ubicación y orientación del nodo pueden tener un efecto directo en el rendimiento general del sistema. Observa que para analizar esto, no tenemos que recurrir a la simulación, en su lugar podemos utilizar los datos reales de prueba recopilados en Aberdeen. Pero en lugar de utilizar las ubicaciones reales de los sensores conocidas con gran precisión y las orientaciones de los nodos medidas y calibradas casi perfectamente, podemos agregar términos de error a ellas y ejecutar la fusión de sensores. Esto replica exactamente cómo el sistema habría funcionado durante la prueba utilizando las ubicaciones y orientaciones imprecisamente conocidas. Otro aspecto del rendimiento del sistema que se puede evaluar de esta manera es el efecto del número de sensores disponibles. En lugar de utilizar los diez sensores en la fusión de datos, podemos elegir cualquier subconjunto de los nodos para ver cómo disminuye la precisión a medida que reducimos el número de nodos. El siguiente experimento fue llevado a cabo. El número de sensores varió de 2 a 10 en incrementos de 2. Cada ejecución seleccionó los sensores al azar utilizando una distribución uniforme. En cada ejecución, cada nodo fue movido aleatoriamente a una nueva ubicación dentro de un círculo alrededor de su posición real, con un radio determinado por una distribución gaussiana de media cero. Finalmente, las orientaciones de los nodos fueron perturbadas utilizando una distribución gaussiana con media cero. Cada combinación de parámetros se generó 100 veces y se utilizó para los 196 disparos. Los resultados se resumen en la Figura 14. Hay un gráfico de barras en 3D para cada uno de los conjuntos de experimentos con el número fijo de sensores dado. El eje x muestra el error de ubicación del nodo, es decir, la desviación estándar de la distribución gaussiana correspondiente que varió entre 0 y 6 metros. El eje y muestra la desviación estándar del error de orientación del nodo que varió entre 0 y 6 grados. El eje z es el error de azimut de la trayectoria resultante. Se observó que los ángulos de elevación presentaron errores algo mayores que los de azimut. Dado que todos los sensores estaban aproximadamente en un plano horizontal y solo unas pocas posiciones de tirador estaban fuera del mismo plano y solo por unos 2 m, la prueba no fue suficiente para evaluar este aspecto del sistema. Se pueden hacer muchas observaciones interesantes al analizar estos gráficos. Los errores de ubicación del nodo en este rango tienen un efecto pequeño en la precisión. Los errores de orientación de los nodos, por otro lado, degradan notablemente el rendimiento. Aún así, los errores más grandes en este experimento de 3.5 grados para 6 sensores y 5 grados para 2 sensores siguen siendo muy buenos. Ten en cuenta que a medida que aumentan los errores de ubicación y orientación y disminuye el número de sensores, la métrica de rendimiento más afectada de manera significativa es la tasa de localización. Consulta la Tabla 4 para un resumen. La localización exitosa disminuye de casi el 100% a un 50% cuando pasamos de 10 sensores a 2, incluso sin errores adicionales. Esto es causado principalmente por la geometría: para una localización exitosa, la bala necesita pasar sobre la red de sensores, es decir, al menos un sensor debe estar en el lado de la trayectoria distinto al resto de los nodos. (Esta es una simplificación con fines ilustrativos). Si todos los sensores y la trayectoria no son coplanares, la localización puede ser exitosa incluso si el proyectil pasa por un lado de la red. Ver la Sección 6.3. A medida que disminuyeron los números de sensores en el experimento al seleccionar aleatoriamente un subconjunto, la probabilidad de que las trayectorias cumplieran con esta regla disminuyó. Esto también significa que incluso si hay 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 2 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 4 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 6 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 8 sensores Figura 14: El efecto de los errores de localización y orientación del nodo en la precisión del azimut con 2, 4, 6 y 8 nodos. Ten en cuenta que el gráfico para 10 nodos es casi idéntico al caso de 8 nodos, por lo tanto, se omite. Si hay demasiados sensores (es decir, soldados), pero todos están uno al lado del otro, la tasa de localización se verá afectada. Sin embargo, cuando la fusión de sensores proporciona un resultado, sigue siendo preciso incluso con pocos sensores disponibles y errores individuales relativamente grandes. Unas pocas observaciones consistentes llevan a una buena precisión, ya que las inconsistentes son descartadas por el algoritmo. Esto también se ve respaldado por la observación de que, para los casos con un mayor número de sensores (8 o 10), la tasa de localización apenas se ve afectada incluso por errores grandes. Errores/Sensores 2 4 6 8 10 0 m, 0 grados 54% 87% 94% 95% 96% 2 m, 2 grados 53% 80% 91% 96% 96% 6 m, 0 grados 43% 79% 88% 94% 94% 0 m, 6 grados 44% 78% 90% 93% 94% 6 m, 6 grados 41% 73% 85% 89% 92% Tabla 4: Tasa de localización en función del número de sensores utilizados, los errores de ubicación y orientación del nodo sensor. Una de las observaciones más significativas en la Figura 14 y la Tabla 4 es que apenas hay diferencia en los datos para 6, 8 y 10 sensores. Esto significa que hay poco beneficio en agregar más nodos más allá de 6 sensores en cuanto a la precisión se refiere. La velocidad del sonido depende de la temperatura ambiente. El prototipo actual considera constante lo que normalmente se establece antes de una prueba. Sería sencillo emplear un sensor de temperatura para actualizar periódicamente el valor de la velocidad del sonido durante la operación. Tenga en cuenta también que el viento puede afectar negativamente la precisión del sistema. La fusión de sensores, sin embargo, podría incorporar la velocidad del viento en sus cálculos. Sería más complicado que la compensación de temperatura, pero se podría hacer. Otros problemas prácticos también deben ser considerados antes de implementar en el mundo real. Los silenciadores reducen la energía de la explosión en la boca del cañón y, por lo tanto, el alcance efectivo en el que el sistema puede detectarla. Sin embargo, los silenciadores no afectan la onda de choque y el sistema seguiría detectando con precisión la trayectoria y el calibre. El alcance y el tipo de arma no se pudieron estimar sin detectar la explosión en la boca del cañón. Las armas subsónicas no producen una onda de choque. Sin embargo, esto no es de gran importancia, ya que tienen un alcance más corto, menor precisión y mucha menos letalidad. Por lo tanto, su uso no es generalizado y representan menos peligro en cualquier caso. Otro problema es el tipo de munición utilizada. Los ejércitos irregulares pueden usar balas de calidad inferior, incluso fabricadas a mano. Esto afecta la velocidad inicial del proyectil del arma. Para que la clasificación de armas funcione con precisión, el sistema debería ser calibrado con la munición típica utilizada por el adversario dado. TRABAJO RELACIONADO La detección y reconocimiento acústico ha sido objeto de investigación desde principios de los años cincuenta. La zona tiene una estrecha relevancia con el tema de la mecánica del flujo supersónico [20]. Fansler analizó las complejas ondas de presión de campo cercano que ocurren dentro de un pie de la explosión del cañón. El trabajo de Fansler proporciona una buena idea de la onda de presión ideal del estallido del cañón sin contaminación de ecos o efectos de propagación [4]. Los experimentos con distancias mayores desde la boca del cañón fueron realizados por Stoughton [18]. Las mediciones de las ondas de choque balísticas utilizando transductores de presión calibrados en ubicaciones conocidas, velocidades de bala medidas y distancias de error de 355 metros para proyectiles de 5.56 mm y 7.62 mm fueron realizadas. Los resultados indican que la interacción con el suelo se convierte en un problema para distancias de error de 30 metros o más grandes. Otra área de investigación es el procesamiento de señales de la acústica de disparos. El enfoque se centra en la detección robusta y estimación de la longitud de ondas de choque acústicas de pequeño calibre y explosiones de boca de fuego. Posibles técnicas para clasificar señales como ondas de choque o explosiones de boca de fuego incluyen la Transformada de Fourier de tiempo corto (STFT), la distribución de Wigner-Ville pseudo suavizada (SPWVD) y una transformación discreta de wavelet (DWT). Los espectrogramas de tiempo-frecuencia conjunta (JTF) se utilizan para analizar la separación típica de los transitorios de la onda de choque y la explosión del cañón tanto en tiempo como en frecuencia. Mays concluye que la DWT es el mejor método para clasificar señales como ondas de choque o explosiones de boca de fuego porque funciona bien y es menos costoso de calcular que el SPWVD [10]. Los bordes de la onda de choque suelen estar bien definidos y la longitud de la onda de choque está directamente relacionada con las características de la bala. Un artículo de Sadler [14] compara dos métodos de detección de bordes de onda de choque: un detector simple basado en gradientes y un detector de ondaleta de múltiples escalas. También demuestra cómo la longitud de la onda de choque, determinada por los detectores de borde, puede ser utilizada junto con las ecuaciones de Whitham [20] para estimar el calibre de un proyectil. Ten en cuenta que el rendimiento computacional disponible en los nodos sensores, el ancho de banda inalámbrico limitado y los requisitos en tiempo real hacen que estos enfoques sean inviables en nuestra plataforma. Un tema relacionado es la investigación y desarrollo de sistemas experimentales y prototipos de localización de disparos. Los investigadores de BBN han desarrollado el sistema Bullet Ears [3], el cual tiene la capacidad de ser instalado en una posición fija o usado por soldados. El sistema fijo tiene matrices de micrófonos con forma de tetraedro con un espaciado de 1.5 metros. El sistema en general consiste en dos o tres de estos conjuntos espaciados de 20 a 100 metros entre sí. El sistema usado por los soldados cuenta con 12 micrófonos, así como una antena GPS y sensores de orientación montados en un casco. Hay una conexión de RF de baja velocidad desde el casco hasta el cuerpo de procesamiento. Se ha realizado una prueba extensa para medir el rendimiento de ambos tipos de sistemas. El rendimiento de los sistemas fijos fue una orden de magnitud mejor en los cálculos de ángulo, mientras que su rendimiento en alcance fue igualado. La precisión del ángulo del sistema fijo era predominantemente inferior a un grado, mientras que era de alrededor de cinco grados para el montado en el casco. La precisión del rango fue de alrededor del 5 por ciento para ambos sistemas. El problema con este y otros sistemas centralizados similares es la necesidad de que uno o un puñado de matrices de micrófonos estén a la vista del tirador. Una solución basada en redes de sensores tiene la ventaja de un amplio alcance de detección para una mejor cobertura, compensación de efectos de múltiples trayectorias y resolución de múltiples disparos simultáneos [8]. Esto es especialmente importante para operar en áreas urbanas con reverberación acústica. Ten en cuenta que el sistema actual montado en vehículos de BBN llamado BOOMERANG, una versión modificada de Bullet Ears, se utiliza actualmente en Iraq [1]. La empresa ShotSpotter se especializa en sistemas de aplicación de la ley que informan la ubicación de disparos a la policía en cuestión de segundos. El objetivo del sistema es significativamente diferente al de los sistemas militares. Shotspotter informa una precisión típica de 25 m, lo cual es más que suficiente para que la policía responda a 125. También están fabricando sistemas experimentales portátiles para soldados y montados en UAV para uso militar [16], pero no hay especificaciones ni resultados de evaluación disponibles públicamente. 9. CONCLUSIONES La principal contribución de este trabajo es doble. Primero, el rendimiento del sistema distribuido en red en general es excelente. Lo más destacado es la precisión de la trayectoria de un grado, la tasa de estimación de calibre correcta de más del 90% y la tasa de clasificación de armas cercana al 100% para 4 de las 6 armas probadas. El sistema demostró ser muy robusto al aumentar los errores de ubicación y orientación de los nodos y al disminuir el número de sensores disponibles hasta llegar a solo un par. El factor clave detrás de esto es la capacidad de los algoritmos de fusión de sensores para rechazar mediciones erróneas. También vale la pena mencionar que los resultados presentados aquí corresponden al primer y único test del sistema más allá de los 100 m y con seis armas diferentes. Creemos que con las lecciones aprendidas en la prueba, un experimento de campo consecutivo podría haber mostrado resultados significativamente mejorados, especialmente en la estimación de alcance más allá de los 100 m y la clasificación de armas para las dos armas restantes que se confundieron la mayoría de las veces durante la prueba. Segundo, el rendimiento del sistema cuando se utilizaba en modo independiente, es decir, cuando solo los sensores proporcionaban la localización, también fue muy bueno. Si bien la tasa de localización general del 42% por sensor para disparos de hasta 130 m podría mejorarse, la precisión del rumbo de menos de un grado y el error promedio de rango del 5% son notables utilizando los prototipos hechos a mano de los nodos de bajo costo. Se observó que el 87% de los disparos fueron localizados con éxito por al menos uno de los diez sensores utilizados en modo independiente. Creemos que la tecnología está suficientemente madura como para que una próxima revisión del sistema pueda ser comercial. Sin embargo, todavía sería necesario trabajar en aspectos importantes del sistema. Todavía no hemos abordado el manejo de energía. Un nodo actual funciona con 4 pilas AA durante aproximadamente 12 horas de operación continua. Una versión desplegable del nodo sensor debería estar en modo de reposo durante la operación normal y solo despertarse cuando ocurre un evento interesante. Un circuito de disparo analógico podría resolver este problema, sin embargo, el sistema se perdería el primer disparo. En cambio, los canales acústicos deberían ser muestreados y almacenados en un búfer circular. El resto del tablero podría apagarse. Cuando un disparador despierta la placa, los datos acústicos estarían disponibles de inmediato. Los experimentos con una placa de sensores de generación anterior indicaron que esto podría proporcionar un aumento de 10 veces en la vida útil de la batería. Otros problemas pendientes incluyen el empaquetado resistente a la intemperie y la robustez, así como la integración con la infraestructura militar actual. 10. REFERENCIAS [1] Sitio web de BBN Technologies. http://www.bbn.com. [2] E. Danicki. Localización acústica de francotiradores. Archivos de Acústica, 30(2):233-245, 2005. [3] G. L. Duckworth y col. Sistemas acústicos fijos y portátiles para la detección de francotiradores para las fuerzas del orden. En E. M. Carapezza y D. B. Ley, editores, Proc. SPIE Vol. 3577, p. 210-230, páginas 210-230, enero de 1999. [4] K. Fansler. Descripción de la explosión de la boca de fuego mediante modelos de escala modificados. Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.\n\nImpacto y Vibración, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer y D. Culler. El lenguaje nesC: un enfoque holístico para sistemas embebidos en red. Actas del Diseño e Implementación de Lenguajes de Programación (PLDI), junio de 2003. [6] J. Hill, R. Szewczyk, A. Woo, S. Hollar, D. Culler y K. Pister. Direcciones de arquitectura del sistema para sensores en red. en Proc. de ASPLOS 2000, noviembre de 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti y L. Meertens. Localización independiente de la densidad de nodos. Procesamiento de información en redes de sensores (IPSN 06) SPOTS Track, abril de 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti y G. Simon. Sistema contratirador para la guerra urbana. ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Maróti. Marco de enrutamiento de inundaciones dirigidas para redes de sensores inalámbricos. En Actas de la 5ta Conferencia Internacional de Middleware ACM/IFIP/USENIX, páginas 99-114, Nueva York, NY, EE. UU., 2004. Springer-Verlag New York, Inc. [10] B. Mays. \n\nSpringer-Verlag New York, Inc. [10] B. Mays. Clasificación de la onda de choque y la explosión de la boca del cañón mediante análisis conjunto de tiempo-frecuencia y wavelet. Informe técnico, Laboratorio de Investigación del Ejército, Adelphi MD 20783-1197, septiembre de 2001. [11] Plataformas de hardware de TinyOS. http://tinyos.net/scoop/special/hardware. [12] Módulo de radio Crossbow MICAz (MPR2400). http://www.xbow.com/Products/productsdetails.aspx?sid=101. [13] Recursos para usuarios de PicoBlaze. http://www.xilinx.com/ipcenter/processor_central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham y L. C. Sadler. Detección y estimación óptima basada en wavelets de onda de choque. Revista de la Sociedad Acústica de América, 104:955-963, agosto de 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi y P. Dutta. Sobre la escalabilidad de la sincronización de tiempo integrada en enrutamiento. 3er Taller Europeo sobre Redes de Sensores Inalámbricos (EWSN 2006), febrero de 2006. [16] Sitio web de ShotSpotter. http://www.shotspotter.com/products/military.html. [17] G. Simon, M. Maróti, A. Lédeczi, G. Balogh, B. Kušy, A. Nádas, G. Pap, J. Sallai y K. Frampton. Sistema de contratirador basado en redes de sensores. En SenSys 04: Actas de la 2ª conferencia internacional sobre sistemas de sensores en red integrados, páginas 1-12, Nueva York, NY, EE. UU., 2004. ACM Press. [18] R. Stoughton. \n\nACM Press. [18] R. Stoughton. Mediciones de ondas de choque balísticas de pequeño calibre en el aire. Revista de la Sociedad Acústica de América, 102:781-787, agosto de 1997. [19] B. A. Weiss, C. Schlenoff, M. Shneier y A. Virts. Evaluaciones de tecnología y métricas de rendimiento para sensores llevados por soldados para asistencia. En el taller de Métricas de Rendimiento para Sistemas Inteligentes, agosto de 2006. [20] G. Whitham. Patrón de flujo de un proyectil supersónico. Comunicaciones en matemáticas puras y aplicadas, 5(3):301, 1952. 126 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "trajectory": {
            "translated_key": "trayectoria",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the <br>trajectory</br>, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree <br>trajectory</br> precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the <br>trajectory</br>, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the <br>trajectory</br> and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a <br>trajectory</br> estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a <br>trajectory</br>.",
                "In fact, an infinite number of <br>trajectory</br>-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the <br>trajectory</br>, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet <br>trajectory</br>, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single <br>trajectory</br> from all shockwave measurements (see 6.3). 4.",
                "If <br>trajectory</br> available compute range (see 6.4). else compute shooter position first and then <br>trajectory</br> based on it. (see 6.4) 5.",
                "If <br>trajectory</br> available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet <br>trajectory</br> Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 <br>trajectory</br> estimation Danicki showed that the bullet <br>trajectory</br> and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the <br>trajectory</br> cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the <br>trajectory</br> measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several <br>trajectory</br> candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single <br>trajectory</br>.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the <br>trajectory</br> for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A <br>trajectory</br> is represented by one point pi and the normal vector vi (where i is the <br>trajectory</br> index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each <br>trajectory</br> a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final <br>trajectory</br>.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the <br>trajectory</br>.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the <br>trajectory</br> estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. <br>trajectory</br>, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet <br>trajectory</br> shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the <br>trajectory</br> has already been calculated in previous steps, the search needs to be done only on the <br>trajectory</br> making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet <br>trajectory</br> to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate <br>trajectory</br> estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a <br>trajectory</br>. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the <br>trajectory</br> is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber <br>trajectory</br> <br>trajectory</br> Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the <br>trajectory</br> of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the <br>trajectory</br>.",
                "The <br>trajectory</br> error is broken down to azimuth in degrees and the actual distance of the shooter from the <br>trajectory</br>.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the <br>trajectory</br> and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated <br>trajectory</br> and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the <br>trajectory</br> of shots.",
                "Since caliber estimation and weapon classification relies on the <br>trajectory</br>, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the <br>trajectory</br> ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a <br>trajectory</br> at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to <br>trajectory</br> accuracy and range estimation precision.",
                "The angle of the estimated <br>trajectory</br> was better than 1 degree except for the 300 m range.",
                "Since the range should not affect <br>trajectory</br> estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated <br>trajectory</br> distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the <br>trajectory</br> itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated <br>trajectory</br>.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a <br>trajectory</br> estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual <br>trajectory</br> directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated <br>trajectory</br> range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the <br>trajectory</br> and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting <br>trajectory</br> azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the <br>trajectory</br> other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the <br>trajectory</br> are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the <br>trajectory</br> and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the <br>trajectory</br> accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "The system estimates the <br>trajectory</br>, the range, the caliber and the weapon type.",
                "The system performance is characterized by 1degree <br>trajectory</br> precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Special emphasis is paid to the sensor fusion technique that estimates the <br>trajectory</br>, range, caliber and weapon type simultaneously.",
                "The length is determined by the caliber and the miss distance, the distance between the <br>trajectory</br> and the sensor.",
                "Once a <br>trajectory</br> estimate is available, the shockwave length can be used for caliber estimation."
            ],
            "translated_annotated_samples": [
                "El sistema estima la <br>trayectoria</br>, el alcance, el calibre y el tipo de arma.",
                "El rendimiento del sistema se caracteriza por una precisión de <br>trayectoria</br> de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas.",
                "Se presta especial atención a la técnica de fusión de sensores que estima la <br>trayectoria</br>, alcance, calibre y tipo de arma simultáneamente.",
                "La longitud está determinada por el calibre y la distancia de error, la distancia entre la <br>trayectoria</br> y el sensor.",
                "Una vez que se tiene una estimación de la <br>trayectoria</br>, la longitud de la onda de choque se puede utilizar para estimar el calibre."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la <br>trayectoria</br>, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de <br>trayectoria</br> de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la <br>trayectoria</br>, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la <br>trayectoria</br> y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la <br>trayectoria</br>, la longitud de la onda de choque se puede utilizar para estimar el calibre. ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "range": {
            "translated_key": "alcance",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the <br>range</br>, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in <br>range</br> estimation for longer <br>range</br> shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, <br>range</br>, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the <br>range</br>, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic <br>range</br>) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz <br>range</br>) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute <br>range</br> estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute <br>range</br> (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the <br>range</br>.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller <br>range</br>, so the above formula underestimates the true <br>range</br>.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. <br>range</br> estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has <br>range</br> estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and <br>range</br> estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two <br>range</br> estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and <br>range</br> data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A <br>range</br> supports B, if the sphere with the radius of the <br>range</br> and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-<br>range</br> pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and <br>range</br> estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 <br>range</br> (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 <br>range</br> (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the <br>range</br> and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed <br>range</br>, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated <br>range</br>-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting <br>range</br> with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the <br>range</br> was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby <br>range</br>.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "<br>range</br> ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the <br>range</br> estimation.",
                "Note that the traditional bearing and <br>range</br> measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the <br>range</br> is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and <br>range</br> estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m <br>range</br>.",
                "Since the <br>range</br> should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the <br>range</br>.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory <br>range</br> estimation due to the lack of a better term.",
                "The <br>range</br> estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long <br>range</br> shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the <br>range</br>, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the <br>range</br>.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the <br>range</br>-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and <br>range</br> estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 <br>range</br> (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and <br>range</br> values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and <br>range</br> error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m <br>range</br> error).",
                "Interestingly, the largest error in <br>range</br> was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing <br>range</br> was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this <br>range</br> have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective <br>range</br> the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The <br>range</br> and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter <br>range</br>, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their <br>range</br> performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The <br>range</br> accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in <br>range</br> estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% <br>range</br> error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "The system estimates the trajectory, the <br>range</br>, the caliber and the weapon type.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in <br>range</br> estimation for longer <br>range</br> shots.",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, <br>range</br>, caliber and weapon type simultaneously.",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the <br>range</br>, the caliber and the weapon type based on all available observations.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic <br>range</br>) and also results in less noisy measurements by avoiding long analog signal paths."
            ],
            "translated_annotated_samples": [
                "El sistema estima la trayectoria, el <br>alcance</br>, el calibre y el tipo de arma.",
                "PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia.",
                "Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, <br>alcance</br>, calibre y tipo de arma simultáneamente.",
                "Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el <br>alcance</br>, el calibre y el tipo de arma basándose en todas las observaciones disponibles.",
                "Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o <br>rango dinámico</br> diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el <br>alcance</br>, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, <br>alcance</br>, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el <br>alcance</br>, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o <br>rango dinámico</br> diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. ",
            "candidates": [],
            "error": [
                [
                    "alcance",
                    "alcance",
                    "alcance",
                    "rango dinámico"
                ]
            ]
        },
        "caliber": {
            "translated_key": "calibre",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the <br>caliber</br> and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% <br>caliber</br> estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for <br>caliber</br> estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, <br>caliber</br> and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the <br>caliber</br> and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for <br>caliber</br> estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the <br>caliber</br> and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the <br>caliber</br> of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute <br>caliber</br> (see 6.5). 6.",
                "If <br>caliber</br> available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 <br>caliber</br> estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different <br>caliber</br> projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different <br>caliber</br> projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given <br>caliber</br> can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the <br>caliber</br> whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% <br>caliber</br> estimation error when an accurate trajectory estimate is available.",
                "In other words, <br>caliber</br> estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same <br>caliber</br>.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same <br>caliber</br>.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its <br>caliber</br> showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm <br>caliber</br>, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm <br>caliber</br>.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated <br>caliber</br> class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 <br>caliber</br> M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- <br>caliber</br> Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The <br>caliber</br> accuracy rate is relative to the shots localized and not all the shots because <br>caliber</br> estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The <br>caliber</br> and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since <br>caliber</br> estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The <br>caliber</br> and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the <br>caliber</br> estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same <br>caliber</br> (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same <br>caliber</br>.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the <br>caliber</br> or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and <br>caliber</br> accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small <br>caliber</br> acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the <br>caliber</br> of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct <br>caliber</br> estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-<br>caliber</br> ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "The system estimates the trajectory, the range, the <br>caliber</br> and the weapon type.",
                "The system performance is characterized by 1degree trajectory precision and over 95% <br>caliber</br> estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Finally, additional requirements called for <br>caliber</br> estimation and weapon classification in addition to source localization.",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, <br>caliber</br> and weapon type simultaneously.",
                "The length is determined by the <br>caliber</br> and the miss distance, the distance between the trajectory and the sensor."
            ],
            "translated_annotated_samples": [
                "El sistema estima la trayectoria, el alcance, el <br>calibre</br> y el tipo de arma.",
                "El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de <br>calibre</br> de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas.",
                "Finalmente, se requirió la estimación del <br>calibre</br> y la clasificación de armas, además de la localización de la fuente.",
                "Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, <br>calibre</br> y tipo de arma simultáneamente.",
                "La longitud está determinada por el <br>calibre</br> y la distancia de error, la distancia entre la trayectoria y el sensor."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el <br>calibre</br> y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de <br>calibre</br> de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del <br>calibre</br> y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, <br>calibre</br> y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el <br>calibre</br> y la distancia de error, la distancia entre la trayectoria y el sensor. ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "weapon type": {
            "translated_key": "tipo de arma",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the <br>weapon type</br>.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and <br>weapon type</br> simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the <br>weapon type</br> based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute <br>weapon type</br> (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the <br>weapon type</br>.",
                "This is because for a given <br>weapon type</br> and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the <br>weapon type</br> whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and <br>weapon type</br> could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "The system estimates the trajectory, the range, the caliber and the <br>weapon type</br>.",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and <br>weapon type</br> simultaneously.",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the <br>weapon type</br> based on all available observations.",
                "If caliber available compute <br>weapon type</br> (see 6.6).",
                "However, the measured speed of the projectile and its caliber showed good correlation with the <br>weapon type</br>."
            ],
            "translated_annotated_samples": [
                "El sistema estima la trayectoria, el alcance, el calibre y el <br>tipo de arma</br>.",
                "Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y <br>tipo de arma</br> simultáneamente.",
                "Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el <br>tipo de arma</br> basándose en todas las observaciones disponibles.",
                "Si el calibre está disponible, calcular el <br>tipo de arma</br> (ver 6.6).",
                "Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el <br>tipo de arma</br>."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el <br>tipo de arma</br>. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y <br>tipo de arma</br> simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el <br>tipo de arma</br> basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo. La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él. El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz. El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado. Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros. Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes. Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula. Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth). Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador. El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R. El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa. Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo. Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente. Las rutas de señal se encuentran justo antes del archivo de registros. Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida. Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5. Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí. El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial. El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas. Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM. Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB. La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros. Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea. Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador. La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz). Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo. Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo. Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento. Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación. Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas. Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos. Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc. Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía). De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo. La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores. El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje. Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual. Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local. El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación. Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente. La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6]. Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz. ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares. Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos. Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular. Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios. Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias. Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento. Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos. Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente). Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque. En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples. Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal. Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento. Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote. En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente. Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal. Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs). El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado. La máquina de estados del algoritmo se muestra en la Figura 5(b). Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax). La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada. A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4]. Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a). Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad. La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC). Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC. Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período. Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido. Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente. El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente. El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca). El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b). Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes. Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE. La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6. La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma. El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1. Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2. Calcular estimaciones de rango. Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3. Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4. Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5. Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6. Si el calibre está disponible, calcular el <br>tipo de arma</br> (ver 6.6). Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor. Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s. Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano). Formalicemos primero el problema para 3 micrófonos. Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3. Primero aplicamos un paso de validación de geometría simple. La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición. Si esta condición no se cumple, las detecciones correspondientes son descartadas. Sea v(x, y, z) el vector normal de la dirección de llegada desconocida. También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3. Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c). Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos. Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden). Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos. De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2). Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque. Considera la situación en la Figura 7. Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos. Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible. La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u. La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales. Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P). Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie. Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2). La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t). P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1. Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón). En este caso: t = uvt1−t2 uv−1. Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango. Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil. En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano. La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala. Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango. Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada. Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2]. El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí. En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular. En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente. En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque. Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico. Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque). Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral. Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria. Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque. Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno. Esto nos da como máximo N(N−1) 2 trayectorias. Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria). Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio. El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos. El conjunto central se puede encontrar en tiempo O(N2). Las trayectorias en el conjunto central se promedian para obtener la trayectoria final. Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección. Significa que todos los sensores están en el mismo lado de la trayectoria. En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido. Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque. Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria. Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles). Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor. Para un ejemplo, consulte la Figura 8. Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque. Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador. Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos. Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8]. La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales. Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja. La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas. La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada. El retroceso es posible para evitar quedarse atascado en un máximo local. Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea. Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida. A continuación, describamos detalladamente cómo se calcula la función de consistencia. Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular. Primero consideramos solo la información de ToA. Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA. Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B. Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo. El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B. Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8]. Aquí extendemos el enfoque de la siguiente manera. Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales. Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B. Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B. En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores. El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 Estimación de calibre Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20]. Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error. Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos. Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores). Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque. Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos. Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes. Los datos experimentales se muestran en la Figura 9. La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4). Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas. Este método tiene menos del 1% de error en la estimación del calibre cuando se dispone de una estimación precisa de la trayectoria. En otras palabras, la estimación del calibre solo funciona si se realizan suficientes detecciones de ondas de choque por el sistema para calcular una trayectoria. 120 6.6 Estimación de armas Analizamos todas las características de la señal medida para encontrar información específica de la arma. Lamentablemente, concluimos que la firma observada de la explosión del cañón no es lo suficientemente característica del arma para fines de clasificación. Las reflexiones de la explosión de alta energía del freno de boca tienen un impacto mucho mayor en la forma de la señal de la explosión del freno de boca que el arma en sí misma. Disparar la misma arma desde diferentes lugares causó diferencias más grandes en la señal registrada que disparar diferentes armas desde el mismo lugar. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 rango (m) velocidad (m/s) AK-47 M240 Figura 10: Mediciones de desaceleración de balas de AK47 y M240. Ambas armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 rango (m) velocidad (m/s) M16 M249 M4 Figura 11: Mediciones de desaceleración de balas M16, M249 y M4. Todas las armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el <br>tipo de arma</br>. ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "1degree trajectory precision": {
            "translated_key": "precisión de trayectoria",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by <br>1degree trajectory precision</br> and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "The system performance is characterized by <br>1degree trajectory precision</br> and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested."
            ],
            "translated_annotated_samples": [
                "El rendimiento del sistema se caracteriza por una <br>precisión de trayectoria</br> de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una <br>precisión de trayectoria</br> de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo. La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él. El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz. El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado. Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros. Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes. Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula. Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth). Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador. El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R. El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa. Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo. Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente. Las rutas de señal se encuentran justo antes del archivo de registros. Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida. Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5. Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí. El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial. El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas. Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM. Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB. La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros. Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea. Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador. La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz). Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo. Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo. Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento. Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación. Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas. Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos. Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc. Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía). De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo. La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores. El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje. Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual. Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local. El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación. Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente. La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6]. Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz. ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares. Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos. Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular. Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios. Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias. Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento. Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos. Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente). Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque. En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples. Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal. Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento. Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote. En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente. Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal. Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs). El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado. La máquina de estados del algoritmo se muestra en la Figura 5(b). Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax). La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada. A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4]. Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a). Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad. La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC). Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC. Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período. Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido. Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente. El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente. El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca). El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b). Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes. Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE. La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6. La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma. El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1. Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2. Calcular estimaciones de rango. Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3. Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4. Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5. Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6. Si el calibre está disponible, calcular el tipo de arma (ver 6.6). Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor. Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s. Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano). Formalicemos primero el problema para 3 micrófonos. Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3. Primero aplicamos un paso de validación de geometría simple. La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición. Si esta condición no se cumple, las detecciones correspondientes son descartadas. Sea v(x, y, z) el vector normal de la dirección de llegada desconocida. También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3. Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c). Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos. Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden). Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos. De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2). Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque. Considera la situación en la Figura 7. Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos. Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible. La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u. La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales. Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P). Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie. Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2). La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t). P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1. Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón). En este caso: t = uvt1−t2 uv−1. Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango. Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil. En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano. La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala. Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango. Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada. Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2]. El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí. En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular. En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente. En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque. Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico. Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque). Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral. Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria. Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque. Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno. Esto nos da como máximo N(N−1) 2 trayectorias. Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria). Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio. El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos. El conjunto central se puede encontrar en tiempo O(N2). Las trayectorias en el conjunto central se promedian para obtener la trayectoria final. Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección. Significa que todos los sensores están en el mismo lado de la trayectoria. En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido. Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque. Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria. Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles). Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor. Para un ejemplo, consulte la Figura 8. Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque. Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador. Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos. Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8]. La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales. Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja. La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas. La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada. El retroceso es posible para evitar quedarse atascado en un máximo local. Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea. Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida. A continuación, describamos detalladamente cómo se calcula la función de consistencia. Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular. Primero consideramos solo la información de ToA. Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA. Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B. Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo. El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B. Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8]. Aquí extendemos el enfoque de la siguiente manera. Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales. Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B. Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B. En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores. El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 Estimación de calibre Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20]. Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error. Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos. Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores). Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque. Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos. Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes. Los datos experimentales se muestran en la Figura 9. La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4). Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas. Este método tiene menos del 1% de error en la estimación del calibre cuando se dispone de una estimación precisa de la trayectoria. En otras palabras, la estimación del calibre solo funciona si se realizan suficientes detecciones de ondas de choque por el sistema para calcular una trayectoria. 120 6.6 Estimación de armas Analizamos todas las características de la señal medida para encontrar información específica de la arma. Lamentablemente, concluimos que la firma observada de la explosión del cañón no es lo suficientemente característica del arma para fines de clasificación. Las reflexiones de la explosión de alta energía del freno de boca tienen un impacto mucho mayor en la forma de la señal de la explosión del freno de boca que el arma en sí misma. Disparar la misma arma desde diferentes lugares causó diferencias más grandes en la señal registrada que disparar diferentes armas desde el mismo lugar. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 rango (m) velocidad (m/s) AK-47 M240 Figura 10: Mediciones de desaceleración de balas de AK47 y M240. Ambas armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 rango (m) velocidad (m/s) M16 M249 M4 Figura 11: Mediciones de desaceleración de balas M16, M249 y M4. Todas las armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el tipo de arma. Esto se debe a que, para un tipo de arma y par de municiones dados, la velocidad inicial es casi constante. En las Figuras 10 y 11 podemos ver la relación entre el alcance y la velocidad de bala medida para diferentes calibres y armas. En el rango de velocidad supersónica, la desaceleración de la bala se puede aproximar con una función lineal. En el caso del calibre 7.62 mm, las dos armas probadas (AK47, M240) pueden ser claramente diferenciadas (Figura 10). Desafortunadamente, esto no es necesariamente cierto para el calibre 5.56 mm. El M16 con su mayor velocidad de boca aún puede ser bien clasificado, pero las armas M4 y M249 parecen prácticamente indistinguibles (Figura 11). Sin embargo, esto puede deberse en parte al número limitado de disparos de práctica que pudimos realizar antes de que comenzaran las pruebas reales. Más datos de entrenamiento pueden revelar una mejor separación entre las dos armas, ya que sus velocidades de boca publicadas difieren ligeramente. El sistema lleva a cabo la clasificación de armas de la siguiente manera. Una vez que se conoce la trayectoria, la velocidad se puede calcular para cada sensor basándose en la geometría de la onda de choque. Para evaluar un disparo, elegimos el tipo de arma cuya función de desaceleración resulta en el menor error cuadrático medio de los pares estimados de rango-velocidad para la clase de calibre estimada. 7. RESULTADOS Una evaluación independiente del sistema fue realizada por un equipo de NIST en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen en abril de 2006 [19]. El experimento se llevó a cabo en un campo de tiro con edificios y paredes de madera simulados para soportar posiciones elevadas de tiradores y generar efectos de trayectorias múltiples. La Figura 12 muestra la interfaz de usuario con una fotografía aérea del sitio. Se desplegaron 10 nodos sensores en puntos relevados en un área de aproximadamente 30×30 m. Había cinco objetivos fijos detrás de la red de sensores. Varias posiciones de disparo se ubicaron en cada una de las líneas de tiro a 50, 100, 200 y 300 metros. Estas posiciones eran conocidas por los evaluadores, pero no por los operadores del sistema. Se utilizaron seis armas diferentes: AK47 y M240 disparando proyectiles de 7.62 mm, M16, M4 y M249 con munición de 5.56 mm y el M107 de calibre .50. Ten en cuenta que los sensores permanecieron estáticos durante la prueba. La razón principal de esto es que a nadie se le permite estar en la zona de tiro durante las pruebas con fuego real. Utilizar algún tipo de plataforma de control remoto habría sido demasiado complicado dada la limitada disponibilidad de tiempo para la prueba. Por lo tanto, el experimento no probó el aspecto de movilidad del sistema. Durante la prueba de un día, se realizaron 196 disparos. Los resultados se resumen en la Tabla 1. El sistema detectó todos los disparos exitosamente. Dado que una onda de choque balística es un fenómeno acústico único, hace que la detección sea muy robusta. No hubo falsos positivos para las ondas de choque, pero hubo un puñado de detecciones falsas de explosiones de boca de fuego debido a pruebas paralelas de artillería en un campo cercano. Tirador Local- Calibre Trayectoria Trayectoria Distancia No. Tabla 1: Resumen de resultados fusionando todas las observaciones de sensores disponibles. Todas las tomas fueron detectadas con éxito, por lo que la tasa de detección se omite. La tasa de localización significa el porcentaje de disparos cuya trayectoria el sensor de fusión pudo estimar. La tasa de precisión del calibre es relativa a los disparos localizados y no a todos los disparos, ya que la estimación del calibre requiere la trayectoria. El error de trayectoria se descompone en azimut en grados y la distancia real del tirador a la trayectoria. El error de distancia muestra la distancia entre la posición real del tirador y la posición estimada del tirador. Por lo tanto, incluye el error causado tanto por la trayectoria como por la estimación del alcance. Ten en cuenta que las medidas tradicionales de rumbo y alcance no son adecuadas para un sistema distribuido como el nuestro debido a la falta de un único punto de referencia. Figura 12: La interfaz de usuario del sistema mostrando la configuración experimental. Los 10 nodos sensores están etiquetados por su ID y marcados con círculos oscuros. Los objetivos son cuadrados negros marcados como T-1 a T-5. Las flechas largas y blancas señalan la posición del tirador estimada por cada sensor. Donde faltaba, el sensor correspondiente no tuvo suficientes detecciones para medir el AoA de la explosión del cañón, la onda de choque o ambas. La línea negra gruesa y el círculo grande indican la trayectoria estimada y la posición del tirador según lo estimado al fusionar todas las detecciones disponibles de la red. Este disparo desde la línea de los 100 metros en el blanco T-3 fue localizado casi perfectamente por la red de sensores. El calibre y el arma también fueron identificados correctamente. 6 de cada 10 nodos pudieron estimar la ubicación por sí solos. Su precisión de orientación está dentro de un grado, mientras que el alcance tiene un margen de error de menos del 10% en el peor de los casos. La tasa de localización caracteriza la capacidad del sistema para estimar con éxito la trayectoria de los disparos. Dado que la estimación del calibre y la clasificación de armas dependen de la trayectoria, los disparos no localizados tampoco son clasificados. Hubo 7 disparos de 196 que no fueron localizados. La razón de los tiros fallados es el problema de ambigüedad de trayectoria que ocurre cuando el proyectil pasa por un lado de todos los sensores. En este caso, dos trayectorias significativamente diferentes pueden generar el mismo conjunto de observaciones (ver [8] y también la Sección 6.3). En lugar de estimar cuál es más probable o mostrar ambas posibilidades, decidimos no proporcionar una trayectoria en absoluto. Es mejor no dar una respuesta que no sea una alarma de disparo que confundir al soldado. La precisión de la localización se desglosa en la precisión de la trayectoria y la precisión de la estimación de rango. El ángulo de la trayectoria estimada fue mejor que 1 grado, excepto para el rango de 300 m. Dado que el alcance no debería afectar la estimación de la trayectoria siempre y cuando el proyectil pase sobre la red, sospechamos que la ligera disminución en la precisión del ángulo para 300 m se debe a los disparos apresurados que presenciamos que los soldados realizaron cerca del final del día. Esto también se indica por otro dato: la distancia estimada de trayectoria desde los objetivos reales tiene un error promedio de 1.3 m para disparos de 300 m, 0.75 m para disparos de 200 m y 0.6 m para todos menos los disparos de 300 m. Dado que la distancia entre los objetivos y la red de sensores estaba fija, este número no debería mostrar una mejora de 2× solo porque el tirador está más cerca. Dado que el ángulo de la trayectoria en sí no caracteriza el error general, también puede haber una traducción. La Tabla 1 también proporciona la distancia del tirador desde la trayectoria estimada. Estos indican un error que es aproximadamente del 1-2% del rango. Para poner esto en perspectiva, es muy probable que una estimación de trayectoria para un disparo de 100 m pase por o muy cerca de la ventana en la que se encuentra el tirador. Una vez más, creemos que los errores desproporcionadamente mayores a 300 m se deben a errores humanos en la puntería. Dado que la verdad de referencia se obtuvo al conocer la ubicación precisa del tirador y del objetivo, cualquier inexactitud en la trayectoria real se suma directamente al error percibido del sistema. Llamamos estimación de la posición del tirador en la estimación del alcance de la trayectoria calculada debido a la falta de un término mejor. Las estimaciones de alcance son más precisas que el 5% a 50 m y el 10% a 100 m. Sin embargo, esto empeora a un 20% o más para distancias más largas. No teníamos una instalación para probar el sistema antes de la evaluación para rangos superiores a 100 m. Durante la evaluación, nos encontramos con el problema de confundir los ecos de ondas de choque con los disparos de la boca del cañón. Estos ecos llegaron a los sensores antes de la verdadera explosión del cañón solo para disparos a larga distancia, ya que el proyectil viaja 2-3 veces más rápido que la velocidad del sonido, por lo que el tiempo entre la onda de choque (y su posible eco de objetos cercanos) y la explosión del cañón aumenta con el aumento de las distancias. Esto resultó en subestimar el alcance, ya que el sistema medía tiempos más cortos que los reales. Desde la evaluación, ajustamos el algoritmo de detección de explosiones de boca para evitar este problema. Distancia M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% Todos 96% 100% 97% 100% 23% 23% 93% Tabla 2: Resultados de clasificación de armas. Los porcentajes son relativos al número de disparos localizados y no a todos los disparos, ya que el algoritmo de clasificación necesita conocer la trayectoria y el alcance. Ten en cuenta que la diferencia es pequeña; se localizaron 189 disparos de un total de 196. Las tasas de precisión de estimación del calibre y del arma se basan en los 189 disparos que fueron localizados con éxito. Se debe tener en cuenta que hubo un único disparo que fue clasificado erróneamente por el estimador de calibre. La precisión general de clasificación de armas del 73% no parece impresionante. Pero si lo desglosamos en las seis armas diferentes probadas, la imagen cambia drásticamente como se muestra en la Tabla 2. Para cuatro de las armas (AK14, M16, M240 y M107), la tasa de clasificación es casi del 100%. Solo hubo dos tiros de aproximadamente 140 que fallaron. El M4 y el M249 resultaron ser demasiado similares y la mayoría de las veces se confundían entre sí. Una posible explicación es que solo tuvimos un número limitado de disparos de prueba tomados con estas armas justo antes de la evaluación y utilizamos la función de aproximación de desaceleración incorrecta. Cualquier error similar a este fue cometido 122 veces, ya que si simplemente usáramos lo opuesto a la respuesta del sistema donde se indicaba que una de estas armas estaba presente, la precisión habría mejorado 3 veces. Si consideramos estas dos armas como una sola clase de arma, entonces la precisión de clasificación para ella es del 93%. Ten en cuenta que el AK47 y el M240 tienen el mismo calibre (7.62 mm), al igual que el M16, M4 y M249 (5.56 mm). Es decir, el sistema es capaz de diferenciar entre armas del mismo calibre. No tenemos conocimiento de ningún sistema que clasifique armas con tanta precisión. 7.1 Rendimiento de un solo sensor Como se mostró anteriormente, un solo sensor por sí solo es capaz de localizar al tirador si puede determinar tanto la explosión del cañón como el ángulo de llegada de la onda de choque, es decir, necesita medir el tiempo de llegada de ambos en al menos tres canales acústicos. Si bien la detección de ondas de choque es independiente del alcance, a menos que el proyectil se vuelva subsónico, la probabilidad de detectar la explosión del cañón más allá de 150 metros no es suficiente para obtener de manera consistente al menos tres por nodo sensor para la estimación del ángulo de llegada. Por lo tanto, solo evaluamos el rendimiento del sensor único para las 104 tomas que se tomaron desde 50 y 100 m. Tenga en cuenta que utilizamos los mismos datos de prueba que en la sección anterior, pero evaluamos individualmente para cada sensor. La Tabla 3 resume los resultados desglosados por los diez sensores utilizados. Dado que esto ya no es un sistema distribuido, los resultados se dan en relación a la posición del sensor dado, es decir, se proporciona una estimación de rumbo y alcance. Ten en cuenta que muchas de las fuentes comunes de error del sistema en red no tienen relevancia aquí. La sincronización de tiempo no es aplicable. La ubicación absoluta de los sensores es irrelevante (al igual que la ubicación relativa de varios sensores). La orientación de los sensores sigue siendo importante. Existen varias desventajas del caso del sensor único en comparación con el sistema en red: no hay redundancia para compensar otros errores y realizar el rechazo de valores atípicos, la tasa de localización es notablemente más baja, y un solo sensor por sí solo no es capaz de estimar el calibre o clasificar el arma. Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Tabla 3: Precisión de un solo sensor para 108 disparos realizados desde 50 y 100 metros. La tasa de localización se refiere al porcentaje de disparos que el sensor dado pudo localizar por sí solo. Los valores de rumbo y alcance son errores promedio. Caracterizan la precisión de la localización desde la perspectiva de los sensores dados. Los datos indican que el rendimiento de los sensores varió significativamente, especialmente considerando la tasa de localización. Un factor a considerar es la ubicación del sensor dado, incluyendo qué tan lejos estaba de las líneas de disparo y qué tan obstruida estaba su vista. Además, los sensores eran prototipos construidos a mano que no utilizaban ni de cerca empaques/montajes de calidad de producción. A la luz de estos factores, el error promedio general de orientación de 0.9 grados y el error de alcance de 5 m con un espaciado de micrófono de menos de 10 cm son excelentes. Creemos que la fabricación profesional y mejores micrófonos podrían lograr fácilmente un mejor rendimiento que el mejor sensor en nuestro experimento (>60% de tasa de localización y un error de rango de 3 m). Curiosamente, el mayor error en el rango fue de enormes 90 m, claramente debido a alguna detección errónea, sin embargo, el mayor error en la dirección fue de menos de 12 grados, lo cual sigue siendo una buena indicación para el soldado de hacia dónde mirar. La tasa de localización general de todos los sensores individuales fue del 42%, mientras que para disparos de 50 m solamente, esto aumentó al 61%. Se debe tener en cuenta que el campo de tiro fue preparado para simular en cierta medida un área urbana: había algunas estructuras de madera de uno y dos pisos construidas tanto dentro como alrededor del área de despliegue de sensores y las líneas de tiro. Por lo tanto, no todos los sensores tenían línea de visión a todas las posiciones de disparo. Estimamos que en promedio el 10% de los sensores tenían la vista obstruida hacia el tirador. Por lo tanto, podemos afirmar que un sensor dado tenía aproximadamente un 50% de probabilidad de localizar un disparo dentro de 130 m. (Dado que el área de despliegue del sensor era de 30 m de profundidad, los disparos de 100 m corresponden a distancias reales entre 100 y 130 m). Nuevamente, enfatizamos que la localización requiere al menos tres detecciones de explosión de boca de fuego y tres de onda de choque de un posible total de cuatro para cada sensor. La tasa de detección para sensores individuales, correspondiente a al menos una detección de onda de choque por sensor, fue prácticamente del 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 número de sensores porcentaje de disparos Figura 13: Histograma que muestra qué fracción de los 104 disparos tomados desde 50 y 100 metros fueron localizados por al menos cuántos sensores individuales solamente. El 13% de los disparos no fueron detectados por ningún sensor, es decir, ninguno de ellos tuvo detecciones tanto de la explosión del cañón como de la onda de choque. Cabe destacar que casi todos estos disparos fueron localizados con precisión por el sistema en red, es decir, la fusión de sensores utilizando todas las observaciones disponibles en la red de sensores. Sería engañoso interpretar estos resultados como si el sistema estuviera perdiendo la mitad de los disparos. Dado que los soldados nunca trabajan solos y el nodo sensor es relativamente económico para equipar a cada soldado con uno, también necesitamos analizar las tasas de detección globales para cada disparo. La Figura 13 muestra el histograma del porcentaje de disparos vs. el número de sensores individuales que lo localizaron. El 13% de los disparos no fueron localizados por ningún sensor por sí solo, pero el 87% fue localizado por al menos un sensor de diez. 7.2 Fuentes de error En esta sección, analizamos las fuentes de error más significativas que afectan el rendimiento del sistema de localización de tiradores en red y clasificación de armas. Para correlacionar las observaciones distribuidas de los eventos acústicos, los nodos necesitan tener una referencia común de tiempo y espacio. Por lo tanto, los errores en la sincronización del tiempo, la localización de nodos y la orientación de nodos degradan la precisión general del sistema. Nuestro enfoque de sincronización del tiempo produce errores significativamente inferiores a 100 microsegundos. Dado que el sonido viaja aproximadamente 3 cm en ese tiempo, los errores de sincronización temporal tienen un efecto insignificante en el sistema. Por otro lado, la ubicación y orientación del nodo pueden tener un efecto directo en el rendimiento general del sistema. Observa que para analizar esto, no tenemos que recurrir a la simulación, en su lugar podemos utilizar los datos reales de prueba recopilados en Aberdeen. Pero en lugar de utilizar las ubicaciones reales de los sensores conocidas con gran precisión y las orientaciones de los nodos medidas y calibradas casi perfectamente, podemos agregar términos de error a ellas y ejecutar la fusión de sensores. Esto replica exactamente cómo el sistema habría funcionado durante la prueba utilizando las ubicaciones y orientaciones imprecisamente conocidas. Otro aspecto del rendimiento del sistema que se puede evaluar de esta manera es el efecto del número de sensores disponibles. En lugar de utilizar los diez sensores en la fusión de datos, podemos elegir cualquier subconjunto de los nodos para ver cómo disminuye la precisión a medida que reducimos el número de nodos. El siguiente experimento fue llevado a cabo. El número de sensores varió de 2 a 10 en incrementos de 2. Cada ejecución seleccionó los sensores al azar utilizando una distribución uniforme. En cada ejecución, cada nodo fue movido aleatoriamente a una nueva ubicación dentro de un círculo alrededor de su posición real, con un radio determinado por una distribución gaussiana de media cero. Finalmente, las orientaciones de los nodos fueron perturbadas utilizando una distribución gaussiana con media cero. Cada combinación de parámetros se generó 100 veces y se utilizó para los 196 disparos. Los resultados se resumen en la Figura 14. Hay un gráfico de barras en 3D para cada uno de los conjuntos de experimentos con el número fijo de sensores dado. El eje x muestra el error de ubicación del nodo, es decir, la desviación estándar de la distribución gaussiana correspondiente que varió entre 0 y 6 metros. El eje y muestra la desviación estándar del error de orientación del nodo que varió entre 0 y 6 grados. El eje z es el error de azimut de la trayectoria resultante. Se observó que los ángulos de elevación presentaron errores algo mayores que los de azimut. Dado que todos los sensores estaban aproximadamente en un plano horizontal y solo unas pocas posiciones de tirador estaban fuera del mismo plano y solo por unos 2 m, la prueba no fue suficiente para evaluar este aspecto del sistema. Se pueden hacer muchas observaciones interesantes al analizar estos gráficos. Los errores de ubicación del nodo en este rango tienen un efecto pequeño en la precisión. Los errores de orientación de los nodos, por otro lado, degradan notablemente el rendimiento. Aún así, los errores más grandes en este experimento de 3.5 grados para 6 sensores y 5 grados para 2 sensores siguen siendo muy buenos. Ten en cuenta que a medida que aumentan los errores de ubicación y orientación y disminuye el número de sensores, la métrica de rendimiento más afectada de manera significativa es la tasa de localización. Consulta la Tabla 4 para un resumen. La localización exitosa disminuye de casi el 100% a un 50% cuando pasamos de 10 sensores a 2, incluso sin errores adicionales. Esto es causado principalmente por la geometría: para una localización exitosa, la bala necesita pasar sobre la red de sensores, es decir, al menos un sensor debe estar en el lado de la trayectoria distinto al resto de los nodos. (Esta es una simplificación con fines ilustrativos). Si todos los sensores y la trayectoria no son coplanares, la localización puede ser exitosa incluso si el proyectil pasa por un lado de la red. Ver la Sección 6.3. A medida que disminuyeron los números de sensores en el experimento al seleccionar aleatoriamente un subconjunto, la probabilidad de que las trayectorias cumplieran con esta regla disminuyó. Esto también significa que incluso si hay 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 2 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 4 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 6 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 8 sensores Figura 14: El efecto de los errores de localización y orientación del nodo en la precisión del azimut con 2, 4, 6 y 8 nodos. Ten en cuenta que el gráfico para 10 nodos es casi idéntico al caso de 8 nodos, por lo tanto, se omite. Si hay demasiados sensores (es decir, soldados), pero todos están uno al lado del otro, la tasa de localización se verá afectada. Sin embargo, cuando la fusión de sensores proporciona un resultado, sigue siendo preciso incluso con pocos sensores disponibles y errores individuales relativamente grandes. Unas pocas observaciones consistentes llevan a una buena precisión, ya que las inconsistentes son descartadas por el algoritmo. Esto también se ve respaldado por la observación de que, para los casos con un mayor número de sensores (8 o 10), la tasa de localización apenas se ve afectada incluso por errores grandes. Errores/Sensores 2 4 6 8 10 0 m, 0 grados 54% 87% 94% 95% 96% 2 m, 2 grados 53% 80% 91% 96% 96% 6 m, 0 grados 43% 79% 88% 94% 94% 0 m, 6 grados 44% 78% 90% 93% 94% 6 m, 6 grados 41% 73% 85% 89% 92% Tabla 4: Tasa de localización en función del número de sensores utilizados, los errores de ubicación y orientación del nodo sensor. Una de las observaciones más significativas en la Figura 14 y la Tabla 4 es que apenas hay diferencia en los datos para 6, 8 y 10 sensores. Esto significa que hay poco beneficio en agregar más nodos más allá de 6 sensores en cuanto a la precisión se refiere. La velocidad del sonido depende de la temperatura ambiente. El prototipo actual considera constante lo que normalmente se establece antes de una prueba. Sería sencillo emplear un sensor de temperatura para actualizar periódicamente el valor de la velocidad del sonido durante la operación. Tenga en cuenta también que el viento puede afectar negativamente la precisión del sistema. La fusión de sensores, sin embargo, podría incorporar la velocidad del viento en sus cálculos. Sería más complicado que la compensación de temperatura, pero se podría hacer. Otros problemas prácticos también deben ser considerados antes de implementar en el mundo real. Los silenciadores reducen la energía de la explosión en la boca del cañón y, por lo tanto, el alcance efectivo en el que el sistema puede detectarla. Sin embargo, los silenciadores no afectan la onda de choque y el sistema seguiría detectando con precisión la trayectoria y el calibre. El alcance y el tipo de arma no se pudieron estimar sin detectar la explosión en la boca del cañón. Las armas subsónicas no producen una onda de choque. Sin embargo, esto no es de gran importancia, ya que tienen un alcance más corto, menor precisión y mucha menos letalidad. Por lo tanto, su uso no es generalizado y representan menos peligro en cualquier caso. Otro problema es el tipo de munición utilizada. Los ejércitos irregulares pueden usar balas de calidad inferior, incluso fabricadas a mano. Esto afecta la velocidad inicial del proyectil del arma. Para que la clasificación de armas funcione con precisión, el sistema debería ser calibrado con la munición típica utilizada por el adversario dado. TRABAJO RELACIONADO La detección y reconocimiento acústico ha sido objeto de investigación desde principios de los años cincuenta. La zona tiene una estrecha relevancia con el tema de la mecánica del flujo supersónico [20]. Fansler analizó las complejas ondas de presión de campo cercano que ocurren dentro de un pie de la explosión del cañón. El trabajo de Fansler proporciona una buena idea de la onda de presión ideal del estallido del cañón sin contaminación de ecos o efectos de propagación [4]. Los experimentos con distancias mayores desde la boca del cañón fueron realizados por Stoughton [18]. Las mediciones de las ondas de choque balísticas utilizando transductores de presión calibrados en ubicaciones conocidas, velocidades de bala medidas y distancias de error de 355 metros para proyectiles de 5.56 mm y 7.62 mm fueron realizadas. Los resultados indican que la interacción con el suelo se convierte en un problema para distancias de error de 30 metros o más grandes. Otra área de investigación es el procesamiento de señales de la acústica de disparos. El enfoque se centra en la detección robusta y estimación de la longitud de ondas de choque acústicas de pequeño calibre y explosiones de boca de fuego. Posibles técnicas para clasificar señales como ondas de choque o explosiones de boca de fuego incluyen la Transformada de Fourier de tiempo corto (STFT), la distribución de Wigner-Ville pseudo suavizada (SPWVD) y una transformación discreta de wavelet (DWT). Los espectrogramas de tiempo-frecuencia conjunta (JTF) se utilizan para analizar la separación típica de los transitorios de la onda de choque y la explosión del cañón tanto en tiempo como en frecuencia. Mays concluye que la DWT es el mejor método para clasificar señales como ondas de choque o explosiones de boca de fuego porque funciona bien y es menos costoso de calcular que el SPWVD [10]. Los bordes de la onda de choque suelen estar bien definidos y la longitud de la onda de choque está directamente relacionada con las características de la bala. Un artículo de Sadler [14] compara dos métodos de detección de bordes de onda de choque: un detector simple basado en gradientes y un detector de ondaleta de múltiples escalas. También demuestra cómo la longitud de la onda de choque, determinada por los detectores de borde, puede ser utilizada junto con las ecuaciones de Whitham [20] para estimar el calibre de un proyectil. Ten en cuenta que el rendimiento computacional disponible en los nodos sensores, el ancho de banda inalámbrico limitado y los requisitos en tiempo real hacen que estos enfoques sean inviables en nuestra plataforma. Un tema relacionado es la investigación y desarrollo de sistemas experimentales y prototipos de localización de disparos. Los investigadores de BBN han desarrollado el sistema Bullet Ears [3], el cual tiene la capacidad de ser instalado en una posición fija o usado por soldados. El sistema fijo tiene matrices de micrófonos con forma de tetraedro con un espaciado de 1.5 metros. El sistema en general consiste en dos o tres de estos conjuntos espaciados de 20 a 100 metros entre sí. El sistema usado por los soldados cuenta con 12 micrófonos, así como una antena GPS y sensores de orientación montados en un casco. Hay una conexión de RF de baja velocidad desde el casco hasta el cuerpo de procesamiento. Se ha realizado una prueba extensa para medir el rendimiento de ambos tipos de sistemas. El rendimiento de los sistemas fijos fue una orden de magnitud mejor en los cálculos de ángulo, mientras que su rendimiento en alcance fue igualado. La precisión del ángulo del sistema fijo era predominantemente inferior a un grado, mientras que era de alrededor de cinco grados para el montado en el casco. La precisión del rango fue de alrededor del 5 por ciento para ambos sistemas. El problema con este y otros sistemas centralizados similares es la necesidad de que uno o un puñado de matrices de micrófonos estén a la vista del tirador. Una solución basada en redes de sensores tiene la ventaja de un amplio alcance de detección para una mejor cobertura, compensación de efectos de múltiples trayectorias y resolución de múltiples disparos simultáneos [8]. Esto es especialmente importante para operar en áreas urbanas con reverberación acústica. Ten en cuenta que el sistema actual montado en vehículos de BBN llamado BOOMERANG, una versión modificada de Bullet Ears, se utiliza actualmente en Iraq [1]. La empresa ShotSpotter se especializa en sistemas de aplicación de la ley que informan la ubicación de disparos a la policía en cuestión de segundos. El objetivo del sistema es significativamente diferente al de los sistemas militares. Shotspotter informa una precisión típica de 25 m, lo cual es más que suficiente para que la policía responda a 125. También están fabricando sistemas experimentales portátiles para soldados y montados en UAV para uso militar [16], pero no hay especificaciones ni resultados de evaluación disponibles públicamente. 9. CONCLUSIONES La principal contribución de este trabajo es doble. Primero, el rendimiento del sistema distribuido en red en general es excelente. Lo más destacado es la precisión de la trayectoria de un grado, la tasa de estimación de calibre correcta de más del 90% y la tasa de clasificación de armas cercana al 100% para 4 de las 6 armas probadas. El sistema demostró ser muy robusto al aumentar los errores de ubicación y orientación de los nodos y al disminuir el número de sensores disponibles hasta llegar a solo un par. El factor clave detrás de esto es la capacidad de los algoritmos de fusión de sensores para rechazar mediciones erróneas. También vale la pena mencionar que los resultados presentados aquí corresponden al primer y único test del sistema más allá de los 100 m y con seis armas diferentes. Creemos que con las lecciones aprendidas en la prueba, un experimento de campo consecutivo podría haber mostrado resultados significativamente mejorados, especialmente en la estimación de alcance más allá de los 100 m y la clasificación de armas para las dos armas restantes que se confundieron la mayoría de las veces durante la prueba. Segundo, el rendimiento del sistema cuando se utilizaba en modo independiente, es decir, cuando solo los sensores proporcionaban la localización, también fue muy bueno. Si bien la tasa de localización general del 42% por sensor para disparos de hasta 130 m podría mejorarse, la precisión del rumbo de menos de un grado y el error promedio de rango del 5% son notables utilizando los prototipos hechos a mano de los nodos de bajo costo. Se observó que el 87% de los disparos fueron localizados con éxito por al menos uno de los diez sensores utilizados en modo independiente. Creemos que la tecnología está suficientemente madura como para que una próxima revisión del sistema pueda ser comercial. Sin embargo, todavía sería necesario trabajar en aspectos importantes del sistema. Todavía no hemos abordado el manejo de energía. Un nodo actual funciona con 4 pilas AA durante aproximadamente 12 horas de operación continua. Una versión desplegable del nodo sensor debería estar en modo de reposo durante la operación normal y solo despertarse cuando ocurre un evento interesante. Un circuito de disparo analógico podría resolver este problema, sin embargo, el sistema se perdería el primer disparo. En cambio, los canales acústicos deberían ser muestreados y almacenados en un búfer circular. El resto del tablero podría apagarse. Cuando un disparador despierta la placa, los datos acústicos estarían disponibles de inmediato. Los experimentos con una placa de sensores de generación anterior indicaron que esto podría proporcionar un aumento de 10 veces en la vida útil de la batería. Otros problemas pendientes incluyen el empaquetado resistente a la intemperie y la robustez, así como la integración con la infraestructura militar actual. 10. REFERENCIAS [1] Sitio web de BBN Technologies. http://www.bbn.com. [2] E. Danicki. Localización acústica de francotiradores. Archivos de Acústica, 30(2):233-245, 2005. [3] G. L. Duckworth y col. Sistemas acústicos fijos y portátiles para la detección de francotiradores para las fuerzas del orden. En E. M. Carapezza y D. B. Ley, editores, Proc. SPIE Vol. 3577, p. 210-230, páginas 210-230, enero de 1999. [4] K. Fansler. Descripción de la explosión de la boca de fuego mediante modelos de escala modificados. Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.\n\nImpacto y Vibración, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer y D. Culler. El lenguaje nesC: un enfoque holístico para sistemas embebidos en red. Actas del Diseño e Implementación de Lenguajes de Programación (PLDI), junio de 2003. [6] J. Hill, R. Szewczyk, A. Woo, S. Hollar, D. Culler y K. Pister. Direcciones de arquitectura del sistema para sensores en red. en Proc. de ASPLOS 2000, noviembre de 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti y L. Meertens. Localización independiente de la densidad de nodos. Procesamiento de información en redes de sensores (IPSN 06) SPOTS Track, abril de 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti y G. Simon. Sistema contratirador para la guerra urbana. ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Maróti. Marco de enrutamiento de inundaciones dirigidas para redes de sensores inalámbricos. En Actas de la 5ta Conferencia Internacional de Middleware ACM/IFIP/USENIX, páginas 99-114, Nueva York, NY, EE. UU., 2004. Springer-Verlag New York, Inc. [10] B. Mays. \n\nSpringer-Verlag New York, Inc. [10] B. Mays. Clasificación de la onda de choque y la explosión de la boca del cañón mediante análisis conjunto de tiempo-frecuencia y wavelet. Informe técnico, Laboratorio de Investigación del Ejército, Adelphi MD 20783-1197, septiembre de 2001. [11] Plataformas de hardware de TinyOS. http://tinyos.net/scoop/special/hardware. [12] Módulo de radio Crossbow MICAz (MPR2400). http://www.xbow.com/Products/productsdetails.aspx?sid=101. [13] Recursos para usuarios de PicoBlaze. http://www.xilinx.com/ipcenter/processor_central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham y L. C. Sadler. Detección y estimación óptima basada en wavelets de onda de choque. Revista de la Sociedad Acústica de América, 104:955-963, agosto de 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi y P. Dutta. Sobre la escalabilidad de la sincronización de tiempo integrada en enrutamiento. 3er Taller Europeo sobre Redes de Sensores Inalámbricos (EWSN 2006), febrero de 2006. [16] Sitio web de ShotSpotter. http://www.shotspotter.com/products/military.html. [17] G. Simon, M. Maróti, A. Lédeczi, G. Balogh, B. Kušy, A. Nádas, G. Pap, J. Sallai y K. Frampton. Sistema de contratirador basado en redes de sensores. En SenSys 04: Actas de la 2ª conferencia internacional sobre sistemas de sensores en red integrados, páginas 1-12, Nueva York, NY, EE. UU., 2004. ACM Press. [18] R. Stoughton. \n\nACM Press. [18] R. Stoughton. Mediciones de ondas de choque balísticas de pequeño calibre en el aire. Revista de la Sociedad Acústica de América, 102:781-787, agosto de 1997. [19] B. A. Weiss, C. Schlenoff, M. Shneier y A. Virts. Evaluaciones de tecnología y métricas de rendimiento para sensores llevados por soldados para asistencia. En el taller de Métricas de Rendimiento para Sistemas Inteligentes, agosto de 2006. [20] G. Whitham. Patrón de flujo de un proyectil supersónico. Comunicaciones en matemáticas puras y aplicadas, 5(3):301, 1952. 126 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "caliber estimation accuracy": {
            "translated_key": "precisión de estimación de calibre",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% <br>caliber estimation accuracy</br> for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "The system performance is characterized by 1degree trajectory precision and over 95% <br>caliber estimation accuracy</br> for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested."
            ],
            "translated_annotated_samples": [
                "El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una <br>precisión de estimación de calibre</br> de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una <br>precisión de estimación de calibre</br> de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo. La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él. El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz. El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado. Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros. Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes. Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula. Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth). Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador. El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R. El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa. Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo. Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente. Las rutas de señal se encuentran justo antes del archivo de registros. Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida. Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5. Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí. El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial. El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas. Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM. Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB. La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros. Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea. Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador. La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz). Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo. Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo. Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento. Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación. Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas. Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos. Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc. Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía). De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo. La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores. El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje. Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual. Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local. El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación. Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente. La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6]. Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz. ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares. Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos. Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular. Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios. Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias. Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento. Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos. Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente). Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque. En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples. Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal. Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento. Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote. En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente. Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal. Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs). El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado. La máquina de estados del algoritmo se muestra en la Figura 5(b). Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax). La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada. A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4]. Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a). Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad. La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC). Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC. Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período. Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido. Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente. El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente. El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca). El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b). Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes. Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE. La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6. La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma. El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1. Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2. Calcular estimaciones de rango. Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3. Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4. Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5. Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6. Si el calibre está disponible, calcular el tipo de arma (ver 6.6). Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor. Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s. Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano). Formalicemos primero el problema para 3 micrófonos. Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3. Primero aplicamos un paso de validación de geometría simple. La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición. Si esta condición no se cumple, las detecciones correspondientes son descartadas. Sea v(x, y, z) el vector normal de la dirección de llegada desconocida. También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3. Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c). Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos. Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden). Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos. De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2). Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque. Considera la situación en la Figura 7. Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos. Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible. La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u. La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales. Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P). Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie. Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2). La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t). P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1. Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón). En este caso: t = uvt1−t2 uv−1. Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango. Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil. En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano. La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala. Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango. Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada. Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2]. El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí. En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular. En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente. En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque. Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico. Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque). Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral. Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria. Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque. Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno. Esto nos da como máximo N(N−1) 2 trayectorias. Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria). Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio. El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos. El conjunto central se puede encontrar en tiempo O(N2). Las trayectorias en el conjunto central se promedian para obtener la trayectoria final. Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección. Significa que todos los sensores están en el mismo lado de la trayectoria. En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido. Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque. Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria. Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles). Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor. Para un ejemplo, consulte la Figura 8. Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque. Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador. Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos. Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8]. La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales. Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja. La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas. La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada. El retroceso es posible para evitar quedarse atascado en un máximo local. Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea. Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida. A continuación, describamos detalladamente cómo se calcula la función de consistencia. Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular. Primero consideramos solo la información de ToA. Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA. Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B. Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo. El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B. Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8]. Aquí extendemos el enfoque de la siguiente manera. Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales. Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B. Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B. En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores. El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 Estimación de calibre Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20]. Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error. Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos. Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores). Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque. Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos. Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes. Los datos experimentales se muestran en la Figura 9. La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4). Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas. Este método tiene menos del 1% de error en la estimación del calibre cuando se dispone de una estimación precisa de la trayectoria. En otras palabras, la estimación del calibre solo funciona si se realizan suficientes detecciones de ondas de choque por el sistema para calcular una trayectoria. 120 6.6 Estimación de armas Analizamos todas las características de la señal medida para encontrar información específica de la arma. Lamentablemente, concluimos que la firma observada de la explosión del cañón no es lo suficientemente característica del arma para fines de clasificación. Las reflexiones de la explosión de alta energía del freno de boca tienen un impacto mucho mayor en la forma de la señal de la explosión del freno de boca que el arma en sí misma. Disparar la misma arma desde diferentes lugares causó diferencias más grandes en la señal registrada que disparar diferentes armas desde el mismo lugar. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 rango (m) velocidad (m/s) AK-47 M240 Figura 10: Mediciones de desaceleración de balas de AK47 y M240. Ambas armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 rango (m) velocidad (m/s) M16 M249 M4 Figura 11: Mediciones de desaceleración de balas M16, M249 y M4. Todas las armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el tipo de arma. Esto se debe a que, para un tipo de arma y par de municiones dados, la velocidad inicial es casi constante. En las Figuras 10 y 11 podemos ver la relación entre el alcance y la velocidad de bala medida para diferentes calibres y armas. En el rango de velocidad supersónica, la desaceleración de la bala se puede aproximar con una función lineal. En el caso del calibre 7.62 mm, las dos armas probadas (AK47, M240) pueden ser claramente diferenciadas (Figura 10). Desafortunadamente, esto no es necesariamente cierto para el calibre 5.56 mm. El M16 con su mayor velocidad de boca aún puede ser bien clasificado, pero las armas M4 y M249 parecen prácticamente indistinguibles (Figura 11). Sin embargo, esto puede deberse en parte al número limitado de disparos de práctica que pudimos realizar antes de que comenzaran las pruebas reales. Más datos de entrenamiento pueden revelar una mejor separación entre las dos armas, ya que sus velocidades de boca publicadas difieren ligeramente. El sistema lleva a cabo la clasificación de armas de la siguiente manera. Una vez que se conoce la trayectoria, la velocidad se puede calcular para cada sensor basándose en la geometría de la onda de choque. Para evaluar un disparo, elegimos el tipo de arma cuya función de desaceleración resulta en el menor error cuadrático medio de los pares estimados de rango-velocidad para la clase de calibre estimada. 7. RESULTADOS Una evaluación independiente del sistema fue realizada por un equipo de NIST en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen en abril de 2006 [19]. El experimento se llevó a cabo en un campo de tiro con edificios y paredes de madera simulados para soportar posiciones elevadas de tiradores y generar efectos de trayectorias múltiples. La Figura 12 muestra la interfaz de usuario con una fotografía aérea del sitio. Se desplegaron 10 nodos sensores en puntos relevados en un área de aproximadamente 30×30 m. Había cinco objetivos fijos detrás de la red de sensores. Varias posiciones de disparo se ubicaron en cada una de las líneas de tiro a 50, 100, 200 y 300 metros. Estas posiciones eran conocidas por los evaluadores, pero no por los operadores del sistema. Se utilizaron seis armas diferentes: AK47 y M240 disparando proyectiles de 7.62 mm, M16, M4 y M249 con munición de 5.56 mm y el M107 de calibre .50. Ten en cuenta que los sensores permanecieron estáticos durante la prueba. La razón principal de esto es que a nadie se le permite estar en la zona de tiro durante las pruebas con fuego real. Utilizar algún tipo de plataforma de control remoto habría sido demasiado complicado dada la limitada disponibilidad de tiempo para la prueba. Por lo tanto, el experimento no probó el aspecto de movilidad del sistema. Durante la prueba de un día, se realizaron 196 disparos. Los resultados se resumen en la Tabla 1. El sistema detectó todos los disparos exitosamente. Dado que una onda de choque balística es un fenómeno acústico único, hace que la detección sea muy robusta. No hubo falsos positivos para las ondas de choque, pero hubo un puñado de detecciones falsas de explosiones de boca de fuego debido a pruebas paralelas de artillería en un campo cercano. Tirador Local- Calibre Trayectoria Trayectoria Distancia No. Tabla 1: Resumen de resultados fusionando todas las observaciones de sensores disponibles. Todas las tomas fueron detectadas con éxito, por lo que la tasa de detección se omite. La tasa de localización significa el porcentaje de disparos cuya trayectoria el sensor de fusión pudo estimar. La tasa de precisión del calibre es relativa a los disparos localizados y no a todos los disparos, ya que la estimación del calibre requiere la trayectoria. El error de trayectoria se descompone en azimut en grados y la distancia real del tirador a la trayectoria. El error de distancia muestra la distancia entre la posición real del tirador y la posición estimada del tirador. Por lo tanto, incluye el error causado tanto por la trayectoria como por la estimación del alcance. Ten en cuenta que las medidas tradicionales de rumbo y alcance no son adecuadas para un sistema distribuido como el nuestro debido a la falta de un único punto de referencia. Figura 12: La interfaz de usuario del sistema mostrando la configuración experimental. Los 10 nodos sensores están etiquetados por su ID y marcados con círculos oscuros. Los objetivos son cuadrados negros marcados como T-1 a T-5. Las flechas largas y blancas señalan la posición del tirador estimada por cada sensor. Donde faltaba, el sensor correspondiente no tuvo suficientes detecciones para medir el AoA de la explosión del cañón, la onda de choque o ambas. La línea negra gruesa y el círculo grande indican la trayectoria estimada y la posición del tirador según lo estimado al fusionar todas las detecciones disponibles de la red. Este disparo desde la línea de los 100 metros en el blanco T-3 fue localizado casi perfectamente por la red de sensores. El calibre y el arma también fueron identificados correctamente. 6 de cada 10 nodos pudieron estimar la ubicación por sí solos. Su precisión de orientación está dentro de un grado, mientras que el alcance tiene un margen de error de menos del 10% en el peor de los casos. La tasa de localización caracteriza la capacidad del sistema para estimar con éxito la trayectoria de los disparos. Dado que la estimación del calibre y la clasificación de armas dependen de la trayectoria, los disparos no localizados tampoco son clasificados. Hubo 7 disparos de 196 que no fueron localizados. La razón de los tiros fallados es el problema de ambigüedad de trayectoria que ocurre cuando el proyectil pasa por un lado de todos los sensores. En este caso, dos trayectorias significativamente diferentes pueden generar el mismo conjunto de observaciones (ver [8] y también la Sección 6.3). En lugar de estimar cuál es más probable o mostrar ambas posibilidades, decidimos no proporcionar una trayectoria en absoluto. Es mejor no dar una respuesta que no sea una alarma de disparo que confundir al soldado. La precisión de la localización se desglosa en la precisión de la trayectoria y la precisión de la estimación de rango. El ángulo de la trayectoria estimada fue mejor que 1 grado, excepto para el rango de 300 m. Dado que el alcance no debería afectar la estimación de la trayectoria siempre y cuando el proyectil pase sobre la red, sospechamos que la ligera disminución en la precisión del ángulo para 300 m se debe a los disparos apresurados que presenciamos que los soldados realizaron cerca del final del día. Esto también se indica por otro dato: la distancia estimada de trayectoria desde los objetivos reales tiene un error promedio de 1.3 m para disparos de 300 m, 0.75 m para disparos de 200 m y 0.6 m para todos menos los disparos de 300 m. Dado que la distancia entre los objetivos y la red de sensores estaba fija, este número no debería mostrar una mejora de 2× solo porque el tirador está más cerca. Dado que el ángulo de la trayectoria en sí no caracteriza el error general, también puede haber una traducción. La Tabla 1 también proporciona la distancia del tirador desde la trayectoria estimada. Estos indican un error que es aproximadamente del 1-2% del rango. Para poner esto en perspectiva, es muy probable que una estimación de trayectoria para un disparo de 100 m pase por o muy cerca de la ventana en la que se encuentra el tirador. Una vez más, creemos que los errores desproporcionadamente mayores a 300 m se deben a errores humanos en la puntería. Dado que la verdad de referencia se obtuvo al conocer la ubicación precisa del tirador y del objetivo, cualquier inexactitud en la trayectoria real se suma directamente al error percibido del sistema. Llamamos estimación de la posición del tirador en la estimación del alcance de la trayectoria calculada debido a la falta de un término mejor. Las estimaciones de alcance son más precisas que el 5% a 50 m y el 10% a 100 m. Sin embargo, esto empeora a un 20% o más para distancias más largas. No teníamos una instalación para probar el sistema antes de la evaluación para rangos superiores a 100 m. Durante la evaluación, nos encontramos con el problema de confundir los ecos de ondas de choque con los disparos de la boca del cañón. Estos ecos llegaron a los sensores antes de la verdadera explosión del cañón solo para disparos a larga distancia, ya que el proyectil viaja 2-3 veces más rápido que la velocidad del sonido, por lo que el tiempo entre la onda de choque (y su posible eco de objetos cercanos) y la explosión del cañón aumenta con el aumento de las distancias. Esto resultó en subestimar el alcance, ya que el sistema medía tiempos más cortos que los reales. Desde la evaluación, ajustamos el algoritmo de detección de explosiones de boca para evitar este problema. Distancia M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% Todos 96% 100% 97% 100% 23% 23% 93% Tabla 2: Resultados de clasificación de armas. Los porcentajes son relativos al número de disparos localizados y no a todos los disparos, ya que el algoritmo de clasificación necesita conocer la trayectoria y el alcance. Ten en cuenta que la diferencia es pequeña; se localizaron 189 disparos de un total de 196. Las tasas de precisión de estimación del calibre y del arma se basan en los 189 disparos que fueron localizados con éxito. Se debe tener en cuenta que hubo un único disparo que fue clasificado erróneamente por el estimador de calibre. La precisión general de clasificación de armas del 73% no parece impresionante. Pero si lo desglosamos en las seis armas diferentes probadas, la imagen cambia drásticamente como se muestra en la Tabla 2. Para cuatro de las armas (AK14, M16, M240 y M107), la tasa de clasificación es casi del 100%. Solo hubo dos tiros de aproximadamente 140 que fallaron. El M4 y el M249 resultaron ser demasiado similares y la mayoría de las veces se confundían entre sí. Una posible explicación es que solo tuvimos un número limitado de disparos de prueba tomados con estas armas justo antes de la evaluación y utilizamos la función de aproximación de desaceleración incorrecta. Cualquier error similar a este fue cometido 122 veces, ya que si simplemente usáramos lo opuesto a la respuesta del sistema donde se indicaba que una de estas armas estaba presente, la precisión habría mejorado 3 veces. Si consideramos estas dos armas como una sola clase de arma, entonces la precisión de clasificación para ella es del 93%. Ten en cuenta que el AK47 y el M240 tienen el mismo calibre (7.62 mm), al igual que el M16, M4 y M249 (5.56 mm). Es decir, el sistema es capaz de diferenciar entre armas del mismo calibre. No tenemos conocimiento de ningún sistema que clasifique armas con tanta precisión. 7.1 Rendimiento de un solo sensor Como se mostró anteriormente, un solo sensor por sí solo es capaz de localizar al tirador si puede determinar tanto la explosión del cañón como el ángulo de llegada de la onda de choque, es decir, necesita medir el tiempo de llegada de ambos en al menos tres canales acústicos. Si bien la detección de ondas de choque es independiente del alcance, a menos que el proyectil se vuelva subsónico, la probabilidad de detectar la explosión del cañón más allá de 150 metros no es suficiente para obtener de manera consistente al menos tres por nodo sensor para la estimación del ángulo de llegada. Por lo tanto, solo evaluamos el rendimiento del sensor único para las 104 tomas que se tomaron desde 50 y 100 m. Tenga en cuenta que utilizamos los mismos datos de prueba que en la sección anterior, pero evaluamos individualmente para cada sensor. La Tabla 3 resume los resultados desglosados por los diez sensores utilizados. Dado que esto ya no es un sistema distribuido, los resultados se dan en relación a la posición del sensor dado, es decir, se proporciona una estimación de rumbo y alcance. Ten en cuenta que muchas de las fuentes comunes de error del sistema en red no tienen relevancia aquí. La sincronización de tiempo no es aplicable. La ubicación absoluta de los sensores es irrelevante (al igual que la ubicación relativa de varios sensores). La orientación de los sensores sigue siendo importante. Existen varias desventajas del caso del sensor único en comparación con el sistema en red: no hay redundancia para compensar otros errores y realizar el rechazo de valores atípicos, la tasa de localización es notablemente más baja, y un solo sensor por sí solo no es capaz de estimar el calibre o clasificar el arma. Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Tabla 3: Precisión de un solo sensor para 108 disparos realizados desde 50 y 100 metros. La tasa de localización se refiere al porcentaje de disparos que el sensor dado pudo localizar por sí solo. Los valores de rumbo y alcance son errores promedio. Caracterizan la precisión de la localización desde la perspectiva de los sensores dados. Los datos indican que el rendimiento de los sensores varió significativamente, especialmente considerando la tasa de localización. Un factor a considerar es la ubicación del sensor dado, incluyendo qué tan lejos estaba de las líneas de disparo y qué tan obstruida estaba su vista. Además, los sensores eran prototipos construidos a mano que no utilizaban ni de cerca empaques/montajes de calidad de producción. A la luz de estos factores, el error promedio general de orientación de 0.9 grados y el error de alcance de 5 m con un espaciado de micrófono de menos de 10 cm son excelentes. Creemos que la fabricación profesional y mejores micrófonos podrían lograr fácilmente un mejor rendimiento que el mejor sensor en nuestro experimento (>60% de tasa de localización y un error de rango de 3 m). Curiosamente, el mayor error en el rango fue de enormes 90 m, claramente debido a alguna detección errónea, sin embargo, el mayor error en la dirección fue de menos de 12 grados, lo cual sigue siendo una buena indicación para el soldado de hacia dónde mirar. La tasa de localización general de todos los sensores individuales fue del 42%, mientras que para disparos de 50 m solamente, esto aumentó al 61%. Se debe tener en cuenta que el campo de tiro fue preparado para simular en cierta medida un área urbana: había algunas estructuras de madera de uno y dos pisos construidas tanto dentro como alrededor del área de despliegue de sensores y las líneas de tiro. Por lo tanto, no todos los sensores tenían línea de visión a todas las posiciones de disparo. Estimamos que en promedio el 10% de los sensores tenían la vista obstruida hacia el tirador. Por lo tanto, podemos afirmar que un sensor dado tenía aproximadamente un 50% de probabilidad de localizar un disparo dentro de 130 m. (Dado que el área de despliegue del sensor era de 30 m de profundidad, los disparos de 100 m corresponden a distancias reales entre 100 y 130 m). Nuevamente, enfatizamos que la localización requiere al menos tres detecciones de explosión de boca de fuego y tres de onda de choque de un posible total de cuatro para cada sensor. La tasa de detección para sensores individuales, correspondiente a al menos una detección de onda de choque por sensor, fue prácticamente del 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 número de sensores porcentaje de disparos Figura 13: Histograma que muestra qué fracción de los 104 disparos tomados desde 50 y 100 metros fueron localizados por al menos cuántos sensores individuales solamente. El 13% de los disparos no fueron detectados por ningún sensor, es decir, ninguno de ellos tuvo detecciones tanto de la explosión del cañón como de la onda de choque. Cabe destacar que casi todos estos disparos fueron localizados con precisión por el sistema en red, es decir, la fusión de sensores utilizando todas las observaciones disponibles en la red de sensores. Sería engañoso interpretar estos resultados como si el sistema estuviera perdiendo la mitad de los disparos. Dado que los soldados nunca trabajan solos y el nodo sensor es relativamente económico para equipar a cada soldado con uno, también necesitamos analizar las tasas de detección globales para cada disparo. La Figura 13 muestra el histograma del porcentaje de disparos vs. el número de sensores individuales que lo localizaron. El 13% de los disparos no fueron localizados por ningún sensor por sí solo, pero el 87% fue localizado por al menos un sensor de diez. 7.2 Fuentes de error En esta sección, analizamos las fuentes de error más significativas que afectan el rendimiento del sistema de localización de tiradores en red y clasificación de armas. Para correlacionar las observaciones distribuidas de los eventos acústicos, los nodos necesitan tener una referencia común de tiempo y espacio. Por lo tanto, los errores en la sincronización del tiempo, la localización de nodos y la orientación de nodos degradan la precisión general del sistema. Nuestro enfoque de sincronización del tiempo produce errores significativamente inferiores a 100 microsegundos. Dado que el sonido viaja aproximadamente 3 cm en ese tiempo, los errores de sincronización temporal tienen un efecto insignificante en el sistema. Por otro lado, la ubicación y orientación del nodo pueden tener un efecto directo en el rendimiento general del sistema. Observa que para analizar esto, no tenemos que recurrir a la simulación, en su lugar podemos utilizar los datos reales de prueba recopilados en Aberdeen. Pero en lugar de utilizar las ubicaciones reales de los sensores conocidas con gran precisión y las orientaciones de los nodos medidas y calibradas casi perfectamente, podemos agregar términos de error a ellas y ejecutar la fusión de sensores. Esto replica exactamente cómo el sistema habría funcionado durante la prueba utilizando las ubicaciones y orientaciones imprecisamente conocidas. Otro aspecto del rendimiento del sistema que se puede evaluar de esta manera es el efecto del número de sensores disponibles. En lugar de utilizar los diez sensores en la fusión de datos, podemos elegir cualquier subconjunto de los nodos para ver cómo disminuye la precisión a medida que reducimos el número de nodos. El siguiente experimento fue llevado a cabo. El número de sensores varió de 2 a 10 en incrementos de 2. Cada ejecución seleccionó los sensores al azar utilizando una distribución uniforme. En cada ejecución, cada nodo fue movido aleatoriamente a una nueva ubicación dentro de un círculo alrededor de su posición real, con un radio determinado por una distribución gaussiana de media cero. Finalmente, las orientaciones de los nodos fueron perturbadas utilizando una distribución gaussiana con media cero. Cada combinación de parámetros se generó 100 veces y se utilizó para los 196 disparos. Los resultados se resumen en la Figura 14. Hay un gráfico de barras en 3D para cada uno de los conjuntos de experimentos con el número fijo de sensores dado. El eje x muestra el error de ubicación del nodo, es decir, la desviación estándar de la distribución gaussiana correspondiente que varió entre 0 y 6 metros. El eje y muestra la desviación estándar del error de orientación del nodo que varió entre 0 y 6 grados. El eje z es el error de azimut de la trayectoria resultante. Se observó que los ángulos de elevación presentaron errores algo mayores que los de azimut. Dado que todos los sensores estaban aproximadamente en un plano horizontal y solo unas pocas posiciones de tirador estaban fuera del mismo plano y solo por unos 2 m, la prueba no fue suficiente para evaluar este aspecto del sistema. Se pueden hacer muchas observaciones interesantes al analizar estos gráficos. Los errores de ubicación del nodo en este rango tienen un efecto pequeño en la precisión. Los errores de orientación de los nodos, por otro lado, degradan notablemente el rendimiento. Aún así, los errores más grandes en este experimento de 3.5 grados para 6 sensores y 5 grados para 2 sensores siguen siendo muy buenos. Ten en cuenta que a medida que aumentan los errores de ubicación y orientación y disminuye el número de sensores, la métrica de rendimiento más afectada de manera significativa es la tasa de localización. Consulta la Tabla 4 para un resumen. La localización exitosa disminuye de casi el 100% a un 50% cuando pasamos de 10 sensores a 2, incluso sin errores adicionales. Esto es causado principalmente por la geometría: para una localización exitosa, la bala necesita pasar sobre la red de sensores, es decir, al menos un sensor debe estar en el lado de la trayectoria distinto al resto de los nodos. (Esta es una simplificación con fines ilustrativos). Si todos los sensores y la trayectoria no son coplanares, la localización puede ser exitosa incluso si el proyectil pasa por un lado de la red. Ver la Sección 6.3. A medida que disminuyeron los números de sensores en el experimento al seleccionar aleatoriamente un subconjunto, la probabilidad de que las trayectorias cumplieran con esta regla disminuyó. Esto también significa que incluso si hay 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 2 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 4 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 6 sensores 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 errores de azimut (grados) error de posición (m) error de orientación (grados) 8 sensores Figura 14: El efecto de los errores de localización y orientación del nodo en la precisión del azimut con 2, 4, 6 y 8 nodos. Ten en cuenta que el gráfico para 10 nodos es casi idéntico al caso de 8 nodos, por lo tanto, se omite. Si hay demasiados sensores (es decir, soldados), pero todos están uno al lado del otro, la tasa de localización se verá afectada. Sin embargo, cuando la fusión de sensores proporciona un resultado, sigue siendo preciso incluso con pocos sensores disponibles y errores individuales relativamente grandes. Unas pocas observaciones consistentes llevan a una buena precisión, ya que las inconsistentes son descartadas por el algoritmo. Esto también se ve respaldado por la observación de que, para los casos con un mayor número de sensores (8 o 10), la tasa de localización apenas se ve afectada incluso por errores grandes. Errores/Sensores 2 4 6 8 10 0 m, 0 grados 54% 87% 94% 95% 96% 2 m, 2 grados 53% 80% 91% 96% 96% 6 m, 0 grados 43% 79% 88% 94% 94% 0 m, 6 grados 44% 78% 90% 93% 94% 6 m, 6 grados 41% 73% 85% 89% 92% Tabla 4: Tasa de localización en función del número de sensores utilizados, los errores de ubicación y orientación del nodo sensor. Una de las observaciones más significativas en la Figura 14 y la Tabla 4 es que apenas hay diferencia en los datos para 6, 8 y 10 sensores. Esto significa que hay poco beneficio en agregar más nodos más allá de 6 sensores en cuanto a la precisión se refiere. La velocidad del sonido depende de la temperatura ambiente. El prototipo actual considera constante lo que normalmente se establece antes de una prueba. Sería sencillo emplear un sensor de temperatura para actualizar periódicamente el valor de la velocidad del sonido durante la operación. Tenga en cuenta también que el viento puede afectar negativamente la precisión del sistema. La fusión de sensores, sin embargo, podría incorporar la velocidad del viento en sus cálculos. Sería más complicado que la compensación de temperatura, pero se podría hacer. Otros problemas prácticos también deben ser considerados antes de implementar en el mundo real. Los silenciadores reducen la energía de la explosión en la boca del cañón y, por lo tanto, el alcance efectivo en el que el sistema puede detectarla. Sin embargo, los silenciadores no afectan la onda de choque y el sistema seguiría detectando con precisión la trayectoria y el calibre. El alcance y el tipo de arma no se pudieron estimar sin detectar la explosión en la boca del cañón. Las armas subsónicas no producen una onda de choque. Sin embargo, esto no es de gran importancia, ya que tienen un alcance más corto, menor precisión y mucha menos letalidad. Por lo tanto, su uso no es generalizado y representan menos peligro en cualquier caso. Otro problema es el tipo de munición utilizada. Los ejércitos irregulares pueden usar balas de calidad inferior, incluso fabricadas a mano. Esto afecta la velocidad inicial del proyectil del arma. Para que la clasificación de armas funcione con precisión, el sistema debería ser calibrado con la munición típica utilizada por el adversario dado. TRABAJO RELACIONADO La detección y reconocimiento acústico ha sido objeto de investigación desde principios de los años cincuenta. La zona tiene una estrecha relevancia con el tema de la mecánica del flujo supersónico [20]. Fansler analizó las complejas ondas de presión de campo cercano que ocurren dentro de un pie de la explosión del cañón. El trabajo de Fansler proporciona una buena idea de la onda de presión ideal del estallido del cañón sin contaminación de ecos o efectos de propagación [4]. Los experimentos con distancias mayores desde la boca del cañón fueron realizados por Stoughton [18]. Las mediciones de las ondas de choque balísticas utilizando transductores de presión calibrados en ubicaciones conocidas, velocidades de bala medidas y distancias de error de 355 metros para proyectiles de 5.56 mm y 7.62 mm fueron realizadas. Los resultados indican que la interacción con el suelo se convierte en un problema para distancias de error de 30 metros o más grandes. Otra área de investigación es el procesamiento de señales de la acústica de disparos. El enfoque se centra en la detección robusta y estimación de la longitud de ondas de choque acústicas de pequeño calibre y explosiones de boca de fuego. Posibles técnicas para clasificar señales como ondas de choque o explosiones de boca de fuego incluyen la Transformada de Fourier de tiempo corto (STFT), la distribución de Wigner-Ville pseudo suavizada (SPWVD) y una transformación discreta de wavelet (DWT). Los espectrogramas de tiempo-frecuencia conjunta (JTF) se utilizan para analizar la separación típica de los transitorios de la onda de choque y la explosión del cañón tanto en tiempo como en frecuencia. Mays concluye que la DWT es el mejor método para clasificar señales como ondas de choque o explosiones de boca de fuego porque funciona bien y es menos costoso de calcular que el SPWVD [10]. Los bordes de la onda de choque suelen estar bien definidos y la longitud de la onda de choque está directamente relacionada con las características de la bala. Un artículo de Sadler [14] compara dos métodos de detección de bordes de onda de choque: un detector simple basado en gradientes y un detector de ondaleta de múltiples escalas. También demuestra cómo la longitud de la onda de choque, determinada por los detectores de borde, puede ser utilizada junto con las ecuaciones de Whitham [20] para estimar el calibre de un proyectil. Ten en cuenta que el rendimiento computacional disponible en los nodos sensores, el ancho de banda inalámbrico limitado y los requisitos en tiempo real hacen que estos enfoques sean inviables en nuestra plataforma. Un tema relacionado es la investigación y desarrollo de sistemas experimentales y prototipos de localización de disparos. Los investigadores de BBN han desarrollado el sistema Bullet Ears [3], el cual tiene la capacidad de ser instalado en una posición fija o usado por soldados. El sistema fijo tiene matrices de micrófonos con forma de tetraedro con un espaciado de 1.5 metros. El sistema en general consiste en dos o tres de estos conjuntos espaciados de 20 a 100 metros entre sí. El sistema usado por los soldados cuenta con 12 micrófonos, así como una antena GPS y sensores de orientación montados en un casco. Hay una conexión de RF de baja velocidad desde el casco hasta el cuerpo de procesamiento. Se ha realizado una prueba extensa para medir el rendimiento de ambos tipos de sistemas. El rendimiento de los sistemas fijos fue una orden de magnitud mejor en los cálculos de ángulo, mientras que su rendimiento en alcance fue igualado. La precisión del ángulo del sistema fijo era predominantemente inferior a un grado, mientras que era de alrededor de cinco grados para el montado en el casco. La precisión del rango fue de alrededor del 5 por ciento para ambos sistemas. El problema con este y otros sistemas centralizados similares es la necesidad de que uno o un puñado de matrices de micrófonos estén a la vista del tirador. Una solución basada en redes de sensores tiene la ventaja de un amplio alcance de detección para una mejor cobertura, compensación de efectos de múltiples trayectorias y resolución de múltiples disparos simultáneos [8]. Esto es especialmente importante para operar en áreas urbanas con reverberación acústica. Ten en cuenta que el sistema actual montado en vehículos de BBN llamado BOOMERANG, una versión modificada de Bullet Ears, se utiliza actualmente en Iraq [1]. La empresa ShotSpotter se especializa en sistemas de aplicación de la ley que informan la ubicación de disparos a la policía en cuestión de segundos. El objetivo del sistema es significativamente diferente al de los sistemas militares. Shotspotter informa una precisión típica de 25 m, lo cual es más que suficiente para que la policía responda a 125. También están fabricando sistemas experimentales portátiles para soldados y montados en UAV para uso militar [16], pero no hay especificaciones ni resultados de evaluación disponibles públicamente. 9. CONCLUSIONES La principal contribución de este trabajo es doble. Primero, el rendimiento del sistema distribuido en red en general es excelente. Lo más destacado es la precisión de la trayectoria de un grado, la tasa de estimación de calibre correcta de más del 90% y la tasa de clasificación de armas cercana al 100% para 4 de las 6 armas probadas. El sistema demostró ser muy robusto al aumentar los errores de ubicación y orientación de los nodos y al disminuir el número de sensores disponibles hasta llegar a solo un par. El factor clave detrás de esto es la capacidad de los algoritmos de fusión de sensores para rechazar mediciones erróneas. También vale la pena mencionar que los resultados presentados aquí corresponden al primer y único test del sistema más allá de los 100 m y con seis armas diferentes. Creemos que con las lecciones aprendidas en la prueba, un experimento de campo consecutivo podría haber mostrado resultados significativamente mejorados, especialmente en la estimación de alcance más allá de los 100 m y la clasificación de armas para las dos armas restantes que se confundieron la mayoría de las veces durante la prueba. Segundo, el rendimiento del sistema cuando se utilizaba en modo independiente, es decir, cuando solo los sensores proporcionaban la localización, también fue muy bueno. Si bien la tasa de localización general del 42% por sensor para disparos de hasta 130 m podría mejorarse, la precisión del rumbo de menos de un grado y el error promedio de rango del 5% son notables utilizando los prototipos hechos a mano de los nodos de bajo costo. Se observó que el 87% de los disparos fueron localizados con éxito por al menos uno de los diez sensores utilizados en modo independiente. Creemos que la tecnología está suficientemente madura como para que una próxima revisión del sistema pueda ser comercial. Sin embargo, todavía sería necesario trabajar en aspectos importantes del sistema. Todavía no hemos abordado el manejo de energía. Un nodo actual funciona con 4 pilas AA durante aproximadamente 12 horas de operación continua. Una versión desplegable del nodo sensor debería estar en modo de reposo durante la operación normal y solo despertarse cuando ocurre un evento interesante. Un circuito de disparo analógico podría resolver este problema, sin embargo, el sistema se perdería el primer disparo. En cambio, los canales acústicos deberían ser muestreados y almacenados en un búfer circular. El resto del tablero podría apagarse. Cuando un disparador despierta la placa, los datos acústicos estarían disponibles de inmediato. Los experimentos con una placa de sensores de generación anterior indicaron que esto podría proporcionar un aumento de 10 veces en la vida útil de la batería. Otros problemas pendientes incluyen el empaquetado resistente a la intemperie y la robustez, así como la integración con la infraestructura militar actual. 10. REFERENCIAS [1] Sitio web de BBN Technologies. http://www.bbn.com. [2] E. Danicki. Localización acústica de francotiradores. Archivos de Acústica, 30(2):233-245, 2005. [3] G. L. Duckworth y col. Sistemas acústicos fijos y portátiles para la detección de francotiradores para las fuerzas del orden. En E. M. Carapezza y D. B. Ley, editores, Proc. SPIE Vol. 3577, p. 210-230, páginas 210-230, enero de 1999. [4] K. Fansler. Descripción de la explosión de la boca de fuego mediante modelos de escala modificados. Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.\n\nImpacto y Vibración, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer y D. Culler. El lenguaje nesC: un enfoque holístico para sistemas embebidos en red. Actas del Diseño e Implementación de Lenguajes de Programación (PLDI), junio de 2003. [6] J. Hill, R. Szewczyk, A. Woo, S. Hollar, D. Culler y K. Pister. Direcciones de arquitectura del sistema para sensores en red. en Proc. de ASPLOS 2000, noviembre de 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti y L. Meertens. Localización independiente de la densidad de nodos. Procesamiento de información en redes de sensores (IPSN 06) SPOTS Track, abril de 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti y G. Simon. Sistema contratirador para la guerra urbana. ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Maróti. Marco de enrutamiento de inundaciones dirigidas para redes de sensores inalámbricos. En Actas de la 5ta Conferencia Internacional de Middleware ACM/IFIP/USENIX, páginas 99-114, Nueva York, NY, EE. UU., 2004. Springer-Verlag New York, Inc. [10] B. Mays. \n\nSpringer-Verlag New York, Inc. [10] B. Mays. Clasificación de la onda de choque y la explosión de la boca del cañón mediante análisis conjunto de tiempo-frecuencia y wavelet. Informe técnico, Laboratorio de Investigación del Ejército, Adelphi MD 20783-1197, septiembre de 2001. [11] Plataformas de hardware de TinyOS. http://tinyos.net/scoop/special/hardware. [12] Módulo de radio Crossbow MICAz (MPR2400). http://www.xbow.com/Products/productsdetails.aspx?sid=101. [13] Recursos para usuarios de PicoBlaze. http://www.xilinx.com/ipcenter/processor_central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham y L. C. Sadler. Detección y estimación óptima basada en wavelets de onda de choque. Revista de la Sociedad Acústica de América, 104:955-963, agosto de 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi y P. Dutta. Sobre la escalabilidad de la sincronización de tiempo integrada en enrutamiento. 3er Taller Europeo sobre Redes de Sensores Inalámbricos (EWSN 2006), febrero de 2006. [16] Sitio web de ShotSpotter. http://www.shotspotter.com/products/military.html. [17] G. Simon, M. Maróti, A. Lédeczi, G. Balogh, B. Kušy, A. Nádas, G. Pap, J. Sallai y K. Frampton. Sistema de contratirador basado en redes de sensores. En SenSys 04: Actas de la 2ª conferencia internacional sobre sistemas de sensores en red integrados, páginas 1-12, Nueva York, NY, EE. UU., 2004. ACM Press. [18] R. Stoughton. \n\nACM Press. [18] R. Stoughton. Mediciones de ondas de choque balísticas de pequeño calibre en el aire. Revista de la Sociedad Acústica de América, 102:781-787, agosto de 1997. [19] B. A. Weiss, C. Schlenoff, M. Shneier y A. Virts. Evaluaciones de tecnología y métricas de rendimiento para sensores llevados por soldados para asistencia. En el taller de Métricas de Rendimiento para Sistemas Inteligentes, agosto de 2006. [20] G. Whitham. Patrón de flujo de un proyectil supersónico. Comunicaciones en matemáticas puras y aplicadas, 5(3):301, 1952. 126 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "sensor network": {
            "translated_key": "red de sensores",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless <br>sensor network</br>-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the <br>sensor network</br> and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static <br>sensor network</br>-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the <br>sensor network</br>.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the <br>sensor network</br> and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the <br>sensor network</br>.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the <br>sensor network</br> and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the <br>sensor network</br>.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the <br>sensor network</br>.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the <br>sensor network</br> was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the <br>sensor network</br>.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the <br>sensor network</br>, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "<br>sensor network</br>-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless <br>sensor network</br>-based mobile countersniper system.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the <br>sensor network</br> and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static <br>sensor network</br>-based solution to a highly mobile one presents significant challenges.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the <br>sensor network</br>.",
                "The time conversion and synchronization between the <br>sensor network</br> and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface."
            ],
            "translated_annotated_samples": [
                "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una <br>red de sensores</br> inalámbricos.",
                "PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la <br>red de sensores</br> y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia.",
                "Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una <br>red de sensores</br> estáticos a una altamente móvil presenta desafíos significativos.",
                "Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la <br>red de sensores</br>.",
                "La conversión de tiempo y sincronización entre la <br>red de sensores</br> y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una <br>red de sensores</br> inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la <br>red de sensores</br> y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una <br>red de sensores</br> estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la <br>red de sensores</br>. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la <br>red de sensores</br> y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "datum fusion": {
            "translated_key": "fusión de datos",
            "is_in_text": false,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [],
            "translated_text": "",
            "candidates": [],
            "error": [
                []
            ]
        },
        "acoustic source localization": {
            "translated_key": "localización de la fuente acústica",
            "is_in_text": false,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [],
            "translated_text": "",
            "candidates": [],
            "error": [
                []
            ]
        },
        "weapon classification": {
            "translated_key": "clasificación de armas",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and <br>weapon classification</br> with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% caliber estimation accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for caliber estimation and <br>weapon classification</br> in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for caliber estimation.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 Caliber estimation The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% caliber estimation error when an accurate trajectory estimate is available.",
                "In other words, caliber estimation only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out <br>weapon classification</br> in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because caliber estimation requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since caliber estimation and <br>weapon classification</br> relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: <br>weapon classification</br> results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall <br>weapon classification</br> accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and <br>weapon classification</br> system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For <br>weapon classification</br> to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct caliber estimation rate of well over 90% and the close to 100% <br>weapon classification</br> rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and <br>weapon classification</br> for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "Shooter Localization and <br>weapon classification</br> with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "Finally, additional requirements called for caliber estimation and <br>weapon classification</br> in addition to source localization.",
                "The system carries out <br>weapon classification</br> in the following manner.",
                "Since caliber estimation and <br>weapon classification</br> relies on the trajectory, non-localized shots are not classified either.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: <br>weapon classification</br> results."
            ],
            "translated_annotated_samples": [
                "Localización de tiradores y <br>clasificación de armas</br> con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos.",
                "Finalmente, se requirió la estimación del calibre y la <br>clasificación de armas</br>, además de la localización de la fuente.",
                "El sistema lleva a cabo la <br>clasificación de armas</br> de la siguiente manera.",
                "Dado que la estimación del calibre y la <br>clasificación de armas</br> dependen de la trayectoria, los disparos no localizados tampoco son clasificados.",
                "Distancia M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% Todos 96% 100% 97% 100% 23% 23% 93% Tabla 2: Resultados de <br>clasificación de armas</br>."
            ],
            "translated_text": "Localización de tiradores y <br>clasificación de armas</br> con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una precisión de estimación de calibre de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la estimación del calibre y la <br>clasificación de armas</br>, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para estimar el calibre. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo. La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él. El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz. El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado. Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros. Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes. Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula. Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth). Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador. El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R. El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa. Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo. Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente. Las rutas de señal se encuentran justo antes del archivo de registros. Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida. Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5. Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí. El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial. El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas. Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM. Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB. La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros. Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea. Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador. La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz). Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo. Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo. Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento. Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación. Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas. Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos. Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc. Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía). De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo. La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores. El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje. Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual. Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local. El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación. Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente. La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6]. Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz. ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares. Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos. Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular. Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios. Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias. Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento. Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos. Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente). Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque. En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples. Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal. Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento. Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote. En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente. Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal. Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs). El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado. La máquina de estados del algoritmo se muestra en la Figura 5(b). Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax). La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada. A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4]. Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a). Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad. La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC). Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC. Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período. Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido. Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente. El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente. El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca). El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b). Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes. Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE. La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6. La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma. El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1. Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2. Calcular estimaciones de rango. Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3. Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4. Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5. Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6. Si el calibre está disponible, calcular el tipo de arma (ver 6.6). Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor. Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s. Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano). Formalicemos primero el problema para 3 micrófonos. Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3. Primero aplicamos un paso de validación de geometría simple. La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición. Si esta condición no se cumple, las detecciones correspondientes son descartadas. Sea v(x, y, z) el vector normal de la dirección de llegada desconocida. También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3. Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c). Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos. Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden). Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos. De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2). Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque. Considera la situación en la Figura 7. Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos. Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible. La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u. La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales. Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P). Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie. Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2). La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t). P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1. Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón). En este caso: t = uvt1−t2 uv−1. Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango. Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil. En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano. La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala. Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango. Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada. Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2]. El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí. En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular. En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente. En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque. Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico. Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque). Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral. Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria. Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque. Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno. Esto nos da como máximo N(N−1) 2 trayectorias. Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria). Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio. El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos. El conjunto central se puede encontrar en tiempo O(N2). Las trayectorias en el conjunto central se promedian para obtener la trayectoria final. Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección. Significa que todos los sensores están en el mismo lado de la trayectoria. En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido. Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque. Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria. Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles). Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor. Para un ejemplo, consulte la Figura 8. Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque. Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador. Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos. Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8]. La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales. Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja. La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas. La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada. El retroceso es posible para evitar quedarse atascado en un máximo local. Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea. Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida. A continuación, describamos detalladamente cómo se calcula la función de consistencia. Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular. Primero consideramos solo la información de ToA. Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA. Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B. Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo. El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B. Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8]. Aquí extendemos el enfoque de la siguiente manera. Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales. Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B. Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B. En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores. El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 Estimación de calibre Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20]. Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error. Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos. Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores). Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque. Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos. Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes. Los datos experimentales se muestran en la Figura 9. La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4). Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas. Este método tiene menos del 1% de error en la estimación del calibre cuando se dispone de una estimación precisa de la trayectoria. En otras palabras, la estimación del calibre solo funciona si se realizan suficientes detecciones de ondas de choque por el sistema para calcular una trayectoria. 120 6.6 Estimación de armas Analizamos todas las características de la señal medida para encontrar información específica de la arma. Lamentablemente, concluimos que la firma observada de la explosión del cañón no es lo suficientemente característica del arma para fines de clasificación. Las reflexiones de la explosión de alta energía del freno de boca tienen un impacto mucho mayor en la forma de la señal de la explosión del freno de boca que el arma en sí misma. Disparar la misma arma desde diferentes lugares causó diferencias más grandes en la señal registrada que disparar diferentes armas desde el mismo lugar. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 rango (m) velocidad (m/s) AK-47 M240 Figura 10: Mediciones de desaceleración de balas de AK47 y M240. Ambas armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 rango (m) velocidad (m/s) M16 M249 M4 Figura 11: Mediciones de desaceleración de balas M16, M249 y M4. Todas las armas tienen el mismo calibre. Los datos se aproximan utilizando regresión lineal simple. Sin embargo, la velocidad medida del proyectil y su calibre mostraron una buena correlación con el tipo de arma. Esto se debe a que, para un tipo de arma y par de municiones dados, la velocidad inicial es casi constante. En las Figuras 10 y 11 podemos ver la relación entre el alcance y la velocidad de bala medida para diferentes calibres y armas. En el rango de velocidad supersónica, la desaceleración de la bala se puede aproximar con una función lineal. En el caso del calibre 7.62 mm, las dos armas probadas (AK47, M240) pueden ser claramente diferenciadas (Figura 10). Desafortunadamente, esto no es necesariamente cierto para el calibre 5.56 mm. El M16 con su mayor velocidad de boca aún puede ser bien clasificado, pero las armas M4 y M249 parecen prácticamente indistinguibles (Figura 11). Sin embargo, esto puede deberse en parte al número limitado de disparos de práctica que pudimos realizar antes de que comenzaran las pruebas reales. Más datos de entrenamiento pueden revelar una mejor separación entre las dos armas, ya que sus velocidades de boca publicadas difieren ligeramente. El sistema lleva a cabo la <br>clasificación de armas</br> de la siguiente manera. Una vez que se conoce la trayectoria, la velocidad se puede calcular para cada sensor basándose en la geometría de la onda de choque. Para evaluar un disparo, elegimos el tipo de arma cuya función de desaceleración resulta en el menor error cuadrático medio de los pares estimados de rango-velocidad para la clase de calibre estimada. 7. RESULTADOS Una evaluación independiente del sistema fue realizada por un equipo de NIST en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen en abril de 2006 [19]. El experimento se llevó a cabo en un campo de tiro con edificios y paredes de madera simulados para soportar posiciones elevadas de tiradores y generar efectos de trayectorias múltiples. La Figura 12 muestra la interfaz de usuario con una fotografía aérea del sitio. Se desplegaron 10 nodos sensores en puntos relevados en un área de aproximadamente 30×30 m. Había cinco objetivos fijos detrás de la red de sensores. Varias posiciones de disparo se ubicaron en cada una de las líneas de tiro a 50, 100, 200 y 300 metros. Estas posiciones eran conocidas por los evaluadores, pero no por los operadores del sistema. Se utilizaron seis armas diferentes: AK47 y M240 disparando proyectiles de 7.62 mm, M16, M4 y M249 con munición de 5.56 mm y el M107 de calibre .50. Ten en cuenta que los sensores permanecieron estáticos durante la prueba. La razón principal de esto es que a nadie se le permite estar en la zona de tiro durante las pruebas con fuego real. Utilizar algún tipo de plataforma de control remoto habría sido demasiado complicado dada la limitada disponibilidad de tiempo para la prueba. Por lo tanto, el experimento no probó el aspecto de movilidad del sistema. Durante la prueba de un día, se realizaron 196 disparos. Los resultados se resumen en la Tabla 1. El sistema detectó todos los disparos exitosamente. Dado que una onda de choque balística es un fenómeno acústico único, hace que la detección sea muy robusta. No hubo falsos positivos para las ondas de choque, pero hubo un puñado de detecciones falsas de explosiones de boca de fuego debido a pruebas paralelas de artillería en un campo cercano. Tirador Local- Calibre Trayectoria Trayectoria Distancia No. Tabla 1: Resumen de resultados fusionando todas las observaciones de sensores disponibles. Todas las tomas fueron detectadas con éxito, por lo que la tasa de detección se omite. La tasa de localización significa el porcentaje de disparos cuya trayectoria el sensor de fusión pudo estimar. La tasa de precisión del calibre es relativa a los disparos localizados y no a todos los disparos, ya que la estimación del calibre requiere la trayectoria. El error de trayectoria se descompone en azimut en grados y la distancia real del tirador a la trayectoria. El error de distancia muestra la distancia entre la posición real del tirador y la posición estimada del tirador. Por lo tanto, incluye el error causado tanto por la trayectoria como por la estimación del alcance. Ten en cuenta que las medidas tradicionales de rumbo y alcance no son adecuadas para un sistema distribuido como el nuestro debido a la falta de un único punto de referencia. Figura 12: La interfaz de usuario del sistema mostrando la configuración experimental. Los 10 nodos sensores están etiquetados por su ID y marcados con círculos oscuros. Los objetivos son cuadrados negros marcados como T-1 a T-5. Las flechas largas y blancas señalan la posición del tirador estimada por cada sensor. Donde faltaba, el sensor correspondiente no tuvo suficientes detecciones para medir el AoA de la explosión del cañón, la onda de choque o ambas. La línea negra gruesa y el círculo grande indican la trayectoria estimada y la posición del tirador según lo estimado al fusionar todas las detecciones disponibles de la red. Este disparo desde la línea de los 100 metros en el blanco T-3 fue localizado casi perfectamente por la red de sensores. El calibre y el arma también fueron identificados correctamente. 6 de cada 10 nodos pudieron estimar la ubicación por sí solos. Su precisión de orientación está dentro de un grado, mientras que el alcance tiene un margen de error de menos del 10% en el peor de los casos. La tasa de localización caracteriza la capacidad del sistema para estimar con éxito la trayectoria de los disparos. Dado que la estimación del calibre y la <br>clasificación de armas</br> dependen de la trayectoria, los disparos no localizados tampoco son clasificados. Hubo 7 disparos de 196 que no fueron localizados. La razón de los tiros fallados es el problema de ambigüedad de trayectoria que ocurre cuando el proyectil pasa por un lado de todos los sensores. En este caso, dos trayectorias significativamente diferentes pueden generar el mismo conjunto de observaciones (ver [8] y también la Sección 6.3). En lugar de estimar cuál es más probable o mostrar ambas posibilidades, decidimos no proporcionar una trayectoria en absoluto. Es mejor no dar una respuesta que no sea una alarma de disparo que confundir al soldado. La precisión de la localización se desglosa en la precisión de la trayectoria y la precisión de la estimación de rango. El ángulo de la trayectoria estimada fue mejor que 1 grado, excepto para el rango de 300 m. Dado que el alcance no debería afectar la estimación de la trayectoria siempre y cuando el proyectil pase sobre la red, sospechamos que la ligera disminución en la precisión del ángulo para 300 m se debe a los disparos apresurados que presenciamos que los soldados realizaron cerca del final del día. Esto también se indica por otro dato: la distancia estimada de trayectoria desde los objetivos reales tiene un error promedio de 1.3 m para disparos de 300 m, 0.75 m para disparos de 200 m y 0.6 m para todos menos los disparos de 300 m. Dado que la distancia entre los objetivos y la red de sensores estaba fija, este número no debería mostrar una mejora de 2× solo porque el tirador está más cerca. Dado que el ángulo de la trayectoria en sí no caracteriza el error general, también puede haber una traducción. La Tabla 1 también proporciona la distancia del tirador desde la trayectoria estimada. Estos indican un error que es aproximadamente del 1-2% del rango. Para poner esto en perspectiva, es muy probable que una estimación de trayectoria para un disparo de 100 m pase por o muy cerca de la ventana en la que se encuentra el tirador. Una vez más, creemos que los errores desproporcionadamente mayores a 300 m se deben a errores humanos en la puntería. Dado que la verdad de referencia se obtuvo al conocer la ubicación precisa del tirador y del objetivo, cualquier inexactitud en la trayectoria real se suma directamente al error percibido del sistema. Llamamos estimación de la posición del tirador en la estimación del alcance de la trayectoria calculada debido a la falta de un término mejor. Las estimaciones de alcance son más precisas que el 5% a 50 m y el 10% a 100 m. Sin embargo, esto empeora a un 20% o más para distancias más largas. No teníamos una instalación para probar el sistema antes de la evaluación para rangos superiores a 100 m. Durante la evaluación, nos encontramos con el problema de confundir los ecos de ondas de choque con los disparos de la boca del cañón. Estos ecos llegaron a los sensores antes de la verdadera explosión del cañón solo para disparos a larga distancia, ya que el proyectil viaja 2-3 veces más rápido que la velocidad del sonido, por lo que el tiempo entre la onda de choque (y su posible eco de objetos cercanos) y la explosión del cañón aumenta con el aumento de las distancias. Esto resultó en subestimar el alcance, ya que el sistema medía tiempos más cortos que los reales. Desde la evaluación, ajustamos el algoritmo de detección de explosiones de boca para evitar este problema. Distancia M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% Todos 96% 100% 97% 100% 23% 23% 93% Tabla 2: Resultados de <br>clasificación de armas</br>. ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "caliber estimation": {
            "translated_key": "estimación del calibre",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Shooter Localization and Weapon Classification with Soldier-Wearable Networked Sensors Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Institute for Software Integrated Systems, Vanderbilt University Nashville, TN, USA akos.ledeczi@vanderbilt.edu ABSTRACT The paper presents a wireless sensor network-based mobile countersniper system.",
                "A sensor node consists of a helmetmounted microphone array, a COTS MICAz mote for internode communication and a custom sensorboard that implements the acoustic detection and Time of Arrival (ToA) estimation algorithms on an FPGA.",
                "A 3-axis compass provides self orientation and Bluetooth is used for communication with the soldiers PDA running the data fusion and the user interface.",
                "The heterogeneous sensor fusion algorithm can work with data from a single sensor or it can fuse ToA or Angle of Arrival (AoA) observations of muzzle blasts and ballistic shockwaves from multiple sensors.",
                "The system estimates the trajectory, the range, the caliber and the weapon type.",
                "The paper presents the system design and the results from an independent evaluation at the US Army Aberdeen Test Center.",
                "The system performance is characterized by 1degree trajectory precision and over 95% <br>caliber estimation</br> accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Categories and Subject Descriptors C.2.4 [Computer-Communications Networks]: Distributed Systems; J.7 [Computers in Other Systems]: Military General Terms: Design, Measurement, Performance 1.",
                "INTRODUCTION The importance of countersniper systems is underscored by the constant stream of news reports coming from the Middle East.",
                "In October 2006 CNN reported on a new tactic employed by insurgents.",
                "A mobile sniper team moves around busy city streets in a car, positions itself at a good standoff distance from dismounted US military personnel, takes a single well-aimed shot and immediately melts in the city traffic.",
                "By the time the soldiers can react, they are gone.",
                "A countersniper system that provides almost immediate shooter location to every soldier in the vicinity would provide clear benefits to the warfigthers.",
                "Our team introduced PinPtr, the first sensor networkbased countersniper system [17, 8] in 2003.",
                "The system is based on potentially hundreds of inexpensive sensor nodes deployed in the area of interest forming an ad-hoc multihop network.",
                "The acoustic sensors measure the Time of Arrival (ToA) of muzzle blasts and ballistic shockwaves, pressure waves induced by the supersonic projectile, send the data to a base station where a sensor fusion algorithm determines the origin of the shot.",
                "PinPtr is characterized by high precision: 1m average 3D accuracy for shots originating within or near the sensor network and 1 degree bearing precision for both azimuth and elevation and 10% accuracy in range estimation for longer range shots.",
                "The truly unique characteristic of the system is that it works in such reverberant environments as cluttered urban terrain and that it can resolve multiple simultaneous shots at the same time.",
                "This capability is due to the widely distributed sensing and the unique sensor fusion approach [8].",
                "The system has been tested several times in US Army MOUT (Military Operations in Urban Terrain) facilities.",
                "The obvious disadvantage of such a system is its static nature.",
                "Once the sensors are distributed, they cover a certain area.",
                "Depending on the operation, the deployment may be needed for an hour or a month, but eventually the area looses its importance.",
                "It is not practical to gather and reuse the sensors, especially under combat conditions.",
                "Even if the sensors are cheap, it is still a waste and a logistical problem to provide a continuous stream of sensors as the operations move from place to place.",
                "As it is primarily the soldiers that the system protects, a natural extension is to mount the sensors on the soldiers themselves.",
                "While there are vehiclemounted countersniper systems [1] available commercially, we are not aware of a deployed system that protects dismounted soldiers.",
                "A helmet-mounted system was developed in the mid 90s by BBN [3], but it was not continued beyond the Darpa program that funded it. 113 To move from a static sensor network-based solution to a highly mobile one presents significant challenges.",
                "The sensor positions and orientation need to be constantly monitored.",
                "As soldiers may work in groups of as little as four people, the number of sensors measuring the acoustic phenomena may be an order of magnitude smaller than before.",
                "Moreover, the system should be useful to even a single soldier.",
                "Finally, additional requirements called for <br>caliber estimation</br> and weapon classification in addition to source localization.",
                "The paper presents the design and evaluation of our soldierwearable mobile countersniper system.",
                "It describes the hardware and software architecture including the custom sensor board equipped with a small microphone array and connected to a COTS MICAz mote [12].",
                "Special emphasis is paid to the sensor fusion technique that estimates the trajectory, range, caliber and weapon type simultaneously.",
                "The results and analysis of an independent evaluation of the system at the US Army Aberdeen Test Center are also presented. 2.",
                "APPROACH The firing of a typical military rifle, such as the AK47 or M16, produces two distinct acoustic phenomena.",
                "The muzzle blast is generated at the muzzle of the gun and travels at the speed sound.",
                "The supersonic projectile generates an acoustic shockwave, a kind of sonic boom.",
                "The wavefront has a conical shape, the angle of which depends on the Mach number, the speed of the bullet relative to the speed of sound.",
                "The shockwave has a characteristic shape resembling a capital N. The rise time at both the start and end of the signal is very fast, under 1 μsec.",
                "The length is determined by the caliber and the miss distance, the distance between the trajectory and the sensor.",
                "It is typically a few hundred μsec.",
                "Once a trajectory estimate is available, the shockwave length can be used for <br>caliber estimation</br>.",
                "Our system is based on four microphones connected to a sensorboard.",
                "The board detects shockwaves and muzzle blasts and measures their ToA.",
                "If at least three acoustic channels detect the same event, its AoA is also computed.",
                "If both the shockwave and muzzle blast AoA are available, a simple analytical solution gives the shooter location as shown in Section 6.",
                "As the microphones are close to each other, typically 2-4, we cannot expect very high precision.",
                "Also, this method does not estimate a trajectory.",
                "In fact, an infinite number of trajectory-bullet speed pairs satisfy the observations.",
                "However, the sensorboards are also connected to COTS MICAz motes and they share their AoA and ToA measurements, as well as their own location and orientation, with each other using a multihop routing service [9].",
                "A hybrid sensor fusion algorithm then estimates the trajectory, the range, the caliber and the weapon type based on all available observations.",
                "The sensorboard is also Bluetooth capable for communication with the soldiers PDA or laptop computer.",
                "A wired USB connection is also available.",
                "The sensorfusion algorithm and the user interface get their data through one of these channels.",
                "The orientation of the microphone array at the time of detection is provided by a 3-axis digital compass.",
                "Currently the system assumes that the soldiers PDA is GPS-capable and it does not provide self localization service itself.",
                "However, the accuracy of GPS is a few meters degrading the Figure 1: Acoustic sensorboard/mote assembly . overall accuracy of the system.",
                "Refer to Section 7 for an analysis.",
                "The latest generation sensorboard features a Texas Instruments CC-1000 radio enabling the high-precision radio interferometric self localization approach we have developed separately [7].",
                "However, we leave the integration of the two technologies for future work. 3.",
                "HARDWARE Since the first static version of our system in 2003, the sensor nodes have been built upon the UC Berkeley/Crossbow MICA product line [11].",
                "Although rudimentary acoustic signal processing can be done on these microcontroller-based boards, they do not provide the required computational performance for shockwave detection and angle of arrival measurements, where multiple signals from different microphones need to be processed in parallel at a high sampling rate.",
                "Our 3rd generation sensorboard is designed to be used with MICAz motes-in fact it has almost the same size as the mote itself (see Figure 1).",
                "The board utilizes a powerful Xilinx XC3S1000 FPGA chip with various standard peripheral IP cores, multiple soft processor cores and custom logic for the acoustic detectors (Figure 2).",
                "The onboard Flash (4MB) and PSRAM (8MB) modules allow storing raw samples of several acoustic events, which can be used to build libraries of various acoustic signatures and for refining the detection cores off-line.",
                "Also, the external memory blocks can store program code and data used by the soft processor cores on the FPGA.",
                "The board supports four independent analog channels sampled at up to 1 MS/s (million samples per seconds).",
                "These channels, featuring an electret microphone (Panasonic WM64PNT), amplifiers with controllable gain (30-60 dB) and a 12-bit serial ADC (Analog Devices AD7476), reside on separate tiny boards which are connected to the main sensorboard with ribbon cables.",
                "This partitioning enables the use of truly different audio channels (eg. : slower sampling frequency, different gain or dynamic range) and also results in less noisy measurements by avoiding long analog signal paths.",
                "The sensor platform offers a rich set of interfaces and can be integrated with existing systems in diverse ways.",
                "An RS232 port and a Bluetooth (BlueGiga WT12) wireless link with virtual UART emulation are directly available on the board and provide simple means to connect the sensor to PCs and PDAs.",
                "The mote interface consists of an I2 C bus along with an interrupt and GPIO line (the latter one is used 114 Figure 2: Block diagram of the sensorboard. for precise time synchronization between the board and the mote).",
                "The motes are equipped with IEEE 802.15.4 compliant radio transceivers and support ad-hoc wireless networking among the nodes and to/from the base station.",
                "The sensorboard also supports full-speed USB transfers (with custom USB dongles) for uploading recorded audio samples to the PC.",
                "The on-board JTAG chain-directly accessible through a dedicated connector-contains the FPGA part and configuration memory and provides in-system programming and debugging facilities.",
                "The integrated Honeywell HMR3300 digital compass module provides heading, pitch and roll information with 1◦ accuracy, which is essential for calculating and combining directional estimates of the detected events.",
                "Due to the complex voltage requirements of the FPGA, the power supply circuitry is implemented on the sensorboard and provides power both locally and to the mote.",
                "We used a quad pack of rechargeable AA batteries as the power source (although any other configuration is viable that meets the voltage requirements).",
                "The FPGA core (1.2 V) and I/O (3.3 V) voltages are generated by a highly efficient buck switching regulator.",
                "The FPGA configuration (2.5 V) and a separate 3.3 V power net are fed by low current LDOs, the latter one is used to provide independent power to the mote and to the Bluetooth radio.",
                "The regulators-except the last one-can be turned on/off from the mote or through the Bluetooth radio (via GPIO lines) to save power.",
                "The first prototype of our system employed 10 sensor nodes.",
                "Some of these nodes were mounted on military kevlar helmets with the microphones directly attached to the surface at about 20 cm separation as shown in Figure 3(a).",
                "The rest of the nodes were mounted in plastic enclosures (Figure 3(b)) with the microphones placed near the corners of the boxes to form approximately 5 cm×10 cm rectangles. 4.",
                "SOFTWARE ARCHITECTURE The sensor application relies on three subsystems exploiting three different computing paradigms as they are shown in Figure 4.",
                "Although each of these execution models suit their domain specific tasks extremely well, this diversity (a) (b) Figure 3: Sensor prototypes mounted on a kevlar helmet (a) and in a plastic box on a tripod (b). presents a challenge for software development and system integration.",
                "The sensor fusion and user interface subsystem is running on PDAs and were implemented in Java.",
                "The sensing and signal processing tasks are executed by an FPGA, which also acts as a bridge between various wired and wireless communication channels.",
                "The ad-hoc internode communication, time synchronization and data sharing are the responsibilities of a microcontroller based radio module.",
                "Similarly, the application employs a wide variety of communication protocols such as Bluetooth and IEEE 802.14.5 wireless links, as well as optional UARTs, I2 C and/or USB buses.",
                "Soldier Operated Device (PDA/Laptop) FPGA Sensor Board Mica Radio Module 2.4 GHz Wireless Link Radio Control Message Routing Acoustic Event Encoder Sensor Time Synch.",
                "Network Time Synch.Remote Control Time stamping Interrupts Virtual Register Interface C O O R D I N A T O R A n a l o g c h a n n e l s Compass PicoBlaze Comm.",
                "Interface PicoBlaze WT12 Bluetooth Radio MOTE IF:I2C,Interrupts USB PSRAM U A R T U A R T MB det SW det REC Bluetooth Link User Interface Sensor Fusion Location Engine GPS Message (Dis-)AssemblerSensor Control Figure 4: Software architecture diagram.",
                "The sensor fusion module receives and unpacks raw measurements (time stamps and feature vectors) from the sensorboard through the Bluetooth link.",
                "Also, it fine tunes the execution of the signal processing cores by setting parameters through the same link.",
                "Note that measurements from other nodes along with their location and orientation information also arrive from the sensorboard which acts as a gateway between the PDA and the sensor network.",
                "The handheld device obtains its own GPS location data and di115 rectly receives orientation information through the sensorboard.",
                "The results of the sensor fusion are displayed on the PDA screen with low latency.",
                "Since, the application is implemented in pure Java, it is portable across different PDA platforms.",
                "The border between software and hardware is considerably blurred on the sensor board.",
                "The IP cores-implemented in hardware description languages (HDL) on the reconfigurable FPGA fabric-closely resemble hardware building blocks.",
                "However, some of them-most notably the soft processor cores-execute true software programs.",
                "The primary tasks of the sensor board software are 1) acquiring data samples from the analog channels, 2) processing acoustic data (detection), and 3) providing access to the results and run-time parameters through different interfaces.",
                "As it is shown in Figure 4, a centralized virtual register file contains the address decoding logic, the registers for storing parameter values and results and the point to point data buses to and from the peripherals.",
                "Thus, it effectively integrates the building blocks within the sensorboard and decouples the various communication interfaces.",
                "This architecture enabled us to deploy the same set of sensors in a centralized scenario, where the ad-hoc mote network (using the I2 C interface) collected and forwarded the results to a base station or to build a decentralized system where the local PDAs execute the sensor fusion on the data obtained through the Bluetooth interface (and optionally from other sensors through the mote interface).",
                "The same set of registers are also accessible through a UART link with a terminal emulation program.",
                "Also, because the low-level interfaces are hidden by the register file, one can easily add/replace these with new ones (eg. : the first generation of motes supported a standard μP interface bus on the sensor connector, which was dropped in later designs).",
                "The most important results are the time stamps of the detected events.",
                "These time stamps and all other timing information (parameters, acoustic event features) are based on a 1 MHz clock and an internal timer on the FPGA.",
                "The time conversion and synchronization between the sensor network and the board is done by the mote by periodically requesting the capture of the current timer value through a dedicated GPIO line and reading the captured value from the register file through the I2 C interface.",
                "Based on the the current and previous readings and the corresponding mote local time stamps, the mote can calculate and maintain the scaling factor and offset between the two time domains.",
                "The mote interface is implemented by the I2 C slave IP core and a thin adaptation layer which provides a data and address bus abstraction on top of it.",
                "The maximum effective bandwidth is 100 Kbps through this interface.",
                "The FPGA contains several UART cores as well: for communicating with the on-board Bluetooth module, for controlling the digital compass and for providing a wired RS232 link through a dedicated connector.",
                "The control, status and data registers of the UART modules are available through the register file.",
                "The higher level protocols on these lines are implemented by Xilinx PicoBlaze microcontroller cores [13] and corresponding software programs.",
                "One of them provides a command line interface for test and debug purposes, while the other is responsible for parsing compass readings.",
                "By default, they are connected to the RS232 port and to the on-board digital compass line respectively, however, they can be rewired to any communication interface by changing the register file base address in the programs (e.g. the command line interface can be provided through the Bluetooth channel).",
                "Two of the external interfaces are not accessible through the register file: a high speed USB link and the SRAM interface are tied to the recorder block.",
                "The USB module implements a simple FIFO with parallel data lines connected to an external FT245R USB device controller.",
                "The RAM driver implements data read/write cycles with correct timing and is connected to the on-board pseudo SRAM.",
                "These interfaces provide 1 MB/s effective bandwidth for downloading recorded audio samples, for example.",
                "The data acquisition and signal processing paths exhibit clear symmetry: the same set of IP cores are instantiated four times (i.e. the number of acoustic channels) and run independently.",
                "The signal paths meet only just before the register file.",
                "Each of the analog channels is driven by a serial A/D core for providing a 20 MHz serial clock and shifting in 8-bit data samples at 1 MS/s and a digital potentiometer driver for setting the required gain.",
                "Each channel has its own shockwave and muzzle blast detector, which are described in Section 5.",
                "The detectors fetch run-time parameter values from the register file and store their results there as well.",
                "The coordinator core constantly monitors the detection results and generates a mote interrupt promptly upon full detection or after a reasonable timeout after partial detection.",
                "The recorder component is not used in the final deployment, however, it is essential for development purposes for refining parameter values for new types of weapons or for other acoustic sources.",
                "This component receives the samples from all channels and stores them in circular buffers in the PSRAM device.",
                "If the signal amplitude on one of the channels crosses a predefined threshold, the recorder component suspends the sample collection with a predefined delay and dumps the contents of the buffers through the USB link.",
                "The length of these buffers and delays, the sampling rate, the threshold level and the set of recorded channels can be (re)configured run-time through the register file.",
                "Note that the core operates independently from the other signal processing modules, therefore, it can be used to validate the detection results off-line.",
                "The FPGA cores are implemented in VHDL, the PicoBlaze programs are written in assembly.",
                "The complete configuration occupies 40% of the resources (slices) of the FPGA and the maximum clock speed is 30 MHz, which is safely higher than the speed used with the actual device (20MHz).",
                "The MICAz motes are responsible for distributing measurement data across the network, which drastically improves the localization and classification results at each node.",
                "Besides a robust radio (MAC) layer, the motes require two essential middleware services to achieve this goal.",
                "The messages need to be propagated in the ad-hoc multihop network using a routing service.",
                "We successfully integrated the Directed Flood-Routing Framework (DFRF) [9] in our application.",
                "Apart from automatic message aggregation and efficient buffer management, the most unique feature of DFRF is its plug-in architecture, which accepts custom routing policies.",
                "Routing policies are state machines that govern how received messages are stored, resent or discarded.",
                "Example policies include spanning tree routing, broadcast, geographic routing, etc.",
                "Different policies can be used for different messages concurrently, and the application is able to 116 change the underlying policies at run-time (eg. : because of the changing RF environment or power budget).",
                "In fact, we switched several times between a simple but lavish broadcast policy and a more efficient gradient routing on the field.",
                "Correlating ToA measurements requires a common time base and precise time synchronization in the sensor network.",
                "The Routing Integrated Time Synchronization (RITS) [15] protocol relies on very accurate MAC-layer time-stamping to embed the cumulative delay that a data message accrued since the time of the detection in the message itself.",
                "That is, at every node it measures the time the message spent there and adds this to the number in the time delay slot of the message, right before it leaves the current node.",
                "Every receiving node can subtract the delay from its current time to obtain the detection time in its local time reference.",
                "The service provides very accurate time conversion (few μs per hop error), which is more than adequate for this application.",
                "Note, that the motes also need to convert the sensorboard time stamps to mote time as it is described earlier.",
                "The mote application is implemented in nesC [5] and is running on top of TinyOS [6].",
                "With its 3 KB RAM and 28 KB program space (ROM) requirement, it easily fits on the MICAz motes. 5.",
                "DETECTION ALGORITHM There are several characteristics of acoustic shockwaves and muzzle blasts which distinguish their detection and signal processing algorithms from regular audio applications.",
                "Both events are transient by their nature and present very intense stimuli to the microphones.",
                "This is increasingly problematic with low cost electret microphones-designed for picking up regular speech or music.",
                "Although mechanical damping of the microphone membranes can mitigate the problem, this approach is not without side effects.",
                "The detection algorithms have to be robust enough to handle severe nonlinear distortion and transitory oscillations.",
                "Since the muzzle blast signature closely follows the shockwave signal and because of potential automatic weapon bursts, it is extremely important to settle the audio channels and the detection logic as soon as possible after an event.",
                "Also, precise angle of arrival estimation necessitates high sampling frequency (in the MHz range) and accurate event detection.",
                "Moreover, the detection logic needs to process multiple channels in parallel (4 channels on our existing hardware).",
                "These requirements dictated simple and robust algorithms both for muzzle blast and shockwave detections.",
                "Instead of using mundane energy detectors-which might not be able to distinguish the two different events-the applied detectors strive to find the most important characteristics of the two signals in the time-domain using simple state machine logic.",
                "The detectors are implemented as independent IP cores within the FPGA-one pair for each channel.",
                "The cores are run-time configurable and provide detection event signals with high precision time stamps and event specific feature vectors.",
                "Although the cores are running independently and in parallel, a crude local fusion module integrates them by shutting down those cores which missed their events after a reasonable timeout and by generating a single detection message towards the mote.",
                "At this point, the mote can read and forward the detection times and features and is responsible to restart the cores afterwards.",
                "The most conspicuous characteristics of an acoustic shockwave (see Figure 5(a)) are the steep rising edges at the be0 200 400 600 800 1000 1200 1400 1600 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Shockwave (M16) Time (µs) Amplitude 1 3 5 2 4 len (a) s[t] - s[t-D] > E tstart := t s[t] - s[t-D] < E s[t] - s[t-D] > E & t - t_start > Lmin s[t] - s[t-D] < E len := t - tstart IDLE 1 FIRST EDGE DONE 3 SECOND EDGE 4 FIRST EDGE 2 FOUND 5 t - tstart ≥ Lmax t - tstart ≥ Lmax (b) Figure 5: Shockwave signal generated by a 5.56 × 45 mm NATO projectile (a) and the state machine of the detection algorithm (b). ginning and end of the signal.",
                "Also, the length of the N-wave is fairly predictable-as it is described in Section 6.5-and is relatively short (200-300 μs).",
                "The shockwave detection core is continuously looking for two rising edges within a given interval.",
                "The state machine of the algorithm is shown in Figure 5(b).",
                "The input parameters are the minimum steepness of the edges (D, E), and the bounds on the length of the wave (Lmin, Lmax).",
                "The only feature calculated by the core is the length of the observed shockwave signal.",
                "In contrast to shockwaves, the muzzle blast signatures are characterized by a long initial period (1-5 ms) where the first half period is significantly shorter than the second half [4].",
                "Due to the physical limitations of the analog circuitry described at the beginning of this section, irregular oscillations and glitches might show up within this longer time window as they can be clearly seen in Figure 6(a).",
                "Therefore, the real challenge for the matching detection core is to identify the first and second half periods properly.",
                "The state machine (Figure 6(b)) does not work on the raw samples directly but is fed by a zero crossing (ZC) encoder.",
                "After the initial triggering, the detector attempts to collect those ZC segments which belong to the first period (positive amplitude) while discarding too short (in our terminology: garbage) segments-effectively implementing a rudimentary low-pass filter in the ZC domain.",
                "After it encounters a sufficiently long negative segment, it runs the same collection logic for the second half period.",
                "If too much garbage is discarded in the collection phases, the core resets itself to prevent the (false) detection of the halves from completely different periods separated by rapid oscillation or noise.",
                "Finally, if the constraints on the total length and on the length ratio hold, the core generates a detection event along with the actual length, amplitude and energy of the period calculated concurrently.",
                "The initial triggering mechanism is based on two amplitude thresholds: one static (but configurable) amplitude level and a dynamically computed one.",
                "The latter one is essential to adapt the sensor to different ambient noise environments and to temporarily suspend the muzzle blast detector after a shock wave event (oscillations in the analog section or reverberations in the sensor enclosure might otherwise trigger false muzzle blast detections).",
                "The dynamic noise level is estimated by a single pole recursive low-pass filter (cutoff @ 0.5 kHz ) on the FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Time (µs) Amplitude Muzzle blast (M16) 1 2 3 4 5 len2 + len1 (a) IDLE 1 SECOND ZC 3 PENDING ZC 4 FIRST ZC 2 FOUND 5 amplitude threshold long positive ZC long negative ZC valid full period max garbage wrong sign garbage collect first period garbage collect first period garbage (b) Figure 6: Muzzle blast signature (a) produced by an M16 assault rifle and the corresponding detection logic (b).",
                "The detection cores were originally implemented in Java and evaluated on pre-recorded signals because of much faster test runs and more convenient debugging facilities.",
                "Later on, they were ported to VHDL and synthesized using the Xilinx ISE tool suite.",
                "The functional equivalence between the two implementations were tested by VHDL test benches and Python scripts which provided an automated way to exercise the detection cores on the same set of pre-recorded signals and to compare the results. 6.",
                "SENSOR FUSION The sensor fusion algorithm receives detection messages from the sensor network and estimates the bullet trajectory, the shooter position, the caliber of the projectile and the type of the weapon.",
                "The algorithm consists of well separated computational tasks outlined below: 1.",
                "Compute muzzle blast and shockwave directions of arrivals for each individual sensor (see 6.1). 2.",
                "Compute range estimates.",
                "This algorithm can analytically fuse a pair of shockwave and muzzle blast AoA estimates. (see 6.2). 3.",
                "Compute a single trajectory from all shockwave measurements (see 6.3). 4.",
                "If trajectory available compute range (see 6.4). else compute shooter position first and then trajectory based on it. (see 6.4) 5.",
                "If trajectory available compute caliber (see 6.5). 6.",
                "If caliber available compute weapon type (see 6.6).",
                "We describe each step in the following sections in detail. 6.1 Direction of arrival The first step of the sensor fusion is to calculate the muzzle blast and shockwave AoA-s for each sensorboard.",
                "Each sensorboard has four microphones that measure the ToA-s.",
                "Since the microphone spacing is orders of magnitude smaller than the distance to the sound source, we can approximate the approaching sound wave front with a plane (far field assumption).",
                "Let us formalize the problem for 3 microphones first.",
                "Let P1, P2 and P3 be the position of the microphones ordered by time of arrival t1 < t2 < t3.",
                "First we apply a simple geometry validation step.",
                "The measured time difference between two microphones cannot be larger than the sound propagation time between the two microphones: |ti − tj| <= |Pi − Pj |/c + ε Where c is the speed of sound and ε is the maximum measurement error.",
                "If this condition does not hold, the corresponding detections are discarded.",
                "Let v(x, y, z) be the normal vector of the unknown direction of arrival.",
                "We also use r1(x1, y1, z1), the vector from P1 to P2 and r2(x2, y2, z2), the vector from P1 to P3.",
                "Lets consider the projection of the direction of the motion of the wave front (v) to r1 divided by the speed of sound (c).",
                "This gives us how long it takes the wave front to propagate form P1 to P2: vr1 = c(t2 − t1) The same relationship holds for r2 and v: vr2 = c(t3 − t1) We also know that v is a normal vector: vv = 1 Moving from vectors to coordinates using the dot product definition leads to a quadratic system: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 We omit the solution steps here, as they are straightforward, but long.",
                "There are two solutions (if the source is on the P1P2P3 plane the two solutions coincide).",
                "We use the fourth microphones measurement-if there is one-to eliminate one of them.",
                "Otherwise, both solutions are considered for further processing. 6.2 Muzzle-shock fusion u v 11,tP 22,tP tP, 2P′ Bullet trajectory Figure 7: Section plane of a shot (at P) and two sensors (at P1 and at P2).",
                "One sensor detects the muzzle blasts, the other the shockwaves time and direction of arrivals.",
                "Consider the situation in Figure 7.",
                "A shot was fired from P at time t. Both P and t are unknown.",
                "We have one muzzle blast and one shockwave detections by two different sensors 118 with AoA and hence, ToA information available.",
                "The muzzle blast detection is at position P1 with time t1 and AoA u.",
                "The shockwave detection is at P2 with time t2 and AoA v. u and v are normal vectors.",
                "It is shown below that these measurements are sufficient to compute the position of the shooter (P).",
                "Let P2 be the point on the extended shockwave cone surface where PP2 is perpendicular to the surface.",
                "Note that PP2 is parallel with v. Since P2 is on the cone surface which hits P2, a sensor at P2 would detect the same shockwave time of arrival (t2).",
                "The cone surface travels at the speed of sound (c), so we can express P using P2: P = P2 + cv(t2 − t).",
                "P can also be expressed from P1: P = P1 + cu(t1 − t) yielding P1 + cu(t1 − t) = P2 + cv(t2 − t).",
                "P2P2 is perpendicular to v: (P2 − P2)v = 0 yielding (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0 containing only one unknown t. One obtains: t = (P1−P2)v c +uvt1−t2 uv−1 .",
                "From here we can calculate the shoter position P. Lets consider the special single sensor case where P1 = P2 (one sensor detects both shockwave and muzzle blast AoA).",
                "In this case: t = uvt1−t2 uv−1 .",
                "Since u and v are not used separately only uv, the absolute orientation of the sensor can be arbitrary, we still get t which gives us the range.",
                "Here we assumed that the shockwave is a cone which is only true for constant projectile speeds.",
                "In reality, the angle of the cone slowly grows; the surface resembles one half of an American football.",
                "The decelerating bullet results in a smaller time difference between the shockwave and the muzzle blast detections because the shockwave generation slows down with the bullet.",
                "A smaller time difference results in a smaller range, so the above formula underestimates the true range.",
                "However, it can still be used with a proper deceleration correction function.",
                "We leave this for future work. 6.3 Trajectory estimation Danicki showed that the bullet trajectory and speed can be computed analytically from two independent shockwave measurements where both ToA and AoA are measured [2].",
                "The method gets more sensitive to measurement errors as the two shockwave directions get closer to each other.",
                "In the special case when both directions are the same, the trajectory cannot be computed.",
                "In a real world application, the sensors are typically deployed on a plane approximately.",
                "In this case, all sensors located on one side of the trajectory measure almost the same shockwave AoA.",
                "To avoid this error sensitivity problem, we consider shockwave measurement pairs only if the direction of arrival difference is larger than a certain threshold.",
                "We have multiple sensors and one sensor can report two different directions (when only three microphones detect the shockwave).",
                "Hence, we typically have several trajectory candidates, i.e. one for each AoA pair over the threshold.",
                "We applied an outlier filtering and averaging method to fuse together the shockwave direction and time information and come up with a single trajectory.",
                "Assume that we have N individual shockwave AoA measurements.",
                "Lets take all possible unordered pairs where the direction difference is above the mentioned threshold and compute the trajectory for each.",
                "This gives us at most N(N−1) 2 trajectories.",
                "A trajectory is represented by one point pi and the normal vector vi (where i is the trajectory index).",
                "We define the distance of two trajectories as the dot product of their normal vectors: D(i, j) = vivj For each trajectory a neighbor set is defined: N(i) := {j|D(i, j) < R} where R is a radius parameter.",
                "The largest neighbor set is considered to be the core set C, all other trajectories are outliers.",
                "The core set can be found in O(N2 ) time.",
                "The trajectories in the core set are then averaged to get the final trajectory.",
                "It can happen that we cannot form any sensor pairs because of the direction difference threshold.",
                "It means all sensors are on the same side of the trajectory.",
                "In this case, we first compute the shooter position (described in the next section) that fixes p making v the only unknown.",
                "To find v in this case, we use a simple high resolution grid search and minimize an error function based on the shockwave directions.",
                "We have made experiments to utilize the measured shockwave length in the trajectory estimation.",
                "There are some promising results, but it needs further research. 6.4 Shooter position estimation The shooter position estimation algorithm aggregates the following heterogenous information generated by earlier computational steps: 1. trajectory, 2. muzzle blast ToA at a sensor, 3. muzzle blast AoA at a sensor, which is effectively a bearing estimate to the shooter, and 4. range estimate at a sensor (when both shockwave and muzzle blast AoA are available).",
                "Some sensors report only ToA, some has bearing estimate(s) also and some has range estimate(s) as well, depending on the number of successful muzzle blast and shockwave detections by the sensor.",
                "For an example, refer to Figure 8.",
                "Note that a sensor may have two different bearing and range estimates. 3 detections gives two possible AoA-s for muzzle blast (i.e. bearing) and/or shockwave.",
                "Furthermore, the combination of two different muzzle blast and shockwave AoA-s may result in two different ranges. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t bullet trajectory shooter position Figure 8: Example of heterogenous input data for the shooter position estimation algorithm.",
                "All sensors have ToA measurements (t1, t2, t3, t4, t5), one sensor has a single bearing estimate (v2), one sensor has two possible bearings (v3, v3) and one sensor has two bearing and two range estimates (v1, v1,r1, r1) In a multipath environment, these detections will not only contain gaussian noise, but also possibly large errors due to echoes.",
                "It has been showed in our earlier work that a similar problem can be solved efficiently with an interval arithmetic based bisection search algorithm [8].",
                "The basic idea is to define a discrete consistency function over the area of interest and subdivide the space into 3D boxes.",
                "For any given 3D box, this function gives the number of measurements supporting the hypothesis that the shooter was within that box.",
                "The search starts with a box large enough to contain the whole area of interest, then zooms in by dividing and evaluating boxes.",
                "The box with the maximum consistency is divided until the desired precision is reached.",
                "Backtracking is possible to avoid getting stuck in a local maximum.",
                "This approach has been shown to be fast enough for online processing.",
                "Note, however, that when the trajectory has already been calculated in previous steps, the search needs to be done only on the trajectory making it orders of magnitude faster.",
                "Next let us describe how the consistency function is calculated in detail.",
                "Consider B, a three dimensional box, we would like to compute the consistency value of.",
                "First we consider only the ToA information.",
                "If one sensor has multiple ToA detections, we use the average of those times, so one sensor supplies at most one ToA estimate.",
                "For each ToA, we can calculate the corresponding time of the shot, since the origin is assumed to be in box B.",
                "Since it is a box and not a single point, this gives us an interval for the shot time.",
                "The maximum number of overlapping time intervals gives us the value of the consistency function for B.",
                "For a detailed description of the consistency function and search algorithm, refer to [8].",
                "Here we extend the approach the following way.",
                "We modify the consistency function based on the bearing and range data from individual sensors.",
                "A bearing estimate supports B if the line segment starting from the sensor with the measured direction intersects the B box.",
                "A range supports B, if the sphere with the radius of the range and origin of the sensor intersects B.",
                "Instead of simply checking whether the position specified by the corresponding bearing-range pairs falls within B, this eliminates the sensors possible orientation error.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 <br>caliber estimation</br> The shockwave signal characteristics has been studied before by Whitham [20].",
                "He showed that the shockwave period T is related to the projectile diameter d, the length l, the perpendicular miss distance b from the bullet trajectory to the sensor, the Mach number M and the speed of sound c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 miss distance (m)shockwavelength(microseconds) .50 cal 5.56 mm 7.62 mm Figure 9: Shockwave length and miss distance relationship.",
                "Each data point represents one sensorboard after an aggregation of the individual measurements of the four acoustic channels.",
                "Three different caliber projectiles have been tested (196 shots, 10 sensors).",
                "To illustrate the relationship between miss distance and shockwave length, here we use all 196 shots with three different caliber projectiles fired during the evaluation. (During the evaluation we used data obtained previously using a few practice shots per weapon.) 10 sensors (4 microphones by sensor) measured the shockwave length.",
                "For each sensor, we considered the shockwave length estimation valid if at least three out of four microphones agreed on a value with at most 5 microsecond variance.",
                "This filtering leads to a 86% report rate per sensor and gets rid of large measurement errors.",
                "The experimental data is shown in Figure 9.",
                "Whithams formula suggests that the shockwave length for a given caliber can be approximated with a power function of the miss distance (with a 1/4 exponent).",
                "Best fit functions on our data are: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 To evaluate a shot, we take the caliber whose approximation function results in the smallest RMS error of the filtered sensor readings.",
                "This method has less than 1% <br>caliber estimation</br> error when an accurate trajectory estimate is available.",
                "In other words, <br>caliber estimation</br> only works if enough shockwave detections are made by the system to compute a trajectory. 120 6.6 Weapon estimation We analyzed all measured signal characteristics to find weapon specific information.",
                "Unfortunately, we concluded that the observed muzzle blast signature is not characteristic enough of the weapon for classification purposes.",
                "The reflections of the high energy muzzle blast from the environment have much higher impact on the muzzle blast signal shape than the weapon itself.",
                "Shooting the same weapon from different places caused larger differences on the recorded signal than shooting different weapons from the same place. 0 100 200 300 400 500 600 700 800 900 0 100 200 300 400 range (m) speed(m/s) AK-47 M240 Figure 10: AK47 and M240 bullet deceleration measurements.",
                "Both weapons have the same caliber.",
                "Data is approximated using simple linear regression. 0 100 200 300 400 500 600 700 800 900 1000 0 50 100 150 200 250 300 350 range (m) speed(m/s) M16 M249 M4 Figure 11: M16, M249 and M4 bullet deceleration measurements.",
                "All weapons have the same caliber.",
                "Data is approximated using simple linear regression.",
                "However, the measured speed of the projectile and its caliber showed good correlation with the weapon type.",
                "This is because for a given weapon type and ammunition pair, the muzzle velocity is nearly constant.",
                "In Figures 10 and 11 we can see the relationship between the range and the measured bullet speed for different calibers and weapons.",
                "In the supersonic speed range, the bullet deceleration can be approximated with a linear function.",
                "In case of the 7.62 mm caliber, the two tested weapons (AK47, M240) can be clearly separated (Figure 10).",
                "Unfortunately, this is not necessarily true for the 5.56 mm caliber.",
                "The M16 with its higher muzzle speed can still be well classified, but the M4 and M249 weapons seem practically undistinguishable (Figure 11).",
                "However, this may be partially due to the limited number of practice shots we were able to take before the actual testing began.",
                "More training data may reveal better separation between the two weapons since their published muzzle velocities do differ somewhat.",
                "The system carries out weapon classification in the following manner.",
                "Once the trajectory is known, the speed can be calculated for each sensor based on the shockwave geometry.",
                "To evaluate a shot, we choose the weapon type whose deceleration function results in the smallest RMS error of the estimated range-speed pairs for the estimated caliber class. 7.",
                "RESULTS An independent evaluation of the system was carried out by a team from NIST at the US Army Aberdeen Test Center in April 2006 [19].",
                "The experiment was setup on a shooting range with mock-up wooden buildings and walls for supporting elevated shooter positions and generating multipath effects.",
                "Figure 12 shows the user interface with an aerial photograph of the site. 10 sensor nodes were deployed on surveyed points in an approximately 30×30 m area.",
                "There were five fixed targets behind the sensor network.",
                "Several firing positions were located at each of the firing lines at 50, 100, 200 and 300 meters.",
                "These positions were known to the evaluators, but not to the operators of the system.",
                "Six different weapons were utilized: AK47 and M240 firing 7.62 mm projectiles, M16, M4 and M249 with 5.56mm ammunition and the .50 caliber M107.",
                "Note that the sensors remained static during the test.",
                "The primary reason for this is that nobody is allowed downrange during live fire tests.",
                "Utilizing some kind of remote control platform would have been too involved for the limited time the range was available for the test.",
                "The experiment, therefore, did not test the mobility aspect of the system.",
                "During the one day test, there were 196 shots fired.",
                "The results are summarized in Table 1.",
                "The system detected all shots successfully.",
                "Since a ballistic shockwave is a unique acoustic phenomenon, it makes the detection very robust.",
                "There were no false positives for shockwaves, but there were a handful of false muzzle blast detections due to parallel tests of artillery at a nearby range.",
                "Shooter Local- Caliber Trajectory Trajectory Distance No.",
                "Range ization Accu- Azimuth Distance Error of (m) Rate racy Error (deg) Error (m) (m) Shots 50 93% 100% 0.86 0.91 2.2 54 100 100% 100% 0.66 1.34 8.7 54 200 96% 100% 0.74 2.71 32.8 54 300 97% 97% 1.49 6.29 70.6 34 All 96% 99.5% 0.88 2.47 23.0 196 Table 1: Summary of results fusing all available sensor observations.",
                "All shots were successfully detected, so the detection rate is omitted.",
                "Localization rate means the percentage of shots that the sensor fusion was able to estimate the trajectory of.",
                "The caliber accuracy rate is relative to the shots localized and not all the shots because <br>caliber estimation</br> requires the trajectory.",
                "The trajectory error is broken down to azimuth in degrees and the actual distance of the shooter from the trajectory.",
                "The distance error shows the distance between the real shooter position and the estimated shooter position.",
                "As such, it includes the error caused by both the trajectory and that of the range estimation.",
                "Note that the traditional bearing and range measures are not good ones for a distributed system such as ours because of the lack of a single reference point. 121 Figure 12: The user interface of the system showing the experimental setup.",
                "The 10 sensor nodes are labeled by their ID and marked by dark circles.",
                "The targets are black squares marked T-1 through T-5.",
                "The long white arrows point to the shooter position estimated by each sensor.",
                "Where it is missing, the corresponding sensor did not have enough detections to measure the AoA of either the muzzle blast, the shockwave or both.",
                "The thick black line and large circle indicate the estimated trajectory and the shooter position as estimated by fusing all available detections from the network.",
                "This shot from the 100-meter line at target T-3 was localized almost perfectly by the sensor network.",
                "The caliber and weapon were also identified correctly. 6 out of 10 nodes were able to estimate the location alone.",
                "Their bearing accuracy is within a degree, while the range is off by less than 10% in the worst case.",
                "The localization rate characterizes the systems ability to successfully estimate the trajectory of shots.",
                "Since <br>caliber estimation</br> and weapon classification relies on the trajectory, non-localized shots are not classified either.",
                "There were 7 shots out of 196 that were not localized.",
                "The reason for missed shots is the trajectory ambiguity problem that occurs when the projectile passes on one side of all the sensors.",
                "In this case, two significantly different trajectories can generate the same set of observations (see [8] and also Section 6.3).",
                "Instead of estimating which one is more likely or displaying both possibilities, we decided not to provide a trajectory at all.",
                "It is better not to give an answer other than a shot alarm than misleading the soldier.",
                "Localization accuracy is broken down to trajectory accuracy and range estimation precision.",
                "The angle of the estimated trajectory was better than 1 degree except for the 300 m range.",
                "Since the range should not affect trajectory estimation as long as the projectile passes over the network, we suspect that the slightly worse angle precision for 300 m is due to the hurried shots we witnessed the soldiers took near the end of the day.",
                "This is also indicated by another datapoint: the estimated trajectory distance from the actual targets has an average error of 1.3 m for 300 m shots, 0.75 m for 200 m shots and 0.6 m for all but 300 m shots.",
                "As the distance between the targets and the sensor network was fixed, this number should not show a 2× improvement just because the shooter is closer.",
                "Since the angle of the trajectory itself does not characterize the overall error-there can be a translation alsoTable 1 also gives the distance of the shooter from the estimated trajectory.",
                "These indicate an error which is about 1-2% of the range.",
                "To put this into perspective, a trajectory estimate for a 100 m shot will very likely go through or very near the window the shooter is located at.",
                "Again, we believe that the disproportionally larger errors at 300 m are due to human errors in aiming.",
                "As the ground truth was obtained by knowing the precise location of the shooter and the target, any inaccuracy in the actual trajectory directly adds to the perceived error of the system.",
                "We call the estimation of the shooters position on the calculated trajectory range estimation due to the lack of a better term.",
                "The range estimates are better than 5% accurate from 50 m and 10% for 100 m. However, this goes to 20% or worse for longer distances.",
                "We did not have a facility to test system before the evaluation for ranges beyond 100 m. During the evaluation, we ran into the problem of mistaking shockwave echoes for muzzle blasts.",
                "These echoes reached the sensors before the real muzzle blast for long range shots only, since the projectile travels 2-3× faster than the speed of sound, so the time between the shockwave (and its possible echo from nearby objects) and the muzzle blast increases with increasing ranges.",
                "This resulted in underestimating the range, since the system measured shorter times than the real ones.",
                "Since the evaluation we finetuned the muzzle blast detection algorithm to avoid this problem.",
                "Distance M16 AK47 M240 M107 M4 M249 M4-M249 50m 100% 100% 100% 100% 11% 25% 94% 100m 100% 100% 100% 100% 22% 33% 100% 200m 100% 100% 100% 100% 50% 22% 100% 300m 67% 100% 83% 100% 33% 0% 57% All 96% 100% 97% 100% 23% 23% 93% Table 2: Weapon classification results.",
                "The percentages are relative to the number of shots localized and not all shots, as the classification algorithm needs to know the trajectory and the range.",
                "Note that the difference is small; there were 189 shots localized out of the total 196.",
                "The caliber and weapon estimation accuracy rates are based on the 189 shots that were successfully localized.",
                "Note that there was a single shot that was falsely classified by the caliber estimator.",
                "The 73% overall weapon classification accuracy does not seem impressive.",
                "But if we break it down to the six different weapons tested, the picture changes dramatically as shown in Table 2.",
                "For four of the weapons (AK14, M16, M240 and M107), the classification rate is almost 100%.",
                "There were only two shots out of approximately 140 that were missed.",
                "The M4 and M249 proved to be too similar and they were mistaken for each other most of the time.",
                "One possible explanation is that we had only a limited number of test shots taken with these weapons right before the evaluation and used the wrong deceleration approximation function.",
                "Either this or a similar mistake was made 122 since if we simply used the opposite of the systems answer where one of these weapons were indicated, the accuracy would have improved 3x.",
                "If we consider these two weapons a single weapon class, then the classification accuracy for it becomes 93%.",
                "Note that the AK47 and M240 have the same caliber (7.62 mm), just as the M16, M4 and M249 do (5.56 mm).",
                "That is, the system is able to differentiate between weapons of the same caliber.",
                "We are not aware of any system that classifies weapons this accurately. 7.1 Single sensor performance As was shown previously, a single sensor alone is able to localize the shooter if it can determine both the muzzle blast and the shockwave AoA, that is, it needs to measure the ToA of both on at least three acoustic channels.",
                "While shockwave detection is independent of the range-unless the projectile becomes subsonic-, the likelihood of muzzle blast detection beyond 150 meters is not enough for consistently getting at least three per sensor node for AoA estimation.",
                "Hence, we only evaluate the single sensor performance for the 104 shots that were taken from 50 and 100 m. Note that we use the same test data as in the previous section, but we evaluate individually for each sensor.",
                "Table 3 summarizes the results broken down by the ten sensors utilized.",
                "Since this is now not a distributed system, the results are given relative to the position of the given sensor, that is, a bearing and range estimate is provided.",
                "Note that many of the common error sources of the networked system do not play a role here.",
                "Time synchronization is not applicable.",
                "The sensors absolute location is irrelevant (just as the relative location of multiple sensors).",
                "The sensors orientation is still important though.",
                "There are several disadvantages of the single sensor case compared to the networked system: there is no redundancy to compensate for other errors and to perform outlier rejection, the localization rate is markedly lower, and a single sensor alone is not able to estimate the caliber or classify the weapon.",
                "Sensor id 1 2 3 5 7 8 9 10 11 12 Loc. rate 44% 37% 53% 52% 19% 63% 51% 31% 23% 44% Bearing (deg) 0.80 1.25 0.60 0.85 1.02 0.92 0.73 0.71 1.28 1.44 Range (m) 3.2 6.1 4.4 4.7 4.6 4.6 4.1 5.2 4.8 8.2 Table 3: Single sensor accuracy for 108 shots fired from 50 and 100 meters.",
                "Localization rate refers to the percentage of shots the given sensor alone was able to localize.",
                "The bearing and range values are average errors.",
                "They characterize the accuracy of localization from the given sensors perspective.",
                "The data indicates that the performance of the sensors varied significantly especially considering the localization rate.",
                "One factor has to be the location of the given sensor including how far it was from the firing lines and how obstructed its view was.",
                "Also, the sensors were hand-built prototypes utilizing nowhere near production quality packaging/mounting.",
                "In light of these factors, the overall average bearing error of 0.9 degrees and range error of 5 m with a microphone spacing of less than 10 cm are excellent.",
                "We believe that professional manufacturing and better microphones could easily achieve better performance than the best sensor in our experiment (>60% localization rate and 3 m range error).",
                "Interestingly, the largest error in range was a huge 90 m clearly due to some erroneous detection, yet the largest bearing error was less than 12 degrees which is still a good indication for the soldier where to look.",
                "The overall localization rate over all single sensors was 42%, while for 50 m shots only, this jumped to 61%.",
                "Note that the firing range was prepared to simulate an urban area to some extent: there were a few single- and two-storey wooden structures built both in and around the sensor deployment area and the firing lines.",
                "Hence, not all sensors had line-of-sight to all shooting positions.",
                "We estimate that 10% of the sensors had obstructed view to the shooter on average.",
                "Hence, we can claim that a given sensor had about 50% chance of localizing a shot within 130 m. (Since the sensor deployment area was 30 m deep, 100 m shots correspond to actual distances between 100 and 130 m.) Again, we emphasize that localization needs at least three muzzle blast and three shockwave detections out of a possible four for each per sensor.",
                "The detection rate for single sensors-corresponding to at least one shockwave detection per sensor-was practically 100%. 0% 10% 20% 30% 40% 50% 60% 70% 80% 90% 100% 0 1 2 3 4 5 6 7 8 9 10 number of sensors percentageofshots Figure 13: Histogram showing what fraction of the 104 shots taken from 50 and 100 meters were localized by at most how many individual sensors alone. 13% of the shots were missed by every single sensor, i.e., none of them had both muzzle blast and shockwave AoA detections.",
                "Note that almost all of these shots were still accurately localized by the networked system, i.e. the sensor fusion using all available observations in the sensor network.",
                "It would be misleading to interpret these results as the system missing half the shots.",
                "As soldiers never work alone and the sensor node is relatively cheap to afford having every soldier equipped with one, we also need to look at the overall detection rates for every shot.",
                "Figure 13 shows the histogram of the percentage of shots vs. the number of individual sensors that localized it. 13% of shots were not localized by any sensor alone, but 87% was localized by at least one sensor out of ten. 7.2 Error sources In this section, we analyze the most significant sources of error that affect the performance of the networked shooter localization and weapon classification system.",
                "In order to correlate the distributed observations of the acoustic events, the nodes need to have a common time and space reference.",
                "Hence, errors in the time synchronization, node localization and node orientation all degrade the overall accuracy of the system. 123 Our time synchronization approach yields errors significantly less than 100 microseconds.",
                "As the sound travels about 3 cm in that time, time synchronization errors have a negligible effect on the system.",
                "On the other hand, node location and orientation can have a direct effect on the overall system performance.",
                "Notice that to analyze this, we do not have to resort to simulation, instead we can utilize the real test data gathered at Aberdeen.",
                "But instead of using the real sensor locations known very accurately and the measured and calibrated almost perfect node orientations, we can add error terms to them and run the sensor fusion.",
                "This exactly replicates how the system would have performed during the test using the imprecisely known locations and orientations.",
                "Another aspect of the system performance that can be evaluated this way is the effect of the number of available sensors.",
                "Instead of using all ten sensors in the data fusion, we can pick any subset of the nodes to see how the accuracy degrades as we decrease the number of nodes.",
                "The following experiment was carried out.",
                "The number of sensors were varied from 2 to 10 in increments of 2.",
                "Each run picked the sensors randomly using a uniform distribution.",
                "At each run each node was randomly moved to a new location within a circle around its true position with a radius determined by a zero-mean Gaussian distribution.",
                "Finally, the node orientations were perturbed using a zeromean Gaussian distribution.",
                "Each combination of parameters were generated 100 times and utilized for all 196 shots.",
                "The results are summarized in Figure 14.",
                "There is one 3D barchart for each of the experiment sets with the given fixed number of sensors.",
                "The x-axis shows the node location error, that is, the standard deviation of the corresponding Gaussian distribution that was varied between 0 and 6 meters.",
                "The y-axis shows the standard deviation of the node orientation error that was varied between 0 and 6 degrees.",
                "The z-axis is the resulting trajectory azimuth error.",
                "Note that the elevation angles showed somewhat larger errors than the azimuth.",
                "Since all the sensors were in approximately a horizontal plane and only a few shooter positions were out of the same plane and only by 2 m or so, the test was not sufficient to evaluate this aspect of the system.",
                "There are many interesting observation one can make by analyzing these charts.",
                "Node location errors in this range have a small effect on accuracy.",
                "Node orientation errors, on the other hand, noticeably degrade the performance.",
                "Still the largest errors in this experiment of 3.5 degrees for 6 sensors and 5 degrees for 2 sensors are still very good.",
                "Note that as the location and orientation errors increase and the number of sensors decrease, the most significantly affected performance metric is the localization rate.",
                "See Table 4 for a summary.",
                "Successful localization goes down from almost 100% to 50% when we go from 10 sensors to 2 even without additional errors.",
                "This is primarily caused by geometry: for a successful localization, the bullet needs to pass over the sensor network, that is, at least one sensor should be on the side of the trajectory other than the rest of the nodes. (This is a simplification for illustrative purposes.",
                "If all the sensors and the trajectory are not coplanar, localization may be successful even if the projectile passes on one side of the network.",
                "See Section 6.3.)",
                "As the numbers of sensors decreased in the experiment by randomly selecting a subset, the probability of trajectories abiding by this rule decreased.",
                "This also means that even if there are 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 2 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 4 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 6 sensors 0 2 4 6 0 2 4 6 0 1 2 3 4 5 6 azimutherror(degree) position error (m) orientation error (degree) 8 sensors Figure 14: The effect of node localization and orientation errors on azimuth accuracy with 2, 4, 6 and 8 nodes.",
                "Note that the chart for 10 nodes is almost identical for the 8-node case, hence, it is omitted. 124 many sensors (i.e. soldiers), but all of them are right next to each other, the localization rate will suffer.",
                "However, when the sensor fusion does provide a result, it is still accurate even with few available sensors and relatively large individual errors.",
                "A very few consistent observation lead to good accuracy as the inconsistent ones are discarded by the algorithm.",
                "This is also supported by the observation that for the cases with the higher number of sensors (8 or 10), the localization rate is hardly affected by even large errors.",
                "Errors/Sensors 2 4 6 8 10 0 m, 0 deg 54% 87% 94% 95% 96% 2 m, 2 deg 53% 80% 91% 96% 96% 6 m, 0 deg 43% 79% 88% 94% 94% 0 m, 6 deg 44% 78% 90% 93% 94% 6 m, 6 deg 41% 73% 85% 89% 92% Table 4: Localization rate as a function of the number of sensors used, the sensor node location and orientation errors.",
                "One of the most significant observations on Figure 14 and Table 4 is that there is hardly any difference in the data for 6, 8 and 10 sensors.",
                "This means that there is little advantage of adding more nodes beyond 6 sensors as far as the accuracy is concerned.",
                "The speed of sound depends on the ambient temperature.",
                "The current prototype considers it constant that is typically set before a test.",
                "It would be straightforward to employ a temperature sensor to update the value of the speed of sound periodically during operation.",
                "Note also that wind may adversely affect the accuracy of the system.",
                "The sensor fusion, however, could incorporate wind speed into its calculations.",
                "It would be more complicated than temperature compensation, but could be done.",
                "Other practical issues also need to be looked at before a real world deployment.",
                "Silencers reduce the muzzle blast energy and hence, the effective range the system can detect it at.",
                "However, silencers do not effect the shockwave and the system would still detect the trajectory and caliber accurately.",
                "The range and weapon type could not be estimated without muzzle blast detections.",
                "Subsonic weapons do not produce a shockwave.",
                "However, this is not of great significance, since they have shorter range, lower accuracy and much less lethality.",
                "Hence, their use is not widespread and they pose less danger in any case.",
                "Another issue is the type of ammunition used.",
                "Irregular armies may use substandard, even hand manufactured bullets.",
                "This effects the muzzle velocity of the weapon.",
                "For weapon classification to work accurately, the system would need to be calibrated with the typical ammunition used by the given adversary. 8.",
                "RELATED WORK Acoustic detection and recognition has been under research since the early fifties.",
                "The area has a close relevance to the topic of supersonic flow mechanics [20].",
                "Fansler analyzed the complex near-field pressure waves that occur within a foot of the muzzle blast.",
                "Fanslers work gives a good idea of the ideal muzzle blast pressure wave without contamination from echoes or propagation effects [4].",
                "Experiments with greater distances from the muzzle were conducted by Stoughton [18].",
                "The measurements of the ballistic shockwaves using calibrated pressure transducers at known locations, measured bullet speeds, and miss distances of 355 meters for 5.56 mm and 7.62 mm projectiles were made.",
                "Results indicate that ground interaction becomes a problem for miss distances of 30 meters or larger.",
                "Another area of research is the signal processing of gunfire acoustics.",
                "The focus is on the robust detection and length estimation of small caliber acoustic shockwaves and muzzle blasts.",
                "Possible techniques for classifying signals as either shockwaves or muzzle blasts includes short-time Fourier Transform (STFT), the Smoothed Pseudo Wigner-Ville distribution (SPWVD), and a discrete wavelet transformation (DWT).",
                "Joint time-frequency (JTF) spectrograms are used to analyze the typical separation of the shockwave and muzzle blast transients in both time and frequency.",
                "Mays concludes that the DWT is the best method for classifying signals as either shockwaves or muzzle blasts because it works well and is less expensive to compute than the SPWVD [10].",
                "The edges of the shockwave are typically well defined and the shockwave length is directly related to the bullet characteristics.",
                "A paper by Sadler [14] compares two shockwave edge detection methods: a simple gradient-based detector, and a multi-scale wavelet detector.",
                "It also demonstrates how the length of the shockwave, as determined by the edge detectors, can be used along with Whithams equations [20] to estimate the caliber of a projectile.",
                "Note that the available computational performance on the sensor nodes, the limited wireless bandwidth and real-time requirements render these approaches infeasible on our platform.",
                "A related topic is the research and development of experimental and prototype shooter location systems.",
                "Researchers at BBN have developed the Bullet Ears system [3] which has the capability to be installed in a fixed position or worn by soldiers.",
                "The fixed system has tetrahedron shaped microphone arrays with 1.5 meter spacing.",
                "The overall system consists of two to three of these arrays spaced 20 to 100 meters from each other.",
                "The soldier-worn system has 12 microphones as well as a GPS antenna and orientation sensors mounted on a helmet.",
                "There is a low speed RF connection from the helmet to the processing body.",
                "An extensive test has been conducted to measure the performance of both type of systems.",
                "The fixed systems performance was one order of magnitude better in the angle calculations while their range performance where matched.",
                "The angle accuracy of the fixed system was dominantly less than one degree while it was around five degrees for the helmet mounted one.",
                "The range accuracy was around 5 percent for both of the systems.",
                "The problem with this and similar centralized systems is the need of the one or handful of microphone arrays to be in line-of-sight of the shooter.",
                "A sensor networked based solution has the advantage of widely distributed sensing for better coverage, multipath effect compensation and multiple simultaneous shot resolution [8].",
                "This is especially important for operation in acoustically reverberant urban areas.",
                "Note that BBNs current vehicle-mounted system called BOOMERANG, a modified version of Bullet Ears, is currently used in Iraq [1].",
                "The company ShotSpotter specializes in law enforcement systems that report the location of gunfire to police within seconds.",
                "The goal of the system is significantly different than that of military systems.",
                "Shotspotter reports 25 m typical accuracy which is more than enough for police to 125 respond.",
                "They are also manufacturing experimental soldier wearable and UAV mounted systems for military use [16], but no specifications or evaluation results are publicly available. 9.",
                "CONCLUSIONS The main contribution of this work is twofold.",
                "First, the performance of the overall distributed networked system is excellent.",
                "Most noteworthy are the trajectory accuracy of one degree, the correct <br>caliber estimation</br> rate of well over 90% and the close to 100% weapon classification rate for 4 of the 6 weapons tested.",
                "The system proved to be very robust when increasing the node location and orientation errors and decreasing the number of available sensors all the way down to a couple.",
                "The key factor behind this is the sensor fusion algorithms ability to reject erroneous measurements.",
                "It is also worth mentioning that the results presented here correspond to the first and only test of the system beyond 100 m and with six different weapons.",
                "We believe that with the lessons learned in the test, a consecutive field experiment could have showed significantly improved results especially in range estimation beyond 100 m and weapon classification for the remaining two weapons that were mistaken for each other the majority of the times during the test.",
                "Second, the performance of the system when used in standalone mode, that is, when single sensors alone provided localization, was also very good.",
                "While the overall localization rate of 42% per sensor for shots up to 130 m could be improved, the bearing accuracy of less than a degree and the average 5% range error are remarkable using the handmade prototypes of the low-cost nodes.",
                "Note that 87% of the shots were successfully localized by at least one of the ten sensors utilized in standalone mode.",
                "We believe that the technology is mature enough that a next revision of the system could be a commercial one.",
                "However, important aspects of the system would still need to be worked on.",
                "We have not addresses power management yet.",
                "A current node runs on 4 AA batteries for about 12 hours of continuous operation.",
                "A deployable version of the sensor node would need to be asleep during normal operation and only wake up when an interesting event occurs.",
                "An analog trigger circuit could solve this problem, however, the system would miss the first shot.",
                "Instead, the acoustic channels would need to be sampled and stored in a circular buffer.",
                "The rest of the board could be turned off.",
                "When a trigger wakes up the board, the acoustic data would be immediately available.",
                "Experiments with a previous generation sensor board indicated that this could provide a 10x increase in battery life.",
                "Other outstanding issues include weatherproof packaging and ruggedization, as well as integration with current military infrastructure. 10.",
                "REFERENCES [1] BBN technologies website. http://www.bbn.com. [2] E. Danicki.",
                "Acoustic sniper localization.",
                "Archives of Acoustics, 30(2):233-245, 2005. [3] G. L. Duckworth et al.",
                "Fixed and wearable acoustic counter-sniper systems for law enforcement.",
                "In E. M. Carapezza and D. B.",
                "Law, editors, Proc.",
                "SPIE Vol. 3577, p. 210-230, pages 210-230, Jan. 1999. [4] K. Fansler.",
                "Description of muzzle blast by modified scaling models.",
                "Shock and Vibration, 5(1):1-12, 1998. [5] D. Gay, P. Levis, R. von Behren, M. Welsh, E. Brewer, and D. Culler.",
                "The nesC language: a holistic approach to networked embedded systems.",
                "Proceedings of Programming Language Design and Implementation (PLDI), June 2003. [6] J. Hill, R. Szewczyk, A.",
                "Woo, S. Hollar, D. Culler, and K. Pister.",
                "System architecture directions for networked sensors. in Proc. of ASPLOS 2000, Nov. 2000. [7] B. Kus´y, G. Balogh, P. V¨olgyesi, J. Sallai, A. N´adas, A. L´edeczi, M. Mar´oti, and L. Meertens.",
                "Node-density independent localization.",
                "Information Processing in Sensor Networks (IPSN 06) SPOTS Track, Apr. 2006. [8] A. L´edeczi, A. N´adas, P. V¨olgyesi, G. Balogh, B. Kus´y, J. Sallai, G. Pap, S. D´ora, K. Moln´ar, M. Mar´oti, and G. Simon.",
                "Countersniper system for urban warfare.",
                "ACM Transactions on Sensor Networks, 1(1):153-177, Nov. 2005. [9] M. Mar´oti.",
                "Directed flood-routing framework for wireless sensor networks.",
                "In Proceedings of the 5th ACM/IFIP/USENIX International Conference on Middleware, pages 99-114, New York, NY, USA, 2004.",
                "Springer-Verlag New York, Inc. [10] B. Mays.",
                "Shockwave and muzzle blast classification via joint time frequency and wavelet analysis.",
                "Technical report, Army Research Lab Adelphi MD 20783-1197, Sept. 2001. [11] TinyOS Hardware Platforms. http://tinyos.net/scoop/special/hardware. [12] Crossbow MICAz (MPR2400) Radio Module. http://www.xbow.com/Products/productsdetails. aspx?sid=101. [13] PicoBlaze User Resources. http://www.xilinx.com/ipcenter/processor_ central/picoblaze/picoblaze_user_resources.htm. [14] B. M. Sadler, T. Pham, and L. C. Sadler.",
                "Optimal and wavelet-based shock wave detection and estimation.",
                "Acoustical Society of America Journal, 104:955-963, Aug. 1998. [15] J. Sallai, B. Kus´y, A. L´edeczi, and P. Dutta.",
                "On the scalability of routing-integrated time synchronization. 3rd European Workshop on Wireless Sensor Networks (EWSN 2006), Feb. 2006. [16] ShotSpotter website. http: //www.shotspotter.com/products/military.html. [17] G. Simon, M. Mar´oti, A. L´edeczi, G. Balogh, B. Kus´y, A. N´adas, G. Pap, J. Sallai, and K. Frampton.",
                "Sensor network-based countersniper system.",
                "In SenSys 04: Proceedings of the 2nd international conference on Embedded networked sensor systems, pages 1-12, New York, NY, USA, 2004.",
                "ACM Press. [18] R. Stoughton.",
                "Measurements of small-caliber ballistic shock waves in air.",
                "Acoustical Society of America Journal, 102:781-787, Aug. 1997. [19] B.",
                "A. Weiss, C. Schlenoff, M. Shneier, and A. Virts.",
                "Technology evaluations and performance metrics for soldier-worn sensors for assist.",
                "In Performance Metrics for Intelligent Systems Workshop, Aug. 2006. [20] G. Whitham.",
                "Flow pattern of a supersonic projectile.",
                "Communications on pure and applied mathematics, 5(3):301, 1952. 126"
            ],
            "original_annotated_samples": [
                "The system performance is characterized by 1degree trajectory precision and over 95% <br>caliber estimation</br> accuracy for all shots, and close to 100% weapon estimation accuracy for 4 out of 6 guns tested.",
                "Finally, additional requirements called for <br>caliber estimation</br> and weapon classification in addition to source localization.",
                "Once a trajectory estimate is available, the shockwave length can be used for <br>caliber estimation</br>.",
                "The value of the consistency function is incremented by one for each bearing and range estimate that is consistent with B. 6.5 <br>caliber estimation</br> The shockwave signal characteristics has been studied before by Whitham [20].",
                "This method has less than 1% <br>caliber estimation</br> error when an accurate trajectory estimate is available."
            ],
            "translated_annotated_samples": [
                "El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una <br>precisión de estimación de calibre</br> de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas.",
                "Finalmente, se requirió la <br>estimación del calibre</br> y la clasificación de armas, además de la localización de la fuente.",
                "Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para <br>estimar el calibre</br>.",
                "El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 <br>Estimación de calibre</br> Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20].",
                "Este método tiene menos del 1% de error en la <br>estimación del calibre</br> cuando se dispone de una estimación precisa de la trayectoria."
            ],
            "translated_text": "Localización de tiradores y clasificación de armas con sensores en red portátiles para soldados. Peter Volgyesi, Gyorgy Balogh, Andras Nadas, Christopher B. Nash, Akos Ledeczi Instituto de Sistemas Integrados de Software, Universidad de Vanderbilt Nashville, TN, EE. UU. akos.ledeczi@vanderbilt.edu RESUMEN El artículo presenta un sistema móvil contra francotiradores basado en una red de sensores inalámbricos. Un nodo sensor consta de un conjunto de micrófonos montados en un casco, un mote MICAz COTS para la comunicación entre nodos y una placa de sensores personalizada que implementa los algoritmos de detección acústica y estimación del Tiempo de Llegada (ToA) en un FPGA. Una brújula de 3 ejes proporciona auto-orientación y se utiliza Bluetooth para la comunicación con la PDA de los soldados que ejecuta la fusión de datos y la interfaz de usuario. El algoritmo de fusión de sensores heterogéneos puede trabajar con datos de un solo sensor o puede fusionar observaciones de ToA o Ángulo de Llegada (AoA) de explosiones de boca de fuego y ondas de choque balísticas de múltiples sensores. El sistema estima la trayectoria, el alcance, el calibre y el tipo de arma. El artículo presenta el diseño del sistema y los resultados de una evaluación independiente en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen. El rendimiento del sistema se caracteriza por una precisión de trayectoria de 1 grado y una <br>precisión de estimación de calibre</br> de más del 95% para todos los disparos, y una precisión de estimación de arma cercana al 100% para 4 de las 6 armas probadas. Categorías y Descriptores de Asignaturas C.2.4 [Redes de Comunicación de Computadoras]: Sistemas Distribuidos; J.7 [Computadoras en Otros Sistemas]: Términos Generales Militares: Diseño, Medición, Rendimiento 1. INTRODUCCIÓN La importancia de los sistemas contratiradores se destaca por la constante corriente de informes de noticias que provienen de Oriente Medio. En octubre de 2006, CNN informó sobre una nueva táctica empleada por insurgentes. Un equipo móvil de francotiradores se desplaza por las concurridas calles de la ciudad en un coche, se posiciona a una buena distancia de seguridad de los militares estadounidenses desmontados, realiza un único disparo bien apuntado y se funde de inmediato en el tráfico de la ciudad. Para cuando los soldados pueden reaccionar, ya se han ido. Un sistema contratirador que proporcione la ubicación del tirador casi de inmediato a cada soldado en las cercanías proporcionaría claros beneficios a los combatientes. Nuestro equipo introdujo PinPtr, el primer sistema de contratirador basado en redes de sensores [17, 8] en 2003. El sistema se basa en potencialmente cientos de nodos sensores económicos desplegados en el área de interés formando una red ad-hoc de múltiples saltos. Los sensores acústicos miden el Tiempo de Llegada (ToA) de las explosiones de boca y las ondas de choque balísticas, ondas de presión inducidas por el proyectil supersónico, envían los datos a una estación base donde un algoritmo de fusión de sensores determina el origen del disparo. PinPtr se caracteriza por su alta precisión: una precisión promedio de 1m en 3D para disparos que se originan dentro o cerca de la red de sensores y una precisión de 1 grado en el rumbo tanto en azimut como en elevación, y una precisión del 10% en la estimación de la distancia para disparos a larga distancia. La característica verdaderamente única del sistema es que funciona en entornos tan reverberantes como terrenos urbanos abarrotados y que puede resolver múltiples disparos simultáneos al mismo tiempo. Esta capacidad se debe a la amplia distribución de sensores y al enfoque único de fusión de sensores [8]. El sistema ha sido probado varias veces en instalaciones de MOUT (Operaciones Militares en Terreno Urbano) del Ejército de los Estados Unidos. La desventaja obvia de un sistema así es su naturaleza estática. Una vez que los sensores están distribuidos, cubren cierta área. Dependiendo de la operación, el despliegue puede ser necesario durante una hora o un mes, pero eventualmente el área pierde su importancia. No es práctico recoger y reutilizar los sensores, especialmente en condiciones de combate. Aunque los sensores sean baratos, sigue siendo un desperdicio y un problema logístico proporcionar un flujo continuo de sensores a medida que las operaciones se trasladan de un lugar a otro. Dado que principalmente son los soldados a quienes protege el sistema, una extensión natural es montar los sensores en los propios soldados. Si bien existen sistemas contratiradores montados en vehículos disponibles comercialmente, no tenemos conocimiento de un sistema desplegado que proteja a los soldados a pie. Un sistema montado en el casco fue desarrollado a mediados de los años 90 por BBN, pero no se continuó más allá del programa de Darpa que lo financió. Moverse de una solución basada en una red de sensores estáticos a una altamente móvil presenta desafíos significativos. Las posiciones y la orientación del sensor deben ser monitoreadas constantemente. Dado que los soldados pueden trabajar en grupos de tan solo cuatro personas, el número de sensores que miden los fenómenos acústicos puede ser un orden de magnitud menor que antes. Además, el sistema debería ser útil incluso para un solo soldado. Finalmente, se requirió la <br>estimación del calibre</br> y la clasificación de armas, además de la localización de la fuente. El artículo presenta el diseño y la evaluación de nuestro sistema móvil contra francotiradores portátil para soldados. Describe la arquitectura de hardware y software, incluyendo la placa de sensores personalizada equipada con un pequeño conjunto de micrófonos y conectada a un nodo MICAz COTS [12]. Se presta especial atención a la técnica de fusión de sensores que estima la trayectoria, alcance, calibre y tipo de arma simultáneamente. Los resultados y el análisis de una evaluación independiente del sistema en el Centro de Pruebas del Ejército de los Estados Unidos en Aberdeen también se presentan. 2. El disparo de un rifle militar típico, como el AK47 o M16, produce dos fenómenos acústicos distintos. La explosión del freno de boca se genera en la boca del arma y viaja a la velocidad del sonido. El proyectil supersónico genera una onda de choque acústica, una especie de explosión sónica. La frente de onda tiene una forma cónica, cuyo ángulo depende del número de Mach, la velocidad de la bala en relación con la velocidad del sonido. La onda de choque tiene una forma característica que se asemeja a la letra N mayúscula. El tiempo de subida tanto al inicio como al final de la señal es muy rápido, inferior a 1 μseg. La longitud está determinada por el calibre y la distancia de error, la distancia entre la trayectoria y el sensor. Normalmente son unos pocos cientos de μseg. Una vez que se tiene una estimación de la trayectoria, la longitud de la onda de choque se puede utilizar para <br>estimar el calibre</br>. Nuestro sistema se basa en cuatro micrófonos conectados a una placa de sensores. El tablero detecta ondas de choque y explosiones de boca y mide su tiempo de llegada. Si al menos tres canales acústicos detectan el mismo evento, también se calcula su AoA. Si tanto la onda de choque como el ángulo de ataque de la explosión del cañón están disponibles, una solución analítica simple proporciona la ubicación del tirador como se muestra en la Sección 6. Dado que los micrófonos están cerca uno del otro, típicamente de 2 a 4, no podemos esperar una precisión muy alta. Además, este método no estima una trayectoria. De hecho, un número infinito de pares de trayectoria y velocidad de bala satisfacen las observaciones. Sin embargo, las placas de sensores también están conectadas a los nodos MICAz COTS y comparten sus mediciones de AoA y ToA, así como su propia ubicación y orientación, entre sí utilizando un servicio de enrutamiento multihop [9]. Un algoritmo híbrido de fusión de sensores luego estima la trayectoria, el alcance, el calibre y el tipo de arma basándose en todas las observaciones disponibles. La placa de sensores también es compatible con Bluetooth para la comunicación con la PDA o la computadora portátil de los soldados. Una conexión USB por cable también está disponible. El algoritmo de fusión de sensores y la interfaz de usuario obtienen sus datos a través de uno de estos canales. La orientación del conjunto de micrófonos en el momento de la detección es proporcionada por una brújula digital de 3 ejes. Actualmente, el sistema asume que el PDA de los soldados tiene capacidad GPS y no proporciona un servicio de auto-localización por sí mismo. Sin embargo, la precisión del GPS es de unos pocos metros, degradando la precisión general del sistema. Consulte la Sección 7 para un análisis. La placa de sensores de última generación cuenta con un radio Texas Instruments CC-1000 que permite el enfoque de auto-localización interferométrica de alta precisión que hemos desarrollado por separado [7]. Sin embargo, dejamos la integración de las dos tecnologías para trabajos futuros. 3. HARDWARE Desde la primera versión estática de nuestro sistema en 2003, los nodos sensores se han construido sobre la línea de productos UC Berkeley/Crossbow MICA [11]. Aunque el procesamiento rudimentario de señales acústicas se puede realizar en estas placas basadas en microcontroladores, no proporcionan el rendimiento computacional requerido para la detección de ondas de choque y las mediciones del ángulo de llegada, donde múltiples señales de diferentes micrófonos deben ser procesadas en paralelo a una alta tasa de muestreo. Nuestra placa de sensores de tercera generación está diseñada para ser utilizada con los motes MICAz, de hecho, tiene casi el mismo tamaño que el mote en sí mismo (ver Figura 1). La placa utiliza un potente chip FPGA Xilinx XC3S1000 con varios núcleos IP periféricos estándar, múltiples núcleos de procesador suave y lógica personalizada para los detectores acústicos (Figura 2). Los módulos Flash integrados (4MB) y PSRAM (8MB) permiten almacenar muestras en bruto de varios eventos acústicos, que pueden utilizarse para construir bibliotecas de diferentes firmas acústicas y para refinar los núcleos de detección fuera de línea. Además, los bloques de memoria externa pueden almacenar el código del programa y los datos utilizados por los núcleos de procesador suave en la FPGA. La placa soporta cuatro canales analógicos independientes muestreados a una velocidad de hasta 1 MS/s (millón de muestras por segundo). Estos canales, que cuentan con un micrófono electret (Panasonic WM64PNT), amplificadores con ganancia controlable (30-60 dB) y un convertidor analógico-digital serie de 12 bits (Analog Devices AD7476), se encuentran en placas pequeñas separadas que están conectadas a la placa principal del sensor con cables de cinta. Esta partición permite el uso de canales de audio verdaderamente diferentes (por ejemplo: frecuencia de muestreo más lenta, ganancia o rango dinámico diferentes) y también resulta en mediciones menos ruidosas al evitar largas rutas de señal analógica. La plataforma del sensor ofrece un amplio conjunto de interfaces y puede integrarse con sistemas existentes de diversas formas. Un puerto RS232 y un enlace inalámbrico Bluetooth (BlueGiga WT12) con emulación de UART virtual están directamente disponibles en la placa y proporcionan medios simples para conectar el sensor a computadoras y PDAs. La interfaz mote consiste en un bus I2C junto con una línea de interrupción y GPIO (esta última se utiliza para la sincronización precisa del tiempo entre la placa y el mote). Los motes están equipados con transceptores de radio compatibles con IEEE 802.15.4 y admiten redes inalámbricas ad-hoc entre los nodos y hacia/desde la estación base. La placa de sensores también admite transferencias USB de alta velocidad (con dongles USB personalizados) para subir muestras de audio grabadas a la PC. La cadena JTAG integrada, accesible directamente a través de un conector dedicado, contiene la parte del FPGA y la memoria de configuración y proporciona facilidades de programación y depuración en el sistema. El módulo de brújula digital integrado Honeywell HMR3300 proporciona información de rumbo, inclinación y balance con una precisión de 1◦, lo cual es esencial para calcular y combinar estimaciones direccionales de los eventos detectados. Debido a los complejos requisitos de voltaje de la FPGA, la circuitería de suministro de energía se implementa en la placa del sensor y proporciona energía tanto localmente como al nodo. Utilizamos un paquete cuádruple de pilas recargables tipo AA como fuente de energía (aunque cualquier otra configuración viable que cumpla con los requisitos de voltaje es aceptable). Los voltajes del núcleo de la FPGA (1.2 V) y de entrada/salida (3.3 V) son generados por un regulador conmutado buck altamente eficiente. La configuración del FPGA (2.5 V) y una red de alimentación separada de 3.3 V son alimentadas por LDOs de baja corriente, este último se utiliza para proporcionar energía independiente al mote y a la radio Bluetooth. Los reguladores, excepto el último, pueden encenderse/apagarse desde el mote o a través de la radio Bluetooth (a través de las líneas GPIO) para ahorrar energía. El primer prototipo de nuestro sistema empleó 10 nodos sensores. Algunos de estos nodos fueron montados en cascos militares de kevlar con los micrófonos directamente unidos a la superficie a una separación de aproximadamente 20 cm, como se muestra en la Figura 3(a). El resto de los nodos fueron montados en cajas de plástico (Figura 3(b)) con los micrófonos colocados cerca de las esquinas de las cajas para formar rectángulos de aproximadamente 5 cm × 10 cm. 4. La aplicación del sensor se basa en tres subsistemas que explotan tres paradigmas informáticos diferentes, tal como se muestra en la Figura 4. Aunque cada uno de estos modelos de ejecución se adapta extremadamente bien a sus tareas específicas de dominio, esta diversidad presenta un desafío para el desarrollo de software e integración de sistemas. El subsistema de fusión de sensores y la interfaz de usuario se están ejecutando en PDAs y fueron implementados en Java. Las tareas de detección y procesamiento de señales son ejecutadas por un FPGA, que también actúa como puente entre varios canales de comunicación cableados e inalámbricos. La comunicación entre nodos ad-hoc, la sincronización de tiempo y el intercambio de datos son responsabilidades de un módulo de radio basado en microcontrolador. De igual manera, la aplicación emplea una amplia variedad de protocolos de comunicación como Bluetooth y enlaces inalámbricos IEEE 802.14.5, así como buses UARTs, I2C y/o USB opcionales. Dispositivo operado por soldados (PDA/Laptop) Placa de sensores FPGA Módulo de radio Mica Enlace inalámbrico de 2.4 GHz Enrutamiento de mensajes de control de radio Codificador de eventos acústicos Sincronización de tiempo de sensores. Sincronización de tiempo de red. Control remoto. Estampado de tiempo. Interrupciones. Interfaz de registro virtual. C O O R D I N A D O R A. Canales analógicos. Brújula. PicoBlaze. Comunicación. Interfaz PicoBlaze WT12 Radio Bluetooth MOTE IF:I2C, Interrupciones USB PSRAM U A R T U A R T MB det SW det REC Enlace Bluetooth Interfaz de Usuario Fusión de Sensores Motor de Localización GPS Mensaje (Des)Ensamblador de Sensores Control de Sensores Figura 4: Diagrama de arquitectura de software. El módulo de fusión de sensores recibe y desempaqueta las mediciones en bruto (marcas de tiempo y vectores de características) de la placa de sensores a través de la conexión Bluetooth. Además, ajusta finamente la ejecución de los núcleos de procesamiento de señales al establecer parámetros a través del mismo enlace. Ten en cuenta que las mediciones de otros nodos, junto con su información de ubicación y orientación, también llegan desde la placa de sensores, que actúa como una pasarela entre la PDA y la red de sensores. El dispositivo portátil obtiene sus propios datos de ubicación GPS y recibe directamente información de orientación a través de la placa del sensor. Los resultados de la fusión de sensores se muestran en la pantalla del PDA con baja latencia. Dado que la aplicación está implementada en Java puro, es portátil en diferentes plataformas de PDA. La frontera entre el software y el hardware está considerablemente difuminada en la placa del sensor. Los núcleos IP implementados en lenguajes de descripción de hardware (HDL) en la tela FPGA reconfigurable se asemejan estrechamente a bloques de construcción de hardware. Sin embargo, algunos de ellos, especialmente los núcleos de procesador suave, ejecutan programas de software reales. Las tareas principales del software de la placa del sensor son 1) adquirir muestras de datos de los canales analógicos, 2) procesar datos acústicos (detección) y 3) proporcionar acceso a los resultados y parámetros en tiempo de ejecución a través de diferentes interfaces. Como se muestra en la Figura 4, un archivo de registro virtual centralizado contiene la lógica de decodificación de direcciones, los registros para almacenar valores de parámetros y resultados, y los buses de datos punto a punto hacia y desde los periféricos. Por lo tanto, integra de manera efectiva los bloques de construcción dentro de la placa del sensor y desacopla las diversas interfaces de comunicación. Esta arquitectura nos permitió desplegar el mismo conjunto de sensores en un escenario centralizado, donde la red de motes ad-hoc (utilizando la interfaz I2C) recopilaba y enviaba los resultados a una estación base, o construir un sistema descentralizado donde las PDAs locales ejecutan la fusión de sensores en los datos obtenidos a través de la interfaz Bluetooth (y opcionalmente de otros sensores a través de la interfaz de mote). El mismo conjunto de registros también es accesible a través de un enlace UART con un programa de emulación de terminal. Además, debido a que las interfaces de bajo nivel están ocultas por el archivo de registros, uno puede fácilmente agregar/reemplazarlas con nuevas (por ejemplo: la primera generación de motas soportaba un bus de interfaz estándar μP en el conector del sensor, el cual fue eliminado en diseños posteriores). Los resultados más importantes son los sellos de tiempo de los eventos detectados. Estos sellos de tiempo y toda otra información de temporización (parámetros, características de eventos acústicos) se basan en un reloj de 1 MHz y un temporizador interno en la FPGA. La conversión de tiempo y sincronización entre la red de sensores y la placa es realizada por el mote al solicitar periódicamente la captura del valor actual del temporizador a través de una línea GPIO dedicada y leer el valor capturado del archivo de registro a través de la interfaz I2C. Basándose en las lecturas actuales y anteriores y los sellos de tiempo locales correspondientes del mote, este puede calcular y mantener el factor de escala y el desplazamiento entre los dos dominios de tiempo. La interfaz mote está implementada por el núcleo IP esclavo I2C y una capa de adaptación delgada que proporciona una abstracción de bus de datos y direcciones encima de él. El ancho de banda efectivo máximo es de 100 Kbps a través de esta interfaz. El FPGA también contiene varios núcleos UART: para comunicarse con el módulo Bluetooth integrado, para controlar la brújula digital y para proporcionar una conexión cableada RS232 a través de un conector dedicado. Los registros de control, estado y datos de los módulos UART están disponibles a través del archivo de registros. Los protocolos de nivel superior en estas líneas son implementados por núcleos de microcontrolador Xilinx PicoBlaze [13] y programas de software correspondientes. Uno de ellos proporciona una interfaz de línea de comandos para propósitos de prueba y depuración, mientras que el otro es responsable de analizar lecturas de brújula. Por defecto, están conectados al puerto RS232 y a la línea de la brújula digital integrada respectivamente, sin embargo, pueden ser cableados a cualquier interfaz de comunicación cambiando la dirección base del archivo de registro en los programas (por ejemplo, la interfaz de línea de comandos puede ser proporcionada a través del canal Bluetooth). Dos de las interfaces externas no son accesibles a través del archivo de registro: un enlace USB de alta velocidad y la interfaz SRAM están conectados al bloque del grabador. El módulo USB implementa un simple FIFO con líneas de datos paralelas conectadas a un controlador de dispositivo USB externo FT245R. El controlador de RAM implementa ciclos de lectura/escritura de datos con el tiempo correcto y está conectado a la pseudo SRAM integrada en la placa. Estas interfaces proporcionan un ancho de banda efectivo de 1 MB/s para descargar muestras de audio grabadas, por ejemplo. Las rutas de adquisición de datos y procesamiento de señales muestran una clara simetría: el mismo conjunto de núcleos IP se instancian cuatro veces (es decir, el número de canales acústicos) y se ejecutan de forma independiente. Las rutas de señal se encuentran justo antes del archivo de registros. Cada uno de los canales analógicos es controlado por un núcleo A/D serie para proporcionar un reloj serie de 20 MHz y desplazar muestras de datos de 8 bits a 1 MS/s, y un controlador de potenciómetro digital para ajustar la ganancia requerida. Cada canal tiene su propio detector de onda de choque y explosión de boca de fuego, los cuales se describen en la Sección 5. Los detectores obtienen los valores de los parámetros de tiempo de ejecución del archivo de registros y también almacenan sus resultados allí. El núcleo del coordinador monitorea constantemente los resultados de detección y genera una interrupción de mote de manera inmediata al completarse la detección total o después de un tiempo de espera razonable tras la detección parcial. El componente de grabación no se utiliza en la implementación final, sin embargo, es esencial para propósitos de desarrollo para refinar los valores de los parámetros para nuevos tipos de armas u otras fuentes acústicas. Este componente recibe las muestras de todos los canales y las almacena en búferes circulares en el dispositivo PSRAM. Si la amplitud de la señal en uno de los canales cruza un umbral predefinido, el componente grabador suspende la recolección de muestras con un retraso predefinido y descarga el contenido de los buffers a través del enlace USB. La longitud de estos búferes y retrasos, la tasa de muestreo, el nivel de umbral y el conjunto de canales grabados pueden ser (re)configurados en tiempo de ejecución a través del archivo de registros. Ten en cuenta que el núcleo opera de forma independiente de los otros módulos de procesamiento de señales, por lo tanto, se puede utilizar para validar los resultados de detección fuera de línea. Los núcleos de FPGA están implementados en VHDL, los programas de PicoBlaze se escriben en ensamblador. La configuración completa ocupa el 40% de los recursos (slices) de la FPGA y la velocidad máxima del reloj es de 30 MHz, que es seguramente más alta que la velocidad utilizada con el dispositivo actual (20 MHz). Los nodos MICAz son responsables de distribuir los datos de medición a lo largo de la red, lo que mejora drásticamente los resultados de localización y clasificación en cada nodo. Además de una capa de radio (MAC) robusta, los motes requieren dos servicios de middleware esenciales para lograr este objetivo. Los mensajes deben ser propagados en la red ad-hoc multihop utilizando un servicio de enrutamiento. Integramos con éxito el Marco de Enrutamiento de Inundación Dirigida (DFRF) [9] en nuestra aplicación. Además de la agregación automática de mensajes y la gestión eficiente de búferes, la característica más única de DFRF es su arquitectura de plug-ins, que acepta políticas de enrutamiento personalizadas. Las políticas de enrutamiento son máquinas de estado que regulan cómo se almacenan, reenvían o descartan los mensajes recibidos. Los ejemplos de políticas incluyen enrutamiento de árbol de expansión, difusión, enrutamiento geográfico, etc. Diferentes políticas pueden ser utilizadas para diferentes mensajes simultáneamente, y la aplicación puede cambiar las políticas subyacentes en tiempo de ejecución (por ejemplo, debido al cambio del entorno de RF o presupuesto de energía). De hecho, alternamos varias veces entre una política de difusión simple pero lujosa y un enrutamiento de gradiente más eficiente en el campo. La correlación de las mediciones de ToA requiere una base de tiempo común y una sincronización precisa en la red de sensores. El protocolo de Sincronización de Tiempo Integrado en Enrutamiento (RITS) [15] se basa en marcas de tiempo muy precisas a nivel de MAC para incrustar el retraso acumulado que un mensaje de datos ha acumulado desde el momento de la detección en el propio mensaje. Es decir, en cada nodo mide el tiempo que el mensaje pasó allí y lo suma al número en la ranura de retraso de tiempo del mensaje, justo antes de que salga del nodo actual. Cada nodo receptor puede restar el retraso de su tiempo actual para obtener el tiempo de detección en su referencia horaria local. El servicio proporciona una conversión de tiempo muy precisa (con un error de unos pocos μs por salto), lo cual es más que adecuado para esta aplicación. Ten en cuenta que los motes también necesitan convertir las marcas de tiempo de la placa de sensores a la hora del mote, tal como se describe anteriormente. La aplicación mote está implementada en nesC [5] y se ejecuta sobre TinyOS [6]. Con sus 3 KB de RAM y requisito de espacio de programa de 28 KB (ROM), se adapta fácilmente a los motes MICAz. ALGORITMO DE DETECCIÓN Existen varias características de las ondas de choque acústico y explosiones de boca de fuego que distinguen sus algoritmos de detección y procesamiento de señales de las aplicaciones de audio regulares. Ambos eventos son transitorios por naturaleza y presentan estímulos muy intensos a los micrófonos. Esto se vuelve cada vez más problemático con los micrófonos electret de bajo costo diseñados para captar el habla o la música regular. Aunque el amortiguamiento mecánico de las membranas del micrófono puede mitigar el problema, este enfoque no está exento de efectos secundarios. Los algoritmos de detección deben ser lo suficientemente robustos para manejar distorsiones no lineales severas y oscilaciones transitorias. Dado que la firma de la explosión del cañón sigue de cerca la señal de la onda de choque y debido a posibles ráfagas de armas automáticas, es extremadamente importante ajustar los canales de audio y la lógica de detección lo antes posible después de un evento. Además, la estimación precisa del ángulo de llegada requiere una alta frecuencia de muestreo (en el rango de MHz) y una detección precisa de eventos. Además, la lógica de detección necesita procesar múltiples canales en paralelo (4 canales en nuestro hardware existente). Estos requisitos dictaron algoritmos simples y robustos tanto para la detección de la explosión de la boca del cañón como de la onda de choque. En lugar de utilizar detectores de energía mundanos, que podrían no ser capaces de distinguir los dos eventos diferentes, los detectores aplicados se esfuerzan por encontrar las características más importantes de las dos señales en el dominio del tiempo utilizando lógica de máquina de estados simples. Los detectores se implementan como núcleos IP independientes dentro de la FPGA, un par para cada canal. Los núcleos son configurables en tiempo de ejecución y proporcionan señales de eventos de detección con marcas de tiempo de alta precisión y vectores de características específicas del evento. Aunque los núcleos funcionan de forma independiente y en paralelo, un módulo de fusión local rudimentario los integra al apagar aquellos núcleos que no cumplieron con sus eventos después de un tiempo de espera razonable y al generar un único mensaje de detección hacia el mote. En este punto, el mote puede leer y reenviar los tiempos de detección y características, y es responsable de reiniciar los núcleos posteriormente. Las características más conspicuas de una onda de choque acústica (ver Figura 5(a)) son los bordes de subida pronunciados al principio y al final de la señal. Además, la longitud de la onda N es bastante predecible, tal como se describe en la Sección 6.5, y es relativamente corta (200-300 μs). El núcleo de detección de ondas de choque está buscando continuamente dos flancos ascendentes dentro de un intervalo dado. La máquina de estados del algoritmo se muestra en la Figura 5(b). Los parámetros de entrada son la pendiente mínima de los bordes (D, E) y los límites en la longitud de la onda (Lmin, Lmax). La única característica calculada por el núcleo es la longitud de la señal de la onda de choque observada. A diferencia de las ondas de choque, las firmas de explosión del cañón se caracterizan por un largo período inicial (1-5 ms) donde el primer semiperíodo es significativamente más corto que el segundo [4]. Debido a las limitaciones físicas de la circuitería analógica descrita al principio de esta sección, pueden aparecer oscilaciones irregulares y fallas dentro de esta ventana de tiempo más larga, como se puede ver claramente en la Figura 6(a). Por lo tanto, el verdadero desafío para el núcleo de detección de coincidencias es identificar adecuadamente los períodos de la primera y segunda mitad. La máquina de estados (Figura 6(b)) no trabaja directamente con las muestras en bruto, sino que es alimentada por un codificador de cruce por cero (ZC). Después de la activación inicial, el detector intenta recopilar aquellos segmentos de ZC que pertenecen al primer período (amplitud positiva) mientras descarta segmentos demasiado cortos (en nuestra terminología: basura), implementando efectivamente un filtro paso bajo rudimentario en el dominio de ZC. Después de encontrar un segmento negativo lo suficientemente largo, ejecuta la misma lógica de recolección para la segunda mitad del período. Si se descarta demasiada basura en las fases de recolección, el núcleo se reinicia para evitar la detección (falsa) de las mitades de períodos completamente diferentes separados por una oscilación rápida o ruido. Finalmente, si se cumplen las restricciones en la longitud total y en la proporción de longitud, el núcleo genera un evento de detección junto con la longitud real, la amplitud y la energía del período calculadas simultáneamente. El mecanismo de activación inicial se basa en dos umbrales de amplitud: uno estático (pero configurable) y otro calculado dinámicamente. El último es esencial para adaptar el sensor a diferentes entornos de ruido ambiental y para suspender temporalmente el detector de explosiones de boca después de un evento de onda de choque (las oscilaciones en la sección analógica o las reverberaciones en el recinto del sensor de lo contrario podrían desencadenar detecciones falsas de explosiones de boca). El nivel dinámico de ruido se estima mediante un filtro pasa bajos recursivo de un solo polo (corte @ 0.5 kHz) en el FPGA. 117 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 Tiempo (µs) Amplitud Explosión de boca (M16) 1 2 3 4 5 len2 + len1 (a) INACTIVO 1 SEGUNDO ZC 3 ZC PENDIENTE 4 PRIMER ZC 2 ENCONTRADO 5 umbral de amplitud ZC positivo largo ZC negativo largo período completo válido basura máxima basura signo incorrecto recolección de basura primer período recolección de basura primer período basura (b) Figura 6: Firma de explosión de boca (a) producida por un rifle de asalto M16 y la lógica de detección correspondiente (b). Los núcleos de detección fueron originalmente implementados en Java y evaluados en señales pregrabadas debido a la ejecución de pruebas mucho más rápida y a instalaciones de depuración más convenientes. Más tarde, fueron trasladados a VHDL y sintetizados utilizando la suite de herramientas Xilinx ISE. La equivalencia funcional entre las dos implementaciones fue probada mediante bancos de pruebas VHDL y scripts de Python que proporcionaron una forma automatizada de poner en funcionamiento los núcleos de detección en el mismo conjunto de señales pregrabadas y comparar los resultados. 6. La fusión de sensores El algoritmo de fusión de sensores recibe mensajes de detección de la red de sensores y estima la trayectoria de la bala, la posición del tirador, el calibre del proyectil y el tipo de arma. El algoritmo consiste en tareas computacionales bien separadas detalladas a continuación: 1. Calcular la dirección de llegada de la explosión de la boca y la onda de choque para cada sensor individual (ver 6.1). 2. Calcular estimaciones de rango. Este algoritmo puede fusionar analíticamente un par de estimaciones de ángulo de ataque de onda de choque y explosión de boca de fuego. (ver 6.2). 3. Calcular una única trayectoria a partir de todas las mediciones de ondas de choque (ver 6.3). 4. Si la trayectoria está disponible, calcular el alcance (ver 6.4). De lo contrario, calcular primero la posición del tirador y luego la trayectoria basada en ella (ver 6.4). 5. Si la trayectoria está disponible, calcular el calibre (ver 6.5). 6. Si el calibre está disponible, calcular el tipo de arma (ver 6.6). Describimos cada paso en las siguientes secciones en detalle. 6.1 Dirección de llegada El primer paso de la fusión de sensores es calcular el ángulo de llegada del estampido y la onda de choque AoA-s para cada placa de sensor. Cada placa de sensores tiene cuatro micrófonos que miden los ToA-s. Dado que el espaciado de los micrófonos es órdenes de magnitud más pequeño que la distancia a la fuente de sonido, podemos aproximar la onda sonora que se acerca con un plano (suposición de campo lejano). Formalicemos primero el problema para 3 micrófonos. Que P1, P2 y P3 sean las posiciones de los micrófonos ordenadas por el tiempo de llegada t1 < t2 < t3. Primero aplicamos un paso de validación de geometría simple. La diferencia de tiempo medida entre dos micrófonos no puede ser mayor que el tiempo de propagación del sonido entre los dos micrófonos: |ti − tj| <= |Pi − Pj |/c + ε Donde c es la velocidad del sonido y ε es el error máximo de medición. Si esta condición no se cumple, las detecciones correspondientes son descartadas. Sea v(x, y, z) el vector normal de la dirección de llegada desconocida. También usamos r1(x1, y1, z1), el vector de P1 a P2 y r2(x2, y2, z2), el vector de P1 a P3. Consideremos la proyección de la dirección del movimiento del frente de onda (v) en r1 dividida por la velocidad del sonido (c). Esto nos da cuánto tiempo tarda el frente de onda en propagarse de P1 a P2: vr1 = c(t2 − t1) La misma relación se cumple para r2 y v: vr2 = c(t3 − t1) También sabemos que v es un vector normal: vv = 1 Pasar de vectores a coordenadas utilizando la definición del producto punto nos lleva a un sistema cuadrático: xx1 + yy1 + zz1 = c(t2 − t1) xx2 + yy2 + zz2 = c(t3 − t1) x2 + y2 + z2 = 1 Omitimos los pasos de la solución aquí, ya que son directos pero largos. Hay dos soluciones (si la fuente está en el plano P1P2P3, las dos soluciones coinciden). Utilizamos la cuarta medición de los micrófonos, si existe, para eliminar uno de ellos. De lo contrario, ambas soluciones se consideran para su procesamiento adicional. 6.2 Fusión de choque de boca u v 11, tP 22, tP tP, 2P′ Trayectoria de la bala Figura 7: Plano de sección de un disparo (en P) y dos sensores (en P1 y en P2). Un sensor detecta los estallidos de boca, el otro el tiempo y la dirección de llegada de las ondas de choque. Considera la situación en la Figura 7. Un disparo fue realizado desde P en el momento t. Tanto P como t son desconocidos. Tenemos una detección de la explosión de la boca del cañón y una detección de la onda de choque por dos sensores diferentes 118 con información de AoA y, por lo tanto, información de ToA disponible. La detección de la explosión del freno de boca se encuentra en la posición P1 con el tiempo t1 y el ángulo de ataque u. La detección de la onda de choque está en P2 con el tiempo t2 y el ángulo de ataque v. u y v son vectores normales. Se muestra a continuación que estas medidas son suficientes para calcular la posición del tirador (P). Que P2 sea el punto en la superficie extendida del cono de onda de choque donde PP2 es perpendicular a la superficie. Ten en cuenta que PP2 es paralelo a v. Dado que P2 está en la superficie del cono que alcanza a P2, un sensor en P2 detectaría el mismo tiempo de llegada de la onda de choque (t2). La superficie del cono se desplaza a la velocidad del sonido (c), por lo que podemos expresar P usando P2: P = P2 + cv(t2 − t). P también se puede expresar a partir de P1: P = P1 + cu(t1 − t) resultando en P1 + cu(t1 − t) = P2 + cv(t2 − t). P2P2 es perpendicular a v: (P2 − P2)v = 0, lo que da como resultado (P1 + cu(t1 − t) − cv(t2 − t) − P2)v = 0, que contiene solo una incógnita t. Se obtiene: t = (P1−P2)v c +uvt1−t2 uv−1. Desde aquí podemos calcular la posición más corta P. Consideremos el caso especial de un solo sensor donde P1 = P2 (un sensor detecta tanto la onda de choque como el ángulo de llegada de la explosión del cañón). En este caso: t = uvt1−t2 uv−1. Dado que u y v no se utilizan por separado, solo uv, la orientación absoluta del sensor puede ser arbitraria, aún obtenemos t que nos da el rango. Aquí asumimos que la onda de choque es un cono, lo cual solo es cierto para velocidades constantes del proyectil. En realidad, el ángulo del cono crece lentamente; la superficie se asemeja a la mitad de un balón de fútbol americano. La bala que se desacelera resulta en una diferencia de tiempo más pequeña entre las detecciones de la onda de choque y la explosión en la boca del cañón porque la generación de la onda de choque se ralentiza con la bala. Una diferencia de tiempo más pequeña resulta en un rango más pequeño, por lo que la fórmula anterior subestima el verdadero rango. Sin embargo, aún se puede utilizar con una función de corrección de desaceleración adecuada. Dejamos esto para trabajos futuros. 6.3 Estimación de trayectoria Danicki demostró que la trayectoria y la velocidad de la bala se pueden calcular analíticamente a partir de dos mediciones independientes de ondas de choque donde se miden tanto el ToA como el AoA [2]. El método se vuelve más sensible a los errores de medición a medida que las dos direcciones de onda de choque se acercan entre sí. En el caso especial en el que ambas direcciones sean iguales, la trayectoria no se puede calcular. En una aplicación del mundo real, los sensores suelen ser desplegados en un avión aproximadamente. En este caso, todos los sensores ubicados en un lado de la trayectoria miden casi el mismo ángulo de ataque de la onda de choque. Para evitar este problema de sensibilidad al error, consideramos pares de mediciones de ondas de choque solo si la diferencia en la dirección de llegada es mayor que un umbral específico. Tenemos múltiples sensores y un sensor puede reportar dos direcciones diferentes (cuando solo tres micrófonos detectan la onda de choque). Por lo tanto, típicamente tenemos varios candidatos de trayectoria, es decir, uno para cada par de AoA por encima del umbral. Aplicamos un método de filtrado de valores atípicos y promediado para fusionar la dirección de la onda de choque y la información de tiempo y obtener una única trayectoria. Supongamos que tenemos N mediciones individuales del ángulo de ataque de la onda de choque. Tomemos todos los pares posibles sin ordenar donde la diferencia de dirección esté por encima del umbral mencionado y calculemos la trayectoria para cada uno. Esto nos da como máximo N(N−1) 2 trayectorias. Una trayectoria está representada por un punto pi y el vector normal vi (donde i es el índice de la trayectoria). Definimos la distancia de dos trayectorias como el producto punto de sus vectores normales: D(i, j) = vivj Para cada trayectoria se define un conjunto de vecinos: N(i) := {j|D(i, j) < R} donde R es un parámetro de radio. El conjunto de vecinos más grande se considera el conjunto central C, todas las demás trayectorias son valores atípicos. El conjunto central se puede encontrar en tiempo O(N2). Las trayectorias en el conjunto central se promedian para obtener la trayectoria final. Puede suceder que no podamos formar ningún par de sensores debido al umbral de diferencia de dirección. Significa que todos los sensores están en el mismo lado de la trayectoria. En este caso, primero calculamos la posición del tirador (descrita en la siguiente sección) que fija p haciendo que v sea el único desconocido. Para encontrar v en este caso, utilizamos una búsqueda en una rejilla de alta resolución y minimizamos una función de error basada en las direcciones de las ondas de choque. Hemos realizado experimentos para utilizar la longitud de la onda de choque medida en la estimación de la trayectoria. Hay algunos resultados prometedores, pero necesita más investigación. 6.4 Estimación de la posición del tirador El algoritmo de estimación de la posición del tirador agrega la siguiente información heterogénea generada por pasos computacionales anteriores: 1. trayectoria, 2. tiempo de llegada del estampido del cañón en un sensor, 3. ángulo de llegada del estampido del cañón en un sensor, que efectivamente es una estimación de la dirección al tirador, y 4. estimación de la distancia en un sensor (cuando tanto la onda de choque como el ángulo de llegada del estampido del cañón están disponibles). Algunos sensores reportan solo el tiempo de llegada (ToA), algunos también tienen estimaciones de dirección y algunos también tienen estimaciones de rango, dependiendo del número de detecciones exitosas de la explosión y la onda de choque por parte del sensor. Para un ejemplo, consulte la Figura 8. Ten en cuenta que un sensor puede tener dos estimaciones diferentes de rumbo y alcance. 3 detecciones dan dos posibles ángulos de llegada para la explosión de la boca de fuego (es decir, rumbo) y/o la onda de choque. Además, la combinación de dos ángulos de ataque de onda de choque y explosión de boca de fuego diferentes puede resultar en dos rangos distintos. 119 11111 ,,,, rrvvt ′′ 22 ,vt 333 ,, vvt ′ 4t 5t 6t trayectoria de bala posición del tirador Figura 8: Ejemplo de datos de entrada heterogéneos para el algoritmo de estimación de la posición del tirador. Todos los sensores tienen mediciones de ToA (t1, t2, t3, t4, t5), un sensor tiene una única estimación de dirección (v2), un sensor tiene dos posibles direcciones (v3, v3) y un sensor tiene dos estimaciones de dirección y dos de rango (v1, v1, r1, r1). En un entorno de multipercusión, estas detecciones no solo contendrán ruido gaussiano, sino también posiblemente grandes errores debido a ecos. Se ha demostrado en nuestro trabajo anterior que un problema similar puede resolverse eficientemente con un algoritmo de búsqueda por bisección basado en aritmética de intervalos [8]. La idea básica es definir una función de consistencia discreta sobre el área de interés y subdividir el espacio en cajas tridimensionales. Para cualquier caja tridimensional dada, esta función proporciona el número de mediciones que respaldan la hipótesis de que el tirador estaba dentro de esa caja. La búsqueda comienza con una caja lo suficientemente grande como para contener toda el área de interés, luego se acerca dividiendo y evaluando cajas. La caja con la máxima consistencia se divide hasta alcanzar la precisión deseada. El retroceso es posible para evitar quedarse atascado en un máximo local. Este enfoque ha demostrado ser lo suficientemente rápido para el procesamiento en línea. Sin embargo, hay que tener en cuenta que cuando la trayectoria ya ha sido calculada en pasos anteriores, la búsqueda solo debe realizarse en la trayectoria, lo que la hace ser órdenes de magnitud más rápida. A continuación, describamos detalladamente cómo se calcula la función de consistencia. Consideremos B, una caja tridimensional, cuyo valor de consistencia nos gustaría calcular. Primero consideramos solo la información de ToA. Si un sensor tiene múltiples detecciones de ToA, utilizamos el promedio de esos tiempos, de modo que un sensor suministra como máximo una estimación de ToA. Para cada ToA, podemos calcular el tiempo correspondiente del disparo, ya que se asume que el origen está en la caja B. Dado que se trata de una caja y no de un punto único, esto nos proporciona un intervalo para el tiempo de disparo. El número máximo de intervalos de tiempo superpuestos nos da el valor de la función de consistencia para B. Para obtener una descripción detallada de la función de consistencia y el algoritmo de búsqueda, consulte [8]. Aquí extendemos el enfoque de la siguiente manera. Modificamos la función de consistencia basándonos en los datos de rumbo y alcance de los sensores individuales. Una estimación de orientación apoya a B si el segmento de línea que parte del sensor con la dirección medida intersecta la caja B. Un rango soporta a B, si la esfera con el radio del rango y el origen del sensor intersecta a B. En lugar de simplemente verificar si la posición especificada por los pares de rumbo-distancia correspondientes cae dentro de B, esto elimina el posible error de orientación de los sensores. El valor de la función de consistencia se incrementa en uno por cada estimación de dirección y rango que sea consistente con B. 6.5 <br>Estimación de calibre</br> Las características de la señal de onda de choque han sido estudiadas anteriormente por Whitham [20]. Mostró que el período de la onda de choque T está relacionado con el diámetro del proyectil d, la longitud l, la distancia perpendicular de error b desde la trayectoria de la bala hasta el sensor, el número de Mach M y la velocidad del sonido c. T = 1.82Mb1/4 c(M2−1)3/8 d l1/4 ≈ 1.82d c (Mb l )1/4 0 100 200 300 400 500 600 0 10 20 30 distancia de error (m)longitud de la onda de choque (microsegundos) .50 cal 5.56 mm 7.62 mm Figura 9: Relación entre la longitud de la onda de choque y la distancia de error. Cada punto de datos representa una placa de sensor después de una agregación de las mediciones individuales de los cuatro canales acústicos. Se han probado tres proyectiles de diferentes calibres (196 disparos, 10 sensores). Para ilustrar la relación entre la distancia de error y la longitud de la onda de choque, aquí utilizamos los 196 disparos con proyectiles de tres calibres diferentes disparados durante la evaluación. (Durante la evaluación utilizamos datos obtenidos previamente con unos pocos disparos de práctica por arma). 10 sensores (4 micrófonos por sensor) midieron la longitud de la onda de choque. Para cada sensor, consideramos válida la estimación de la longitud de la onda de choque si al menos tres de los cuatro micrófonos estuvieron de acuerdo en un valor con una variación de máximo 5 microsegundos. Este filtrado resulta en una tasa de informes del 86% por sensor y elimina los errores de medición grandes. Los datos experimentales se muestran en la Figura 9. La fórmula de Whitham sugiere que la longitud de la onda de choque para un calibre dado puede aproximarse con una función de potencia de la distancia errónea (con un exponente de 1/4). Las funciones de mejor ajuste en nuestros datos son: .50 cal: T = 237.75b0.2059 7.62 mm: T = 178.11b0.1996 5.56 mm: T = 144.39b0.1757 Para evaluar un disparo, tomamos el calibre cuya función de aproximación resulte en el menor error cuadrático medio de las lecturas del sensor filtradas. Este método tiene menos del 1% de error en la <br>estimación del calibre</br> cuando se dispone de una estimación precisa de la trayectoria. ",
            "candidates": [],
            "error": [
                [
                    "precisión de estimación de calibre",
                    "estimación del calibre",
                    "estimar el calibre",
                    "Estimación de calibre",
                    "estimación del calibre"
                ]
            ]
        }
    }
}