{
    "id": "J-73",
    "original_text": "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books. We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading. Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1. INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained. The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis. One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading. Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume. In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP. Very large institutional trades constitute one of the main motivations behind VWAP activity. A typical scenario goes as follows. Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.) Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction. Thus, the fund manager would approach brokerages for help in selling the 1%. The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager? Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically. The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent. The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits. If they can beat the VWAP by a penny, they make two cents per share. Such small-margin, high-volume profits can be extremely lucrative for a large brokerage. The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper. The rows represent results for either the OWT or VWAP criterion. The columns represent which model we are working in. The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better. The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.) All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion. However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology. In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting. We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information. In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3]. Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets. Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges. While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data. Such data and algorithms are a topic of great current interest on Wall Street [4]. We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it. Our results are summarized in Figure 1 (see the caption for a summary). 2. THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades. While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has. This will be addressed in the order book model studied in the next section. A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration. The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close. While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street. The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval. In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms. More precisely, in this online model, we see the price-volume sequence one pair at a time. Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt. Let us assume that our goal is to sell N shares over the course of the day. Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT . In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream. Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold. If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue. In the order book model to follow, we do not allow fractional volumes.) In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP. The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt. If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N . Note that the market VWAP does not include the shares that the algorithm sells. The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max. We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account. It is easy to see that this makes it a more challenging criterion to track. In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance. In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely. In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day. As we shall see, there are some important commonalities and differences to these two approaches. For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S). However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price. Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting. We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin . For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin. For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions. To gain some intuition consider the two trivial cases of R = 1 and Q = 1. In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal. In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period. For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central. For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)). Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data. Theorem 1. In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q). In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)). Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1]. Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day. Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares. We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 . Clearly, one of the Ai has a competitive ratio of 2. We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.) We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems. Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2. To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem. The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ). Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval. Then in the VWAP sequence we set the volume vt = 2i−1 . If this is not the first visit to the interval containing pt, we set vt = 0. Assume that the maximum price in S is pmax . The VWAP of our sequence is at least pmax /3. Since we had a c competitive algorithm, its average sell is at least pmax /3c. The lower bound now follows using the lower bound in [3]. An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem. Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2. In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)). In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)). Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT. Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price. If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R). This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information. In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt). Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data. Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio. Theorem 3. In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)). The proofs of all the results in this subsection are in the Appendix. So far our emphasis has been on VWAP algorithms that must sell exactly N shares. In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold. For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices. The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model. It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1. Theorem 4. In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S). In many online problems, there is a clear distinction between benefit problems and cost problems [2]. In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem. The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively. Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem. Theorem 5. In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}). In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3. A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure. We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order. Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock. In a limit order, we specify not only the desired volume (1000 shares), but also the desired price. Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower. We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid). If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book). In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours. Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask). Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders. The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread. By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction. How then do orders get executed? There are two methods. First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book. Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares. For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09. The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book. Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books. It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed. Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously. This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order. It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock. Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order. We shall thus assume without loss of generality that all orders are placed as limit order. Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books. We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting. In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt). Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired. Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order. These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1. Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book. The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways. First, the assumption of infinite liquidity in the price-volume model is eliminated entirely. The number of shares available at any given price is restricted to the total volume of limit orders offering that price. Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm. This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4]. In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes. We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm). Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type). Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm. Note that the algorithm has the option of not placing an order, which we can view as a zero volume order. If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price. In each executed trade, the selling party is either the market or the algorithm. Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes. Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party. Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions. We generally expect T to be (possibly much) smaller than T . The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively. For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ . More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A. We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs. More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market. Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares). The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption. This is due to the fact that our algorithms trading can impact the high and low prices of the day. For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin. For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price. Theorem 6. In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N). Proof. The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).) By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price. Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares. We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders). Assume without loss of generality that p1 ≥ p2 ≥ . . .. Consider guessing the kth highest such price, pk. If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk. Let k∗ = argmaxk{kpk}. We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ]. Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk. Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement. Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A . We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ. Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices. To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase. First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share. After this modification, the top N prices p1 . . . pN will not decrease. This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price. For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease. We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease. If this sell order share was not executed, then the claim is trivially true. Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices. Hence, we have proven that for all A which sell N shares REVA ≤ ρ. We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7. In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)). We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption. The set of sequences Σ satisfies the following two properties. First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues). This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions. Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax . The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax . Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0). Theorem 8. Consider the order book model under the bounded order volume and max price assumption. There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof. The algorithm divides the trading day into volume intervals whose real-time duration may vary. For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi. Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi. More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . .. Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller. For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed. We now count the potential lost revenue of the algorithm due to unexecuted limit orders. By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded. Hence, after γN market orders have been executed, A has placed N orders in the market. Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above. This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed. Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level. A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / . Clearly our algorithm has sold at most N shares. Note that as N becomes large, VWAPA approaches 1 − times the market VWAP. If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1. If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss. The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption. We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume. More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax . Let Q = Vmax /Vmin . The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders. Corollary 9. In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP. The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E). We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively. The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively. The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement). Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4. MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms. We leave the generalization of these methods to the order book model for future work. The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ. It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence. We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ. In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume. More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) . Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V . Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) . Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p). Analogous buy-side definitions can be given. We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm. We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt). Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures. For this reason, we refer to such settings as the macroscopic distribution model. The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences. In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3). Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately. Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls. It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index. In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2. Let Pvol denote the distribution of total daily market volume. We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] . We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 . Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals). Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ]. Theorem 10. In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ). All proofs in this section are provided in the appendix. As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ]. In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight. In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio. On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier. In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks. We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available. Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) . C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0. Theorem 11. In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ). As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1. Thus our estimated bin index probabilities are all within a factor of α of the truth. Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5. REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en. Competitive non-preemptive call control. In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv. Online Computation and Competitive Analysis. Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin. Optimal search and one-way trading online algorithms. Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz. The Penn-Lehman automated trading project. IEEE Intelligent Systems, 2003. To appear. 6. APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V . Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T. Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0. The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin . Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound. Consider the following scenario. For the first T time units we have a price of √ Rpmin , and a total volume of Vmin . We observe how many shares the online algorithm has bought. If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin . Otherwise, the remaining time steps have price pmax and negligible volume. In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin . Therefore, in this case the competitive ratio is Ω(Q). In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2. The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R). For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin . The Q upper bound is derive by running an algorithm that assumes the volume is Vmin . The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume. In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V . Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i). Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2. This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol . We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem. Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198",
    "original_translation": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP. Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por acción. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading. Más precisamente, en este modelo en línea, observamos la secuencia de precio-volumen de a pares. Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt. Supongamos que nuestro objetivo es vender N acciones a lo largo del día. Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT. De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante. Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas. Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema). En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios. En el trading de VWAP, el objetivo de un algoritmo en línea A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado. El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt. Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N. Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo. El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo. Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales. Es fácil ver que esto lo convierte en un criterio más desafiante de seguir. A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado. En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes. En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día. Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques. Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S). Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio. Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto. Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin. Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones. Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1. En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo. En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo. Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP. Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)). Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios. Teorema 1. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q). Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier algoritmo en línea A para vender N acciones tiene RVWAP(A) = Ω(log(Q)). Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1]. Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día. Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones. Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1. Claramente, uno de los Ai tiene una proporción competitiva de 2. Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada). Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT. Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2. Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP. Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ). Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo. Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1. Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0. Suponga que el precio máximo en S es pmax. El VWAP de nuestra secuencia es al menos pmax /3. Dado que teníamos un algoritmo c competitivo, su venta promedio es al menos pmax /3c. El límite inferior ahora se sigue utilizando el límite inferior en [3]. Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT. Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191. En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)). Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)). Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT. Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo. Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R). Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen. Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt). Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario. Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso. Teorema 3. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)). Las pruebas de todos los resultados de esta subsección están en el Apéndice. Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones. En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender. Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución. El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo. Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1. Teorema 4. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S). En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2]. En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo. Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente. Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema. Teorema 5. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un algoritmo en línea A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}). Además, cualquier algoritmo en línea A para comprar N acciones tiene una proporción competitiva de compra VWAP Rbuy VWAP(A) = Ω(min{Q, √ R}). 3. Un modelo de trading de libro de órdenes limitadas. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado. Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la negociación de acciones es entre una orden limitada y una orden de mercado. Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT). En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado. Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 2, que muestra una captura de pantalla real de un libro de órdenes reciente de MSFT en Island (www.island.com), un conocido intercambio electrónico de acciones de NASDAQ), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos. Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta). Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (siendo las órdenes más antiguas las primeras en el libro). En el ejemplo proporcionado por la Figura 2, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra. De manera similar, se mantiene un libro de órdenes de venta para órdenes de límite de venta (por ejemplo, podríamos querer vender 500 acciones de MSFT a $24.10 o más) esta vez con el precio de venta más bajo ofrecido (a menudo denominado como el precio de venta). Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas. Los precios de oferta y demanda (que nuevamente, son simplemente los precios en las órdenes límite en la parte superior de los libros de compra y venta, respectivamente) a veces se denominan como el mercado interno, y la diferencia entre ellos como el spread. Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección. ¿Entonces, cómo se ejecutan las órdenes? Hay dos métodos. Primero, cada vez que llega una orden de mercado, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto. Por lo tanto, una orden de mercado para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones. Por ejemplo, en el ejemplo de la Figura 2, tal orden sería completada por las dos órdenes de venta límite de 500 acciones a $24.069, las 500 acciones a $24.07, las 200 acciones a $24.08, y luego 300 de las 1981 acciones a $24.09. Las 1681 acciones restantes de esta última orden límite permanecerían como el nuevo tope del libro de órdenes de venta límite. Segundo, si una orden de límite de compra (venta, respectivamente) entra por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con órdenes en los libros opuestos. Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato. Cada orden de mercado o límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que las órdenes llegan, y dos órdenes nunca pueden llegar simultáneamente. Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden. Es esta cantidad la que generalmente se quiere decir cuando la gente se refiere casualmente al precio de una acción (ticker). Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una orden de mercado. Por lo tanto, asumiremos sin pérdida de generalidad que todas las órdenes se colocan como órdenes límite. Aunque las órdenes límite que no se ejecutan pueden ser eliminadas por la parte que las colocó, para simplificar, asumimos que las órdenes límite nunca son eliminadas de los libros. Remitimos al lector a [4] para obtener más información sobre los intercambios electrónicos modernos y la microestructura del mercado. 3.2 El Modelo El modelo de negociación de libros de órdenes en línea tiene como objetivo capturar los detalles realistas de la microestructura del mercado recién discutidos en un entorno de relación competitiva. En este modelo refinado, la actividad del mercado de un día se describe por una secuencia de órdenes límite (pt, vt, bt). Aquí bt es un bit que indica si la orden es de compra o venta, mientras que pt es el precio de la orden límite y vt es el número de acciones deseado. Tras la llegada de cada orden límite de este tipo, se permite a un algoritmo de trading en línea colocar su propia orden límite. Estas dos fuentes entrelazadas (mercado y algoritmo) de órdenes límite son simplemente operadas de acuerdo con el proceso de emparejamiento descrito en la Sección 3.1. Cualquier orden límite que no sea ejecutable de inmediato según este proceso se coloca en el libro correspondiente (compra o venta) para una posible ejecución futura; las órdenes que llegan y pueden ser ejecutadas parcial o totalmente se ejecutan de esa manera, con cualquier acción residual que permanezca en el libro respectivo. El objetivo de un algoritmo de venta VWAP u OWT es esencialmente el mismo que en el modelo de precio-volumen, pero el contexto ha cambiado en las siguientes dos formas fundamentales. Primero, la suposición de liquidez infinita en el modelo de precio-volumen se elimina por completo. El número de acciones disponibles a cualquier precio dado está restringido al volumen total de órdenes límite que ofrecen ese precio. Segundo, se asume que todas las órdenes entrantes, y por lo tanto los libros completos de órdenes límite, son visibles para el algoritmo. Esto es coherente con los intercambios financieros electrónicos modernos, y de hecho es la fuente de mucho interés actual en Wall Street [4]. En general, la definición de las ratios competitivas en el modelo de libro de órdenes se complica por el hecho de que ahora nuestra actividad algorítmica influye en la secuencia de precios y volúmenes ejecutados. Por lo tanto, primero definimos la secuencia de ejecución determinada por una secuencia de órdenes límite (colocadas por el mercado y nuestro algoritmo). Sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por el mercado, y sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por nuestro algoritmo (a menos que se especifique lo contrario, todos los bt son de tipo venta). Sea merge(S, S) la secuencia fusionada (p1, v1, b1), (p1, v1, b1), . . . , (pT, vT, bT), (pT, vT, bT), que es la secuencia temporal de órdenes realizadas por el mercado y el algoritmo. Ten en cuenta que el algoritmo tiene la opción de no realizar un pedido, lo cual podemos considerar como un pedido de volumen cero. Si llevamos a cabo el mantenimiento del libro de órdenes y el proceso de ejecución de órdenes descrito en la Sección 3.1 en la fusión de secuencias (S, S), en intervalos irregulares se produce una operación de compra/venta de un cierto número de acciones a un determinado precio. En cada operación ejecutada, la parte vendedora es o bien el mercado o el algoritmo. Sea execM (S, S ) = (q1, w1), . . . , (qT , wT ) la secuencia de ejecuciones donde el mercado (es decir, una parte distinta al algoritmo) fue la parte vendedora, donde los qt son los precios de ejecución y wt los volúmenes de ejecución. De manera similar, definimos execA(S, S) = (r1, x1), . . . , (rT, xT) como la secuencia de ejecuciones en las que el algoritmo fue la parte vendedora. Por lo tanto, execA(S, S) ∪ execM(S, S) es el conjunto de todas las ejecuciones. Generalmente esperamos que T sea (posiblemente mucho) más pequeño que T. Los ingresos del algoritmo y del mercado se definen como: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt. Nótese que ambas cantidades están determinadas únicamente por las secuencias de ejecución execM (S, S ) y execA(S, S ), respectivamente. Para un algoritmo A que está limitado a vender exactamente N acciones, definimos la razón de competencia OWT de A, ROWT(A), como la razón máxima (bajo cualquier S ∈ Σ) de los ingresos obtenidos por A, en comparación con los ingresos obtenidos por un algoritmo óptimo fuera de línea A∗. De manera más formal, para A∗ que está limitado a vender exactamente N acciones, definimos ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) donde S∗ es la secuencia de órdenes límite colocadas por A∗ en S. Si el algoritmo A es aleatorio, entonces tomamos la expectativa apropiada con respecto a S ∼ A. Definimos la ratio competitiva VWAP, RVWAP(A), como la ratio máxima (bajo cualquier S ∈ Σ) entre los VWAPs del mercado y del algoritmo. Más formalmente, define VWAPM (S, S ) como REVM (S, S )/ T t=1 wt, donde el denominador es simplemente el volumen total ejecutado de órdenes colocadas por el mercado. De manera similar, definimos VWAPA(S, S) como REVA(S, S)/N, ya que asumimos que el algoritmo vende no más de N acciones (esta definición asume implícitamente que A obtiene un precio de 0 por las acciones no vendidas). El ratio competitivo VWAP de A es entonces: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} donde S es la secuencia en línea de órdenes límite generadas por A en respuesta a la secuencia S. 3.3 Resultados de OWT en el Modelo de Libro de Órdenes. Para el problema de OWT en el modelo de libro de órdenes, introducimos una versión más sutil de la suposición de variabilidad de precios. Esto se debe al hecho de que nuestro trading algorítmico puede afectar los precios altos y bajos del día. Para la suposición a continuación, tenga en cuenta que execM (S, ∅) es la secuencia de ejecuciones sin la interacción de nuestro algoritmo. 3.3.0.3 Suposición de Variabilidad del Precio del Libro de Órdenes. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios pt en la secuencia execM (S, ∅) cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Tenga en cuenta que esta suposición no implica que las ratios de precios altos a bajos bajo las secuencias execM (S, S ) o execA(S, S ) estén limitadas por R. De hecho, la ratio en la secuencia execA(S, S ) podría ser infinita si el algoritmo termina vendiendo algunas acciones a un precio de 0. Teorema 6. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de venta OWT ROWT(A) = 2 log(R) log(N). Prueba. El algoritmo A funciona al adivinar un precio p en el conjunto {pmin2i : 1 ≤ i ≤ log(R)} y colocar una orden de venta límite por todas las N acciones al precio p al comienzo del día. (Alternativamente, el algoritmo A puede colocar log(R) órdenes de venta límite, donde la i-ésima tiene un precio de 2i pmin y un volumen de N/ log(R).) Al realizar un pedido al comienzo del día, el algoritmo ofrece un precio más bajo que todos los pedidos de venta que se realizarán durante el día por un precio de p o superior, lo que significa que primero se deben completar las N acciones del algoritmo a este precio. Por lo tanto, si hubiera habido k acciones que se hubieran vendido a un precio p o superior sin nuestra actividad, entonces A vendería al menos kp acciones. Definimos {pj} como el multiconjunto de precios de acciones individuales que han sido ejecutadas o son acciones de órdenes de compra límite que permanecieron sin ejecutar, excluyendo la actividad de nuestro algoritmo (es decir, asumiendo que nuestro algoritmo no coloca órdenes). Suponga sin pérdida de generalidad que p1 ≥ p2 ≥ . . .. Considerar adivinar el k-ésimo precio más alto, pk. Si se coloca una orden de N acciones al comienzo del día a un precio pk, entonces estamos garantizados de obtener un retorno de kpk. Que k∗ = argmaxk{kpk}. Podemos ver nuestro algoritmo como intentando adivinar pk∗, y teniendo éxito si la suposición p satisface p ∈ [pk∗ /2, pk∗]. Por lo tanto, somos 2 log(R) competitivos con la cantidad max1≤k≤N kpk. Se debe tener en cuenta que ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk donde ρ se define como la suma de los N precios principales pi sin la participación de A. De manera similar, sea {pj} el multiconjunto de precios de las acciones individuales ejecutadas, o los precios de las acciones de órdenes de compra no ejecutadas, pero ahora incluyendo las órdenes realizadas por algún algoritmo de venta A. Ahora deseamos demostrar que para todos los algoritmos A que venden N acciones, REVA ≤ N i=1 pi ≤ ρ. Esencialmente, esta desigualdad establece la idea intuitiva de que un algoritmo de venta solo puede reducir los precios de las órdenes de compra ejecutadas o no coincidentes. Para demostrar esto, utilizamos la inducción para mostrar que la eliminación de la actividad de un algoritmo de venta hace que estos precios aumenten. Primero, elimine la última acción en la última orden de venta realizada por A o el mercado en una fusión de secuencia arbitraria merge(S, S) - con esto queremos decir, tome la última orden de venta realizada por A o el mercado y disminuya su volumen en una acción. Después de esta modificación, los N precios más altos p1 . . . pN no disminuirán. Esto se debe a que o bien esta orden de venta no se ejecutó, en cuyo caso la afirmación es trivialmente verdadera, o, si se ejecutó, la eliminación de esta orden de venta deja una orden de compra adicional no ejecutada de igual o mayor precio. Para la inducción, asumimos que si eliminamos una participación de cualquier orden de venta que se haya colocado, ya sea por A o por el mercado, en o después del tiempo t, entonces los N precios principales no disminuyen. Ahora demostramos que si eliminamos una participación de la última orden de venta que fue colocada por A o el mercado antes del tiempo t, entonces los N precios principales no disminuyen. Si esta orden de venta de acciones no se ejecutó, entonces la afirmación es trivialmente verdadera. De lo contrario, si la orden de venta se ejecutó, entonces la afirmación es verdadera porque al eliminar esta acción ejecutada de la orden de venta, o bien: i) la acción correspondiente de la orden de compra (de igual o mayor valor) no se empareja en el resto de la secuencia, en cuyo caso la afirmación es verdadera; o ii) esta orden de compra se empareja con alguna acción de una orden de venta a un precio igual o mayor, lo que tiene el efecto de eliminar una acción de una orden de venta en el resto de la secuencia y, por la suposición inductiva, esto solo puede aumentar los precios. Por lo tanto, hemos demostrado que para todos los A que venden N acciones, REVA ≤ ρ. Ahora hemos establecido que nuestra ganancia satisface 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), donde A realiza una secuencia arbitraria de N órdenes de venta límite. 3.4 Resultados de VWAP en el Modelo del Libro de Órdenes El algoritmo OWT del Teorema 6 se puede aplicar para obtener el siguiente resultado de VWAP: Corolario 7. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de VWAP de venta RVWAP(A) = O(log(R) log(N)). Ahora hacemos una suposición bastante diferente sobre las secuencias S. 3.4.0.4 Volumen de Orden Acotado y Suposición de Precio Máximo. El conjunto de secuencias Σ satisface las siguientes dos propiedades. Primero, asumimos que cada orden colocada en el mercado tiene un volumen menor que γ, lo cual consideramos como una suposición leve ya que típicamente las órdenes individuales en el mercado no tienen un alto volumen (debido a problemas de liquidez). Esta suposición permite que nuestro algoritmo coloque al menos una orden límite a la vez intercalada con aproximadamente γ ejecuciones de mercado. Segundo, asumimos que hay un gran volumen en los libros de órdenes de venta por debajo del precio pmax, lo que significa que ninguna orden colocada por el mercado se ejecutará por encima del precio pmax. La forma más sencilla de instanciar esta última suposición en el modelo de libro de órdenes es asumir que cada secuencia S ∈ Σ comienza colocando un gran número de órdenes de venta (más de Vmax) a un precio pmax. Aunque esta suposición tiene un parámetro de precio máximo, no implica que la proporción de precios R sea finita, ya que no implica ningún límite inferior en los precios de compra o de las acciones ejecutadas (aparte del trivial de 0). Teorema 8. Considera el modelo de libro de órdenes bajo la suposición de volumen de orden limitado y precio máximo. Existe un algoritmo A en el cual después de exactamente γN ejecuciones de mercado, entonces A ha vendido como máximo N acciones y REVA(S, S) ≤ N = VWAPA(S, S) ≥ (1 − ε)VWAPM(S, S) − pmax N donde S es una secuencia de N órdenes de venta límite generadas por A al observar S. Demostración. El algoritmo divide el día de negociación en intervalos de volumen cuya duración en tiempo real puede variar. Para cada período i en el que se hayan ejecutado acciones γ en el mercado, el algoritmo calcula el VWAP de mercado solo de aquellas acciones negociadas en el período i; denotémoslo como VWAPi. Tras este intervalo de volumen i-ésimo, el algoritmo coloca una orden límite para vender exactamente una acción a un precio cercano al VWAPi. Más precisamente, el algoritmo solo coloca órdenes a los precios discretos (1− )pmax , (1− )2 pmax , . . .. Tras el intervalo de volumen i, el algoritmo coloca una orden límite para vender una acción al precio discretizado que esté más cercano al VWAPi, pero que sea estrictamente menor. Para el análisis, comenzamos observando que si todas las órdenes límite de los algoritmos se ejecutan durante el día, los ingresos totales recibidos por el algoritmo serían al menos (1 − )VWAPM (S, S )N. Para ver esto, basta con notar que VWAPM (S, S ) es una mezcla uniforme de los VWAPi (ya que por definición cubren la misma cantidad de volumen de mercado); y si todas las órdenes límite de los algoritmos se ejecutaran, cada uno recibiría más de (1 − )VWAPi dólares por el intervalo i que siguieron. Ahora contamos el potencial de ingresos perdidos del algoritmo debido a órdenes límite no ejecutadas. Por la suposición de que los pedidos individuales se realizan con un volumen menor que γ, entonces nuestro algoritmo es capaz de colocar una orden límite durante cada bloque de γ acciones que se han negociado. Por lo tanto, después de que se hayan ejecutado γN órdenes de mercado, A ha colocado N órdenes en el mercado. Ten en cuenta que puede haber como máximo una orden límite (y por lo tanto, como máximo una acción) sin ejecutar en cada nivel de la escalera de precios discretizada definida anteriormente. Esto se debe a que después del intervalo i, el algoritmo coloca su orden límite estrictamente por debajo de VWAPi, por lo que si VWAPj ≥ VWAPi para j > i, esta orden límite debe haber sido ejecutada. Por lo tanto, las órdenes límite no ejecutadas limitaron los VWAPs del resto del día, resultando en un máximo de una orden no ejecutada por nivel de precio. Un límite en la pérdida de ingresos es, por lo tanto, la suma de los precios discretizados: ∞ i=1(1 − )i pmax ≤ pmax / . Claramente nuestro algoritmo ha vendido como máximo N acciones. Ten en cuenta que a medida que N se vuelve grande, VWAPA se acerca a 1 menos el VWAP del mercado. Si supiéramos que el volumen total final de las ejecuciones del mercado es V, entonces podríamos establecer γ = V/N, asumiendo que γ >> 1. Si solo tenemos un límite superior e inferior en V, deberíamos poder adivinar y incurrir en una pérdida logarítmica. La siguiente suposición intenta capturar la variabilidad del volumen del mercado. Suposición de Variabilidad del Volumen del Libro de Órdenes 3.4.0.5. Ahora asumimos que el volumen total (que incluye las operaciones ejecutadas tanto por nuestro algoritmo como por el mercado) es variable dentro de una región conocida y que el volumen del mercado será mayor que el volumen de nuestros algoritmos. De manera más formal, para todo S ∈ Σ, asumir que el volumen total V de acciones negociadas en execM (S, S), para cualquier secuencia S de N órdenes de venta límite, satisface 2N ≤ Vmin ≤ V ≤ Vmax. Que Q = Vmax / Vmin. El siguiente corolario se deriva utilizando una constante = 1/2 y observando que si establecemos γ de manera que V ≤ γN ≤ 2V entonces nuestro algoritmo colocará entre N y N/2 órdenes límite. Corolario 9. En el modelo de libro de órdenes, si se cumplen la suposición de volumen de orden acotado y precio máximo, y la suposición de variabilidad del volumen del libro de órdenes, existe un algoritmo en línea A para vender como máximo N acciones tal que VWAPA(S, S) ≥ 1 4 log(Q) VWAPM(S, S) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figura 3: Aquí presentamos límites de la Sección 4 basados en las distribuciones de volumen empíricas para cuatro acciones reales: QQQ, MCHP, JNPR y CHKP. Los gráficos muestran histogramas de los volúmenes totales diarios transados en Island para estas acciones, en el último año y medio, junto con los valores correspondientes de log(Q) y E(Pbins vol) (denotado por E). Suponemos que los volúmenes diarios mínimo y máximo en los datos corresponden a Vmin y Vmax, respectivamente. Los límites de la razón competitiva en el peor de los casos (que son dos veces el logaritmo de Q) de nuestro algoritmo para esas acciones son 9.42, 10.56, 11.32 y 13.20, respectivamente. Los límites correspondientes sobre el rendimiento de la proporción competitiva de nuestro algoritmo bajo el modelo de distribución de volumen (que son el doble de E(Pbins vol )) son mejores: 7.54, 7.72, 7.94 y 9.00, respectivamente (una mejora relativa del 20-40%). Usando una partición de volumen más fina junto con un límite ligeramente más refinado en la relación competitiva, podemos construir algoritmos que, utilizando la distribución de volumen empírica dada como correcta, garantizan relaciones competitivas aún mejores de 2.76, 2.73, 2.75 y 3.17, respectivamente para esas acciones (detalles omitidos). MODELOS DE DISTRIBUCIÓN MACROSCÓPICA Concluimos nuestros resultados con un regreso al modelo de precio-volumen, donde introduciremos algunos métodos refinados de análisis para algoritmos de trading en línea. Dejamos la generalización de estos métodos al modelo de libro de órdenes para trabajos futuros. Los ratios de competitividad definidos hasta ahora miden el rendimiento en relación con algún criterio de referencia en el peor caso sobre todas las secuencias de mercado S ∈ Σ. Se ha observado en muchos entornos en línea que tales métricas de peor caso pueden arrojar resultados pesimistas, y se han considerado varias relajaciones, como permitir una distribución de probabilidad sobre la secuencia de entrada. Ahora consideramos modelos de distribución que son considerablemente más débiles que asumir una distribución sobre secuencias de mercado completas S ∈ Σ. En el modelo de distribución de volumen, asumimos únicamente que existe una distribución Pvol sobre el volumen total V negociado en el mercado durante el día, y luego examinamos la peor relación competitiva en secuencias consistentes con el volumen elegido al azar. Más precisamente, definimos RVWAP(A, Pvol) = EV ∼Pvol max S∈seq(V) VWAPM(S) VWAPA(S). Aquí V ∼ Pvol denota que V es elegido con respecto a la distribución Pvol, y seq(V) ⊂ Σ es el conjunto de todas las secuencias de mercado (p1, v1), . . . , (pT, vT) que satisfacen T t=1 vt = V. De manera similar, para OWT, podemos definir ROWT(A, Pmaxprice) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S). Aquí Pmaxprice es una distribución solo sobre el precio máximo del día, y luego examinamos secuencias de peor caso consistentes con este precio (seq(p) ⊂ Σ es el conjunto de todas las secuencias de mercado que satisfacen max1≤t≤T pt = p). Se pueden proporcionar definiciones análogas del lado de compra. Enfatizamos que en estos modelos, solo la distribución del volumen máximo y el precio es conocida por el algoritmo. También observamos que nuestras suposiciones probabilísticas sobre S son considerablemente más débiles que los modelos típicos de finanzas estadísticas, los cuales postularían un modelo estocástico detallado para la evolución paso a paso de (pt, vt). Aquí permitimos únicamente una distribución sobre medidas crudas y macroscópicas de la actividad del mercado durante todo el día, como el volumen total y el precio máximo, y analizamos el rendimiento en el peor de los casos coherente con estas medidas crudas. Por esta razón, nos referimos a tales configuraciones como el modelo de distribución macroscópica. El trabajo de El-Yaniv et al. [3] examina supuestos de distribución similares a los nuestros, pero también enfatizan las elecciones de peor caso para las distribuciones, y muestran que esto conduce a resultados no mejores que el análisis de peor caso original sobre todas las secuencias. Por el contrario, consideramos que el análisis de las distribuciones específicas Pvol y Pmaxprice es natural en muchos contextos financieros y nuestros resultados experimentales preliminares muestran mejoras significativas cuando se tiene en cuenta esta información distribucional bastante rudimentaria (ver Figura 3). Nuestros resultados en el contexto de VWAP examinan los casos en los que estas distribuciones son conocidas exactamente o solo aproximadamente. Resultados similares pueden obtenerse para distribuciones macroscópicas del precio máximo diario en el escenario de negociación unidireccional. 4.1 Resultados en el Modelo de Distribución Macroscópica Comenzamos señalando que los algoritmos examinados hasta ahora funcionan dividiendo los volúmenes totales o los precios máximos en contenedores de tamaño exponencialmente creciente, y luego adivinando el índice del contenedor en el que cae la cantidad real. Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en análisis competitivos) pueda depender de la distribución del índice de contenedor real. En lo que resta, asumimos que Q es una potencia de 2 y la base del logaritmo es 2. Que Pvol denote la distribución del volumen total diario del mercado. Definimos la distribución relacionada Pbins vol sobre los índices de los contenedores i de la siguiente manera: para todo i = 1, . . . , log(Q) − 1, Pbins vol (i) es igual a la probabilidad, bajo Pvol, de que el volumen diario caiga en el intervalo [Vmin 2i−1 , Vmin 2i ), y Pbins vol (log(Q)) es para el último intervalo [Vmax /2, Vmax]. Definimos E como E(Pbins vol) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2. Dado que el soporte de Pbins vol tiene solo log(Q) elementos, E(Pbins vol ) puede variar desde 1 (para distribuciones Pvol que colocan todo su peso en solo uno de los log(Q) intervalos entre Vmin , Vmin 2, Vmin 4, . . . , Vmax ) hasta log(Q) (para distribuciones Pvol en las que el volumen diario total tiene igual probabilidad de caer en cualquiera de estos intervalos). Ten en cuenta que las distribuciones Pvol de este último tipo están lejos de ser uniformes en todo el rango [Vmin, Vmax]. Teorema 10. En el modelo de distribución de volumen bajo el supuesto de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando únicamente el conocimiento de la distribución total de volumen Pvol, logra RVWAP(A, Pvol) ≤ 2E(Pbins vol). Todas las pruebas en esta sección se proporcionan en el apéndice. Como ejemplo concreto, considera el caso en el que Pvol es la distribución uniforme sobre [Vmin, Vmax]. En ese caso, el volumen de Pbins está aumentando de forma exponencial y alcanza su punto máximo en el último bin, que, al tener el ancho más grande, también tiene el mayor peso. En este caso, E(Pbins vol) es una constante (es decir, independiente de Q), lo que conduce a una proporción competitiva constante. Por otro lado, si Pvol es exponencial, entonces Pbins vol es uniforme, lo que conduce a una proporción competitiva de O(log(Q)), al igual que en el entorno de precio-volumen más adversarial discutido anteriormente. En la Figura 3, proporcionamos límites específicos adicionales obtenidos para distribuciones empíricas de volumen diario total calculadas para algunas acciones reales. Ahora examinamos el escenario en el que Pvol es desconocido, pero se dispone de una aproximación ˜Pvol. Definamos C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) . C se minimiza en C(Pbins vol , Pbins vol ) = E(Pbins vol ), y C puede ser infinito si ˜Pbins vol (i) es 0 cuando Pbins vol (i) > 0. Teorema 11. En el modelo de distribución de volumen bajo la suposición de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando solo el conocimiento de una aproximación ˜Pvol de Pvol, logra que RVWAP(A, Pvol) ≤ 2C(Pbins vol, ˜Pbins vol). Como ejemplo de este resultado, supongamos que nuestra aproximación cumple (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) para todo i, para algún α > 1. Por lo tanto, nuestras probabilidades estimadas de índice de contenedor están todas dentro de un factor de α de la verdad. Entonces es fácil demostrar que C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), por lo tanto, según los Teoremas 10 y 11, nuestra penalización por usar la distribución aproximada es un factor de α en la proporción competitiva. 5. REFERENCIAS [1] B. Awerbuch, Y. Bartal, A. Fiat y A. Rosén. Control de llamadas competitivo no preemptivo. En Proc. 5to Simposio ACM-SIAM sobre Algoritmos Discretos, páginas 312-320, 1994. [2] A. Borodin y R. El-Yaniv. Computación en línea y análisis competitivo. Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp y G. Turpin. Algoritmos óptimos de búsqueda y comercio en línea unidireccional. Algorithmica, 30:101-139, 2001. [4] M. Kearns y L. Ortiz. El proyecto de trading automatizado Penn-Lehman. IEEE Intelligent Systems, 2003. \n\nSistemas Inteligentes de IEEE, 2003. Aparecer. 6. APÉNDICE 6.1 Pruebas de la Subsección 2.3 Prueba. (Bosquejo del Teorema 3) Sin pérdida de generalidad, asumir que Q = 1 y el volumen total es V. Considera el tiempo t donde el horario fijo f vende menos, entonces ft ≤ N/T. Considera las secuencias donde en el tiempo t tenemos pt = pmax, vt = V, y para los tiempos t = t tenemos pt = pmin y vt = 0. El VWAP es pmax y el promedio de horario fijo es (N/T)pmax + (N − N/T)pmin. Prueba. (Bosquejo del Teorema 4) El algoritmo simplemente vende ut = (vt/Vmin)N acciones en el tiempo t. El número total de acciones vendidas U es claramente mayor que N y U = t ut = t (vt/Vmin)N = (V/Vmin)N ≤ QN El precio promedio es V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), donde usamos el hecho de que ut/U = vt/V. 197 Prueba. (del Teorema 5) Comenzamos con la prueba del límite inferior. Considera el siguiente escenario. Durante las primeras T unidades de tiempo tenemos un precio de √ Rpmin y un volumen total de Vmin. Observamos cuántas acciones ha comprado el algoritmo en línea. Si ha comprado más de la mitad de las acciones, los pasos de tiempo restantes tienen un precio pmin y un volumen de Vmax − Vmin. De lo contrario, los pasos de tiempo restantes tienen un precio pmax y un volumen insignificante. En el primer caso, el comprador en línea ha pagado al menos √ Rpmin /2 mientras que el VWAP es a lo sumo √ Rpmin /Q + pmin. Por lo tanto, en este caso la proporción competitiva es Ω(Q). En el segundo caso, el comprador en línea tiene que comprar al menos la mitad de las acciones a pmax, por lo que su costo promedio es al menos pmax/2. El VWAP del mercado es √ Rpmin = pmax / √ R, por lo tanto, la proporción competitiva es Ω( √ R). Para el límite superior, podemos obtener una proporción competitiva de √ R, comprando todas las acciones una vez que el precio caiga por debajo de √ Rpmin. El límite superior de Q se deriva ejecutando un algoritmo que asume que el volumen es Vmin. El comprador en línea paga un costo de p, mientras que el VWAP será al menos p/Q. 6.2 Pruebas de la Sección 4 Prueba. (Bosquejo del Teorema 10) Utilizamos la idea de adivinar el volumen total del Teorema 1, pero ahora permitimos la posibilidad de una distribución arbitraria (pero conocida) sobre el volumen total. En particular, considere construir una distribución Gbins vol sobre un conjunto de valores de volumen utilizando Pvol y úsela para estimar el volumen total V. Permita que el algoritmo adivine ˆV = Vmin 2i con probabilidad Gbins vol (i). Luego, observe que, para cualquier secuencia de precio-volumen S, si V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2. Esto implica un límite superior en RVWAP(A, Pvol) en términos de Gbins vol. Entonces obtenemos que Gbins vol (i) ∝ Pbins vol (i) minimiza el límite superior, lo que conduce al límite superior establecido en el teorema. Prueba. (Bosquejo del Teorema 11) Reemplace Pvol con ˜Pvol en la expresión de Gbins vol en el bosquejo de la prueba para el último resultado. 198",
    "original_sentences": [
        "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
        "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
        "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
        "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
        "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
        "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
        "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
        "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
        "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
        "A typical scenario goes as follows.",
        "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
        "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
        "Thus, the fund manager would approach brokerages for help in selling the 1%.",
        "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
        "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
        "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
        "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
        "If they can beat the VWAP by a penny, they make two cents per share.",
        "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
        "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
        "The rows represent results for either the OWT or VWAP criterion.",
        "The columns represent which model we are working in.",
        "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
        "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
        "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
        "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
        "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
        "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
        "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
        "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
        "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
        "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
        "Such data and algorithms are a topic of great current interest on Wall Street [4].",
        "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
        "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
        "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
        "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
        "This will be addressed in the order book model studied in the next section.",
        "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
        "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
        "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
        "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
        "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
        "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
        "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
        "Let us assume that our goal is to sell N shares over the course of the day.",
        "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
        "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
        "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
        "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
        "In the order book model to follow, we do not allow fractional volumes.)",
        "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
        "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
        "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
        "Note that the market VWAP does not include the shares that the algorithm sells.",
        "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
        "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
        "It is easy to see that this makes it a more challenging criterion to track.",
        "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
        "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
        "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
        "As we shall see, there are some important commonalities and differences to these two approaches.",
        "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
        "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
        "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
        "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
        "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
        "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
        "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
        "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
        "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
        "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
        "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
        "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
        "Theorem 1.",
        "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
        "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
        "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
        "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
        "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
        "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
        "Clearly, one of the Ai has a competitive ratio of 2.",
        "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
        "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
        "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
        "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
        "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
        "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
        "Then in the VWAP sequence we set the volume vt = 2i−1 .",
        "If this is not the first visit to the interval containing pt, we set vt = 0.",
        "Assume that the maximum price in S is pmax .",
        "The VWAP of our sequence is at least pmax /3.",
        "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
        "The lower bound now follows using the lower bound in [3].",
        "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
        "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
        "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
        "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
        "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
        "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
        "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
        "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
        "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
        "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
        "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
        "Theorem 3.",
        "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
        "The proofs of all the results in this subsection are in the Appendix.",
        "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
        "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
        "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
        "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
        "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
        "Theorem 4.",
        "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
        "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
        "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
        "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
        "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
        "Theorem 5.",
        "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
        "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
        "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
        "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
        "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
        "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
        "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
        "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
        "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
        "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
        "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
        "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
        "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
        "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
        "How then do orders get executed?",
        "There are two methods.",
        "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
        "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
        "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
        "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
        "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
        "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
        "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
        "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
        "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
        "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
        "We shall thus assume without loss of generality that all orders are placed as limit order.",
        "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
        "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
        "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
        "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
        "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
        "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
        "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
        "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
        "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
        "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
        "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
        "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
        "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
        "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
        "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
        "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
        "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
        "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
        "In each executed trade, the selling party is either the market or the algorithm.",
        "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
        "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
        "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
        "We generally expect T to be (possibly much) smaller than T .",
        "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
        "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
        "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
        "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
        "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
        "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
        "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
        "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
        "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
        "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
        "Theorem 6.",
        "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
        "Proof.",
        "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
        "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
        "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
        "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
        "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
        "Consider guessing the kth highest such price, pk.",
        "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
        "Let k∗ = argmaxk{kpk}.",
        "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
        "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
        "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
        "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
        "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
        "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
        "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
        "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
        "After this modification, the top N prices p1 . . . pN will not decrease.",
        "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
        "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
        "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
        "If this sell order share was not executed, then the claim is trivially true.",
        "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
        "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
        "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
        "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
        "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
        "The set of sequences Σ satisfies the following two properties.",
        "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
        "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
        "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
        "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
        "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
        "Theorem 8.",
        "Consider the order book model under the bounded order volume and max price assumption.",
        "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
        "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
        "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
        "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
        "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
        "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
        "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
        "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
        "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
        "Hence, after γN market orders have been executed, A has placed N orders in the market.",
        "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
        "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
        "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
        "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
        "Clearly our algorithm has sold at most N shares.",
        "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
        "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
        "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
        "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
        "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
        "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
        "Let Q = Vmax /Vmin .",
        "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
        "Corollary 9.",
        "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
        "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
        "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
        "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
        "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
        "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
        "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
        "We leave the generalization of these methods to the order book model for future work.",
        "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
        "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
        "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
        "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
        "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
        "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
        "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
        "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
        "Analogous buy-side definitions can be given.",
        "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
        "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
        "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
        "For this reason, we refer to such settings as the macroscopic distribution model.",
        "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
        "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
        "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
        "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
        "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
        "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
        "Let Pvol denote the distribution of total daily market volume.",
        "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
        "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
        "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
        "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
        "Theorem 10.",
        "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
        "All proofs in this section are provided in the appendix.",
        "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
        "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
        "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
        "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
        "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
        "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
        "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
        "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
        "Theorem 11.",
        "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
        "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
        "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
        "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
        "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
        "Competitive non-preemptive call control.",
        "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
        "Online Computation and Competitive Analysis.",
        "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
        "Optimal search and one-way trading online algorithms.",
        "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
        "The Penn-Lehman automated trading project.",
        "IEEE Intelligent Systems, 2003.",
        "To appear. 6.",
        "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
        "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
        "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
        "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
        "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
        "Consider the following scenario.",
        "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
        "We observe how many shares the online algorithm has bought.",
        "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
        "Otherwise, the remaining time steps have price pmax and negligible volume.",
        "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
        "Therefore, in this case the competitive ratio is Ω(Q).",
        "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
        "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
        "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
        "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
        "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
        "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
        "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
        "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
        "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
        "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
        "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
    ],
    "translated_text_sentences": [
        "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite.",
        "Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones.",
        "Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1.",
        "INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas.",
        "Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico.",
        "Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP.",
        "Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen.",
        "En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP.",
        "Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP.",
        "Un escenario típico se desarrolla de la siguiente manera.",
        "Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones).",
        "Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable.",
        "Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%.",
        "La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo?",
        "Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente.",
        "La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo.",
        "La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias.",
        "Si pueden superar el VWAP por un centavo, ganan dos centavos por acción.",
        "Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría.",
        "La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento.",
        "Las filas representan resultados para el criterio OWT o VWAP.",
        "Las columnas representan en qué modelo estamos trabajando.",
        "La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor.",
        "El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica).",
        "Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP.",
        "Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria.",
        "En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea.",
        "Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado.",
        "En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3].",
        "Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros.",
        "En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas.",
        "Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado.",
        "Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4].",
        "Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él.",
        "Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2.",
        "MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones.",
        "Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones.",
        "Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección.",
        "Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración.",
        "El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre.",
        "Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street.",
        "El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo.",
        "En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading.",
        "Más precisamente, en este modelo en línea, observamos la secuencia de precio-volumen de a pares.",
        "Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt.",
        "Supongamos que nuestro objetivo es vender N acciones a lo largo del día.",
        "Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT.",
        "De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante.",
        "Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas.",
        "Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema).",
        "En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios.",
        "En el trading de VWAP, el objetivo de un algoritmo en línea A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado.",
        "El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt.",
        "Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N.",
        "Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo.",
        "El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo.",
        "Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales.",
        "Es fácil ver que esto lo convierte en un criterio más desafiante de seguir.",
        "A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado.",
        "En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes.",
        "En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día.",
        "Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques.",
        "Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S).",
        "Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio.",
        "Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto.",
        "Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin.",
        "Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin.",
        "Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones.",
        "Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1.",
        "En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo.",
        "En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo.",
        "Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP.",
        "Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)).",
        "Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios.",
        "Teorema 1.",
        "En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q).",
        "Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier algoritmo en línea A para vender N acciones tiene RVWAP(A) = Ω(log(Q)).",
        "Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1].",
        "Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día.",
        "Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones.",
        "Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1.",
        "Claramente, uno de los Ai tiene una proporción competitiva de 2.",
        "Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada).",
        "Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT.",
        "Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2.",
        "Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP.",
        "Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ).",
        "Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo.",
        "Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1.",
        "Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0.",
        "Suponga que el precio máximo en S es pmax.",
        "El VWAP de nuestra secuencia es al menos pmax /3.",
        "Dado que teníamos un algoritmo c competitivo, su venta promedio es al menos pmax /3c.",
        "El límite inferior ahora se sigue utilizando el límite inferior en [3].",
        "Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT.",
        "Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191.",
        "En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)).",
        "Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)).",
        "Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT.",
        "Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo.",
        "Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R).",
        "Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen.",
        "Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt).",
        "Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario.",
        "Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso.",
        "Teorema 3.",
        "En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)).",
        "Las pruebas de todos los resultados de esta subsección están en el Apéndice.",
        "Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones.",
        "En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender.",
        "Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución.",
        "El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo.",
        "Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1.",
        "Teorema 4.",
        "En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S).",
        "En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2].",
        "En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo.",
        "Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente.",
        "Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema.",
        "Teorema 5.",
        "En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un algoritmo en línea A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}).",
        "Además, cualquier algoritmo en línea A para comprar N acciones tiene una proporción competitiva de compra VWAP Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
        "Un modelo de trading de libro de órdenes limitadas. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado.",
        "Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la negociación de acciones es entre una orden limitada y una orden de mercado.",
        "Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT).",
        "En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado.",
        "Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 2, que muestra una captura de pantalla real de un libro de órdenes reciente de MSFT en Island (www.island.com), un conocido intercambio electrónico de acciones de NASDAQ), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos.",
        "Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta).",
        "Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (siendo las órdenes más antiguas las primeras en el libro).",
        "En el ejemplo proporcionado por la Figura 2, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra.",
        "De manera similar, se mantiene un libro de órdenes de venta para órdenes de límite de venta (por ejemplo, podríamos querer vender 500 acciones de MSFT a $24.10 o más) esta vez con el precio de venta más bajo ofrecido (a menudo denominado como el precio de venta).",
        "Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas.",
        "Los precios de oferta y demanda (que nuevamente, son simplemente los precios en las órdenes límite en la parte superior de los libros de compra y venta, respectivamente) a veces se denominan como el mercado interno, y la diferencia entre ellos como el spread.",
        "Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección.",
        "¿Entonces, cómo se ejecutan las órdenes?",
        "Hay dos métodos.",
        "Primero, cada vez que llega una orden de mercado, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto.",
        "Por lo tanto, una orden de mercado para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones.",
        "Por ejemplo, en el ejemplo de la Figura 2, tal orden sería completada por las dos órdenes de venta límite de 500 acciones a $24.069, las 500 acciones a $24.07, las 200 acciones a $24.08, y luego 300 de las 1981 acciones a $24.09.",
        "Las 1681 acciones restantes de esta última orden límite permanecerían como el nuevo tope del libro de órdenes de venta límite.",
        "Segundo, si una orden de límite de compra (venta, respectivamente) entra por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con órdenes en los libros opuestos.",
        "Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato.",
        "Cada orden de mercado o límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que las órdenes llegan, y dos órdenes nunca pueden llegar simultáneamente.",
        "Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden.",
        "Es esta cantidad la que generalmente se quiere decir cuando la gente se refiere casualmente al precio de una acción (ticker).",
        "Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una orden de mercado.",
        "Por lo tanto, asumiremos sin pérdida de generalidad que todas las órdenes se colocan como órdenes límite.",
        "Aunque las órdenes límite que no se ejecutan pueden ser eliminadas por la parte que las colocó, para simplificar, asumimos que las órdenes límite nunca son eliminadas de los libros.",
        "Remitimos al lector a [4] para obtener más información sobre los intercambios electrónicos modernos y la microestructura del mercado. 3.2 El Modelo El modelo de negociación de libros de órdenes en línea tiene como objetivo capturar los detalles realistas de la microestructura del mercado recién discutidos en un entorno de relación competitiva.",
        "En este modelo refinado, la actividad del mercado de un día se describe por una secuencia de órdenes límite (pt, vt, bt).",
        "Aquí bt es un bit que indica si la orden es de compra o venta, mientras que pt es el precio de la orden límite y vt es el número de acciones deseado.",
        "Tras la llegada de cada orden límite de este tipo, se permite a un algoritmo de trading en línea colocar su propia orden límite.",
        "Estas dos fuentes entrelazadas (mercado y algoritmo) de órdenes límite son simplemente operadas de acuerdo con el proceso de emparejamiento descrito en la Sección 3.1.",
        "Cualquier orden límite que no sea ejecutable de inmediato según este proceso se coloca en el libro correspondiente (compra o venta) para una posible ejecución futura; las órdenes que llegan y pueden ser ejecutadas parcial o totalmente se ejecutan de esa manera, con cualquier acción residual que permanezca en el libro respectivo.",
        "El objetivo de un algoritmo de venta VWAP u OWT es esencialmente el mismo que en el modelo de precio-volumen, pero el contexto ha cambiado en las siguientes dos formas fundamentales.",
        "Primero, la suposición de liquidez infinita en el modelo de precio-volumen se elimina por completo.",
        "El número de acciones disponibles a cualquier precio dado está restringido al volumen total de órdenes límite que ofrecen ese precio.",
        "Segundo, se asume que todas las órdenes entrantes, y por lo tanto los libros completos de órdenes límite, son visibles para el algoritmo.",
        "Esto es coherente con los intercambios financieros electrónicos modernos, y de hecho es la fuente de mucho interés actual en Wall Street [4].",
        "En general, la definición de las ratios competitivas en el modelo de libro de órdenes se complica por el hecho de que ahora nuestra actividad algorítmica influye en la secuencia de precios y volúmenes ejecutados.",
        "Por lo tanto, primero definimos la secuencia de ejecución determinada por una secuencia de órdenes límite (colocadas por el mercado y nuestro algoritmo).",
        "Sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por el mercado, y sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por nuestro algoritmo (a menos que se especifique lo contrario, todos los bt son de tipo venta).",
        "Sea merge(S, S) la secuencia fusionada (p1, v1, b1), (p1, v1, b1), . . . , (pT, vT, bT), (pT, vT, bT), que es la secuencia temporal de órdenes realizadas por el mercado y el algoritmo.",
        "Ten en cuenta que el algoritmo tiene la opción de no realizar un pedido, lo cual podemos considerar como un pedido de volumen cero.",
        "Si llevamos a cabo el mantenimiento del libro de órdenes y el proceso de ejecución de órdenes descrito en la Sección 3.1 en la fusión de secuencias (S, S), en intervalos irregulares se produce una operación de compra/venta de un cierto número de acciones a un determinado precio.",
        "En cada operación ejecutada, la parte vendedora es o bien el mercado o el algoritmo.",
        "Sea execM (S, S ) = (q1, w1), . . . , (qT , wT ) la secuencia de ejecuciones donde el mercado (es decir, una parte distinta al algoritmo) fue la parte vendedora, donde los qt son los precios de ejecución y wt los volúmenes de ejecución.",
        "De manera similar, definimos execA(S, S) = (r1, x1), . . . , (rT, xT) como la secuencia de ejecuciones en las que el algoritmo fue la parte vendedora.",
        "Por lo tanto, execA(S, S) ∪ execM(S, S) es el conjunto de todas las ejecuciones.",
        "Generalmente esperamos que T sea (posiblemente mucho) más pequeño que T.",
        "Los ingresos del algoritmo y del mercado se definen como: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt. Nótese que ambas cantidades están determinadas únicamente por las secuencias de ejecución execM (S, S ) y execA(S, S ), respectivamente.",
        "Para un algoritmo A que está limitado a vender exactamente N acciones, definimos la razón de competencia OWT de A, ROWT(A), como la razón máxima (bajo cualquier S ∈ Σ) de los ingresos obtenidos por A, en comparación con los ingresos obtenidos por un algoritmo óptimo fuera de línea A∗.",
        "De manera más formal, para A∗ que está limitado a vender exactamente N acciones, definimos ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) donde S∗ es la secuencia de órdenes límite colocadas por A∗ en S. Si el algoritmo A es aleatorio, entonces tomamos la expectativa apropiada con respecto a S ∼ A.",
        "Definimos la ratio competitiva VWAP, RVWAP(A), como la ratio máxima (bajo cualquier S ∈ Σ) entre los VWAPs del mercado y del algoritmo.",
        "Más formalmente, define VWAPM (S, S ) como REVM (S, S )/ T t=1 wt, donde el denominador es simplemente el volumen total ejecutado de órdenes colocadas por el mercado.",
        "De manera similar, definimos VWAPA(S, S) como REVA(S, S)/N, ya que asumimos que el algoritmo vende no más de N acciones (esta definición asume implícitamente que A obtiene un precio de 0 por las acciones no vendidas).",
        "El ratio competitivo VWAP de A es entonces: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} donde S es la secuencia en línea de órdenes límite generadas por A en respuesta a la secuencia S. 3.3 Resultados de OWT en el Modelo de Libro de Órdenes. Para el problema de OWT en el modelo de libro de órdenes, introducimos una versión más sutil de la suposición de variabilidad de precios.",
        "Esto se debe al hecho de que nuestro trading algorítmico puede afectar los precios altos y bajos del día.",
        "Para la suposición a continuación, tenga en cuenta que execM (S, ∅) es la secuencia de ejecuciones sin la interacción de nuestro algoritmo. 3.3.0.3 Suposición de Variabilidad del Precio del Libro de Órdenes. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin.",
        "Para todas las secuencias de trading intradía S ∈ Σ, los precios pt en la secuencia execM (S, ∅) cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Tenga en cuenta que esta suposición no implica que las ratios de precios altos a bajos bajo las secuencias execM (S, S ) o execA(S, S ) estén limitadas por R. De hecho, la ratio en la secuencia execA(S, S ) podría ser infinita si el algoritmo termina vendiendo algunas acciones a un precio de 0.",
        "Teorema 6.",
        "En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de venta OWT ROWT(A) = 2 log(R) log(N).",
        "Prueba.",
        "El algoritmo A funciona al adivinar un precio p en el conjunto {pmin2i : 1 ≤ i ≤ log(R)} y colocar una orden de venta límite por todas las N acciones al precio p al comienzo del día. (Alternativamente, el algoritmo A puede colocar log(R) órdenes de venta límite, donde la i-ésima tiene un precio de 2i pmin y un volumen de N/ log(R).)",
        "Al realizar un pedido al comienzo del día, el algoritmo ofrece un precio más bajo que todos los pedidos de venta que se realizarán durante el día por un precio de p o superior, lo que significa que primero se deben completar las N acciones del algoritmo a este precio.",
        "Por lo tanto, si hubiera habido k acciones que se hubieran vendido a un precio p o superior sin nuestra actividad, entonces A vendería al menos kp acciones.",
        "Definimos {pj} como el multiconjunto de precios de acciones individuales que han sido ejecutadas o son acciones de órdenes de compra límite que permanecieron sin ejecutar, excluyendo la actividad de nuestro algoritmo (es decir, asumiendo que nuestro algoritmo no coloca órdenes).",
        "Suponga sin pérdida de generalidad que p1 ≥ p2 ≥ . . ..",
        "Considerar adivinar el k-ésimo precio más alto, pk.",
        "Si se coloca una orden de N acciones al comienzo del día a un precio pk, entonces estamos garantizados de obtener un retorno de kpk.",
        "Que k∗ = argmaxk{kpk}.",
        "Podemos ver nuestro algoritmo como intentando adivinar pk∗, y teniendo éxito si la suposición p satisface p ∈ [pk∗ /2, pk∗].",
        "Por lo tanto, somos 2 log(R) competitivos con la cantidad max1≤k≤N kpk.",
        "Se debe tener en cuenta que ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk donde ρ se define como la suma de los N precios principales pi sin la participación de A.",
        "De manera similar, sea {pj} el multiconjunto de precios de las acciones individuales ejecutadas, o los precios de las acciones de órdenes de compra no ejecutadas, pero ahora incluyendo las órdenes realizadas por algún algoritmo de venta A.",
        "Ahora deseamos demostrar que para todos los algoritmos A que venden N acciones, REVA ≤ N i=1 pi ≤ ρ.",
        "Esencialmente, esta desigualdad establece la idea intuitiva de que un algoritmo de venta solo puede reducir los precios de las órdenes de compra ejecutadas o no coincidentes.",
        "Para demostrar esto, utilizamos la inducción para mostrar que la eliminación de la actividad de un algoritmo de venta hace que estos precios aumenten.",
        "Primero, elimine la última acción en la última orden de venta realizada por A o el mercado en una fusión de secuencia arbitraria merge(S, S) - con esto queremos decir, tome la última orden de venta realizada por A o el mercado y disminuya su volumen en una acción.",
        "Después de esta modificación, los N precios más altos p1 . . . pN no disminuirán.",
        "Esto se debe a que o bien esta orden de venta no se ejecutó, en cuyo caso la afirmación es trivialmente verdadera, o, si se ejecutó, la eliminación de esta orden de venta deja una orden de compra adicional no ejecutada de igual o mayor precio.",
        "Para la inducción, asumimos que si eliminamos una participación de cualquier orden de venta que se haya colocado, ya sea por A o por el mercado, en o después del tiempo t, entonces los N precios principales no disminuyen.",
        "Ahora demostramos que si eliminamos una participación de la última orden de venta que fue colocada por A o el mercado antes del tiempo t, entonces los N precios principales no disminuyen.",
        "Si esta orden de venta de acciones no se ejecutó, entonces la afirmación es trivialmente verdadera.",
        "De lo contrario, si la orden de venta se ejecutó, entonces la afirmación es verdadera porque al eliminar esta acción ejecutada de la orden de venta, o bien: i) la acción correspondiente de la orden de compra (de igual o mayor valor) no se empareja en el resto de la secuencia, en cuyo caso la afirmación es verdadera; o ii) esta orden de compra se empareja con alguna acción de una orden de venta a un precio igual o mayor, lo que tiene el efecto de eliminar una acción de una orden de venta en el resto de la secuencia y, por la suposición inductiva, esto solo puede aumentar los precios.",
        "Por lo tanto, hemos demostrado que para todos los A que venden N acciones, REVA ≤ ρ.",
        "Ahora hemos establecido que nuestra ganancia satisface 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), donde A realiza una secuencia arbitraria de N órdenes de venta límite. 3.4 Resultados de VWAP en el Modelo del Libro de Órdenes El algoritmo OWT del Teorema 6 se puede aplicar para obtener el siguiente resultado de VWAP: Corolario 7.",
        "En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de VWAP de venta RVWAP(A) = O(log(R) log(N)).",
        "Ahora hacemos una suposición bastante diferente sobre las secuencias S. 3.4.0.4 Volumen de Orden Acotado y Suposición de Precio Máximo.",
        "El conjunto de secuencias Σ satisface las siguientes dos propiedades.",
        "Primero, asumimos que cada orden colocada en el mercado tiene un volumen menor que γ, lo cual consideramos como una suposición leve ya que típicamente las órdenes individuales en el mercado no tienen un alto volumen (debido a problemas de liquidez).",
        "Esta suposición permite que nuestro algoritmo coloque al menos una orden límite a la vez intercalada con aproximadamente γ ejecuciones de mercado.",
        "Segundo, asumimos que hay un gran volumen en los libros de órdenes de venta por debajo del precio pmax, lo que significa que ninguna orden colocada por el mercado se ejecutará por encima del precio pmax.",
        "La forma más sencilla de instanciar esta última suposición en el modelo de libro de órdenes es asumir que cada secuencia S ∈ Σ comienza colocando un gran número de órdenes de venta (más de Vmax) a un precio pmax.",
        "Aunque esta suposición tiene un parámetro de precio máximo, no implica que la proporción de precios R sea finita, ya que no implica ningún límite inferior en los precios de compra o de las acciones ejecutadas (aparte del trivial de 0).",
        "Teorema 8.",
        "Considera el modelo de libro de órdenes bajo la suposición de volumen de orden limitado y precio máximo.",
        "Existe un algoritmo A en el cual después de exactamente γN ejecuciones de mercado, entonces A ha vendido como máximo N acciones y REVA(S, S) ≤ N = VWAPA(S, S) ≥ (1 − ε)VWAPM(S, S) − pmax N donde S es una secuencia de N órdenes de venta límite generadas por A al observar S. Demostración.",
        "El algoritmo divide el día de negociación en intervalos de volumen cuya duración en tiempo real puede variar.",
        "Para cada período i en el que se hayan ejecutado acciones γ en el mercado, el algoritmo calcula el VWAP de mercado solo de aquellas acciones negociadas en el período i; denotémoslo como VWAPi.",
        "Tras este intervalo de volumen i-ésimo, el algoritmo coloca una orden límite para vender exactamente una acción a un precio cercano al VWAPi.",
        "Más precisamente, el algoritmo solo coloca órdenes a los precios discretos (1− )pmax , (1− )2 pmax , . . ..",
        "Tras el intervalo de volumen i, el algoritmo coloca una orden límite para vender una acción al precio discretizado que esté más cercano al VWAPi, pero que sea estrictamente menor.",
        "Para el análisis, comenzamos observando que si todas las órdenes límite de los algoritmos se ejecutan durante el día, los ingresos totales recibidos por el algoritmo serían al menos (1 − )VWAPM (S, S )N. Para ver esto, basta con notar que VWAPM (S, S ) es una mezcla uniforme de los VWAPi (ya que por definición cubren la misma cantidad de volumen de mercado); y si todas las órdenes límite de los algoritmos se ejecutaran, cada uno recibiría más de (1 − )VWAPi dólares por el intervalo i que siguieron.",
        "Ahora contamos el potencial de ingresos perdidos del algoritmo debido a órdenes límite no ejecutadas.",
        "Por la suposición de que los pedidos individuales se realizan con un volumen menor que γ, entonces nuestro algoritmo es capaz de colocar una orden límite durante cada bloque de γ acciones que se han negociado.",
        "Por lo tanto, después de que se hayan ejecutado γN órdenes de mercado, A ha colocado N órdenes en el mercado.",
        "Ten en cuenta que puede haber como máximo una orden límite (y por lo tanto, como máximo una acción) sin ejecutar en cada nivel de la escalera de precios discretizada definida anteriormente.",
        "Esto se debe a que después del intervalo i, el algoritmo coloca su orden límite estrictamente por debajo de VWAPi, por lo que si VWAPj ≥ VWAPi para j > i, esta orden límite debe haber sido ejecutada.",
        "Por lo tanto, las órdenes límite no ejecutadas limitaron los VWAPs del resto del día, resultando en un máximo de una orden no ejecutada por nivel de precio.",
        "Un límite en la pérdida de ingresos es, por lo tanto, la suma de los precios discretizados: ∞ i=1(1 − )i pmax ≤ pmax / .",
        "Claramente nuestro algoritmo ha vendido como máximo N acciones.",
        "Ten en cuenta que a medida que N se vuelve grande, VWAPA se acerca a 1 menos el VWAP del mercado.",
        "Si supiéramos que el volumen total final de las ejecuciones del mercado es V, entonces podríamos establecer γ = V/N, asumiendo que γ >> 1.",
        "Si solo tenemos un límite superior e inferior en V, deberíamos poder adivinar y incurrir en una pérdida logarítmica.",
        "La siguiente suposición intenta capturar la variabilidad del volumen del mercado. Suposición de Variabilidad del Volumen del Libro de Órdenes 3.4.0.5.",
        "Ahora asumimos que el volumen total (que incluye las operaciones ejecutadas tanto por nuestro algoritmo como por el mercado) es variable dentro de una región conocida y que el volumen del mercado será mayor que el volumen de nuestros algoritmos.",
        "De manera más formal, para todo S ∈ Σ, asumir que el volumen total V de acciones negociadas en execM (S, S), para cualquier secuencia S de N órdenes de venta límite, satisface 2N ≤ Vmin ≤ V ≤ Vmax.",
        "Que Q = Vmax / Vmin.",
        "El siguiente corolario se deriva utilizando una constante = 1/2 y observando que si establecemos γ de manera que V ≤ γN ≤ 2V entonces nuestro algoritmo colocará entre N y N/2 órdenes límite.",
        "Corolario 9.",
        "En el modelo de libro de órdenes, si se cumplen la suposición de volumen de orden acotado y precio máximo, y la suposición de variabilidad del volumen del libro de órdenes, existe un algoritmo en línea A para vender como máximo N acciones tal que VWAPA(S, S) ≥ 1 4 log(Q) VWAPM(S, S) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figura 3: Aquí presentamos límites de la Sección 4 basados en las distribuciones de volumen empíricas para cuatro acciones reales: QQQ, MCHP, JNPR y CHKP.",
        "Los gráficos muestran histogramas de los volúmenes totales diarios transados en Island para estas acciones, en el último año y medio, junto con los valores correspondientes de log(Q) y E(Pbins vol) (denotado por E).",
        "Suponemos que los volúmenes diarios mínimo y máximo en los datos corresponden a Vmin y Vmax, respectivamente.",
        "Los límites de la razón competitiva en el peor de los casos (que son dos veces el logaritmo de Q) de nuestro algoritmo para esas acciones son 9.42, 10.56, 11.32 y 13.20, respectivamente.",
        "Los límites correspondientes sobre el rendimiento de la proporción competitiva de nuestro algoritmo bajo el modelo de distribución de volumen (que son el doble de E(Pbins vol )) son mejores: 7.54, 7.72, 7.94 y 9.00, respectivamente (una mejora relativa del 20-40%).",
        "Usando una partición de volumen más fina junto con un límite ligeramente más refinado en la relación competitiva, podemos construir algoritmos que, utilizando la distribución de volumen empírica dada como correcta, garantizan relaciones competitivas aún mejores de 2.76, 2.73, 2.75 y 3.17, respectivamente para esas acciones (detalles omitidos).",
        "MODELOS DE DISTRIBUCIÓN MACROSCÓPICA Concluimos nuestros resultados con un regreso al modelo de precio-volumen, donde introduciremos algunos métodos refinados de análisis para algoritmos de trading en línea.",
        "Dejamos la generalización de estos métodos al modelo de libro de órdenes para trabajos futuros.",
        "Los ratios de competitividad definidos hasta ahora miden el rendimiento en relación con algún criterio de referencia en el peor caso sobre todas las secuencias de mercado S ∈ Σ.",
        "Se ha observado en muchos entornos en línea que tales métricas de peor caso pueden arrojar resultados pesimistas, y se han considerado varias relajaciones, como permitir una distribución de probabilidad sobre la secuencia de entrada.",
        "Ahora consideramos modelos de distribución que son considerablemente más débiles que asumir una distribución sobre secuencias de mercado completas S ∈ Σ.",
        "En el modelo de distribución de volumen, asumimos únicamente que existe una distribución Pvol sobre el volumen total V negociado en el mercado durante el día, y luego examinamos la peor relación competitiva en secuencias consistentes con el volumen elegido al azar.",
        "Más precisamente, definimos RVWAP(A, Pvol) = EV ∼Pvol max S∈seq(V) VWAPM(S) VWAPA(S).",
        "Aquí V ∼ Pvol denota que V es elegido con respecto a la distribución Pvol, y seq(V) ⊂ Σ es el conjunto de todas las secuencias de mercado (p1, v1), . . . , (pT, vT) que satisfacen T t=1 vt = V.",
        "De manera similar, para OWT, podemos definir ROWT(A, Pmaxprice) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S).",
        "Aquí Pmaxprice es una distribución solo sobre el precio máximo del día, y luego examinamos secuencias de peor caso consistentes con este precio (seq(p) ⊂ Σ es el conjunto de todas las secuencias de mercado que satisfacen max1≤t≤T pt = p).",
        "Se pueden proporcionar definiciones análogas del lado de compra.",
        "Enfatizamos que en estos modelos, solo la distribución del volumen máximo y el precio es conocida por el algoritmo.",
        "También observamos que nuestras suposiciones probabilísticas sobre S son considerablemente más débiles que los modelos típicos de finanzas estadísticas, los cuales postularían un modelo estocástico detallado para la evolución paso a paso de (pt, vt).",
        "Aquí permitimos únicamente una distribución sobre medidas crudas y macroscópicas de la actividad del mercado durante todo el día, como el volumen total y el precio máximo, y analizamos el rendimiento en el peor de los casos coherente con estas medidas crudas.",
        "Por esta razón, nos referimos a tales configuraciones como el modelo de distribución macroscópica.",
        "El trabajo de El-Yaniv et al. [3] examina supuestos de distribución similares a los nuestros, pero también enfatizan las elecciones de peor caso para las distribuciones, y muestran que esto conduce a resultados no mejores que el análisis de peor caso original sobre todas las secuencias.",
        "Por el contrario, consideramos que el análisis de las distribuciones específicas Pvol y Pmaxprice es natural en muchos contextos financieros y nuestros resultados experimentales preliminares muestran mejoras significativas cuando se tiene en cuenta esta información distribucional bastante rudimentaria (ver Figura 3).",
        "Nuestros resultados en el contexto de VWAP examinan los casos en los que estas distribuciones son conocidas exactamente o solo aproximadamente.",
        "Resultados similares pueden obtenerse para distribuciones macroscópicas del precio máximo diario en el escenario de negociación unidireccional. 4.1 Resultados en el Modelo de Distribución Macroscópica Comenzamos señalando que los algoritmos examinados hasta ahora funcionan dividiendo los volúmenes totales o los precios máximos en contenedores de tamaño exponencialmente creciente, y luego adivinando el índice del contenedor en el que cae la cantidad real.",
        "Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en análisis competitivos) pueda depender de la distribución del índice de contenedor real.",
        "En lo que resta, asumimos que Q es una potencia de 2 y la base del logaritmo es 2.",
        "Que Pvol denote la distribución del volumen total diario del mercado.",
        "Definimos la distribución relacionada Pbins vol sobre los índices de los contenedores i de la siguiente manera: para todo i = 1, . . . , log(Q) − 1, Pbins vol (i) es igual a la probabilidad, bajo Pvol, de que el volumen diario caiga en el intervalo [Vmin 2i−1 , Vmin 2i ), y Pbins vol (log(Q)) es para el último intervalo [Vmax /2, Vmax].",
        "Definimos E como E(Pbins vol) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2.",
        "Dado que el soporte de Pbins vol tiene solo log(Q) elementos, E(Pbins vol ) puede variar desde 1 (para distribuciones Pvol que colocan todo su peso en solo uno de los log(Q) intervalos entre Vmin , Vmin 2, Vmin 4, . . . , Vmax ) hasta log(Q) (para distribuciones Pvol en las que el volumen diario total tiene igual probabilidad de caer en cualquiera de estos intervalos).",
        "Ten en cuenta que las distribuciones Pvol de este último tipo están lejos de ser uniformes en todo el rango [Vmin, Vmax].",
        "Teorema 10.",
        "En el modelo de distribución de volumen bajo el supuesto de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando únicamente el conocimiento de la distribución total de volumen Pvol, logra RVWAP(A, Pvol) ≤ 2E(Pbins vol).",
        "Todas las pruebas en esta sección se proporcionan en el apéndice.",
        "Como ejemplo concreto, considera el caso en el que Pvol es la distribución uniforme sobre [Vmin, Vmax].",
        "En ese caso, el volumen de Pbins está aumentando de forma exponencial y alcanza su punto máximo en el último bin, que, al tener el ancho más grande, también tiene el mayor peso.",
        "En este caso, E(Pbins vol) es una constante (es decir, independiente de Q), lo que conduce a una proporción competitiva constante.",
        "Por otro lado, si Pvol es exponencial, entonces Pbins vol es uniforme, lo que conduce a una proporción competitiva de O(log(Q)), al igual que en el entorno de precio-volumen más adversarial discutido anteriormente.",
        "En la Figura 3, proporcionamos límites específicos adicionales obtenidos para distribuciones empíricas de volumen diario total calculadas para algunas acciones reales.",
        "Ahora examinamos el escenario en el que Pvol es desconocido, pero se dispone de una aproximación ˜Pvol.",
        "Definamos C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
        "C se minimiza en C(Pbins vol , Pbins vol ) = E(Pbins vol ), y C puede ser infinito si ˜Pbins vol (i) es 0 cuando Pbins vol (i) > 0.",
        "Teorema 11.",
        "En el modelo de distribución de volumen bajo la suposición de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando solo el conocimiento de una aproximación ˜Pvol de Pvol, logra que RVWAP(A, Pvol) ≤ 2C(Pbins vol, ˜Pbins vol).",
        "Como ejemplo de este resultado, supongamos que nuestra aproximación cumple (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) para todo i, para algún α > 1.",
        "Por lo tanto, nuestras probabilidades estimadas de índice de contenedor están todas dentro de un factor de α de la verdad.",
        "Entonces es fácil demostrar que C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), por lo tanto, según los Teoremas 10 y 11, nuestra penalización por usar la distribución aproximada es un factor de α en la proporción competitiva. 5.",
        "REFERENCIAS [1] B. Awerbuch, Y. Bartal, A. Fiat y A. Rosén.",
        "Control de llamadas competitivo no preemptivo.",
        "En Proc. 5to Simposio ACM-SIAM sobre Algoritmos Discretos, páginas 312-320, 1994. [2] A. Borodin y R. El-Yaniv.",
        "Computación en línea y análisis competitivo.",
        "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp y G. Turpin.",
        "Algoritmos óptimos de búsqueda y comercio en línea unidireccional.",
        "Algorithmica, 30:101-139, 2001. [4] M. Kearns y L. Ortiz.",
        "El proyecto de trading automatizado Penn-Lehman.",
        "IEEE Intelligent Systems, 2003. \n\nSistemas Inteligentes de IEEE, 2003.",
        "Aparecer. 6.",
        "APÉNDICE 6.1 Pruebas de la Subsección 2.3 Prueba. (Bosquejo del Teorema 3) Sin pérdida de generalidad, asumir que Q = 1 y el volumen total es V.",
        "Considera el tiempo t donde el horario fijo f vende menos, entonces ft ≤ N/T.",
        "Considera las secuencias donde en el tiempo t tenemos pt = pmax, vt = V, y para los tiempos t = t tenemos pt = pmin y vt = 0.",
        "El VWAP es pmax y el promedio de horario fijo es (N/T)pmax + (N − N/T)pmin.",
        "Prueba. (Bosquejo del Teorema 4) El algoritmo simplemente vende ut = (vt/Vmin)N acciones en el tiempo t. El número total de acciones vendidas U es claramente mayor que N y U = t ut = t (vt/Vmin)N = (V/Vmin)N ≤ QN El precio promedio es V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), donde usamos el hecho de que ut/U = vt/V. 197 Prueba. (del Teorema 5) Comenzamos con la prueba del límite inferior.",
        "Considera el siguiente escenario.",
        "Durante las primeras T unidades de tiempo tenemos un precio de √ Rpmin y un volumen total de Vmin.",
        "Observamos cuántas acciones ha comprado el algoritmo en línea.",
        "Si ha comprado más de la mitad de las acciones, los pasos de tiempo restantes tienen un precio pmin y un volumen de Vmax − Vmin.",
        "De lo contrario, los pasos de tiempo restantes tienen un precio pmax y un volumen insignificante.",
        "En el primer caso, el comprador en línea ha pagado al menos √ Rpmin /2 mientras que el VWAP es a lo sumo √ Rpmin /Q + pmin.",
        "Por lo tanto, en este caso la proporción competitiva es Ω(Q).",
        "En el segundo caso, el comprador en línea tiene que comprar al menos la mitad de las acciones a pmax, por lo que su costo promedio es al menos pmax/2.",
        "El VWAP del mercado es √ Rpmin = pmax / √ R, por lo tanto, la proporción competitiva es Ω( √ R).",
        "Para el límite superior, podemos obtener una proporción competitiva de √ R, comprando todas las acciones una vez que el precio caiga por debajo de √ Rpmin.",
        "El límite superior de Q se deriva ejecutando un algoritmo que asume que el volumen es Vmin.",
        "El comprador en línea paga un costo de p, mientras que el VWAP será al menos p/Q. 6.2 Pruebas de la Sección 4 Prueba. (Bosquejo del Teorema 10) Utilizamos la idea de adivinar el volumen total del Teorema 1, pero ahora permitimos la posibilidad de una distribución arbitraria (pero conocida) sobre el volumen total.",
        "En particular, considere construir una distribución Gbins vol sobre un conjunto de valores de volumen utilizando Pvol y úsela para estimar el volumen total V.",
        "Permita que el algoritmo adivine ˆV = Vmin 2i con probabilidad Gbins vol (i).",
        "Luego, observe que, para cualquier secuencia de precio-volumen S, si V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
        "Esto implica un límite superior en RVWAP(A, Pvol) en términos de Gbins vol.",
        "Entonces obtenemos que Gbins vol (i) ∝ Pbins vol (i) minimiza el límite superior, lo que conduce al límite superior establecido en el teorema.",
        "Prueba. (Bosquejo del Teorema 11) Reemplace Pvol con ˜Pvol en la expresión de Gbins vol en el bosquejo de la prueba para el último resultado. 198"
    ],
    "error_count": 3,
    "keys": {
        "online model": {
            "translated_key": "modelo en línea",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic <br>online model</br> we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this <br>online model</br>, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "We first formalize the VWAP trading problem in a basic <br>online model</br> we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "More precisely, in this <br>online model</br>, we see the price-volume sequence one pair at a time."
            ],
            "translated_annotated_samples": [
                "Primero formalizamos el problema de trading VWAP en un <br>modelo en línea</br> básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado.",
                "Más precisamente, en este <br>modelo en línea</br>, observamos la secuencia de precio-volumen de a pares."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP. Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por acción. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un <br>modelo en línea</br> básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading. Más precisamente, en este <br>modelo en línea</br>, observamos la secuencia de precio-volumen de a pares. Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt. Supongamos que nuestro objetivo es vender N acciones a lo largo del día. Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT. De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante. Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas. Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema). En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios. En el trading de VWAP, el objetivo de un algoritmo en línea A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado. El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt. Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N. Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo. El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo. Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales. Es fácil ver que esto lo convierte en un criterio más desafiante de seguir. A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado. En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes. En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día. Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques. Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S). Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio. Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto. Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin. Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones. Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1. En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo. En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo. Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP. Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)). Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios. Teorema 1. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q). Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier algoritmo en línea A para vender N acciones tiene RVWAP(A) = Ω(log(Q)). Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1]. Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día. Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones. Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1. Claramente, uno de los Ai tiene una proporción competitiva de 2. Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada). Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT. Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2. Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP. Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ). Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo. Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1. Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0. Suponga que el precio máximo en S es pmax. El VWAP de nuestra secuencia es al menos pmax /3. Dado que teníamos un algoritmo c competitivo, su venta promedio es al menos pmax /3c. El límite inferior ahora se sigue utilizando el límite inferior en [3]. Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT. Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191. En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)). Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)). Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT. Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo. Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R). Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen. Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt). Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario. Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso. Teorema 3. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)). Las pruebas de todos los resultados de esta subsección están en el Apéndice. Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones. En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender. Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución. El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo. Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1. Teorema 4. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S). En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2]. En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo. Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente. Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema. Teorema 5. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un algoritmo en línea A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}). Además, cualquier algoritmo en línea A para comprar N acciones tiene una proporción competitiva de compra VWAP Rbuy VWAP(A) = Ω(min{Q, √ R}). 3. Un modelo de trading de libro de órdenes limitadas. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado. Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la negociación de acciones es entre una orden limitada y una orden de mercado. Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT). En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado. Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 2, que muestra una captura de pantalla real de un libro de órdenes reciente de MSFT en Island (www.island.com), un conocido intercambio electrónico de acciones de NASDAQ), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos. Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta). Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (siendo las órdenes más antiguas las primeras en el libro). En el ejemplo proporcionado por la Figura 2, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra. De manera similar, se mantiene un libro de órdenes de venta para órdenes de límite de venta (por ejemplo, podríamos querer vender 500 acciones de MSFT a $24.10 o más) esta vez con el precio de venta más bajo ofrecido (a menudo denominado como el precio de venta). Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas. Los precios de oferta y demanda (que nuevamente, son simplemente los precios en las órdenes límite en la parte superior de los libros de compra y venta, respectivamente) a veces se denominan como el mercado interno, y la diferencia entre ellos como el spread. Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección. ¿Entonces, cómo se ejecutan las órdenes? Hay dos métodos. Primero, cada vez que llega una orden de mercado, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto. Por lo tanto, una orden de mercado para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones. Por ejemplo, en el ejemplo de la Figura 2, tal orden sería completada por las dos órdenes de venta límite de 500 acciones a $24.069, las 500 acciones a $24.07, las 200 acciones a $24.08, y luego 300 de las 1981 acciones a $24.09. Las 1681 acciones restantes de esta última orden límite permanecerían como el nuevo tope del libro de órdenes de venta límite. Segundo, si una orden de límite de compra (venta, respectivamente) entra por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con órdenes en los libros opuestos. Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato. Cada orden de mercado o límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que las órdenes llegan, y dos órdenes nunca pueden llegar simultáneamente. Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden. Es esta cantidad la que generalmente se quiere decir cuando la gente se refiere casualmente al precio de una acción (ticker). Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una orden de mercado. Por lo tanto, asumiremos sin pérdida de generalidad que todas las órdenes se colocan como órdenes límite. Aunque las órdenes límite que no se ejecutan pueden ser eliminadas por la parte que las colocó, para simplificar, asumimos que las órdenes límite nunca son eliminadas de los libros. Remitimos al lector a [4] para obtener más información sobre los intercambios electrónicos modernos y la microestructura del mercado. 3.2 El Modelo El modelo de negociación de libros de órdenes en línea tiene como objetivo capturar los detalles realistas de la microestructura del mercado recién discutidos en un entorno de relación competitiva. En este modelo refinado, la actividad del mercado de un día se describe por una secuencia de órdenes límite (pt, vt, bt). Aquí bt es un bit que indica si la orden es de compra o venta, mientras que pt es el precio de la orden límite y vt es el número de acciones deseado. Tras la llegada de cada orden límite de este tipo, se permite a un algoritmo de trading en línea colocar su propia orden límite. Estas dos fuentes entrelazadas (mercado y algoritmo) de órdenes límite son simplemente operadas de acuerdo con el proceso de emparejamiento descrito en la Sección 3.1. Cualquier orden límite que no sea ejecutable de inmediato según este proceso se coloca en el libro correspondiente (compra o venta) para una posible ejecución futura; las órdenes que llegan y pueden ser ejecutadas parcial o totalmente se ejecutan de esa manera, con cualquier acción residual que permanezca en el libro respectivo. El objetivo de un algoritmo de venta VWAP u OWT es esencialmente el mismo que en el modelo de precio-volumen, pero el contexto ha cambiado en las siguientes dos formas fundamentales. Primero, la suposición de liquidez infinita en el modelo de precio-volumen se elimina por completo. El número de acciones disponibles a cualquier precio dado está restringido al volumen total de órdenes límite que ofrecen ese precio. Segundo, se asume que todas las órdenes entrantes, y por lo tanto los libros completos de órdenes límite, son visibles para el algoritmo. Esto es coherente con los intercambios financieros electrónicos modernos, y de hecho es la fuente de mucho interés actual en Wall Street [4]. En general, la definición de las ratios competitivas en el modelo de libro de órdenes se complica por el hecho de que ahora nuestra actividad algorítmica influye en la secuencia de precios y volúmenes ejecutados. Por lo tanto, primero definimos la secuencia de ejecución determinada por una secuencia de órdenes límite (colocadas por el mercado y nuestro algoritmo). Sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por el mercado, y sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por nuestro algoritmo (a menos que se especifique lo contrario, todos los bt son de tipo venta). Sea merge(S, S) la secuencia fusionada (p1, v1, b1), (p1, v1, b1), . . . , (pT, vT, bT), (pT, vT, bT), que es la secuencia temporal de órdenes realizadas por el mercado y el algoritmo. Ten en cuenta que el algoritmo tiene la opción de no realizar un pedido, lo cual podemos considerar como un pedido de volumen cero. Si llevamos a cabo el mantenimiento del libro de órdenes y el proceso de ejecución de órdenes descrito en la Sección 3.1 en la fusión de secuencias (S, S), en intervalos irregulares se produce una operación de compra/venta de un cierto número de acciones a un determinado precio. En cada operación ejecutada, la parte vendedora es o bien el mercado o el algoritmo. Sea execM (S, S ) = (q1, w1), . . . , (qT , wT ) la secuencia de ejecuciones donde el mercado (es decir, una parte distinta al algoritmo) fue la parte vendedora, donde los qt son los precios de ejecución y wt los volúmenes de ejecución. De manera similar, definimos execA(S, S) = (r1, x1), . . . , (rT, xT) como la secuencia de ejecuciones en las que el algoritmo fue la parte vendedora. Por lo tanto, execA(S, S) ∪ execM(S, S) es el conjunto de todas las ejecuciones. Generalmente esperamos que T sea (posiblemente mucho) más pequeño que T. Los ingresos del algoritmo y del mercado se definen como: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt. Nótese que ambas cantidades están determinadas únicamente por las secuencias de ejecución execM (S, S ) y execA(S, S ), respectivamente. Para un algoritmo A que está limitado a vender exactamente N acciones, definimos la razón de competencia OWT de A, ROWT(A), como la razón máxima (bajo cualquier S ∈ Σ) de los ingresos obtenidos por A, en comparación con los ingresos obtenidos por un algoritmo óptimo fuera de línea A∗. De manera más formal, para A∗ que está limitado a vender exactamente N acciones, definimos ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) donde S∗ es la secuencia de órdenes límite colocadas por A∗ en S. Si el algoritmo A es aleatorio, entonces tomamos la expectativa apropiada con respecto a S ∼ A. Definimos la ratio competitiva VWAP, RVWAP(A), como la ratio máxima (bajo cualquier S ∈ Σ) entre los VWAPs del mercado y del algoritmo. Más formalmente, define VWAPM (S, S ) como REVM (S, S )/ T t=1 wt, donde el denominador es simplemente el volumen total ejecutado de órdenes colocadas por el mercado. De manera similar, definimos VWAPA(S, S) como REVA(S, S)/N, ya que asumimos que el algoritmo vende no más de N acciones (esta definición asume implícitamente que A obtiene un precio de 0 por las acciones no vendidas). El ratio competitivo VWAP de A es entonces: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} donde S es la secuencia en línea de órdenes límite generadas por A en respuesta a la secuencia S. 3.3 Resultados de OWT en el Modelo de Libro de Órdenes. Para el problema de OWT en el modelo de libro de órdenes, introducimos una versión más sutil de la suposición de variabilidad de precios. Esto se debe al hecho de que nuestro trading algorítmico puede afectar los precios altos y bajos del día. Para la suposición a continuación, tenga en cuenta que execM (S, ∅) es la secuencia de ejecuciones sin la interacción de nuestro algoritmo. 3.3.0.3 Suposición de Variabilidad del Precio del Libro de Órdenes. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios pt en la secuencia execM (S, ∅) cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Tenga en cuenta que esta suposición no implica que las ratios de precios altos a bajos bajo las secuencias execM (S, S ) o execA(S, S ) estén limitadas por R. De hecho, la ratio en la secuencia execA(S, S ) podría ser infinita si el algoritmo termina vendiendo algunas acciones a un precio de 0. Teorema 6. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de venta OWT ROWT(A) = 2 log(R) log(N). Prueba. El algoritmo A funciona al adivinar un precio p en el conjunto {pmin2i : 1 ≤ i ≤ log(R)} y colocar una orden de venta límite por todas las N acciones al precio p al comienzo del día. (Alternativamente, el algoritmo A puede colocar log(R) órdenes de venta límite, donde la i-ésima tiene un precio de 2i pmin y un volumen de N/ log(R).) Al realizar un pedido al comienzo del día, el algoritmo ofrece un precio más bajo que todos los pedidos de venta que se realizarán durante el día por un precio de p o superior, lo que significa que primero se deben completar las N acciones del algoritmo a este precio. Por lo tanto, si hubiera habido k acciones que se hubieran vendido a un precio p o superior sin nuestra actividad, entonces A vendería al menos kp acciones. Definimos {pj} como el multiconjunto de precios de acciones individuales que han sido ejecutadas o son acciones de órdenes de compra límite que permanecieron sin ejecutar, excluyendo la actividad de nuestro algoritmo (es decir, asumiendo que nuestro algoritmo no coloca órdenes). Suponga sin pérdida de generalidad que p1 ≥ p2 ≥ . . .. Considerar adivinar el k-ésimo precio más alto, pk. Si se coloca una orden de N acciones al comienzo del día a un precio pk, entonces estamos garantizados de obtener un retorno de kpk. Que k∗ = argmaxk{kpk}. Podemos ver nuestro algoritmo como intentando adivinar pk∗, y teniendo éxito si la suposición p satisface p ∈ [pk∗ /2, pk∗]. Por lo tanto, somos 2 log(R) competitivos con la cantidad max1≤k≤N kpk. Se debe tener en cuenta que ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk donde ρ se define como la suma de los N precios principales pi sin la participación de A. De manera similar, sea {pj} el multiconjunto de precios de las acciones individuales ejecutadas, o los precios de las acciones de órdenes de compra no ejecutadas, pero ahora incluyendo las órdenes realizadas por algún algoritmo de venta A. Ahora deseamos demostrar que para todos los algoritmos A que venden N acciones, REVA ≤ N i=1 pi ≤ ρ. Esencialmente, esta desigualdad establece la idea intuitiva de que un algoritmo de venta solo puede reducir los precios de las órdenes de compra ejecutadas o no coincidentes. Para demostrar esto, utilizamos la inducción para mostrar que la eliminación de la actividad de un algoritmo de venta hace que estos precios aumenten. Primero, elimine la última acción en la última orden de venta realizada por A o el mercado en una fusión de secuencia arbitraria merge(S, S) - con esto queremos decir, tome la última orden de venta realizada por A o el mercado y disminuya su volumen en una acción. Después de esta modificación, los N precios más altos p1 . . . pN no disminuirán. Esto se debe a que o bien esta orden de venta no se ejecutó, en cuyo caso la afirmación es trivialmente verdadera, o, si se ejecutó, la eliminación de esta orden de venta deja una orden de compra adicional no ejecutada de igual o mayor precio. Para la inducción, asumimos que si eliminamos una participación de cualquier orden de venta que se haya colocado, ya sea por A o por el mercado, en o después del tiempo t, entonces los N precios principales no disminuyen. Ahora demostramos que si eliminamos una participación de la última orden de venta que fue colocada por A o el mercado antes del tiempo t, entonces los N precios principales no disminuyen. Si esta orden de venta de acciones no se ejecutó, entonces la afirmación es trivialmente verdadera. De lo contrario, si la orden de venta se ejecutó, entonces la afirmación es verdadera porque al eliminar esta acción ejecutada de la orden de venta, o bien: i) la acción correspondiente de la orden de compra (de igual o mayor valor) no se empareja en el resto de la secuencia, en cuyo caso la afirmación es verdadera; o ii) esta orden de compra se empareja con alguna acción de una orden de venta a un precio igual o mayor, lo que tiene el efecto de eliminar una acción de una orden de venta en el resto de la secuencia y, por la suposición inductiva, esto solo puede aumentar los precios. Por lo tanto, hemos demostrado que para todos los A que venden N acciones, REVA ≤ ρ. Ahora hemos establecido que nuestra ganancia satisface 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), donde A realiza una secuencia arbitraria de N órdenes de venta límite. 3.4 Resultados de VWAP en el Modelo del Libro de Órdenes El algoritmo OWT del Teorema 6 se puede aplicar para obtener el siguiente resultado de VWAP: Corolario 7. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de VWAP de venta RVWAP(A) = O(log(R) log(N)). Ahora hacemos una suposición bastante diferente sobre las secuencias S. 3.4.0.4 Volumen de Orden Acotado y Suposición de Precio Máximo. El conjunto de secuencias Σ satisface las siguientes dos propiedades. Primero, asumimos que cada orden colocada en el mercado tiene un volumen menor que γ, lo cual consideramos como una suposición leve ya que típicamente las órdenes individuales en el mercado no tienen un alto volumen (debido a problemas de liquidez). Esta suposición permite que nuestro algoritmo coloque al menos una orden límite a la vez intercalada con aproximadamente γ ejecuciones de mercado. Segundo, asumimos que hay un gran volumen en los libros de órdenes de venta por debajo del precio pmax, lo que significa que ninguna orden colocada por el mercado se ejecutará por encima del precio pmax. La forma más sencilla de instanciar esta última suposición en el modelo de libro de órdenes es asumir que cada secuencia S ∈ Σ comienza colocando un gran número de órdenes de venta (más de Vmax) a un precio pmax. Aunque esta suposición tiene un parámetro de precio máximo, no implica que la proporción de precios R sea finita, ya que no implica ningún límite inferior en los precios de compra o de las acciones ejecutadas (aparte del trivial de 0). Teorema 8. Considera el modelo de libro de órdenes bajo la suposición de volumen de orden limitado y precio máximo. Existe un algoritmo A en el cual después de exactamente γN ejecuciones de mercado, entonces A ha vendido como máximo N acciones y REVA(S, S) ≤ N = VWAPA(S, S) ≥ (1 − ε)VWAPM(S, S) − pmax N donde S es una secuencia de N órdenes de venta límite generadas por A al observar S. Demostración. El algoritmo divide el día de negociación en intervalos de volumen cuya duración en tiempo real puede variar. Para cada período i en el que se hayan ejecutado acciones γ en el mercado, el algoritmo calcula el VWAP de mercado solo de aquellas acciones negociadas en el período i; denotémoslo como VWAPi. Tras este intervalo de volumen i-ésimo, el algoritmo coloca una orden límite para vender exactamente una acción a un precio cercano al VWAPi. Más precisamente, el algoritmo solo coloca órdenes a los precios discretos (1− )pmax , (1− )2 pmax , . . .. Tras el intervalo de volumen i, el algoritmo coloca una orden límite para vender una acción al precio discretizado que esté más cercano al VWAPi, pero que sea estrictamente menor. Para el análisis, comenzamos observando que si todas las órdenes límite de los algoritmos se ejecutan durante el día, los ingresos totales recibidos por el algoritmo serían al menos (1 − )VWAPM (S, S )N. Para ver esto, basta con notar que VWAPM (S, S ) es una mezcla uniforme de los VWAPi (ya que por definición cubren la misma cantidad de volumen de mercado); y si todas las órdenes límite de los algoritmos se ejecutaran, cada uno recibiría más de (1 − )VWAPi dólares por el intervalo i que siguieron. Ahora contamos el potencial de ingresos perdidos del algoritmo debido a órdenes límite no ejecutadas. Por la suposición de que los pedidos individuales se realizan con un volumen menor que γ, entonces nuestro algoritmo es capaz de colocar una orden límite durante cada bloque de γ acciones que se han negociado. Por lo tanto, después de que se hayan ejecutado γN órdenes de mercado, A ha colocado N órdenes en el mercado. Ten en cuenta que puede haber como máximo una orden límite (y por lo tanto, como máximo una acción) sin ejecutar en cada nivel de la escalera de precios discretizada definida anteriormente. Esto se debe a que después del intervalo i, el algoritmo coloca su orden límite estrictamente por debajo de VWAPi, por lo que si VWAPj ≥ VWAPi para j > i, esta orden límite debe haber sido ejecutada. Por lo tanto, las órdenes límite no ejecutadas limitaron los VWAPs del resto del día, resultando en un máximo de una orden no ejecutada por nivel de precio. Un límite en la pérdida de ingresos es, por lo tanto, la suma de los precios discretizados: ∞ i=1(1 − )i pmax ≤ pmax / . Claramente nuestro algoritmo ha vendido como máximo N acciones. Ten en cuenta que a medida que N se vuelve grande, VWAPA se acerca a 1 menos el VWAP del mercado. Si supiéramos que el volumen total final de las ejecuciones del mercado es V, entonces podríamos establecer γ = V/N, asumiendo que γ >> 1. Si solo tenemos un límite superior e inferior en V, deberíamos poder adivinar y incurrir en una pérdida logarítmica. La siguiente suposición intenta capturar la variabilidad del volumen del mercado. Suposición de Variabilidad del Volumen del Libro de Órdenes 3.4.0.5. Ahora asumimos que el volumen total (que incluye las operaciones ejecutadas tanto por nuestro algoritmo como por el mercado) es variable dentro de una región conocida y que el volumen del mercado será mayor que el volumen de nuestros algoritmos. De manera más formal, para todo S ∈ Σ, asumir que el volumen total V de acciones negociadas en execM (S, S), para cualquier secuencia S de N órdenes de venta límite, satisface 2N ≤ Vmin ≤ V ≤ Vmax. Que Q = Vmax / Vmin. El siguiente corolario se deriva utilizando una constante = 1/2 y observando que si establecemos γ de manera que V ≤ γN ≤ 2V entonces nuestro algoritmo colocará entre N y N/2 órdenes límite. Corolario 9. En el modelo de libro de órdenes, si se cumplen la suposición de volumen de orden acotado y precio máximo, y la suposición de variabilidad del volumen del libro de órdenes, existe un algoritmo en línea A para vender como máximo N acciones tal que VWAPA(S, S) ≥ 1 4 log(Q) VWAPM(S, S) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figura 3: Aquí presentamos límites de la Sección 4 basados en las distribuciones de volumen empíricas para cuatro acciones reales: QQQ, MCHP, JNPR y CHKP. Los gráficos muestran histogramas de los volúmenes totales diarios transados en Island para estas acciones, en el último año y medio, junto con los valores correspondientes de log(Q) y E(Pbins vol) (denotado por E). Suponemos que los volúmenes diarios mínimo y máximo en los datos corresponden a Vmin y Vmax, respectivamente. Los límites de la razón competitiva en el peor de los casos (que son dos veces el logaritmo de Q) de nuestro algoritmo para esas acciones son 9.42, 10.56, 11.32 y 13.20, respectivamente. Los límites correspondientes sobre el rendimiento de la proporción competitiva de nuestro algoritmo bajo el modelo de distribución de volumen (que son el doble de E(Pbins vol )) son mejores: 7.54, 7.72, 7.94 y 9.00, respectivamente (una mejora relativa del 20-40%). Usando una partición de volumen más fina junto con un límite ligeramente más refinado en la relación competitiva, podemos construir algoritmos que, utilizando la distribución de volumen empírica dada como correcta, garantizan relaciones competitivas aún mejores de 2.76, 2.73, 2.75 y 3.17, respectivamente para esas acciones (detalles omitidos). MODELOS DE DISTRIBUCIÓN MACROSCÓPICA Concluimos nuestros resultados con un regreso al modelo de precio-volumen, donde introduciremos algunos métodos refinados de análisis para algoritmos de trading en línea. Dejamos la generalización de estos métodos al modelo de libro de órdenes para trabajos futuros. Los ratios de competitividad definidos hasta ahora miden el rendimiento en relación con algún criterio de referencia en el peor caso sobre todas las secuencias de mercado S ∈ Σ. Se ha observado en muchos entornos en línea que tales métricas de peor caso pueden arrojar resultados pesimistas, y se han considerado varias relajaciones, como permitir una distribución de probabilidad sobre la secuencia de entrada. Ahora consideramos modelos de distribución que son considerablemente más débiles que asumir una distribución sobre secuencias de mercado completas S ∈ Σ. En el modelo de distribución de volumen, asumimos únicamente que existe una distribución Pvol sobre el volumen total V negociado en el mercado durante el día, y luego examinamos la peor relación competitiva en secuencias consistentes con el volumen elegido al azar. Más precisamente, definimos RVWAP(A, Pvol) = EV ∼Pvol max S∈seq(V) VWAPM(S) VWAPA(S). Aquí V ∼ Pvol denota que V es elegido con respecto a la distribución Pvol, y seq(V) ⊂ Σ es el conjunto de todas las secuencias de mercado (p1, v1), . . . , (pT, vT) que satisfacen T t=1 vt = V. De manera similar, para OWT, podemos definir ROWT(A, Pmaxprice) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S). Aquí Pmaxprice es una distribución solo sobre el precio máximo del día, y luego examinamos secuencias de peor caso consistentes con este precio (seq(p) ⊂ Σ es el conjunto de todas las secuencias de mercado que satisfacen max1≤t≤T pt = p). Se pueden proporcionar definiciones análogas del lado de compra. Enfatizamos que en estos modelos, solo la distribución del volumen máximo y el precio es conocida por el algoritmo. También observamos que nuestras suposiciones probabilísticas sobre S son considerablemente más débiles que los modelos típicos de finanzas estadísticas, los cuales postularían un modelo estocástico detallado para la evolución paso a paso de (pt, vt). Aquí permitimos únicamente una distribución sobre medidas crudas y macroscópicas de la actividad del mercado durante todo el día, como el volumen total y el precio máximo, y analizamos el rendimiento en el peor de los casos coherente con estas medidas crudas. Por esta razón, nos referimos a tales configuraciones como el modelo de distribución macroscópica. El trabajo de El-Yaniv et al. [3] examina supuestos de distribución similares a los nuestros, pero también enfatizan las elecciones de peor caso para las distribuciones, y muestran que esto conduce a resultados no mejores que el análisis de peor caso original sobre todas las secuencias. Por el contrario, consideramos que el análisis de las distribuciones específicas Pvol y Pmaxprice es natural en muchos contextos financieros y nuestros resultados experimentales preliminares muestran mejoras significativas cuando se tiene en cuenta esta información distribucional bastante rudimentaria (ver Figura 3). Nuestros resultados en el contexto de VWAP examinan los casos en los que estas distribuciones son conocidas exactamente o solo aproximadamente. Resultados similares pueden obtenerse para distribuciones macroscópicas del precio máximo diario en el escenario de negociación unidireccional. 4.1 Resultados en el Modelo de Distribución Macroscópica Comenzamos señalando que los algoritmos examinados hasta ahora funcionan dividiendo los volúmenes totales o los precios máximos en contenedores de tamaño exponencialmente creciente, y luego adivinando el índice del contenedor en el que cae la cantidad real. Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en análisis competitivos) pueda depender de la distribución del índice de contenedor real. En lo que resta, asumimos que Q es una potencia de 2 y la base del logaritmo es 2. Que Pvol denote la distribución del volumen total diario del mercado. Definimos la distribución relacionada Pbins vol sobre los índices de los contenedores i de la siguiente manera: para todo i = 1, . . . , log(Q) − 1, Pbins vol (i) es igual a la probabilidad, bajo Pvol, de que el volumen diario caiga en el intervalo [Vmin 2i−1 , Vmin 2i ), y Pbins vol (log(Q)) es para el último intervalo [Vmax /2, Vmax]. Definimos E como E(Pbins vol) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2. Dado que el soporte de Pbins vol tiene solo log(Q) elementos, E(Pbins vol ) puede variar desde 1 (para distribuciones Pvol que colocan todo su peso en solo uno de los log(Q) intervalos entre Vmin , Vmin 2, Vmin 4, . . . , Vmax ) hasta log(Q) (para distribuciones Pvol en las que el volumen diario total tiene igual probabilidad de caer en cualquiera de estos intervalos). Ten en cuenta que las distribuciones Pvol de este último tipo están lejos de ser uniformes en todo el rango [Vmin, Vmax]. Teorema 10. En el modelo de distribución de volumen bajo el supuesto de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando únicamente el conocimiento de la distribución total de volumen Pvol, logra RVWAP(A, Pvol) ≤ 2E(Pbins vol). Todas las pruebas en esta sección se proporcionan en el apéndice. Como ejemplo concreto, considera el caso en el que Pvol es la distribución uniforme sobre [Vmin, Vmax]. En ese caso, el volumen de Pbins está aumentando de forma exponencial y alcanza su punto máximo en el último bin, que, al tener el ancho más grande, también tiene el mayor peso. En este caso, E(Pbins vol) es una constante (es decir, independiente de Q), lo que conduce a una proporción competitiva constante. Por otro lado, si Pvol es exponencial, entonces Pbins vol es uniforme, lo que conduce a una proporción competitiva de O(log(Q)), al igual que en el entorno de precio-volumen más adversarial discutido anteriormente. En la Figura 3, proporcionamos límites específicos adicionales obtenidos para distribuciones empíricas de volumen diario total calculadas para algunas acciones reales. Ahora examinamos el escenario en el que Pvol es desconocido, pero se dispone de una aproximación ˜Pvol. Definamos C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) . C se minimiza en C(Pbins vol , Pbins vol ) = E(Pbins vol ), y C puede ser infinito si ˜Pbins vol (i) es 0 cuando Pbins vol (i) > 0. Teorema 11. En el modelo de distribución de volumen bajo la suposición de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando solo el conocimiento de una aproximación ˜Pvol de Pvol, logra que RVWAP(A, Pvol) ≤ 2C(Pbins vol, ˜Pbins vol). Como ejemplo de este resultado, supongamos que nuestra aproximación cumple (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) para todo i, para algún α > 1. Por lo tanto, nuestras probabilidades estimadas de índice de contenedor están todas dentro de un factor de α de la verdad. Entonces es fácil demostrar que C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), por lo tanto, según los Teoremas 10 y 11, nuestra penalización por usar la distribución aproximada es un factor de α en la proporción competitiva. 5. REFERENCIAS [1] B. Awerbuch, Y. Bartal, A. Fiat y A. Rosén. Control de llamadas competitivo no preemptivo. En Proc. 5to Simposio ACM-SIAM sobre Algoritmos Discretos, páginas 312-320, 1994. [2] A. Borodin y R. El-Yaniv. Computación en línea y análisis competitivo. Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp y G. Turpin. Algoritmos óptimos de búsqueda y comercio en línea unidireccional. Algorithmica, 30:101-139, 2001. [4] M. Kearns y L. Ortiz. El proyecto de trading automatizado Penn-Lehman. IEEE Intelligent Systems, 2003. \n\nSistemas Inteligentes de IEEE, 2003. Aparecer. 6. APÉNDICE 6.1 Pruebas de la Subsección 2.3 Prueba. (Bosquejo del Teorema 3) Sin pérdida de generalidad, asumir que Q = 1 y el volumen total es V. Considera el tiempo t donde el horario fijo f vende menos, entonces ft ≤ N/T. Considera las secuencias donde en el tiempo t tenemos pt = pmax, vt = V, y para los tiempos t = t tenemos pt = pmin y vt = 0. El VWAP es pmax y el promedio de horario fijo es (N/T)pmax + (N − N/T)pmin. Prueba. (Bosquejo del Teorema 4) El algoritmo simplemente vende ut = (vt/Vmin)N acciones en el tiempo t. El número total de acciones vendidas U es claramente mayor que N y U = t ut = t (vt/Vmin)N = (V/Vmin)N ≤ QN El precio promedio es V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), donde usamos el hecho de que ut/U = vt/V. 197 Prueba. (del Teorema 5) Comenzamos con la prueba del límite inferior. Considera el siguiente escenario. Durante las primeras T unidades de tiempo tenemos un precio de √ Rpmin y un volumen total de Vmin. Observamos cuántas acciones ha comprado el algoritmo en línea. Si ha comprado más de la mitad de las acciones, los pasos de tiempo restantes tienen un precio pmin y un volumen de Vmax − Vmin. De lo contrario, los pasos de tiempo restantes tienen un precio pmax y un volumen insignificante. En el primer caso, el comprador en línea ha pagado al menos √ Rpmin /2 mientras que el VWAP es a lo sumo √ Rpmin /Q + pmin. Por lo tanto, en este caso la proporción competitiva es Ω(Q). En el segundo caso, el comprador en línea tiene que comprar al menos la mitad de las acciones a pmax, por lo que su costo promedio es al menos pmax/2. El VWAP del mercado es √ Rpmin = pmax / √ R, por lo tanto, la proporción competitiva es Ω( √ R). Para el límite superior, podemos obtener una proporción competitiva de √ R, comprando todas las acciones una vez que el precio caiga por debajo de √ Rpmin. El límite superior de Q se deriva ejecutando un algoritmo que asume que el volumen es Vmin. El comprador en línea paga un costo de p, mientras que el VWAP será al menos p/Q. 6.2 Pruebas de la Sección 4 Prueba. (Bosquejo del Teorema 10) Utilizamos la idea de adivinar el volumen total del Teorema 1, pero ahora permitimos la posibilidad de una distribución arbitraria (pero conocida) sobre el volumen total. En particular, considere construir una distribución Gbins vol sobre un conjunto de valores de volumen utilizando Pvol y úsela para estimar el volumen total V. Permita que el algoritmo adivine ˆV = Vmin 2i con probabilidad Gbins vol (i). Luego, observe que, para cualquier secuencia de precio-volumen S, si V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2. Esto implica un límite superior en RVWAP(A, Pvol) en términos de Gbins vol. Entonces obtenemos que Gbins vol (i) ∝ Pbins vol (i) minimiza el límite superior, lo que conduce al límite superior establecido en el teorema. Prueba. (Bosquejo del Teorema 11) Reemplace Pvol con ˜Pvol en la expresión de Gbins vol en el bosquejo de la prueba para el último resultado. 198 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "modern financial market": {
            "translated_key": "mercados financieros modernos",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of <br>modern financial market</br>s: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in <br>modern financial market</br>s is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of <br>modern financial market</br>s: Volume Weighted Average Price trading and limit order books.",
                "One of the most common activities in <br>modern financial market</br>s is known as Volume Weighted Average Price, or VWAP, trading."
            ],
            "translated_annotated_samples": [
                "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los <br>mercados financieros modernos</br>: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite.",
                "Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de <br>Precio Promedio Ponderado por Volumen</br>, o VWAP."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los <br>mercados financieros modernos</br>: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de <br>Precio Promedio Ponderado por Volumen</br>, o VWAP. Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por acción. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading. Más precisamente, en este modelo en línea, observamos la secuencia de precio-volumen de a pares. Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt. Supongamos que nuestro objetivo es vender N acciones a lo largo del día. Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT. De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante. Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas. Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema). En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios. En el trading de VWAP, el objetivo de un algoritmo en línea A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado. El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt. Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N. Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo. El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo. Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales. Es fácil ver que esto lo convierte en un criterio más desafiante de seguir. A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado. En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes. En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día. Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques. Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S). Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio. Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto. Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin. Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones. Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1. En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo. En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo. Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP. Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)). Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios. Teorema 1. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q). Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier algoritmo en línea A para vender N acciones tiene RVWAP(A) = Ω(log(Q)). Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1]. Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día. Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones. Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1. Claramente, uno de los Ai tiene una proporción competitiva de 2. Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada). Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT. Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2. Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP. Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ). Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo. Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1. Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0. Suponga que el precio máximo en S es pmax. El VWAP de nuestra secuencia es al menos pmax /3. Dado que teníamos un algoritmo c competitivo, su venta promedio es al menos pmax /3c. El límite inferior ahora se sigue utilizando el límite inferior en [3]. Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT. Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191. En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)). Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)). Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT. Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo. Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R). Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen. Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt). Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario. Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso. Teorema 3. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)). Las pruebas de todos los resultados de esta subsección están en el Apéndice. Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones. En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender. Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución. El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo. Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1. Teorema 4. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S). En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2]. En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo. Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente. Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema. Teorema 5. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un algoritmo en línea A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}). Además, cualquier algoritmo en línea A para comprar N acciones tiene una proporción competitiva de compra VWAP Rbuy VWAP(A) = Ω(min{Q, √ R}). 3. Un modelo de trading de libro de órdenes limitadas. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado. Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la negociación de acciones es entre una orden limitada y una orden de mercado. Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT). En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado. Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 2, que muestra una captura de pantalla real de un libro de órdenes reciente de MSFT en Island (www.island.com), un conocido intercambio electrónico de acciones de NASDAQ), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos. Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta). Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (siendo las órdenes más antiguas las primeras en el libro). En el ejemplo proporcionado por la Figura 2, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra. De manera similar, se mantiene un libro de órdenes de venta para órdenes de límite de venta (por ejemplo, podríamos querer vender 500 acciones de MSFT a $24.10 o más) esta vez con el precio de venta más bajo ofrecido (a menudo denominado como el precio de venta). Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas. Los precios de oferta y demanda (que nuevamente, son simplemente los precios en las órdenes límite en la parte superior de los libros de compra y venta, respectivamente) a veces se denominan como el mercado interno, y la diferencia entre ellos como el spread. Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección. ¿Entonces, cómo se ejecutan las órdenes? Hay dos métodos. Primero, cada vez que llega una orden de mercado, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto. Por lo tanto, una orden de mercado para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones. Por ejemplo, en el ejemplo de la Figura 2, tal orden sería completada por las dos órdenes de venta límite de 500 acciones a $24.069, las 500 acciones a $24.07, las 200 acciones a $24.08, y luego 300 de las 1981 acciones a $24.09. Las 1681 acciones restantes de esta última orden límite permanecerían como el nuevo tope del libro de órdenes de venta límite. Segundo, si una orden de límite de compra (venta, respectivamente) entra por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con órdenes en los libros opuestos. Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato. Cada orden de mercado o límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que las órdenes llegan, y dos órdenes nunca pueden llegar simultáneamente. Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden. Es esta cantidad la que generalmente se quiere decir cuando la gente se refiere casualmente al precio de una acción (ticker). Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una orden de mercado. Por lo tanto, asumiremos sin pérdida de generalidad que todas las órdenes se colocan como órdenes límite. Aunque las órdenes límite que no se ejecutan pueden ser eliminadas por la parte que las colocó, para simplificar, asumimos que las órdenes límite nunca son eliminadas de los libros. Remitimos al lector a [4] para obtener más información sobre los intercambios electrónicos modernos y la microestructura del mercado. 3.2 El Modelo El modelo de negociación de libros de órdenes en línea tiene como objetivo capturar los detalles realistas de la microestructura del mercado recién discutidos en un entorno de relación competitiva. En este modelo refinado, la actividad del mercado de un día se describe por una secuencia de órdenes límite (pt, vt, bt). Aquí bt es un bit que indica si la orden es de compra o venta, mientras que pt es el precio de la orden límite y vt es el número de acciones deseado. Tras la llegada de cada orden límite de este tipo, se permite a un algoritmo de trading en línea colocar su propia orden límite. Estas dos fuentes entrelazadas (mercado y algoritmo) de órdenes límite son simplemente operadas de acuerdo con el proceso de emparejamiento descrito en la Sección 3.1. Cualquier orden límite que no sea ejecutable de inmediato según este proceso se coloca en el libro correspondiente (compra o venta) para una posible ejecución futura; las órdenes que llegan y pueden ser ejecutadas parcial o totalmente se ejecutan de esa manera, con cualquier acción residual que permanezca en el libro respectivo. El objetivo de un algoritmo de venta VWAP u OWT es esencialmente el mismo que en el modelo de precio-volumen, pero el contexto ha cambiado en las siguientes dos formas fundamentales. Primero, la suposición de liquidez infinita en el modelo de precio-volumen se elimina por completo. El número de acciones disponibles a cualquier precio dado está restringido al volumen total de órdenes límite que ofrecen ese precio. Segundo, se asume que todas las órdenes entrantes, y por lo tanto los libros completos de órdenes límite, son visibles para el algoritmo. Esto es coherente con los intercambios financieros electrónicos modernos, y de hecho es la fuente de mucho interés actual en Wall Street [4]. En general, la definición de las ratios competitivas en el modelo de libro de órdenes se complica por el hecho de que ahora nuestra actividad algorítmica influye en la secuencia de precios y volúmenes ejecutados. Por lo tanto, primero definimos la secuencia de ejecución determinada por una secuencia de órdenes límite (colocadas por el mercado y nuestro algoritmo). Sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por el mercado, y sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por nuestro algoritmo (a menos que se especifique lo contrario, todos los bt son de tipo venta). Sea merge(S, S) la secuencia fusionada (p1, v1, b1), (p1, v1, b1), . . . , (pT, vT, bT), (pT, vT, bT), que es la secuencia temporal de órdenes realizadas por el mercado y el algoritmo. Ten en cuenta que el algoritmo tiene la opción de no realizar un pedido, lo cual podemos considerar como un pedido de volumen cero. Si llevamos a cabo el mantenimiento del libro de órdenes y el proceso de ejecución de órdenes descrito en la Sección 3.1 en la fusión de secuencias (S, S), en intervalos irregulares se produce una operación de compra/venta de un cierto número de acciones a un determinado precio. En cada operación ejecutada, la parte vendedora es o bien el mercado o el algoritmo. Sea execM (S, S ) = (q1, w1), . . . , (qT , wT ) la secuencia de ejecuciones donde el mercado (es decir, una parte distinta al algoritmo) fue la parte vendedora, donde los qt son los precios de ejecución y wt los volúmenes de ejecución. De manera similar, definimos execA(S, S) = (r1, x1), . . . , (rT, xT) como la secuencia de ejecuciones en las que el algoritmo fue la parte vendedora. Por lo tanto, execA(S, S) ∪ execM(S, S) es el conjunto de todas las ejecuciones. Generalmente esperamos que T sea (posiblemente mucho) más pequeño que T. Los ingresos del algoritmo y del mercado se definen como: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt. Nótese que ambas cantidades están determinadas únicamente por las secuencias de ejecución execM (S, S ) y execA(S, S ), respectivamente. Para un algoritmo A que está limitado a vender exactamente N acciones, definimos la razón de competencia OWT de A, ROWT(A), como la razón máxima (bajo cualquier S ∈ Σ) de los ingresos obtenidos por A, en comparación con los ingresos obtenidos por un algoritmo óptimo fuera de línea A∗. De manera más formal, para A∗ que está limitado a vender exactamente N acciones, definimos ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) donde S∗ es la secuencia de órdenes límite colocadas por A∗ en S. Si el algoritmo A es aleatorio, entonces tomamos la expectativa apropiada con respecto a S ∼ A. Definimos la ratio competitiva VWAP, RVWAP(A), como la ratio máxima (bajo cualquier S ∈ Σ) entre los VWAPs del mercado y del algoritmo. Más formalmente, define VWAPM (S, S ) como REVM (S, S )/ T t=1 wt, donde el denominador es simplemente el volumen total ejecutado de órdenes colocadas por el mercado. De manera similar, definimos VWAPA(S, S) como REVA(S, S)/N, ya que asumimos que el algoritmo vende no más de N acciones (esta definición asume implícitamente que A obtiene un precio de 0 por las acciones no vendidas). El ratio competitivo VWAP de A es entonces: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} donde S es la secuencia en línea de órdenes límite generadas por A en respuesta a la secuencia S. 3.3 Resultados de OWT en el Modelo de Libro de Órdenes. Para el problema de OWT en el modelo de libro de órdenes, introducimos una versión más sutil de la suposición de variabilidad de precios. Esto se debe al hecho de que nuestro trading algorítmico puede afectar los precios altos y bajos del día. Para la suposición a continuación, tenga en cuenta que execM (S, ∅) es la secuencia de ejecuciones sin la interacción de nuestro algoritmo. 3.3.0.3 Suposición de Variabilidad del Precio del Libro de Órdenes. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios pt en la secuencia execM (S, ∅) cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Tenga en cuenta que esta suposición no implica que las ratios de precios altos a bajos bajo las secuencias execM (S, S ) o execA(S, S ) estén limitadas por R. De hecho, la ratio en la secuencia execA(S, S ) podría ser infinita si el algoritmo termina vendiendo algunas acciones a un precio de 0. Teorema 6. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de venta OWT ROWT(A) = 2 log(R) log(N). Prueba. El algoritmo A funciona al adivinar un precio p en el conjunto {pmin2i : 1 ≤ i ≤ log(R)} y colocar una orden de venta límite por todas las N acciones al precio p al comienzo del día. (Alternativamente, el algoritmo A puede colocar log(R) órdenes de venta límite, donde la i-ésima tiene un precio de 2i pmin y un volumen de N/ log(R).) Al realizar un pedido al comienzo del día, el algoritmo ofrece un precio más bajo que todos los pedidos de venta que se realizarán durante el día por un precio de p o superior, lo que significa que primero se deben completar las N acciones del algoritmo a este precio. Por lo tanto, si hubiera habido k acciones que se hubieran vendido a un precio p o superior sin nuestra actividad, entonces A vendería al menos kp acciones. Definimos {pj} como el multiconjunto de precios de acciones individuales que han sido ejecutadas o son acciones de órdenes de compra límite que permanecieron sin ejecutar, excluyendo la actividad de nuestro algoritmo (es decir, asumiendo que nuestro algoritmo no coloca órdenes). Suponga sin pérdida de generalidad que p1 ≥ p2 ≥ . . .. Considerar adivinar el k-ésimo precio más alto, pk. Si se coloca una orden de N acciones al comienzo del día a un precio pk, entonces estamos garantizados de obtener un retorno de kpk. Que k∗ = argmaxk{kpk}. Podemos ver nuestro algoritmo como intentando adivinar pk∗, y teniendo éxito si la suposición p satisface p ∈ [pk∗ /2, pk∗]. Por lo tanto, somos 2 log(R) competitivos con la cantidad max1≤k≤N kpk. Se debe tener en cuenta que ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk donde ρ se define como la suma de los N precios principales pi sin la participación de A. De manera similar, sea {pj} el multiconjunto de precios de las acciones individuales ejecutadas, o los precios de las acciones de órdenes de compra no ejecutadas, pero ahora incluyendo las órdenes realizadas por algún algoritmo de venta A. Ahora deseamos demostrar que para todos los algoritmos A que venden N acciones, REVA ≤ N i=1 pi ≤ ρ. Esencialmente, esta desigualdad establece la idea intuitiva de que un algoritmo de venta solo puede reducir los precios de las órdenes de compra ejecutadas o no coincidentes. Para demostrar esto, utilizamos la inducción para mostrar que la eliminación de la actividad de un algoritmo de venta hace que estos precios aumenten. Primero, elimine la última acción en la última orden de venta realizada por A o el mercado en una fusión de secuencia arbitraria merge(S, S) - con esto queremos decir, tome la última orden de venta realizada por A o el mercado y disminuya su volumen en una acción. Después de esta modificación, los N precios más altos p1 . . . pN no disminuirán. Esto se debe a que o bien esta orden de venta no se ejecutó, en cuyo caso la afirmación es trivialmente verdadera, o, si se ejecutó, la eliminación de esta orden de venta deja una orden de compra adicional no ejecutada de igual o mayor precio. Para la inducción, asumimos que si eliminamos una participación de cualquier orden de venta que se haya colocado, ya sea por A o por el mercado, en o después del tiempo t, entonces los N precios principales no disminuyen. Ahora demostramos que si eliminamos una participación de la última orden de venta que fue colocada por A o el mercado antes del tiempo t, entonces los N precios principales no disminuyen. Si esta orden de venta de acciones no se ejecutó, entonces la afirmación es trivialmente verdadera. De lo contrario, si la orden de venta se ejecutó, entonces la afirmación es verdadera porque al eliminar esta acción ejecutada de la orden de venta, o bien: i) la acción correspondiente de la orden de compra (de igual o mayor valor) no se empareja en el resto de la secuencia, en cuyo caso la afirmación es verdadera; o ii) esta orden de compra se empareja con alguna acción de una orden de venta a un precio igual o mayor, lo que tiene el efecto de eliminar una acción de una orden de venta en el resto de la secuencia y, por la suposición inductiva, esto solo puede aumentar los precios. Por lo tanto, hemos demostrado que para todos los A que venden N acciones, REVA ≤ ρ. Ahora hemos establecido que nuestra ganancia satisface 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), donde A realiza una secuencia arbitraria de N órdenes de venta límite. 3.4 Resultados de VWAP en el Modelo del Libro de Órdenes El algoritmo OWT del Teorema 6 se puede aplicar para obtener el siguiente resultado de VWAP: Corolario 7. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de VWAP de venta RVWAP(A) = O(log(R) log(N)). Ahora hacemos una suposición bastante diferente sobre las secuencias S. 3.4.0.4 Volumen de Orden Acotado y Suposición de Precio Máximo. El conjunto de secuencias Σ satisface las siguientes dos propiedades. Primero, asumimos que cada orden colocada en el mercado tiene un volumen menor que γ, lo cual consideramos como una suposición leve ya que típicamente las órdenes individuales en el mercado no tienen un alto volumen (debido a problemas de liquidez). Esta suposición permite que nuestro algoritmo coloque al menos una orden límite a la vez intercalada con aproximadamente γ ejecuciones de mercado. Segundo, asumimos que hay un gran volumen en los libros de órdenes de venta por debajo del precio pmax, lo que significa que ninguna orden colocada por el mercado se ejecutará por encima del precio pmax. La forma más sencilla de instanciar esta última suposición en el modelo de libro de órdenes es asumir que cada secuencia S ∈ Σ comienza colocando un gran número de órdenes de venta (más de Vmax) a un precio pmax. Aunque esta suposición tiene un parámetro de precio máximo, no implica que la proporción de precios R sea finita, ya que no implica ningún límite inferior en los precios de compra o de las acciones ejecutadas (aparte del trivial de 0). Teorema 8. Considera el modelo de libro de órdenes bajo la suposición de volumen de orden limitado y precio máximo. Existe un algoritmo A en el cual después de exactamente γN ejecuciones de mercado, entonces A ha vendido como máximo N acciones y REVA(S, S) ≤ N = VWAPA(S, S) ≥ (1 − ε)VWAPM(S, S) − pmax N donde S es una secuencia de N órdenes de venta límite generadas por A al observar S. Demostración. El algoritmo divide el día de negociación en intervalos de volumen cuya duración en tiempo real puede variar. Para cada período i en el que se hayan ejecutado acciones γ en el mercado, el algoritmo calcula el VWAP de mercado solo de aquellas acciones negociadas en el período i; denotémoslo como VWAPi. Tras este intervalo de volumen i-ésimo, el algoritmo coloca una orden límite para vender exactamente una acción a un precio cercano al VWAPi. Más precisamente, el algoritmo solo coloca órdenes a los precios discretos (1− )pmax , (1− )2 pmax , . . .. Tras el intervalo de volumen i, el algoritmo coloca una orden límite para vender una acción al precio discretizado que esté más cercano al VWAPi, pero que sea estrictamente menor. Para el análisis, comenzamos observando que si todas las órdenes límite de los algoritmos se ejecutan durante el día, los ingresos totales recibidos por el algoritmo serían al menos (1 − )VWAPM (S, S )N. Para ver esto, basta con notar que VWAPM (S, S ) es una mezcla uniforme de los VWAPi (ya que por definición cubren la misma cantidad de volumen de mercado); y si todas las órdenes límite de los algoritmos se ejecutaran, cada uno recibiría más de (1 − )VWAPi dólares por el intervalo i que siguieron. Ahora contamos el potencial de ingresos perdidos del algoritmo debido a órdenes límite no ejecutadas. Por la suposición de que los pedidos individuales se realizan con un volumen menor que γ, entonces nuestro algoritmo es capaz de colocar una orden límite durante cada bloque de γ acciones que se han negociado. Por lo tanto, después de que se hayan ejecutado γN órdenes de mercado, A ha colocado N órdenes en el mercado. Ten en cuenta que puede haber como máximo una orden límite (y por lo tanto, como máximo una acción) sin ejecutar en cada nivel de la escalera de precios discretizada definida anteriormente. Esto se debe a que después del intervalo i, el algoritmo coloca su orden límite estrictamente por debajo de VWAPi, por lo que si VWAPj ≥ VWAPi para j > i, esta orden límite debe haber sido ejecutada. Por lo tanto, las órdenes límite no ejecutadas limitaron los VWAPs del resto del día, resultando en un máximo de una orden no ejecutada por nivel de precio. Un límite en la pérdida de ingresos es, por lo tanto, la suma de los precios discretizados: ∞ i=1(1 − )i pmax ≤ pmax / . Claramente nuestro algoritmo ha vendido como máximo N acciones. Ten en cuenta que a medida que N se vuelve grande, VWAPA se acerca a 1 menos el VWAP del mercado. Si supiéramos que el volumen total final de las ejecuciones del mercado es V, entonces podríamos establecer γ = V/N, asumiendo que γ >> 1. Si solo tenemos un límite superior e inferior en V, deberíamos poder adivinar y incurrir en una pérdida logarítmica. La siguiente suposición intenta capturar la variabilidad del volumen del mercado. Suposición de Variabilidad del Volumen del Libro de Órdenes 3.4.0.5. Ahora asumimos que el volumen total (que incluye las operaciones ejecutadas tanto por nuestro algoritmo como por el mercado) es variable dentro de una región conocida y que el volumen del mercado será mayor que el volumen de nuestros algoritmos. De manera más formal, para todo S ∈ Σ, asumir que el volumen total V de acciones negociadas en execM (S, S), para cualquier secuencia S de N órdenes de venta límite, satisface 2N ≤ Vmin ≤ V ≤ Vmax. Que Q = Vmax / Vmin. El siguiente corolario se deriva utilizando una constante = 1/2 y observando que si establecemos γ de manera que V ≤ γN ≤ 2V entonces nuestro algoritmo colocará entre N y N/2 órdenes límite. Corolario 9. En el modelo de libro de órdenes, si se cumplen la suposición de volumen de orden acotado y precio máximo, y la suposición de variabilidad del volumen del libro de órdenes, existe un algoritmo en línea A para vender como máximo N acciones tal que VWAPA(S, S) ≥ 1 4 log(Q) VWAPM(S, S) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figura 3: Aquí presentamos límites de la Sección 4 basados en las distribuciones de volumen empíricas para cuatro acciones reales: QQQ, MCHP, JNPR y CHKP. Los gráficos muestran histogramas de los volúmenes totales diarios transados en Island para estas acciones, en el último año y medio, junto con los valores correspondientes de log(Q) y E(Pbins vol) (denotado por E). Suponemos que los volúmenes diarios mínimo y máximo en los datos corresponden a Vmin y Vmax, respectivamente. Los límites de la razón competitiva en el peor de los casos (que son dos veces el logaritmo de Q) de nuestro algoritmo para esas acciones son 9.42, 10.56, 11.32 y 13.20, respectivamente. Los límites correspondientes sobre el rendimiento de la proporción competitiva de nuestro algoritmo bajo el modelo de distribución de volumen (que son el doble de E(Pbins vol )) son mejores: 7.54, 7.72, 7.94 y 9.00, respectivamente (una mejora relativa del 20-40%). Usando una partición de volumen más fina junto con un límite ligeramente más refinado en la relación competitiva, podemos construir algoritmos que, utilizando la distribución de volumen empírica dada como correcta, garantizan relaciones competitivas aún mejores de 2.76, 2.73, 2.75 y 3.17, respectivamente para esas acciones (detalles omitidos). MODELOS DE DISTRIBUCIÓN MACROSCÓPICA Concluimos nuestros resultados con un regreso al modelo de precio-volumen, donde introduciremos algunos métodos refinados de análisis para algoritmos de trading en línea. Dejamos la generalización de estos métodos al modelo de libro de órdenes para trabajos futuros. Los ratios de competitividad definidos hasta ahora miden el rendimiento en relación con algún criterio de referencia en el peor caso sobre todas las secuencias de mercado S ∈ Σ. Se ha observado en muchos entornos en línea que tales métricas de peor caso pueden arrojar resultados pesimistas, y se han considerado varias relajaciones, como permitir una distribución de probabilidad sobre la secuencia de entrada. Ahora consideramos modelos de distribución que son considerablemente más débiles que asumir una distribución sobre secuencias de mercado completas S ∈ Σ. En el modelo de distribución de volumen, asumimos únicamente que existe una distribución Pvol sobre el volumen total V negociado en el mercado durante el día, y luego examinamos la peor relación competitiva en secuencias consistentes con el volumen elegido al azar. Más precisamente, definimos RVWAP(A, Pvol) = EV ∼Pvol max S∈seq(V) VWAPM(S) VWAPA(S). Aquí V ∼ Pvol denota que V es elegido con respecto a la distribución Pvol, y seq(V) ⊂ Σ es el conjunto de todas las secuencias de mercado (p1, v1), . . . , (pT, vT) que satisfacen T t=1 vt = V. De manera similar, para OWT, podemos definir ROWT(A, Pmaxprice) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S). Aquí Pmaxprice es una distribución solo sobre el precio máximo del día, y luego examinamos secuencias de peor caso consistentes con este precio (seq(p) ⊂ Σ es el conjunto de todas las secuencias de mercado que satisfacen max1≤t≤T pt = p). Se pueden proporcionar definiciones análogas del lado de compra. Enfatizamos que en estos modelos, solo la distribución del volumen máximo y el precio es conocida por el algoritmo. También observamos que nuestras suposiciones probabilísticas sobre S son considerablemente más débiles que los modelos típicos de finanzas estadísticas, los cuales postularían un modelo estocástico detallado para la evolución paso a paso de (pt, vt). Aquí permitimos únicamente una distribución sobre medidas crudas y macroscópicas de la actividad del mercado durante todo el día, como el volumen total y el precio máximo, y analizamos el rendimiento en el peor de los casos coherente con estas medidas crudas. Por esta razón, nos referimos a tales configuraciones como el modelo de distribución macroscópica. El trabajo de El-Yaniv et al. [3] examina supuestos de distribución similares a los nuestros, pero también enfatizan las elecciones de peor caso para las distribuciones, y muestran que esto conduce a resultados no mejores que el análisis de peor caso original sobre todas las secuencias. Por el contrario, consideramos que el análisis de las distribuciones específicas Pvol y Pmaxprice es natural en muchos contextos financieros y nuestros resultados experimentales preliminares muestran mejoras significativas cuando se tiene en cuenta esta información distribucional bastante rudimentaria (ver Figura 3). Nuestros resultados en el contexto de VWAP examinan los casos en los que estas distribuciones son conocidas exactamente o solo aproximadamente. Resultados similares pueden obtenerse para distribuciones macroscópicas del precio máximo diario en el escenario de negociación unidireccional. 4.1 Resultados en el Modelo de Distribución Macroscópica Comenzamos señalando que los algoritmos examinados hasta ahora funcionan dividiendo los volúmenes totales o los precios máximos en contenedores de tamaño exponencialmente creciente, y luego adivinando el índice del contenedor en el que cae la cantidad real. Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en análisis competitivos) pueda depender de la distribución del índice de contenedor real. En lo que resta, asumimos que Q es una potencia de 2 y la base del logaritmo es 2. Que Pvol denote la distribución del volumen total diario del mercado. Definimos la distribución relacionada Pbins vol sobre los índices de los contenedores i de la siguiente manera: para todo i = 1, . . . , log(Q) − 1, Pbins vol (i) es igual a la probabilidad, bajo Pvol, de que el volumen diario caiga en el intervalo [Vmin 2i−1 , Vmin 2i ), y Pbins vol (log(Q)) es para el último intervalo [Vmax /2, Vmax]. Definimos E como E(Pbins vol) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2. Dado que el soporte de Pbins vol tiene solo log(Q) elementos, E(Pbins vol ) puede variar desde 1 (para distribuciones Pvol que colocan todo su peso en solo uno de los log(Q) intervalos entre Vmin , Vmin 2, Vmin 4, . . . , Vmax ) hasta log(Q) (para distribuciones Pvol en las que el volumen diario total tiene igual probabilidad de caer en cualquiera de estos intervalos). Ten en cuenta que las distribuciones Pvol de este último tipo están lejos de ser uniformes en todo el rango [Vmin, Vmax]. Teorema 10. En el modelo de distribución de volumen bajo el supuesto de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando únicamente el conocimiento de la distribución total de volumen Pvol, logra RVWAP(A, Pvol) ≤ 2E(Pbins vol). Todas las pruebas en esta sección se proporcionan en el apéndice. Como ejemplo concreto, considera el caso en el que Pvol es la distribución uniforme sobre [Vmin, Vmax]. En ese caso, el volumen de Pbins está aumentando de forma exponencial y alcanza su punto máximo en el último bin, que, al tener el ancho más grande, también tiene el mayor peso. En este caso, E(Pbins vol) es una constante (es decir, independiente de Q), lo que conduce a una proporción competitiva constante. Por otro lado, si Pvol es exponencial, entonces Pbins vol es uniforme, lo que conduce a una proporción competitiva de O(log(Q)), al igual que en el entorno de precio-volumen más adversarial discutido anteriormente. En la Figura 3, proporcionamos límites específicos adicionales obtenidos para distribuciones empíricas de volumen diario total calculadas para algunas acciones reales. Ahora examinamos el escenario en el que Pvol es desconocido, pero se dispone de una aproximación ˜Pvol. Definamos C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) . C se minimiza en C(Pbins vol , Pbins vol ) = E(Pbins vol ), y C puede ser infinito si ˜Pbins vol (i) es 0 cuando Pbins vol (i) > 0. Teorema 11. En el modelo de distribución de volumen bajo la suposición de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando solo el conocimiento de una aproximación ˜Pvol de Pvol, logra que RVWAP(A, Pvol) ≤ 2C(Pbins vol, ˜Pbins vol). Como ejemplo de este resultado, supongamos que nuestra aproximación cumple (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) para todo i, para algún α > 1. Por lo tanto, nuestras probabilidades estimadas de índice de contenedor están todas dentro de un factor de α de la verdad. Entonces es fácil demostrar que C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), por lo tanto, según los Teoremas 10 y 11, nuestra penalización por usar la distribución aproximada es un factor de α en la proporción competitiva. 5. REFERENCIAS [1] B. Awerbuch, Y. Bartal, A. Fiat y A. Rosén. Control de llamadas competitivo no preemptivo. En Proc. 5to Simposio ACM-SIAM sobre Algoritmos Discretos, páginas 312-320, 1994. [2] A. Borodin y R. El-Yaniv. Computación en línea y análisis competitivo. Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp y G. Turpin. Algoritmos óptimos de búsqueda y comercio en línea unidireccional. Algorithmica, 30:101-139, 2001. [4] M. Kearns y L. Ortiz. El proyecto de trading automatizado Penn-Lehman. IEEE Intelligent Systems, 2003. \n\nSistemas Inteligentes de IEEE, 2003. Aparecer. 6. APÉNDICE 6.1 Pruebas de la Subsección 2.3 Prueba. (Bosquejo del Teorema 3) Sin pérdida de generalidad, asumir que Q = 1 y el volumen total es V. Considera el tiempo t donde el horario fijo f vende menos, entonces ft ≤ N/T. Considera las secuencias donde en el tiempo t tenemos pt = pmax, vt = V, y para los tiempos t = t tenemos pt = pmin y vt = 0. El VWAP es pmax y el promedio de horario fijo es (N/T)pmax + (N − N/T)pmin. Prueba. (Bosquejo del Teorema 4) El algoritmo simplemente vende ut = (vt/Vmin)N acciones en el tiempo t. El número total de acciones vendidas U es claramente mayor que N y U = t ut = t (vt/Vmin)N = (V/Vmin)N ≤ QN El precio promedio es V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), donde usamos el hecho de que ut/U = vt/V. 197 Prueba. (del Teorema 5) Comenzamos con la prueba del límite inferior. Considera el siguiente escenario. Durante las primeras T unidades de tiempo tenemos un precio de √ Rpmin y un volumen total de Vmin. Observamos cuántas acciones ha comprado el algoritmo en línea. Si ha comprado más de la mitad de las acciones, los pasos de tiempo restantes tienen un precio pmin y un volumen de Vmax − Vmin. De lo contrario, los pasos de tiempo restantes tienen un precio pmax y un volumen insignificante. En el primer caso, el comprador en línea ha pagado al menos √ Rpmin /2 mientras que el VWAP es a lo sumo √ Rpmin /Q + pmin. Por lo tanto, en este caso la proporción competitiva es Ω(Q). En el segundo caso, el comprador en línea tiene que comprar al menos la mitad de las acciones a pmax, por lo que su costo promedio es al menos pmax/2. El VWAP del mercado es √ Rpmin = pmax / √ R, por lo tanto, la proporción competitiva es Ω( √ R). Para el límite superior, podemos obtener una proporción competitiva de √ R, comprando todas las acciones una vez que el precio caiga por debajo de √ Rpmin. El límite superior de Q se deriva ejecutando un algoritmo que asume que el volumen es Vmin. El comprador en línea paga un costo de p, mientras que el VWAP será al menos p/Q. 6.2 Pruebas de la Sección 4 Prueba. (Bosquejo del Teorema 10) Utilizamos la idea de adivinar el volumen total del Teorema 1, pero ahora permitimos la posibilidad de una distribución arbitraria (pero conocida) sobre el volumen total. En particular, considere construir una distribución Gbins vol sobre un conjunto de valores de volumen utilizando Pvol y úsela para estimar el volumen total V. Permita que el algoritmo adivine ˆV = Vmin 2i con probabilidad Gbins vol (i). Luego, observe que, para cualquier secuencia de precio-volumen S, si V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2. Esto implica un límite superior en RVWAP(A, Pvol) en términos de Gbins vol. Entonces obtenemos que Gbins vol (i) ∝ Pbins vol (i) minimiza el límite superior, lo que conduce al límite superior establecido en el teorema. Prueba. (Bosquejo del Teorema 11) Reemplace Pvol con ˜Pvol en la expresión de Gbins vol en el bosquejo de la prueba para el último resultado. 198 ",
            "candidates": [],
            "error": [
                [
                    "mercados financieros modernos",
                    "Precio Promedio Ponderado por Volumen"
                ]
            ]
        },
        "volume weighted average price trading model": {
            "translated_key": "modelo de negociación de precio promedio ponderado por volumen",
            "is_in_text": false,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [],
            "translated_text": "",
            "candidates": [],
            "error": [
                []
            ]
        },
        "limit order book trading model": {
            "translated_key": "modelo de trading de libro de órdenes limitadas",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A <br>limit order book trading model</br> Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "A <br>limit order book trading model</br> Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure."
            ],
            "translated_annotated_samples": [
                "Un <br>modelo de trading de libro de órdenes limitadas</br>. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP. Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por acción. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading. Más precisamente, en este modelo en línea, observamos la secuencia de precio-volumen de a pares. Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt. Supongamos que nuestro objetivo es vender N acciones a lo largo del día. Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT. De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante. Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas. Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema). En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios. En el trading de VWAP, el objetivo de un algoritmo en línea A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado. El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt. Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N. Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo. El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo. Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales. Es fácil ver que esto lo convierte en un criterio más desafiante de seguir. A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado. En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes. En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día. Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques. Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S). Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio. Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto. Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin. Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones. Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1. En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo. En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo. Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP. Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)). Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios. Teorema 1. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q). Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier algoritmo en línea A para vender N acciones tiene RVWAP(A) = Ω(log(Q)). Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1]. Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día. Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones. Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1. Claramente, uno de los Ai tiene una proporción competitiva de 2. Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada). Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT. Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2. Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP. Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ). Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo. Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1. Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0. Suponga que el precio máximo en S es pmax. El VWAP de nuestra secuencia es al menos pmax /3. Dado que teníamos un algoritmo c competitivo, su venta promedio es al menos pmax /3c. El límite inferior ahora se sigue utilizando el límite inferior en [3]. Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT. Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191. En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)). Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)). Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT. Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo. Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R). Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen. Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt). Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario. Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso. Teorema 3. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)). Las pruebas de todos los resultados de esta subsección están en el Apéndice. Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones. En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender. Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución. El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo. Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1. Teorema 4. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S). En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2]. En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo. Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente. Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema. Teorema 5. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un algoritmo en línea A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}). Además, cualquier algoritmo en línea A para comprar N acciones tiene una proporción competitiva de compra VWAP Rbuy VWAP(A) = Ω(min{Q, √ R}). 3. Un <br>modelo de trading de libro de órdenes limitadas</br>. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado. Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la negociación de acciones es entre una orden limitada y una orden de mercado. Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT). En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado. Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 2, que muestra una captura de pantalla real de un libro de órdenes reciente de MSFT en Island (www.island.com), un conocido intercambio electrónico de acciones de NASDAQ), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos. Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta). Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (siendo las órdenes más antiguas las primeras en el libro). En el ejemplo proporcionado por la Figura 2, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra. De manera similar, se mantiene un libro de órdenes de venta para órdenes de límite de venta (por ejemplo, podríamos querer vender 500 acciones de MSFT a $24.10 o más) esta vez con el precio de venta más bajo ofrecido (a menudo denominado como el precio de venta). Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas. Los precios de oferta y demanda (que nuevamente, son simplemente los precios en las órdenes límite en la parte superior de los libros de compra y venta, respectivamente) a veces se denominan como el mercado interno, y la diferencia entre ellos como el spread. Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección. ¿Entonces, cómo se ejecutan las órdenes? Hay dos métodos. Primero, cada vez que llega una orden de mercado, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto. Por lo tanto, una orden de mercado para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones. Por ejemplo, en el ejemplo de la Figura 2, tal orden sería completada por las dos órdenes de venta límite de 500 acciones a $24.069, las 500 acciones a $24.07, las 200 acciones a $24.08, y luego 300 de las 1981 acciones a $24.09. Las 1681 acciones restantes de esta última orden límite permanecerían como el nuevo tope del libro de órdenes de venta límite. Segundo, si una orden de límite de compra (venta, respectivamente) entra por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con órdenes en los libros opuestos. Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato. Cada orden de mercado o límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que las órdenes llegan, y dos órdenes nunca pueden llegar simultáneamente. Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden. Es esta cantidad la que generalmente se quiere decir cuando la gente se refiere casualmente al precio de una acción (ticker). Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una orden de mercado. Por lo tanto, asumiremos sin pérdida de generalidad que todas las órdenes se colocan como órdenes límite. Aunque las órdenes límite que no se ejecutan pueden ser eliminadas por la parte que las colocó, para simplificar, asumimos que las órdenes límite nunca son eliminadas de los libros. Remitimos al lector a [4] para obtener más información sobre los intercambios electrónicos modernos y la microestructura del mercado. 3.2 El Modelo El modelo de negociación de libros de órdenes en línea tiene como objetivo capturar los detalles realistas de la microestructura del mercado recién discutidos en un entorno de relación competitiva. En este modelo refinado, la actividad del mercado de un día se describe por una secuencia de órdenes límite (pt, vt, bt). Aquí bt es un bit que indica si la orden es de compra o venta, mientras que pt es el precio de la orden límite y vt es el número de acciones deseado. Tras la llegada de cada orden límite de este tipo, se permite a un algoritmo de trading en línea colocar su propia orden límite. Estas dos fuentes entrelazadas (mercado y algoritmo) de órdenes límite son simplemente operadas de acuerdo con el proceso de emparejamiento descrito en la Sección 3.1. Cualquier orden límite que no sea ejecutable de inmediato según este proceso se coloca en el libro correspondiente (compra o venta) para una posible ejecución futura; las órdenes que llegan y pueden ser ejecutadas parcial o totalmente se ejecutan de esa manera, con cualquier acción residual que permanezca en el libro respectivo. El objetivo de un algoritmo de venta VWAP u OWT es esencialmente el mismo que en el modelo de precio-volumen, pero el contexto ha cambiado en las siguientes dos formas fundamentales. Primero, la suposición de liquidez infinita en el modelo de precio-volumen se elimina por completo. El número de acciones disponibles a cualquier precio dado está restringido al volumen total de órdenes límite que ofrecen ese precio. Segundo, se asume que todas las órdenes entrantes, y por lo tanto los libros completos de órdenes límite, son visibles para el algoritmo. Esto es coherente con los intercambios financieros electrónicos modernos, y de hecho es la fuente de mucho interés actual en Wall Street [4]. En general, la definición de las ratios competitivas en el modelo de libro de órdenes se complica por el hecho de que ahora nuestra actividad algorítmica influye en la secuencia de precios y volúmenes ejecutados. Por lo tanto, primero definimos la secuencia de ejecución determinada por una secuencia de órdenes límite (colocadas por el mercado y nuestro algoritmo). Sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por el mercado, y sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por nuestro algoritmo (a menos que se especifique lo contrario, todos los bt son de tipo venta). Sea merge(S, S) la secuencia fusionada (p1, v1, b1), (p1, v1, b1), . . . , (pT, vT, bT), (pT, vT, bT), que es la secuencia temporal de órdenes realizadas por el mercado y el algoritmo. Ten en cuenta que el algoritmo tiene la opción de no realizar un pedido, lo cual podemos considerar como un pedido de volumen cero. Si llevamos a cabo el mantenimiento del libro de órdenes y el proceso de ejecución de órdenes descrito en la Sección 3.1 en la fusión de secuencias (S, S), en intervalos irregulares se produce una operación de compra/venta de un cierto número de acciones a un determinado precio. En cada operación ejecutada, la parte vendedora es o bien el mercado o el algoritmo. Sea execM (S, S ) = (q1, w1), . . . , (qT , wT ) la secuencia de ejecuciones donde el mercado (es decir, una parte distinta al algoritmo) fue la parte vendedora, donde los qt son los precios de ejecución y wt los volúmenes de ejecución. De manera similar, definimos execA(S, S) = (r1, x1), . . . , (rT, xT) como la secuencia de ejecuciones en las que el algoritmo fue la parte vendedora. Por lo tanto, execA(S, S) ∪ execM(S, S) es el conjunto de todas las ejecuciones. Generalmente esperamos que T sea (posiblemente mucho) más pequeño que T. Los ingresos del algoritmo y del mercado se definen como: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt. Nótese que ambas cantidades están determinadas únicamente por las secuencias de ejecución execM (S, S ) y execA(S, S ), respectivamente. Para un algoritmo A que está limitado a vender exactamente N acciones, definimos la razón de competencia OWT de A, ROWT(A), como la razón máxima (bajo cualquier S ∈ Σ) de los ingresos obtenidos por A, en comparación con los ingresos obtenidos por un algoritmo óptimo fuera de línea A∗. De manera más formal, para A∗ que está limitado a vender exactamente N acciones, definimos ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) donde S∗ es la secuencia de órdenes límite colocadas por A∗ en S. Si el algoritmo A es aleatorio, entonces tomamos la expectativa apropiada con respecto a S ∼ A. Definimos la ratio competitiva VWAP, RVWAP(A), como la ratio máxima (bajo cualquier S ∈ Σ) entre los VWAPs del mercado y del algoritmo. Más formalmente, define VWAPM (S, S ) como REVM (S, S )/ T t=1 wt, donde el denominador es simplemente el volumen total ejecutado de órdenes colocadas por el mercado. De manera similar, definimos VWAPA(S, S) como REVA(S, S)/N, ya que asumimos que el algoritmo vende no más de N acciones (esta definición asume implícitamente que A obtiene un precio de 0 por las acciones no vendidas). El ratio competitivo VWAP de A es entonces: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} donde S es la secuencia en línea de órdenes límite generadas por A en respuesta a la secuencia S. 3.3 Resultados de OWT en el Modelo de Libro de Órdenes. Para el problema de OWT en el modelo de libro de órdenes, introducimos una versión más sutil de la suposición de variabilidad de precios. Esto se debe al hecho de que nuestro trading algorítmico puede afectar los precios altos y bajos del día. Para la suposición a continuación, tenga en cuenta que execM (S, ∅) es la secuencia de ejecuciones sin la interacción de nuestro algoritmo. 3.3.0.3 Suposición de Variabilidad del Precio del Libro de Órdenes. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios pt en la secuencia execM (S, ∅) cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Tenga en cuenta que esta suposición no implica que las ratios de precios altos a bajos bajo las secuencias execM (S, S ) o execA(S, S ) estén limitadas por R. De hecho, la ratio en la secuencia execA(S, S ) podría ser infinita si el algoritmo termina vendiendo algunas acciones a un precio de 0. Teorema 6. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de venta OWT ROWT(A) = 2 log(R) log(N). Prueba. El algoritmo A funciona al adivinar un precio p en el conjunto {pmin2i : 1 ≤ i ≤ log(R)} y colocar una orden de venta límite por todas las N acciones al precio p al comienzo del día. (Alternativamente, el algoritmo A puede colocar log(R) órdenes de venta límite, donde la i-ésima tiene un precio de 2i pmin y un volumen de N/ log(R).) Al realizar un pedido al comienzo del día, el algoritmo ofrece un precio más bajo que todos los pedidos de venta que se realizarán durante el día por un precio de p o superior, lo que significa que primero se deben completar las N acciones del algoritmo a este precio. Por lo tanto, si hubiera habido k acciones que se hubieran vendido a un precio p o superior sin nuestra actividad, entonces A vendería al menos kp acciones. Definimos {pj} como el multiconjunto de precios de acciones individuales que han sido ejecutadas o son acciones de órdenes de compra límite que permanecieron sin ejecutar, excluyendo la actividad de nuestro algoritmo (es decir, asumiendo que nuestro algoritmo no coloca órdenes). Suponga sin pérdida de generalidad que p1 ≥ p2 ≥ . . .. Considerar adivinar el k-ésimo precio más alto, pk. Si se coloca una orden de N acciones al comienzo del día a un precio pk, entonces estamos garantizados de obtener un retorno de kpk. Que k∗ = argmaxk{kpk}. Podemos ver nuestro algoritmo como intentando adivinar pk∗, y teniendo éxito si la suposición p satisface p ∈ [pk∗ /2, pk∗]. Por lo tanto, somos 2 log(R) competitivos con la cantidad max1≤k≤N kpk. Se debe tener en cuenta que ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk donde ρ se define como la suma de los N precios principales pi sin la participación de A. De manera similar, sea {pj} el multiconjunto de precios de las acciones individuales ejecutadas, o los precios de las acciones de órdenes de compra no ejecutadas, pero ahora incluyendo las órdenes realizadas por algún algoritmo de venta A. Ahora deseamos demostrar que para todos los algoritmos A que venden N acciones, REVA ≤ N i=1 pi ≤ ρ. Esencialmente, esta desigualdad establece la idea intuitiva de que un algoritmo de venta solo puede reducir los precios de las órdenes de compra ejecutadas o no coincidentes. Para demostrar esto, utilizamos la inducción para mostrar que la eliminación de la actividad de un algoritmo de venta hace que estos precios aumenten. Primero, elimine la última acción en la última orden de venta realizada por A o el mercado en una fusión de secuencia arbitraria merge(S, S) - con esto queremos decir, tome la última orden de venta realizada por A o el mercado y disminuya su volumen en una acción. Después de esta modificación, los N precios más altos p1 . . . pN no disminuirán. Esto se debe a que o bien esta orden de venta no se ejecutó, en cuyo caso la afirmación es trivialmente verdadera, o, si se ejecutó, la eliminación de esta orden de venta deja una orden de compra adicional no ejecutada de igual o mayor precio. Para la inducción, asumimos que si eliminamos una participación de cualquier orden de venta que se haya colocado, ya sea por A o por el mercado, en o después del tiempo t, entonces los N precios principales no disminuyen. Ahora demostramos que si eliminamos una participación de la última orden de venta que fue colocada por A o el mercado antes del tiempo t, entonces los N precios principales no disminuyen. Si esta orden de venta de acciones no se ejecutó, entonces la afirmación es trivialmente verdadera. De lo contrario, si la orden de venta se ejecutó, entonces la afirmación es verdadera porque al eliminar esta acción ejecutada de la orden de venta, o bien: i) la acción correspondiente de la orden de compra (de igual o mayor valor) no se empareja en el resto de la secuencia, en cuyo caso la afirmación es verdadera; o ii) esta orden de compra se empareja con alguna acción de una orden de venta a un precio igual o mayor, lo que tiene el efecto de eliminar una acción de una orden de venta en el resto de la secuencia y, por la suposición inductiva, esto solo puede aumentar los precios. Por lo tanto, hemos demostrado que para todos los A que venden N acciones, REVA ≤ ρ. Ahora hemos establecido que nuestra ganancia satisface 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), donde A realiza una secuencia arbitraria de N órdenes de venta límite. 3.4 Resultados de VWAP en el Modelo del Libro de Órdenes El algoritmo OWT del Teorema 6 se puede aplicar para obtener el siguiente resultado de VWAP: Corolario 7. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de VWAP de venta RVWAP(A) = O(log(R) log(N)). Ahora hacemos una suposición bastante diferente sobre las secuencias S. 3.4.0.4 Volumen de Orden Acotado y Suposición de Precio Máximo. El conjunto de secuencias Σ satisface las siguientes dos propiedades. Primero, asumimos que cada orden colocada en el mercado tiene un volumen menor que γ, lo cual consideramos como una suposición leve ya que típicamente las órdenes individuales en el mercado no tienen un alto volumen (debido a problemas de liquidez). Esta suposición permite que nuestro algoritmo coloque al menos una orden límite a la vez intercalada con aproximadamente γ ejecuciones de mercado. Segundo, asumimos que hay un gran volumen en los libros de órdenes de venta por debajo del precio pmax, lo que significa que ninguna orden colocada por el mercado se ejecutará por encima del precio pmax. La forma más sencilla de instanciar esta última suposición en el modelo de libro de órdenes es asumir que cada secuencia S ∈ Σ comienza colocando un gran número de órdenes de venta (más de Vmax) a un precio pmax. Aunque esta suposición tiene un parámetro de precio máximo, no implica que la proporción de precios R sea finita, ya que no implica ningún límite inferior en los precios de compra o de las acciones ejecutadas (aparte del trivial de 0). Teorema 8. Considera el modelo de libro de órdenes bajo la suposición de volumen de orden limitado y precio máximo. Existe un algoritmo A en el cual después de exactamente γN ejecuciones de mercado, entonces A ha vendido como máximo N acciones y REVA(S, S) ≤ N = VWAPA(S, S) ≥ (1 − ε)VWAPM(S, S) − pmax N donde S es una secuencia de N órdenes de venta límite generadas por A al observar S. Demostración. El algoritmo divide el día de negociación en intervalos de volumen cuya duración en tiempo real puede variar. Para cada período i en el que se hayan ejecutado acciones γ en el mercado, el algoritmo calcula el VWAP de mercado solo de aquellas acciones negociadas en el período i; denotémoslo como VWAPi. Tras este intervalo de volumen i-ésimo, el algoritmo coloca una orden límite para vender exactamente una acción a un precio cercano al VWAPi. Más precisamente, el algoritmo solo coloca órdenes a los precios discretos (1− )pmax , (1− )2 pmax , . . .. Tras el intervalo de volumen i, el algoritmo coloca una orden límite para vender una acción al precio discretizado que esté más cercano al VWAPi, pero que sea estrictamente menor. Para el análisis, comenzamos observando que si todas las órdenes límite de los algoritmos se ejecutan durante el día, los ingresos totales recibidos por el algoritmo serían al menos (1 − )VWAPM (S, S )N. Para ver esto, basta con notar que VWAPM (S, S ) es una mezcla uniforme de los VWAPi (ya que por definición cubren la misma cantidad de volumen de mercado); y si todas las órdenes límite de los algoritmos se ejecutaran, cada uno recibiría más de (1 − )VWAPi dólares por el intervalo i que siguieron. Ahora contamos el potencial de ingresos perdidos del algoritmo debido a órdenes límite no ejecutadas. Por la suposición de que los pedidos individuales se realizan con un volumen menor que γ, entonces nuestro algoritmo es capaz de colocar una orden límite durante cada bloque de γ acciones que se han negociado. Por lo tanto, después de que se hayan ejecutado γN órdenes de mercado, A ha colocado N órdenes en el mercado. Ten en cuenta que puede haber como máximo una orden límite (y por lo tanto, como máximo una acción) sin ejecutar en cada nivel de la escalera de precios discretizada definida anteriormente. Esto se debe a que después del intervalo i, el algoritmo coloca su orden límite estrictamente por debajo de VWAPi, por lo que si VWAPj ≥ VWAPi para j > i, esta orden límite debe haber sido ejecutada. Por lo tanto, las órdenes límite no ejecutadas limitaron los VWAPs del resto del día, resultando en un máximo de una orden no ejecutada por nivel de precio. Un límite en la pérdida de ingresos es, por lo tanto, la suma de los precios discretizados: ∞ i=1(1 − )i pmax ≤ pmax / . Claramente nuestro algoritmo ha vendido como máximo N acciones. Ten en cuenta que a medida que N se vuelve grande, VWAPA se acerca a 1 menos el VWAP del mercado. Si supiéramos que el volumen total final de las ejecuciones del mercado es V, entonces podríamos establecer γ = V/N, asumiendo que γ >> 1. Si solo tenemos un límite superior e inferior en V, deberíamos poder adivinar y incurrir en una pérdida logarítmica. La siguiente suposición intenta capturar la variabilidad del volumen del mercado. Suposición de Variabilidad del Volumen del Libro de Órdenes 3.4.0.5. Ahora asumimos que el volumen total (que incluye las operaciones ejecutadas tanto por nuestro algoritmo como por el mercado) es variable dentro de una región conocida y que el volumen del mercado será mayor que el volumen de nuestros algoritmos. De manera más formal, para todo S ∈ Σ, asumir que el volumen total V de acciones negociadas en execM (S, S), para cualquier secuencia S de N órdenes de venta límite, satisface 2N ≤ Vmin ≤ V ≤ Vmax. Que Q = Vmax / Vmin. El siguiente corolario se deriva utilizando una constante = 1/2 y observando que si establecemos γ de manera que V ≤ γN ≤ 2V entonces nuestro algoritmo colocará entre N y N/2 órdenes límite. Corolario 9. En el modelo de libro de órdenes, si se cumplen la suposición de volumen de orden acotado y precio máximo, y la suposición de variabilidad del volumen del libro de órdenes, existe un algoritmo en línea A para vender como máximo N acciones tal que VWAPA(S, S) ≥ 1 4 log(Q) VWAPM(S, S) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figura 3: Aquí presentamos límites de la Sección 4 basados en las distribuciones de volumen empíricas para cuatro acciones reales: QQQ, MCHP, JNPR y CHKP. Los gráficos muestran histogramas de los volúmenes totales diarios transados en Island para estas acciones, en el último año y medio, junto con los valores correspondientes de log(Q) y E(Pbins vol) (denotado por E). Suponemos que los volúmenes diarios mínimo y máximo en los datos corresponden a Vmin y Vmax, respectivamente. Los límites de la razón competitiva en el peor de los casos (que son dos veces el logaritmo de Q) de nuestro algoritmo para esas acciones son 9.42, 10.56, 11.32 y 13.20, respectivamente. Los límites correspondientes sobre el rendimiento de la proporción competitiva de nuestro algoritmo bajo el modelo de distribución de volumen (que son el doble de E(Pbins vol )) son mejores: 7.54, 7.72, 7.94 y 9.00, respectivamente (una mejora relativa del 20-40%). Usando una partición de volumen más fina junto con un límite ligeramente más refinado en la relación competitiva, podemos construir algoritmos que, utilizando la distribución de volumen empírica dada como correcta, garantizan relaciones competitivas aún mejores de 2.76, 2.73, 2.75 y 3.17, respectivamente para esas acciones (detalles omitidos). MODELOS DE DISTRIBUCIÓN MACROSCÓPICA Concluimos nuestros resultados con un regreso al modelo de precio-volumen, donde introduciremos algunos métodos refinados de análisis para algoritmos de trading en línea. Dejamos la generalización de estos métodos al modelo de libro de órdenes para trabajos futuros. Los ratios de competitividad definidos hasta ahora miden el rendimiento en relación con algún criterio de referencia en el peor caso sobre todas las secuencias de mercado S ∈ Σ. Se ha observado en muchos entornos en línea que tales métricas de peor caso pueden arrojar resultados pesimistas, y se han considerado varias relajaciones, como permitir una distribución de probabilidad sobre la secuencia de entrada. Ahora consideramos modelos de distribución que son considerablemente más débiles que asumir una distribución sobre secuencias de mercado completas S ∈ Σ. En el modelo de distribución de volumen, asumimos únicamente que existe una distribución Pvol sobre el volumen total V negociado en el mercado durante el día, y luego examinamos la peor relación competitiva en secuencias consistentes con el volumen elegido al azar. Más precisamente, definimos RVWAP(A, Pvol) = EV ∼Pvol max S∈seq(V) VWAPM(S) VWAPA(S). Aquí V ∼ Pvol denota que V es elegido con respecto a la distribución Pvol, y seq(V) ⊂ Σ es el conjunto de todas las secuencias de mercado (p1, v1), . . . , (pT, vT) que satisfacen T t=1 vt = V. De manera similar, para OWT, podemos definir ROWT(A, Pmaxprice) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S). Aquí Pmaxprice es una distribución solo sobre el precio máximo del día, y luego examinamos secuencias de peor caso consistentes con este precio (seq(p) ⊂ Σ es el conjunto de todas las secuencias de mercado que satisfacen max1≤t≤T pt = p). Se pueden proporcionar definiciones análogas del lado de compra. Enfatizamos que en estos modelos, solo la distribución del volumen máximo y el precio es conocida por el algoritmo. También observamos que nuestras suposiciones probabilísticas sobre S son considerablemente más débiles que los modelos típicos de finanzas estadísticas, los cuales postularían un modelo estocástico detallado para la evolución paso a paso de (pt, vt). Aquí permitimos únicamente una distribución sobre medidas crudas y macroscópicas de la actividad del mercado durante todo el día, como el volumen total y el precio máximo, y analizamos el rendimiento en el peor de los casos coherente con estas medidas crudas. Por esta razón, nos referimos a tales configuraciones como el modelo de distribución macroscópica. El trabajo de El-Yaniv et al. [3] examina supuestos de distribución similares a los nuestros, pero también enfatizan las elecciones de peor caso para las distribuciones, y muestran que esto conduce a resultados no mejores que el análisis de peor caso original sobre todas las secuencias. Por el contrario, consideramos que el análisis de las distribuciones específicas Pvol y Pmaxprice es natural en muchos contextos financieros y nuestros resultados experimentales preliminares muestran mejoras significativas cuando se tiene en cuenta esta información distribucional bastante rudimentaria (ver Figura 3). Nuestros resultados en el contexto de VWAP examinan los casos en los que estas distribuciones son conocidas exactamente o solo aproximadamente. Resultados similares pueden obtenerse para distribuciones macroscópicas del precio máximo diario en el escenario de negociación unidireccional. 4.1 Resultados en el Modelo de Distribución Macroscópica Comenzamos señalando que los algoritmos examinados hasta ahora funcionan dividiendo los volúmenes totales o los precios máximos en contenedores de tamaño exponencialmente creciente, y luego adivinando el índice del contenedor en el que cae la cantidad real. Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en análisis competitivos) pueda depender de la distribución del índice de contenedor real. En lo que resta, asumimos que Q es una potencia de 2 y la base del logaritmo es 2. Que Pvol denote la distribución del volumen total diario del mercado. Definimos la distribución relacionada Pbins vol sobre los índices de los contenedores i de la siguiente manera: para todo i = 1, . . . , log(Q) − 1, Pbins vol (i) es igual a la probabilidad, bajo Pvol, de que el volumen diario caiga en el intervalo [Vmin 2i−1 , Vmin 2i ), y Pbins vol (log(Q)) es para el último intervalo [Vmax /2, Vmax]. Definimos E como E(Pbins vol) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2. Dado que el soporte de Pbins vol tiene solo log(Q) elementos, E(Pbins vol ) puede variar desde 1 (para distribuciones Pvol que colocan todo su peso en solo uno de los log(Q) intervalos entre Vmin , Vmin 2, Vmin 4, . . . , Vmax ) hasta log(Q) (para distribuciones Pvol en las que el volumen diario total tiene igual probabilidad de caer en cualquiera de estos intervalos). Ten en cuenta que las distribuciones Pvol de este último tipo están lejos de ser uniformes en todo el rango [Vmin, Vmax]. Teorema 10. En el modelo de distribución de volumen bajo el supuesto de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando únicamente el conocimiento de la distribución total de volumen Pvol, logra RVWAP(A, Pvol) ≤ 2E(Pbins vol). Todas las pruebas en esta sección se proporcionan en el apéndice. Como ejemplo concreto, considera el caso en el que Pvol es la distribución uniforme sobre [Vmin, Vmax]. En ese caso, el volumen de Pbins está aumentando de forma exponencial y alcanza su punto máximo en el último bin, que, al tener el ancho más grande, también tiene el mayor peso. En este caso, E(Pbins vol) es una constante (es decir, independiente de Q), lo que conduce a una proporción competitiva constante. Por otro lado, si Pvol es exponencial, entonces Pbins vol es uniforme, lo que conduce a una proporción competitiva de O(log(Q)), al igual que en el entorno de precio-volumen más adversarial discutido anteriormente. En la Figura 3, proporcionamos límites específicos adicionales obtenidos para distribuciones empíricas de volumen diario total calculadas para algunas acciones reales. Ahora examinamos el escenario en el que Pvol es desconocido, pero se dispone de una aproximación ˜Pvol. Definamos C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) . C se minimiza en C(Pbins vol , Pbins vol ) = E(Pbins vol ), y C puede ser infinito si ˜Pbins vol (i) es 0 cuando Pbins vol (i) > 0. Teorema 11. En el modelo de distribución de volumen bajo la suposición de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando solo el conocimiento de una aproximación ˜Pvol de Pvol, logra que RVWAP(A, Pvol) ≤ 2C(Pbins vol, ˜Pbins vol). Como ejemplo de este resultado, supongamos que nuestra aproximación cumple (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) para todo i, para algún α > 1. Por lo tanto, nuestras probabilidades estimadas de índice de contenedor están todas dentro de un factor de α de la verdad. Entonces es fácil demostrar que C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), por lo tanto, según los Teoremas 10 y 11, nuestra penalización por usar la distribución aproximada es un factor de α en la proporción competitiva. 5. REFERENCIAS [1] B. Awerbuch, Y. Bartal, A. Fiat y A. Rosén. Control de llamadas competitivo no preemptivo. En Proc. 5to Simposio ACM-SIAM sobre Algoritmos Discretos, páginas 312-320, 1994. [2] A. Borodin y R. El-Yaniv. Computación en línea y análisis competitivo. Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp y G. Turpin. Algoritmos óptimos de búsqueda y comercio en línea unidireccional. Algorithmica, 30:101-139, 2001. [4] M. Kearns y L. Ortiz. El proyecto de trading automatizado Penn-Lehman. IEEE Intelligent Systems, 2003. \n\nSistemas Inteligentes de IEEE, 2003. Aparecer. 6. APÉNDICE 6.1 Pruebas de la Subsección 2.3 Prueba. (Bosquejo del Teorema 3) Sin pérdida de generalidad, asumir que Q = 1 y el volumen total es V. Considera el tiempo t donde el horario fijo f vende menos, entonces ft ≤ N/T. Considera las secuencias donde en el tiempo t tenemos pt = pmax, vt = V, y para los tiempos t = t tenemos pt = pmin y vt = 0. El VWAP es pmax y el promedio de horario fijo es (N/T)pmax + (N − N/T)pmin. Prueba. (Bosquejo del Teorema 4) El algoritmo simplemente vende ut = (vt/Vmin)N acciones en el tiempo t. El número total de acciones vendidas U es claramente mayor que N y U = t ut = t (vt/Vmin)N = (V/Vmin)N ≤ QN El precio promedio es V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), donde usamos el hecho de que ut/U = vt/V. 197 Prueba. (del Teorema 5) Comenzamos con la prueba del límite inferior. Considera el siguiente escenario. Durante las primeras T unidades de tiempo tenemos un precio de √ Rpmin y un volumen total de Vmin. Observamos cuántas acciones ha comprado el algoritmo en línea. Si ha comprado más de la mitad de las acciones, los pasos de tiempo restantes tienen un precio pmin y un volumen de Vmax − Vmin. De lo contrario, los pasos de tiempo restantes tienen un precio pmax y un volumen insignificante. En el primer caso, el comprador en línea ha pagado al menos √ Rpmin /2 mientras que el VWAP es a lo sumo √ Rpmin /Q + pmin. Por lo tanto, en este caso la proporción competitiva es Ω(Q). En el segundo caso, el comprador en línea tiene que comprar al menos la mitad de las acciones a pmax, por lo que su costo promedio es al menos pmax/2. El VWAP del mercado es √ Rpmin = pmax / √ R, por lo tanto, la proporción competitiva es Ω( √ R). Para el límite superior, podemos obtener una proporción competitiva de √ R, comprando todas las acciones una vez que el precio caiga por debajo de √ Rpmin. El límite superior de Q se deriva ejecutando un algoritmo que asume que el volumen es Vmin. El comprador en línea paga un costo de p, mientras que el VWAP será al menos p/Q. 6.2 Pruebas de la Sección 4 Prueba. (Bosquejo del Teorema 10) Utilizamos la idea de adivinar el volumen total del Teorema 1, pero ahora permitimos la posibilidad de una distribución arbitraria (pero conocida) sobre el volumen total. En particular, considere construir una distribución Gbins vol sobre un conjunto de valores de volumen utilizando Pvol y úsela para estimar el volumen total V. Permita que el algoritmo adivine ˆV = Vmin 2i con probabilidad Gbins vol (i). Luego, observe que, para cualquier secuencia de precio-volumen S, si V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2. Esto implica un límite superior en RVWAP(A, Pvol) en términos de Gbins vol. Entonces obtenemos que Gbins vol (i) ∝ Pbins vol (i) minimiza el límite superior, lo que conduce al límite superior establecido en el teorema. Prueba. (Bosquejo del Teorema 11) Reemplace Pvol con ˜Pvol en la expresión de Gbins vol en el bosquejo de la prueba para el último resultado. 198 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "competitive algorithm": {
            "translated_key": "algoritmo c competitivo",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c <br>competitive algorithm</br>, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "Since we had a c <br>competitive algorithm</br>, its average sell is at least pmax /3c."
            ],
            "translated_annotated_samples": [
                "Dado que teníamos un <br>algoritmo c competitivo</br>, su venta promedio es al menos pmax /3c."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP. Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por acción. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading. Más precisamente, en este modelo en línea, observamos la secuencia de precio-volumen de a pares. Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt. Supongamos que nuestro objetivo es vender N acciones a lo largo del día. Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT. De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante. Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas. Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema). En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios. En el trading de VWAP, el objetivo de un algoritmo en línea A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado. El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt. Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N. Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo. El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo. Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales. Es fácil ver que esto lo convierte en un criterio más desafiante de seguir. A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado. En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes. En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día. Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques. Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S). Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio. Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto. Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin. Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones. Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1. En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo. En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo. Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP. Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)). Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios. Teorema 1. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q). Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier algoritmo en línea A para vender N acciones tiene RVWAP(A) = Ω(log(Q)). Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1]. Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día. Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones. Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1. Claramente, uno de los Ai tiene una proporción competitiva de 2. Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada). Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT. Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2. Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP. Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ). Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo. Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1. Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0. Suponga que el precio máximo en S es pmax. El VWAP de nuestra secuencia es al menos pmax /3. Dado que teníamos un <br>algoritmo c competitivo</br>, su venta promedio es al menos pmax /3c. El límite inferior ahora se sigue utilizando el límite inferior en [3]. Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT. Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191. En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)). Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)). Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT. Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo. Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R). Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen. Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt). Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario. Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso. Teorema 3. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)). Las pruebas de todos los resultados de esta subsección están en el Apéndice. Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones. En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender. Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución. El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo. Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1. Teorema 4. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S). En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2]. En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo. Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente. Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema. Teorema 5. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un algoritmo en línea A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}). Además, cualquier algoritmo en línea A para comprar N acciones tiene una proporción competitiva de compra VWAP Rbuy VWAP(A) = Ω(min{Q, √ R}). 3. Un modelo de trading de libro de órdenes limitadas. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado. Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la negociación de acciones es entre una orden limitada y una orden de mercado. Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT). En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado. Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 2, que muestra una captura de pantalla real de un libro de órdenes reciente de MSFT en Island (www.island.com), un conocido intercambio electrónico de acciones de NASDAQ), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos. Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta). Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (siendo las órdenes más antiguas las primeras en el libro). En el ejemplo proporcionado por la Figura 2, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra. De manera similar, se mantiene un libro de órdenes de venta para órdenes de límite de venta (por ejemplo, podríamos querer vender 500 acciones de MSFT a $24.10 o más) esta vez con el precio de venta más bajo ofrecido (a menudo denominado como el precio de venta). Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas. Los precios de oferta y demanda (que nuevamente, son simplemente los precios en las órdenes límite en la parte superior de los libros de compra y venta, respectivamente) a veces se denominan como el mercado interno, y la diferencia entre ellos como el spread. Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección. ¿Entonces, cómo se ejecutan las órdenes? Hay dos métodos. Primero, cada vez que llega una orden de mercado, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto. Por lo tanto, una orden de mercado para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones. Por ejemplo, en el ejemplo de la Figura 2, tal orden sería completada por las dos órdenes de venta límite de 500 acciones a $24.069, las 500 acciones a $24.07, las 200 acciones a $24.08, y luego 300 de las 1981 acciones a $24.09. Las 1681 acciones restantes de esta última orden límite permanecerían como el nuevo tope del libro de órdenes de venta límite. Segundo, si una orden de límite de compra (venta, respectivamente) entra por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con órdenes en los libros opuestos. Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato. Cada orden de mercado o límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que las órdenes llegan, y dos órdenes nunca pueden llegar simultáneamente. Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden. Es esta cantidad la que generalmente se quiere decir cuando la gente se refiere casualmente al precio de una acción (ticker). Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una orden de mercado. Por lo tanto, asumiremos sin pérdida de generalidad que todas las órdenes se colocan como órdenes límite. Aunque las órdenes límite que no se ejecutan pueden ser eliminadas por la parte que las colocó, para simplificar, asumimos que las órdenes límite nunca son eliminadas de los libros. Remitimos al lector a [4] para obtener más información sobre los intercambios electrónicos modernos y la microestructura del mercado. 3.2 El Modelo El modelo de negociación de libros de órdenes en línea tiene como objetivo capturar los detalles realistas de la microestructura del mercado recién discutidos en un entorno de relación competitiva. En este modelo refinado, la actividad del mercado de un día se describe por una secuencia de órdenes límite (pt, vt, bt). Aquí bt es un bit que indica si la orden es de compra o venta, mientras que pt es el precio de la orden límite y vt es el número de acciones deseado. Tras la llegada de cada orden límite de este tipo, se permite a un algoritmo de trading en línea colocar su propia orden límite. Estas dos fuentes entrelazadas (mercado y algoritmo) de órdenes límite son simplemente operadas de acuerdo con el proceso de emparejamiento descrito en la Sección 3.1. Cualquier orden límite que no sea ejecutable de inmediato según este proceso se coloca en el libro correspondiente (compra o venta) para una posible ejecución futura; las órdenes que llegan y pueden ser ejecutadas parcial o totalmente se ejecutan de esa manera, con cualquier acción residual que permanezca en el libro respectivo. El objetivo de un algoritmo de venta VWAP u OWT es esencialmente el mismo que en el modelo de precio-volumen, pero el contexto ha cambiado en las siguientes dos formas fundamentales. Primero, la suposición de liquidez infinita en el modelo de precio-volumen se elimina por completo. El número de acciones disponibles a cualquier precio dado está restringido al volumen total de órdenes límite que ofrecen ese precio. Segundo, se asume que todas las órdenes entrantes, y por lo tanto los libros completos de órdenes límite, son visibles para el algoritmo. Esto es coherente con los intercambios financieros electrónicos modernos, y de hecho es la fuente de mucho interés actual en Wall Street [4]. En general, la definición de las ratios competitivas en el modelo de libro de órdenes se complica por el hecho de que ahora nuestra actividad algorítmica influye en la secuencia de precios y volúmenes ejecutados. Por lo tanto, primero definimos la secuencia de ejecución determinada por una secuencia de órdenes límite (colocadas por el mercado y nuestro algoritmo). Sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por el mercado, y sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por nuestro algoritmo (a menos que se especifique lo contrario, todos los bt son de tipo venta). Sea merge(S, S) la secuencia fusionada (p1, v1, b1), (p1, v1, b1), . . . , (pT, vT, bT), (pT, vT, bT), que es la secuencia temporal de órdenes realizadas por el mercado y el algoritmo. Ten en cuenta que el algoritmo tiene la opción de no realizar un pedido, lo cual podemos considerar como un pedido de volumen cero. Si llevamos a cabo el mantenimiento del libro de órdenes y el proceso de ejecución de órdenes descrito en la Sección 3.1 en la fusión de secuencias (S, S), en intervalos irregulares se produce una operación de compra/venta de un cierto número de acciones a un determinado precio. En cada operación ejecutada, la parte vendedora es o bien el mercado o el algoritmo. Sea execM (S, S ) = (q1, w1), . . . , (qT , wT ) la secuencia de ejecuciones donde el mercado (es decir, una parte distinta al algoritmo) fue la parte vendedora, donde los qt son los precios de ejecución y wt los volúmenes de ejecución. De manera similar, definimos execA(S, S) = (r1, x1), . . . , (rT, xT) como la secuencia de ejecuciones en las que el algoritmo fue la parte vendedora. Por lo tanto, execA(S, S) ∪ execM(S, S) es el conjunto de todas las ejecuciones. Generalmente esperamos que T sea (posiblemente mucho) más pequeño que T. Los ingresos del algoritmo y del mercado se definen como: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt. Nótese que ambas cantidades están determinadas únicamente por las secuencias de ejecución execM (S, S ) y execA(S, S ), respectivamente. Para un algoritmo A que está limitado a vender exactamente N acciones, definimos la razón de competencia OWT de A, ROWT(A), como la razón máxima (bajo cualquier S ∈ Σ) de los ingresos obtenidos por A, en comparación con los ingresos obtenidos por un algoritmo óptimo fuera de línea A∗. De manera más formal, para A∗ que está limitado a vender exactamente N acciones, definimos ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) donde S∗ es la secuencia de órdenes límite colocadas por A∗ en S. Si el algoritmo A es aleatorio, entonces tomamos la expectativa apropiada con respecto a S ∼ A. Definimos la ratio competitiva VWAP, RVWAP(A), como la ratio máxima (bajo cualquier S ∈ Σ) entre los VWAPs del mercado y del algoritmo. Más formalmente, define VWAPM (S, S ) como REVM (S, S )/ T t=1 wt, donde el denominador es simplemente el volumen total ejecutado de órdenes colocadas por el mercado. De manera similar, definimos VWAPA(S, S) como REVA(S, S)/N, ya que asumimos que el algoritmo vende no más de N acciones (esta definición asume implícitamente que A obtiene un precio de 0 por las acciones no vendidas). El ratio competitivo VWAP de A es entonces: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} donde S es la secuencia en línea de órdenes límite generadas por A en respuesta a la secuencia S. 3.3 Resultados de OWT en el Modelo de Libro de Órdenes. Para el problema de OWT en el modelo de libro de órdenes, introducimos una versión más sutil de la suposición de variabilidad de precios. Esto se debe al hecho de que nuestro trading algorítmico puede afectar los precios altos y bajos del día. Para la suposición a continuación, tenga en cuenta que execM (S, ∅) es la secuencia de ejecuciones sin la interacción de nuestro algoritmo. 3.3.0.3 Suposición de Variabilidad del Precio del Libro de Órdenes. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios pt en la secuencia execM (S, ∅) cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Tenga en cuenta que esta suposición no implica que las ratios de precios altos a bajos bajo las secuencias execM (S, S ) o execA(S, S ) estén limitadas por R. De hecho, la ratio en la secuencia execA(S, S ) podría ser infinita si el algoritmo termina vendiendo algunas acciones a un precio de 0. Teorema 6. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de venta OWT ROWT(A) = 2 log(R) log(N). Prueba. El algoritmo A funciona al adivinar un precio p en el conjunto {pmin2i : 1 ≤ i ≤ log(R)} y colocar una orden de venta límite por todas las N acciones al precio p al comienzo del día. (Alternativamente, el algoritmo A puede colocar log(R) órdenes de venta límite, donde la i-ésima tiene un precio de 2i pmin y un volumen de N/ log(R).) Al realizar un pedido al comienzo del día, el algoritmo ofrece un precio más bajo que todos los pedidos de venta que se realizarán durante el día por un precio de p o superior, lo que significa que primero se deben completar las N acciones del algoritmo a este precio. Por lo tanto, si hubiera habido k acciones que se hubieran vendido a un precio p o superior sin nuestra actividad, entonces A vendería al menos kp acciones. Definimos {pj} como el multiconjunto de precios de acciones individuales que han sido ejecutadas o son acciones de órdenes de compra límite que permanecieron sin ejecutar, excluyendo la actividad de nuestro algoritmo (es decir, asumiendo que nuestro algoritmo no coloca órdenes). Suponga sin pérdida de generalidad que p1 ≥ p2 ≥ . . .. Considerar adivinar el k-ésimo precio más alto, pk. Si se coloca una orden de N acciones al comienzo del día a un precio pk, entonces estamos garantizados de obtener un retorno de kpk. Que k∗ = argmaxk{kpk}. Podemos ver nuestro algoritmo como intentando adivinar pk∗, y teniendo éxito si la suposición p satisface p ∈ [pk∗ /2, pk∗]. Por lo tanto, somos 2 log(R) competitivos con la cantidad max1≤k≤N kpk. Se debe tener en cuenta que ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk donde ρ se define como la suma de los N precios principales pi sin la participación de A. De manera similar, sea {pj} el multiconjunto de precios de las acciones individuales ejecutadas, o los precios de las acciones de órdenes de compra no ejecutadas, pero ahora incluyendo las órdenes realizadas por algún algoritmo de venta A. Ahora deseamos demostrar que para todos los algoritmos A que venden N acciones, REVA ≤ N i=1 pi ≤ ρ. Esencialmente, esta desigualdad establece la idea intuitiva de que un algoritmo de venta solo puede reducir los precios de las órdenes de compra ejecutadas o no coincidentes. Para demostrar esto, utilizamos la inducción para mostrar que la eliminación de la actividad de un algoritmo de venta hace que estos precios aumenten. Primero, elimine la última acción en la última orden de venta realizada por A o el mercado en una fusión de secuencia arbitraria merge(S, S) - con esto queremos decir, tome la última orden de venta realizada por A o el mercado y disminuya su volumen en una acción. Después de esta modificación, los N precios más altos p1 . . . pN no disminuirán. Esto se debe a que o bien esta orden de venta no se ejecutó, en cuyo caso la afirmación es trivialmente verdadera, o, si se ejecutó, la eliminación de esta orden de venta deja una orden de compra adicional no ejecutada de igual o mayor precio. Para la inducción, asumimos que si eliminamos una participación de cualquier orden de venta que se haya colocado, ya sea por A o por el mercado, en o después del tiempo t, entonces los N precios principales no disminuyen. Ahora demostramos que si eliminamos una participación de la última orden de venta que fue colocada por A o el mercado antes del tiempo t, entonces los N precios principales no disminuyen. Si esta orden de venta de acciones no se ejecutó, entonces la afirmación es trivialmente verdadera. De lo contrario, si la orden de venta se ejecutó, entonces la afirmación es verdadera porque al eliminar esta acción ejecutada de la orden de venta, o bien: i) la acción correspondiente de la orden de compra (de igual o mayor valor) no se empareja en el resto de la secuencia, en cuyo caso la afirmación es verdadera; o ii) esta orden de compra se empareja con alguna acción de una orden de venta a un precio igual o mayor, lo que tiene el efecto de eliminar una acción de una orden de venta en el resto de la secuencia y, por la suposición inductiva, esto solo puede aumentar los precios. Por lo tanto, hemos demostrado que para todos los A que venden N acciones, REVA ≤ ρ. Ahora hemos establecido que nuestra ganancia satisface 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), donde A realiza una secuencia arbitraria de N órdenes de venta límite. 3.4 Resultados de VWAP en el Modelo del Libro de Órdenes El algoritmo OWT del Teorema 6 se puede aplicar para obtener el siguiente resultado de VWAP: Corolario 7. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de VWAP de venta RVWAP(A) = O(log(R) log(N)). Ahora hacemos una suposición bastante diferente sobre las secuencias S. 3.4.0.4 Volumen de Orden Acotado y Suposición de Precio Máximo. El conjunto de secuencias Σ satisface las siguientes dos propiedades. Primero, asumimos que cada orden colocada en el mercado tiene un volumen menor que γ, lo cual consideramos como una suposición leve ya que típicamente las órdenes individuales en el mercado no tienen un alto volumen (debido a problemas de liquidez). Esta suposición permite que nuestro algoritmo coloque al menos una orden límite a la vez intercalada con aproximadamente γ ejecuciones de mercado. Segundo, asumimos que hay un gran volumen en los libros de órdenes de venta por debajo del precio pmax, lo que significa que ninguna orden colocada por el mercado se ejecutará por encima del precio pmax. La forma más sencilla de instanciar esta última suposición en el modelo de libro de órdenes es asumir que cada secuencia S ∈ Σ comienza colocando un gran número de órdenes de venta (más de Vmax) a un precio pmax. Aunque esta suposición tiene un parámetro de precio máximo, no implica que la proporción de precios R sea finita, ya que no implica ningún límite inferior en los precios de compra o de las acciones ejecutadas (aparte del trivial de 0). Teorema 8. Considera el modelo de libro de órdenes bajo la suposición de volumen de orden limitado y precio máximo. Existe un algoritmo A en el cual después de exactamente γN ejecuciones de mercado, entonces A ha vendido como máximo N acciones y REVA(S, S) ≤ N = VWAPA(S, S) ≥ (1 − ε)VWAPM(S, S) − pmax N donde S es una secuencia de N órdenes de venta límite generadas por A al observar S. Demostración. El algoritmo divide el día de negociación en intervalos de volumen cuya duración en tiempo real puede variar. Para cada período i en el que se hayan ejecutado acciones γ en el mercado, el algoritmo calcula el VWAP de mercado solo de aquellas acciones negociadas en el período i; denotémoslo como VWAPi. Tras este intervalo de volumen i-ésimo, el algoritmo coloca una orden límite para vender exactamente una acción a un precio cercano al VWAPi. Más precisamente, el algoritmo solo coloca órdenes a los precios discretos (1− )pmax , (1− )2 pmax , . . .. Tras el intervalo de volumen i, el algoritmo coloca una orden límite para vender una acción al precio discretizado que esté más cercano al VWAPi, pero que sea estrictamente menor. Para el análisis, comenzamos observando que si todas las órdenes límite de los algoritmos se ejecutan durante el día, los ingresos totales recibidos por el algoritmo serían al menos (1 − )VWAPM (S, S )N. Para ver esto, basta con notar que VWAPM (S, S ) es una mezcla uniforme de los VWAPi (ya que por definición cubren la misma cantidad de volumen de mercado); y si todas las órdenes límite de los algoritmos se ejecutaran, cada uno recibiría más de (1 − )VWAPi dólares por el intervalo i que siguieron. Ahora contamos el potencial de ingresos perdidos del algoritmo debido a órdenes límite no ejecutadas. Por la suposición de que los pedidos individuales se realizan con un volumen menor que γ, entonces nuestro algoritmo es capaz de colocar una orden límite durante cada bloque de γ acciones que se han negociado. Por lo tanto, después de que se hayan ejecutado γN órdenes de mercado, A ha colocado N órdenes en el mercado. Ten en cuenta que puede haber como máximo una orden límite (y por lo tanto, como máximo una acción) sin ejecutar en cada nivel de la escalera de precios discretizada definida anteriormente. Esto se debe a que después del intervalo i, el algoritmo coloca su orden límite estrictamente por debajo de VWAPi, por lo que si VWAPj ≥ VWAPi para j > i, esta orden límite debe haber sido ejecutada. Por lo tanto, las órdenes límite no ejecutadas limitaron los VWAPs del resto del día, resultando en un máximo de una orden no ejecutada por nivel de precio. Un límite en la pérdida de ingresos es, por lo tanto, la suma de los precios discretizados: ∞ i=1(1 − )i pmax ≤ pmax / . Claramente nuestro algoritmo ha vendido como máximo N acciones. Ten en cuenta que a medida que N se vuelve grande, VWAPA se acerca a 1 menos el VWAP del mercado. Si supiéramos que el volumen total final de las ejecuciones del mercado es V, entonces podríamos establecer γ = V/N, asumiendo que γ >> 1. Si solo tenemos un límite superior e inferior en V, deberíamos poder adivinar y incurrir en una pérdida logarítmica. La siguiente suposición intenta capturar la variabilidad del volumen del mercado. Suposición de Variabilidad del Volumen del Libro de Órdenes 3.4.0.5. Ahora asumimos que el volumen total (que incluye las operaciones ejecutadas tanto por nuestro algoritmo como por el mercado) es variable dentro de una región conocida y que el volumen del mercado será mayor que el volumen de nuestros algoritmos. De manera más formal, para todo S ∈ Σ, asumir que el volumen total V de acciones negociadas en execM (S, S), para cualquier secuencia S de N órdenes de venta límite, satisface 2N ≤ Vmin ≤ V ≤ Vmax. Que Q = Vmax / Vmin. El siguiente corolario se deriva utilizando una constante = 1/2 y observando que si establecemos γ de manera que V ≤ γN ≤ 2V entonces nuestro algoritmo colocará entre N y N/2 órdenes límite. Corolario 9. En el modelo de libro de órdenes, si se cumplen la suposición de volumen de orden acotado y precio máximo, y la suposición de variabilidad del volumen del libro de órdenes, existe un algoritmo en línea A para vender como máximo N acciones tal que VWAPA(S, S) ≥ 1 4 log(Q) VWAPM(S, S) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figura 3: Aquí presentamos límites de la Sección 4 basados en las distribuciones de volumen empíricas para cuatro acciones reales: QQQ, MCHP, JNPR y CHKP. Los gráficos muestran histogramas de los volúmenes totales diarios transados en Island para estas acciones, en el último año y medio, junto con los valores correspondientes de log(Q) y E(Pbins vol) (denotado por E). Suponemos que los volúmenes diarios mínimo y máximo en los datos corresponden a Vmin y Vmax, respectivamente. Los límites de la razón competitiva en el peor de los casos (que son dos veces el logaritmo de Q) de nuestro algoritmo para esas acciones son 9.42, 10.56, 11.32 y 13.20, respectivamente. Los límites correspondientes sobre el rendimiento de la proporción competitiva de nuestro algoritmo bajo el modelo de distribución de volumen (que son el doble de E(Pbins vol )) son mejores: 7.54, 7.72, 7.94 y 9.00, respectivamente (una mejora relativa del 20-40%). Usando una partición de volumen más fina junto con un límite ligeramente más refinado en la relación competitiva, podemos construir algoritmos que, utilizando la distribución de volumen empírica dada como correcta, garantizan relaciones competitivas aún mejores de 2.76, 2.73, 2.75 y 3.17, respectivamente para esas acciones (detalles omitidos). MODELOS DE DISTRIBUCIÓN MACROSCÓPICA Concluimos nuestros resultados con un regreso al modelo de precio-volumen, donde introduciremos algunos métodos refinados de análisis para algoritmos de trading en línea. Dejamos la generalización de estos métodos al modelo de libro de órdenes para trabajos futuros. Los ratios de competitividad definidos hasta ahora miden el rendimiento en relación con algún criterio de referencia en el peor caso sobre todas las secuencias de mercado S ∈ Σ. Se ha observado en muchos entornos en línea que tales métricas de peor caso pueden arrojar resultados pesimistas, y se han considerado varias relajaciones, como permitir una distribución de probabilidad sobre la secuencia de entrada. Ahora consideramos modelos de distribución que son considerablemente más débiles que asumir una distribución sobre secuencias de mercado completas S ∈ Σ. En el modelo de distribución de volumen, asumimos únicamente que existe una distribución Pvol sobre el volumen total V negociado en el mercado durante el día, y luego examinamos la peor relación competitiva en secuencias consistentes con el volumen elegido al azar. Más precisamente, definimos RVWAP(A, Pvol) = EV ∼Pvol max S∈seq(V) VWAPM(S) VWAPA(S). Aquí V ∼ Pvol denota que V es elegido con respecto a la distribución Pvol, y seq(V) ⊂ Σ es el conjunto de todas las secuencias de mercado (p1, v1), . . . , (pT, vT) que satisfacen T t=1 vt = V. De manera similar, para OWT, podemos definir ROWT(A, Pmaxprice) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S). Aquí Pmaxprice es una distribución solo sobre el precio máximo del día, y luego examinamos secuencias de peor caso consistentes con este precio (seq(p) ⊂ Σ es el conjunto de todas las secuencias de mercado que satisfacen max1≤t≤T pt = p). Se pueden proporcionar definiciones análogas del lado de compra. Enfatizamos que en estos modelos, solo la distribución del volumen máximo y el precio es conocida por el algoritmo. También observamos que nuestras suposiciones probabilísticas sobre S son considerablemente más débiles que los modelos típicos de finanzas estadísticas, los cuales postularían un modelo estocástico detallado para la evolución paso a paso de (pt, vt). Aquí permitimos únicamente una distribución sobre medidas crudas y macroscópicas de la actividad del mercado durante todo el día, como el volumen total y el precio máximo, y analizamos el rendimiento en el peor de los casos coherente con estas medidas crudas. Por esta razón, nos referimos a tales configuraciones como el modelo de distribución macroscópica. El trabajo de El-Yaniv et al. [3] examina supuestos de distribución similares a los nuestros, pero también enfatizan las elecciones de peor caso para las distribuciones, y muestran que esto conduce a resultados no mejores que el análisis de peor caso original sobre todas las secuencias. Por el contrario, consideramos que el análisis de las distribuciones específicas Pvol y Pmaxprice es natural en muchos contextos financieros y nuestros resultados experimentales preliminares muestran mejoras significativas cuando se tiene en cuenta esta información distribucional bastante rudimentaria (ver Figura 3). Nuestros resultados en el contexto de VWAP examinan los casos en los que estas distribuciones son conocidas exactamente o solo aproximadamente. Resultados similares pueden obtenerse para distribuciones macroscópicas del precio máximo diario en el escenario de negociación unidireccional. 4.1 Resultados en el Modelo de Distribución Macroscópica Comenzamos señalando que los algoritmos examinados hasta ahora funcionan dividiendo los volúmenes totales o los precios máximos en contenedores de tamaño exponencialmente creciente, y luego adivinando el índice del contenedor en el que cae la cantidad real. Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en análisis competitivos) pueda depender de la distribución del índice de contenedor real. En lo que resta, asumimos que Q es una potencia de 2 y la base del logaritmo es 2. Que Pvol denote la distribución del volumen total diario del mercado. Definimos la distribución relacionada Pbins vol sobre los índices de los contenedores i de la siguiente manera: para todo i = 1, . . . , log(Q) − 1, Pbins vol (i) es igual a la probabilidad, bajo Pvol, de que el volumen diario caiga en el intervalo [Vmin 2i−1 , Vmin 2i ), y Pbins vol (log(Q)) es para el último intervalo [Vmax /2, Vmax]. Definimos E como E(Pbins vol) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2. Dado que el soporte de Pbins vol tiene solo log(Q) elementos, E(Pbins vol ) puede variar desde 1 (para distribuciones Pvol que colocan todo su peso en solo uno de los log(Q) intervalos entre Vmin , Vmin 2, Vmin 4, . . . , Vmax ) hasta log(Q) (para distribuciones Pvol en las que el volumen diario total tiene igual probabilidad de caer en cualquiera de estos intervalos). Ten en cuenta que las distribuciones Pvol de este último tipo están lejos de ser uniformes en todo el rango [Vmin, Vmax]. Teorema 10. En el modelo de distribución de volumen bajo el supuesto de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando únicamente el conocimiento de la distribución total de volumen Pvol, logra RVWAP(A, Pvol) ≤ 2E(Pbins vol). Todas las pruebas en esta sección se proporcionan en el apéndice. Como ejemplo concreto, considera el caso en el que Pvol es la distribución uniforme sobre [Vmin, Vmax]. En ese caso, el volumen de Pbins está aumentando de forma exponencial y alcanza su punto máximo en el último bin, que, al tener el ancho más grande, también tiene el mayor peso. En este caso, E(Pbins vol) es una constante (es decir, independiente de Q), lo que conduce a una proporción competitiva constante. Por otro lado, si Pvol es exponencial, entonces Pbins vol es uniforme, lo que conduce a una proporción competitiva de O(log(Q)), al igual que en el entorno de precio-volumen más adversarial discutido anteriormente. En la Figura 3, proporcionamos límites específicos adicionales obtenidos para distribuciones empíricas de volumen diario total calculadas para algunas acciones reales. Ahora examinamos el escenario en el que Pvol es desconocido, pero se dispone de una aproximación ˜Pvol. Definamos C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) . C se minimiza en C(Pbins vol , Pbins vol ) = E(Pbins vol ), y C puede ser infinito si ˜Pbins vol (i) es 0 cuando Pbins vol (i) > 0. Teorema 11. En el modelo de distribución de volumen bajo la suposición de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando solo el conocimiento de una aproximación ˜Pvol de Pvol, logra que RVWAP(A, Pvol) ≤ 2C(Pbins vol, ˜Pbins vol). Como ejemplo de este resultado, supongamos que nuestra aproximación cumple (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) para todo i, para algún α > 1. Por lo tanto, nuestras probabilidades estimadas de índice de contenedor están todas dentro de un factor de α de la verdad. Entonces es fácil demostrar que C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), por lo tanto, según los Teoremas 10 y 11, nuestra penalización por usar la distribución aproximada es un factor de α en la proporción competitiva. 5. REFERENCIAS [1] B. Awerbuch, Y. Bartal, A. Fiat y A. Rosén. Control de llamadas competitivo no preemptivo. En Proc. 5to Simposio ACM-SIAM sobre Algoritmos Discretos, páginas 312-320, 1994. [2] A. Borodin y R. El-Yaniv. Computación en línea y análisis competitivo. Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp y G. Turpin. Algoritmos óptimos de búsqueda y comercio en línea unidireccional. Algorithmica, 30:101-139, 2001. [4] M. Kearns y L. Ortiz. El proyecto de trading automatizado Penn-Lehman. IEEE Intelligent Systems, 2003. \n\nSistemas Inteligentes de IEEE, 2003. Aparecer. 6. APÉNDICE 6.1 Pruebas de la Subsección 2.3 Prueba. (Bosquejo del Teorema 3) Sin pérdida de generalidad, asumir que Q = 1 y el volumen total es V. Considera el tiempo t donde el horario fijo f vende menos, entonces ft ≤ N/T. Considera las secuencias donde en el tiempo t tenemos pt = pmax, vt = V, y para los tiempos t = t tenemos pt = pmin y vt = 0. El VWAP es pmax y el promedio de horario fijo es (N/T)pmax + (N − N/T)pmin. Prueba. (Bosquejo del Teorema 4) El algoritmo simplemente vende ut = (vt/Vmin)N acciones en el tiempo t. El número total de acciones vendidas U es claramente mayor que N y U = t ut = t (vt/Vmin)N = (V/Vmin)N ≤ QN El precio promedio es V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), donde usamos el hecho de que ut/U = vt/V. 197 Prueba. (del Teorema 5) Comenzamos con la prueba del límite inferior. Considera el siguiente escenario. Durante las primeras T unidades de tiempo tenemos un precio de √ Rpmin y un volumen total de Vmin. Observamos cuántas acciones ha comprado el algoritmo en línea. Si ha comprado más de la mitad de las acciones, los pasos de tiempo restantes tienen un precio pmin y un volumen de Vmax − Vmin. De lo contrario, los pasos de tiempo restantes tienen un precio pmax y un volumen insignificante. En el primer caso, el comprador en línea ha pagado al menos √ Rpmin /2 mientras que el VWAP es a lo sumo √ Rpmin /Q + pmin. Por lo tanto, en este caso la proporción competitiva es Ω(Q). En el segundo caso, el comprador en línea tiene que comprar al menos la mitad de las acciones a pmax, por lo que su costo promedio es al menos pmax/2. El VWAP del mercado es √ Rpmin = pmax / √ R, por lo tanto, la proporción competitiva es Ω( √ R). Para el límite superior, podemos obtener una proporción competitiva de √ R, comprando todas las acciones una vez que el precio caiga por debajo de √ Rpmin. El límite superior de Q se deriva ejecutando un algoritmo que asume que el volumen es Vmin. El comprador en línea paga un costo de p, mientras que el VWAP será al menos p/Q. 6.2 Pruebas de la Sección 4 Prueba. (Bosquejo del Teorema 10) Utilizamos la idea de adivinar el volumen total del Teorema 1, pero ahora permitimos la posibilidad de una distribución arbitraria (pero conocida) sobre el volumen total. En particular, considere construir una distribución Gbins vol sobre un conjunto de valores de volumen utilizando Pvol y úsela para estimar el volumen total V. Permita que el algoritmo adivine ˆV = Vmin 2i con probabilidad Gbins vol (i). Luego, observe que, para cualquier secuencia de precio-volumen S, si V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2. Esto implica un límite superior en RVWAP(A, Pvol) en términos de Gbins vol. Entonces obtenemos que Gbins vol (i) ∝ Pbins vol (i) minimiza el límite superior, lo que conduce al límite superior establecido en el teorema. Prueba. (Bosquejo del Teorema 11) Reemplace Pvol con ˜Pvol en la expresión de Gbins vol en el bosquejo de la prueba para el último resultado. 198 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "online algorithm": {
            "translated_key": "algoritmo en línea",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an <br>online algorithm</br> A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an <br>online algorithm</br> A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any <br>online algorithm</br> A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an <br>online algorithm</br> A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an <br>online algorithm</br> A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any <br>online algorithm</br> A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an <br>online algorithm</br> A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an <br>online algorithm</br> A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an <br>online algorithm</br> A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an <br>online algorithm</br> A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an <br>online algorithm</br> A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the <br>online algorithm</br> has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "In VWAP trading, the goal of an <br>online algorithm</br> A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "In the price-volume model under the volume variability assumption, there exists an <br>online algorithm</br> A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any <br>online algorithm</br> A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "In the price-volume model under the price variability assumption, there exists an <br>online algorithm</br> A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In the price-volume model under the volume and price variability assumptions, there exists an <br>online algorithm</br> A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R})."
            ],
            "translated_annotated_samples": [
                "En el trading de VWAP, el objetivo de un <br>algoritmo en línea</br> A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado.",
                "En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un <br>algoritmo en línea</br> A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q).",
                "Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier <br>algoritmo en línea</br> A para vender N acciones tiene RVWAP(A) = Ω(log(Q)).",
                "En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un <br>algoritmo en línea</br> A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)).",
                "En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un <br>algoritmo en línea</br> A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R})."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP. Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por acción. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading. Más precisamente, en este modelo en línea, observamos la secuencia de precio-volumen de a pares. Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt. Supongamos que nuestro objetivo es vender N acciones a lo largo del día. Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT. De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante. Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas. Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema). En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios. En el trading de VWAP, el objetivo de un <br>algoritmo en línea</br> A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado. El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt. Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N. Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo. El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo. Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales. Es fácil ver que esto lo convierte en un criterio más desafiante de seguir. A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado. En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes. En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día. Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques. Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S). Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio. Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto. Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin. Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones. Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1. En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo. En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo. Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP. Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)). Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios. Teorema 1. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un <br>algoritmo en línea</br> A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q). Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier <br>algoritmo en línea</br> A para vender N acciones tiene RVWAP(A) = Ω(log(Q)). Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1]. Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día. Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones. Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1. Claramente, uno de los Ai tiene una proporción competitiva de 2. Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada). Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT. Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2. Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP. Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ). Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo. Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1. Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0. Suponga que el precio máximo en S es pmax. El VWAP de nuestra secuencia es al menos pmax /3. Dado que teníamos un algoritmo c competitivo, su venta promedio es al menos pmax /3c. El límite inferior ahora se sigue utilizando el límite inferior en [3]. Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT. Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191. En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un <br>algoritmo en línea</br> A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)). Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)). Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT. Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo. Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R). Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen. Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt). Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario. Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso. Teorema 3. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)). Las pruebas de todos los resultados de esta subsección están en el Apéndice. Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones. En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender. Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución. El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo. Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1. Teorema 4. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S). En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2]. En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo. Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente. Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema. Teorema 5. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un <br>algoritmo en línea</br> A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}). ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "stock trading": {
            "translated_key": "comercio de acciones",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for <br>stock trading</br>.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in <br>stock trading</br> is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for <br>stock trading</br>.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in <br>stock trading</br> is that between a limit order and a market order."
            ],
            "translated_annotated_samples": [
                "Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el <br>comercio de acciones</br>.",
                "Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la <br>negociación de acciones</br> es entre una orden limitada y una orden de mercado."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el <br>comercio de acciones</br>. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP. Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por acción. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading. Más precisamente, en este modelo en línea, observamos la secuencia de precio-volumen de a pares. Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt. Supongamos que nuestro objetivo es vender N acciones a lo largo del día. Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT. De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante. Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas. Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema). En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios. En el trading de VWAP, el objetivo de un algoritmo en línea A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado. El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt. Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N. Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo. El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo. Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales. Es fácil ver que esto lo convierte en un criterio más desafiante de seguir. A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado. En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes. En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día. Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques. Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S). Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio. Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto. Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin. Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones. Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1. En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo. En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo. Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP. Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)). Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios. Teorema 1. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q). Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier algoritmo en línea A para vender N acciones tiene RVWAP(A) = Ω(log(Q)). Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1]. Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día. Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones. Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1. Claramente, uno de los Ai tiene una proporción competitiva de 2. Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada). Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT. Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2. Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP. Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ). Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo. Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1. Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0. Suponga que el precio máximo en S es pmax. El VWAP de nuestra secuencia es al menos pmax /3. Dado que teníamos un algoritmo c competitivo, su venta promedio es al menos pmax /3c. El límite inferior ahora se sigue utilizando el límite inferior en [3]. Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT. Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191. En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)). Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)). Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT. Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo. Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R). Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen. Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt). Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario. Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso. Teorema 3. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)). Las pruebas de todos los resultados de esta subsección están en el Apéndice. Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones. En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender. Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución. El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo. Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1. Teorema 4. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S). En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2]. En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo. Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente. Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema. Teorema 5. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un algoritmo en línea A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}). Además, cualquier algoritmo en línea A para comprar N acciones tiene una proporción competitiva de compra VWAP Rbuy VWAP(A) = Ω(min{Q, √ R}). 3. Un modelo de trading de libro de órdenes limitadas. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado. Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la <br>negociación de acciones</br> es entre una orden limitada y una orden de mercado. Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT). En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado. Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 2, que muestra una captura de pantalla real de un libro de órdenes reciente de MSFT en Island (www.island.com), un conocido intercambio electrónico de acciones de NASDAQ), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos. Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta). Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (siendo las órdenes más antiguas las primeras en el libro). En el ejemplo proporcionado por la Figura 2, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra. De manera similar, se mantiene un libro de órdenes de venta para órdenes de límite de venta (por ejemplo, podríamos querer vender 500 acciones de MSFT a $24.10 o más) esta vez con el precio de venta más bajo ofrecido (a menudo denominado como el precio de venta). Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas. Los precios de oferta y demanda (que nuevamente, son simplemente los precios en las órdenes límite en la parte superior de los libros de compra y venta, respectivamente) a veces se denominan como el mercado interno, y la diferencia entre ellos como el spread. Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección. ¿Entonces, cómo se ejecutan las órdenes? Hay dos métodos. Primero, cada vez que llega una orden de mercado, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto. Por lo tanto, una orden de mercado para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones. Por ejemplo, en el ejemplo de la Figura 2, tal orden sería completada por las dos órdenes de venta límite de 500 acciones a $24.069, las 500 acciones a $24.07, las 200 acciones a $24.08, y luego 300 de las 1981 acciones a $24.09. Las 1681 acciones restantes de esta última orden límite permanecerían como el nuevo tope del libro de órdenes de venta límite. Segundo, si una orden de límite de compra (venta, respectivamente) entra por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con órdenes en los libros opuestos. Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato. Cada orden de mercado o límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que las órdenes llegan, y dos órdenes nunca pueden llegar simultáneamente. Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden. Es esta cantidad la que generalmente se quiere decir cuando la gente se refiere casualmente al precio de una acción (ticker). Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una orden de mercado. Por lo tanto, asumiremos sin pérdida de generalidad que todas las órdenes se colocan como órdenes límite. Aunque las órdenes límite que no se ejecutan pueden ser eliminadas por la parte que las colocó, para simplificar, asumimos que las órdenes límite nunca son eliminadas de los libros. Remitimos al lector a [4] para obtener más información sobre los intercambios electrónicos modernos y la microestructura del mercado. 3.2 El Modelo El modelo de negociación de libros de órdenes en línea tiene como objetivo capturar los detalles realistas de la microestructura del mercado recién discutidos en un entorno de relación competitiva. En este modelo refinado, la actividad del mercado de un día se describe por una secuencia de órdenes límite (pt, vt, bt). Aquí bt es un bit que indica si la orden es de compra o venta, mientras que pt es el precio de la orden límite y vt es el número de acciones deseado. Tras la llegada de cada orden límite de este tipo, se permite a un algoritmo de trading en línea colocar su propia orden límite. Estas dos fuentes entrelazadas (mercado y algoritmo) de órdenes límite son simplemente operadas de acuerdo con el proceso de emparejamiento descrito en la Sección 3.1. Cualquier orden límite que no sea ejecutable de inmediato según este proceso se coloca en el libro correspondiente (compra o venta) para una posible ejecución futura; las órdenes que llegan y pueden ser ejecutadas parcial o totalmente se ejecutan de esa manera, con cualquier acción residual que permanezca en el libro respectivo. El objetivo de un algoritmo de venta VWAP u OWT es esencialmente el mismo que en el modelo de precio-volumen, pero el contexto ha cambiado en las siguientes dos formas fundamentales. Primero, la suposición de liquidez infinita en el modelo de precio-volumen se elimina por completo. El número de acciones disponibles a cualquier precio dado está restringido al volumen total de órdenes límite que ofrecen ese precio. Segundo, se asume que todas las órdenes entrantes, y por lo tanto los libros completos de órdenes límite, son visibles para el algoritmo. Esto es coherente con los intercambios financieros electrónicos modernos, y de hecho es la fuente de mucho interés actual en Wall Street [4]. En general, la definición de las ratios competitivas en el modelo de libro de órdenes se complica por el hecho de que ahora nuestra actividad algorítmica influye en la secuencia de precios y volúmenes ejecutados. Por lo tanto, primero definimos la secuencia de ejecución determinada por una secuencia de órdenes límite (colocadas por el mercado y nuestro algoritmo). Sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por el mercado, y sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por nuestro algoritmo (a menos que se especifique lo contrario, todos los bt son de tipo venta). Sea merge(S, S) la secuencia fusionada (p1, v1, b1), (p1, v1, b1), . . . , (pT, vT, bT), (pT, vT, bT), que es la secuencia temporal de órdenes realizadas por el mercado y el algoritmo. Ten en cuenta que el algoritmo tiene la opción de no realizar un pedido, lo cual podemos considerar como un pedido de volumen cero. Si llevamos a cabo el mantenimiento del libro de órdenes y el proceso de ejecución de órdenes descrito en la Sección 3.1 en la fusión de secuencias (S, S), en intervalos irregulares se produce una operación de compra/venta de un cierto número de acciones a un determinado precio. En cada operación ejecutada, la parte vendedora es o bien el mercado o el algoritmo. Sea execM (S, S ) = (q1, w1), . . . , (qT , wT ) la secuencia de ejecuciones donde el mercado (es decir, una parte distinta al algoritmo) fue la parte vendedora, donde los qt son los precios de ejecución y wt los volúmenes de ejecución. De manera similar, definimos execA(S, S) = (r1, x1), . . . , (rT, xT) como la secuencia de ejecuciones en las que el algoritmo fue la parte vendedora. Por lo tanto, execA(S, S) ∪ execM(S, S) es el conjunto de todas las ejecuciones. Generalmente esperamos que T sea (posiblemente mucho) más pequeño que T. Los ingresos del algoritmo y del mercado se definen como: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt. Nótese que ambas cantidades están determinadas únicamente por las secuencias de ejecución execM (S, S ) y execA(S, S ), respectivamente. Para un algoritmo A que está limitado a vender exactamente N acciones, definimos la razón de competencia OWT de A, ROWT(A), como la razón máxima (bajo cualquier S ∈ Σ) de los ingresos obtenidos por A, en comparación con los ingresos obtenidos por un algoritmo óptimo fuera de línea A∗. De manera más formal, para A∗ que está limitado a vender exactamente N acciones, definimos ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) donde S∗ es la secuencia de órdenes límite colocadas por A∗ en S. Si el algoritmo A es aleatorio, entonces tomamos la expectativa apropiada con respecto a S ∼ A. Definimos la ratio competitiva VWAP, RVWAP(A), como la ratio máxima (bajo cualquier S ∈ Σ) entre los VWAPs del mercado y del algoritmo. Más formalmente, define VWAPM (S, S ) como REVM (S, S )/ T t=1 wt, donde el denominador es simplemente el volumen total ejecutado de órdenes colocadas por el mercado. De manera similar, definimos VWAPA(S, S) como REVA(S, S)/N, ya que asumimos que el algoritmo vende no más de N acciones (esta definición asume implícitamente que A obtiene un precio de 0 por las acciones no vendidas). El ratio competitivo VWAP de A es entonces: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} donde S es la secuencia en línea de órdenes límite generadas por A en respuesta a la secuencia S. 3.3 Resultados de OWT en el Modelo de Libro de Órdenes. Para el problema de OWT en el modelo de libro de órdenes, introducimos una versión más sutil de la suposición de variabilidad de precios. Esto se debe al hecho de que nuestro trading algorítmico puede afectar los precios altos y bajos del día. Para la suposición a continuación, tenga en cuenta que execM (S, ∅) es la secuencia de ejecuciones sin la interacción de nuestro algoritmo. 3.3.0.3 Suposición de Variabilidad del Precio del Libro de Órdenes. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios pt en la secuencia execM (S, ∅) cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Tenga en cuenta que esta suposición no implica que las ratios de precios altos a bajos bajo las secuencias execM (S, S ) o execA(S, S ) estén limitadas por R. De hecho, la ratio en la secuencia execA(S, S ) podría ser infinita si el algoritmo termina vendiendo algunas acciones a un precio de 0. Teorema 6. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de venta OWT ROWT(A) = 2 log(R) log(N). Prueba. El algoritmo A funciona al adivinar un precio p en el conjunto {pmin2i : 1 ≤ i ≤ log(R)} y colocar una orden de venta límite por todas las N acciones al precio p al comienzo del día. (Alternativamente, el algoritmo A puede colocar log(R) órdenes de venta límite, donde la i-ésima tiene un precio de 2i pmin y un volumen de N/ log(R).) Al realizar un pedido al comienzo del día, el algoritmo ofrece un precio más bajo que todos los pedidos de venta que se realizarán durante el día por un precio de p o superior, lo que significa que primero se deben completar las N acciones del algoritmo a este precio. Por lo tanto, si hubiera habido k acciones que se hubieran vendido a un precio p o superior sin nuestra actividad, entonces A vendería al menos kp acciones. Definimos {pj} como el multiconjunto de precios de acciones individuales que han sido ejecutadas o son acciones de órdenes de compra límite que permanecieron sin ejecutar, excluyendo la actividad de nuestro algoritmo (es decir, asumiendo que nuestro algoritmo no coloca órdenes). Suponga sin pérdida de generalidad que p1 ≥ p2 ≥ . . .. Considerar adivinar el k-ésimo precio más alto, pk. Si se coloca una orden de N acciones al comienzo del día a un precio pk, entonces estamos garantizados de obtener un retorno de kpk. Que k∗ = argmaxk{kpk}. Podemos ver nuestro algoritmo como intentando adivinar pk∗, y teniendo éxito si la suposición p satisface p ∈ [pk∗ /2, pk∗]. Por lo tanto, somos 2 log(R) competitivos con la cantidad max1≤k≤N kpk. Se debe tener en cuenta que ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk donde ρ se define como la suma de los N precios principales pi sin la participación de A. De manera similar, sea {pj} el multiconjunto de precios de las acciones individuales ejecutadas, o los precios de las acciones de órdenes de compra no ejecutadas, pero ahora incluyendo las órdenes realizadas por algún algoritmo de venta A. Ahora deseamos demostrar que para todos los algoritmos A que venden N acciones, REVA ≤ N i=1 pi ≤ ρ. Esencialmente, esta desigualdad establece la idea intuitiva de que un algoritmo de venta solo puede reducir los precios de las órdenes de compra ejecutadas o no coincidentes. Para demostrar esto, utilizamos la inducción para mostrar que la eliminación de la actividad de un algoritmo de venta hace que estos precios aumenten. Primero, elimine la última acción en la última orden de venta realizada por A o el mercado en una fusión de secuencia arbitraria merge(S, S) - con esto queremos decir, tome la última orden de venta realizada por A o el mercado y disminuya su volumen en una acción. Después de esta modificación, los N precios más altos p1 . . . pN no disminuirán. Esto se debe a que o bien esta orden de venta no se ejecutó, en cuyo caso la afirmación es trivialmente verdadera, o, si se ejecutó, la eliminación de esta orden de venta deja una orden de compra adicional no ejecutada de igual o mayor precio. Para la inducción, asumimos que si eliminamos una participación de cualquier orden de venta que se haya colocado, ya sea por A o por el mercado, en o después del tiempo t, entonces los N precios principales no disminuyen. Ahora demostramos que si eliminamos una participación de la última orden de venta que fue colocada por A o el mercado antes del tiempo t, entonces los N precios principales no disminuyen. Si esta orden de venta de acciones no se ejecutó, entonces la afirmación es trivialmente verdadera. De lo contrario, si la orden de venta se ejecutó, entonces la afirmación es verdadera porque al eliminar esta acción ejecutada de la orden de venta, o bien: i) la acción correspondiente de la orden de compra (de igual o mayor valor) no se empareja en el resto de la secuencia, en cuyo caso la afirmación es verdadera; o ii) esta orden de compra se empareja con alguna acción de una orden de venta a un precio igual o mayor, lo que tiene el efecto de eliminar una acción de una orden de venta en el resto de la secuencia y, por la suposición inductiva, esto solo puede aumentar los precios. Por lo tanto, hemos demostrado que para todos los A que venden N acciones, REVA ≤ ρ. Ahora hemos establecido que nuestra ganancia satisface 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), donde A realiza una secuencia arbitraria de N órdenes de venta límite. 3.4 Resultados de VWAP en el Modelo del Libro de Órdenes El algoritmo OWT del Teorema 6 se puede aplicar para obtener el siguiente resultado de VWAP: Corolario 7. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de VWAP de venta RVWAP(A) = O(log(R) log(N)). Ahora hacemos una suposición bastante diferente sobre las secuencias S. 3.4.0.4 Volumen de Orden Acotado y Suposición de Precio Máximo. El conjunto de secuencias Σ satisface las siguientes dos propiedades. Primero, asumimos que cada orden colocada en el mercado tiene un volumen menor que γ, lo cual consideramos como una suposición leve ya que típicamente las órdenes individuales en el mercado no tienen un alto volumen (debido a problemas de liquidez). Esta suposición permite que nuestro algoritmo coloque al menos una orden límite a la vez intercalada con aproximadamente γ ejecuciones de mercado. Segundo, asumimos que hay un gran volumen en los libros de órdenes de venta por debajo del precio pmax, lo que significa que ninguna orden colocada por el mercado se ejecutará por encima del precio pmax. La forma más sencilla de instanciar esta última suposición en el modelo de libro de órdenes es asumir que cada secuencia S ∈ Σ comienza colocando un gran número de órdenes de venta (más de Vmax) a un precio pmax. Aunque esta suposición tiene un parámetro de precio máximo, no implica que la proporción de precios R sea finita, ya que no implica ningún límite inferior en los precios de compra o de las acciones ejecutadas (aparte del trivial de 0). Teorema 8. Considera el modelo de libro de órdenes bajo la suposición de volumen de orden limitado y precio máximo. Existe un algoritmo A en el cual después de exactamente γN ejecuciones de mercado, entonces A ha vendido como máximo N acciones y REVA(S, S) ≤ N = VWAPA(S, S) ≥ (1 − ε)VWAPM(S, S) − pmax N donde S es una secuencia de N órdenes de venta límite generadas por A al observar S. Demostración. El algoritmo divide el día de negociación en intervalos de volumen cuya duración en tiempo real puede variar. Para cada período i en el que se hayan ejecutado acciones γ en el mercado, el algoritmo calcula el VWAP de mercado solo de aquellas acciones negociadas en el período i; denotémoslo como VWAPi. Tras este intervalo de volumen i-ésimo, el algoritmo coloca una orden límite para vender exactamente una acción a un precio cercano al VWAPi. Más precisamente, el algoritmo solo coloca órdenes a los precios discretos (1− )pmax , (1− )2 pmax , . . .. Tras el intervalo de volumen i, el algoritmo coloca una orden límite para vender una acción al precio discretizado que esté más cercano al VWAPi, pero que sea estrictamente menor. Para el análisis, comenzamos observando que si todas las órdenes límite de los algoritmos se ejecutan durante el día, los ingresos totales recibidos por el algoritmo serían al menos (1 − )VWAPM (S, S )N. Para ver esto, basta con notar que VWAPM (S, S ) es una mezcla uniforme de los VWAPi (ya que por definición cubren la misma cantidad de volumen de mercado); y si todas las órdenes límite de los algoritmos se ejecutaran, cada uno recibiría más de (1 − )VWAPi dólares por el intervalo i que siguieron. Ahora contamos el potencial de ingresos perdidos del algoritmo debido a órdenes límite no ejecutadas. Por la suposición de que los pedidos individuales se realizan con un volumen menor que γ, entonces nuestro algoritmo es capaz de colocar una orden límite durante cada bloque de γ acciones que se han negociado. Por lo tanto, después de que se hayan ejecutado γN órdenes de mercado, A ha colocado N órdenes en el mercado. Ten en cuenta que puede haber como máximo una orden límite (y por lo tanto, como máximo una acción) sin ejecutar en cada nivel de la escalera de precios discretizada definida anteriormente. Esto se debe a que después del intervalo i, el algoritmo coloca su orden límite estrictamente por debajo de VWAPi, por lo que si VWAPj ≥ VWAPi para j > i, esta orden límite debe haber sido ejecutada. Por lo tanto, las órdenes límite no ejecutadas limitaron los VWAPs del resto del día, resultando en un máximo de una orden no ejecutada por nivel de precio. Un límite en la pérdida de ingresos es, por lo tanto, la suma de los precios discretizados: ∞ i=1(1 − )i pmax ≤ pmax / . Claramente nuestro algoritmo ha vendido como máximo N acciones. Ten en cuenta que a medida que N se vuelve grande, VWAPA se acerca a 1 menos el VWAP del mercado. Si supiéramos que el volumen total final de las ejecuciones del mercado es V, entonces podríamos establecer γ = V/N, asumiendo que γ >> 1. Si solo tenemos un límite superior e inferior en V, deberíamos poder adivinar y incurrir en una pérdida logarítmica. La siguiente suposición intenta capturar la variabilidad del volumen del mercado. Suposición de Variabilidad del Volumen del Libro de Órdenes 3.4.0.5. Ahora asumimos que el volumen total (que incluye las operaciones ejecutadas tanto por nuestro algoritmo como por el mercado) es variable dentro de una región conocida y que el volumen del mercado será mayor que el volumen de nuestros algoritmos. De manera más formal, para todo S ∈ Σ, asumir que el volumen total V de acciones negociadas en execM (S, S), para cualquier secuencia S de N órdenes de venta límite, satisface 2N ≤ Vmin ≤ V ≤ Vmax. Que Q = Vmax / Vmin. El siguiente corolario se deriva utilizando una constante = 1/2 y observando que si establecemos γ de manera que V ≤ γN ≤ 2V entonces nuestro algoritmo colocará entre N y N/2 órdenes límite. Corolario 9. En el modelo de libro de órdenes, si se cumplen la suposición de volumen de orden acotado y precio máximo, y la suposición de variabilidad del volumen del libro de órdenes, existe un algoritmo en línea A para vender como máximo N acciones tal que VWAPA(S, S) ≥ 1 4 log(Q) VWAPM(S, S) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figura 3: Aquí presentamos límites de la Sección 4 basados en las distribuciones de volumen empíricas para cuatro acciones reales: QQQ, MCHP, JNPR y CHKP. Los gráficos muestran histogramas de los volúmenes totales diarios transados en Island para estas acciones, en el último año y medio, junto con los valores correspondientes de log(Q) y E(Pbins vol) (denotado por E). Suponemos que los volúmenes diarios mínimo y máximo en los datos corresponden a Vmin y Vmax, respectivamente. Los límites de la razón competitiva en el peor de los casos (que son dos veces el logaritmo de Q) de nuestro algoritmo para esas acciones son 9.42, 10.56, 11.32 y 13.20, respectivamente. Los límites correspondientes sobre el rendimiento de la proporción competitiva de nuestro algoritmo bajo el modelo de distribución de volumen (que son el doble de E(Pbins vol )) son mejores: 7.54, 7.72, 7.94 y 9.00, respectivamente (una mejora relativa del 20-40%). Usando una partición de volumen más fina junto con un límite ligeramente más refinado en la relación competitiva, podemos construir algoritmos que, utilizando la distribución de volumen empírica dada como correcta, garantizan relaciones competitivas aún mejores de 2.76, 2.73, 2.75 y 3.17, respectivamente para esas acciones (detalles omitidos). MODELOS DE DISTRIBUCIÓN MACROSCÓPICA Concluimos nuestros resultados con un regreso al modelo de precio-volumen, donde introduciremos algunos métodos refinados de análisis para algoritmos de trading en línea. Dejamos la generalización de estos métodos al modelo de libro de órdenes para trabajos futuros. Los ratios de competitividad definidos hasta ahora miden el rendimiento en relación con algún criterio de referencia en el peor caso sobre todas las secuencias de mercado S ∈ Σ. Se ha observado en muchos entornos en línea que tales métricas de peor caso pueden arrojar resultados pesimistas, y se han considerado varias relajaciones, como permitir una distribución de probabilidad sobre la secuencia de entrada. Ahora consideramos modelos de distribución que son considerablemente más débiles que asumir una distribución sobre secuencias de mercado completas S ∈ Σ. En el modelo de distribución de volumen, asumimos únicamente que existe una distribución Pvol sobre el volumen total V negociado en el mercado durante el día, y luego examinamos la peor relación competitiva en secuencias consistentes con el volumen elegido al azar. Más precisamente, definimos RVWAP(A, Pvol) = EV ∼Pvol max S∈seq(V) VWAPM(S) VWAPA(S). Aquí V ∼ Pvol denota que V es elegido con respecto a la distribución Pvol, y seq(V) ⊂ Σ es el conjunto de todas las secuencias de mercado (p1, v1), . . . , (pT, vT) que satisfacen T t=1 vt = V. De manera similar, para OWT, podemos definir ROWT(A, Pmaxprice) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S). Aquí Pmaxprice es una distribución solo sobre el precio máximo del día, y luego examinamos secuencias de peor caso consistentes con este precio (seq(p) ⊂ Σ es el conjunto de todas las secuencias de mercado que satisfacen max1≤t≤T pt = p). Se pueden proporcionar definiciones análogas del lado de compra. Enfatizamos que en estos modelos, solo la distribución del volumen máximo y el precio es conocida por el algoritmo. También observamos que nuestras suposiciones probabilísticas sobre S son considerablemente más débiles que los modelos típicos de finanzas estadísticas, los cuales postularían un modelo estocástico detallado para la evolución paso a paso de (pt, vt). Aquí permitimos únicamente una distribución sobre medidas crudas y macroscópicas de la actividad del mercado durante todo el día, como el volumen total y el precio máximo, y analizamos el rendimiento en el peor de los casos coherente con estas medidas crudas. Por esta razón, nos referimos a tales configuraciones como el modelo de distribución macroscópica. El trabajo de El-Yaniv et al. [3] examina supuestos de distribución similares a los nuestros, pero también enfatizan las elecciones de peor caso para las distribuciones, y muestran que esto conduce a resultados no mejores que el análisis de peor caso original sobre todas las secuencias. Por el contrario, consideramos que el análisis de las distribuciones específicas Pvol y Pmaxprice es natural en muchos contextos financieros y nuestros resultados experimentales preliminares muestran mejoras significativas cuando se tiene en cuenta esta información distribucional bastante rudimentaria (ver Figura 3). Nuestros resultados en el contexto de VWAP examinan los casos en los que estas distribuciones son conocidas exactamente o solo aproximadamente. Resultados similares pueden obtenerse para distribuciones macroscópicas del precio máximo diario en el escenario de negociación unidireccional. 4.1 Resultados en el Modelo de Distribución Macroscópica Comenzamos señalando que los algoritmos examinados hasta ahora funcionan dividiendo los volúmenes totales o los precios máximos en contenedores de tamaño exponencialmente creciente, y luego adivinando el índice del contenedor en el que cae la cantidad real. Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en análisis competitivos) pueda depender de la distribución del índice de contenedor real. En lo que resta, asumimos que Q es una potencia de 2 y la base del logaritmo es 2. Que Pvol denote la distribución del volumen total diario del mercado. Definimos la distribución relacionada Pbins vol sobre los índices de los contenedores i de la siguiente manera: para todo i = 1, . . . , log(Q) − 1, Pbins vol (i) es igual a la probabilidad, bajo Pvol, de que el volumen diario caiga en el intervalo [Vmin 2i−1 , Vmin 2i ), y Pbins vol (log(Q)) es para el último intervalo [Vmax /2, Vmax]. Definimos E como E(Pbins vol) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2. Dado que el soporte de Pbins vol tiene solo log(Q) elementos, E(Pbins vol ) puede variar desde 1 (para distribuciones Pvol que colocan todo su peso en solo uno de los log(Q) intervalos entre Vmin , Vmin 2, Vmin 4, . . . , Vmax ) hasta log(Q) (para distribuciones Pvol en las que el volumen diario total tiene igual probabilidad de caer en cualquiera de estos intervalos). Ten en cuenta que las distribuciones Pvol de este último tipo están lejos de ser uniformes en todo el rango [Vmin, Vmax]. Teorema 10. En el modelo de distribución de volumen bajo el supuesto de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando únicamente el conocimiento de la distribución total de volumen Pvol, logra RVWAP(A, Pvol) ≤ 2E(Pbins vol). Todas las pruebas en esta sección se proporcionan en el apéndice. Como ejemplo concreto, considera el caso en el que Pvol es la distribución uniforme sobre [Vmin, Vmax]. En ese caso, el volumen de Pbins está aumentando de forma exponencial y alcanza su punto máximo en el último bin, que, al tener el ancho más grande, también tiene el mayor peso. En este caso, E(Pbins vol) es una constante (es decir, independiente de Q), lo que conduce a una proporción competitiva constante. Por otro lado, si Pvol es exponencial, entonces Pbins vol es uniforme, lo que conduce a una proporción competitiva de O(log(Q)), al igual que en el entorno de precio-volumen más adversarial discutido anteriormente. En la Figura 3, proporcionamos límites específicos adicionales obtenidos para distribuciones empíricas de volumen diario total calculadas para algunas acciones reales. Ahora examinamos el escenario en el que Pvol es desconocido, pero se dispone de una aproximación ˜Pvol. Definamos C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) . C se minimiza en C(Pbins vol , Pbins vol ) = E(Pbins vol ), y C puede ser infinito si ˜Pbins vol (i) es 0 cuando Pbins vol (i) > 0. Teorema 11. En el modelo de distribución de volumen bajo la suposición de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando solo el conocimiento de una aproximación ˜Pvol de Pvol, logra que RVWAP(A, Pvol) ≤ 2C(Pbins vol, ˜Pbins vol). Como ejemplo de este resultado, supongamos que nuestra aproximación cumple (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) para todo i, para algún α > 1. Por lo tanto, nuestras probabilidades estimadas de índice de contenedor están todas dentro de un factor de α de la verdad. Entonces es fácil demostrar que C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), por lo tanto, según los Teoremas 10 y 11, nuestra penalización por usar la distribución aproximada es un factor de α en la proporción competitiva. 5. REFERENCIAS [1] B. Awerbuch, Y. Bartal, A. Fiat y A. Rosén. Control de llamadas competitivo no preemptivo. En Proc. 5to Simposio ACM-SIAM sobre Algoritmos Discretos, páginas 312-320, 1994. [2] A. Borodin y R. El-Yaniv. Computación en línea y análisis competitivo. Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp y G. Turpin. Algoritmos óptimos de búsqueda y comercio en línea unidireccional. Algorithmica, 30:101-139, 2001. [4] M. Kearns y L. Ortiz. El proyecto de trading automatizado Penn-Lehman. IEEE Intelligent Systems, 2003. \n\nSistemas Inteligentes de IEEE, 2003. Aparecer. 6. APÉNDICE 6.1 Pruebas de la Subsección 2.3 Prueba. (Bosquejo del Teorema 3) Sin pérdida de generalidad, asumir que Q = 1 y el volumen total es V. Considera el tiempo t donde el horario fijo f vende menos, entonces ft ≤ N/T. Considera las secuencias donde en el tiempo t tenemos pt = pmax, vt = V, y para los tiempos t = t tenemos pt = pmin y vt = 0. El VWAP es pmax y el promedio de horario fijo es (N/T)pmax + (N − N/T)pmin. Prueba. (Bosquejo del Teorema 4) El algoritmo simplemente vende ut = (vt/Vmin)N acciones en el tiempo t. El número total de acciones vendidas U es claramente mayor que N y U = t ut = t (vt/Vmin)N = (V/Vmin)N ≤ QN El precio promedio es V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), donde usamos el hecho de que ut/U = vt/V. 197 Prueba. (del Teorema 5) Comenzamos con la prueba del límite inferior. Considera el siguiente escenario. Durante las primeras T unidades de tiempo tenemos un precio de √ Rpmin y un volumen total de Vmin. Observamos cuántas acciones ha comprado el algoritmo en línea. Si ha comprado más de la mitad de las acciones, los pasos de tiempo restantes tienen un precio pmin y un volumen de Vmax − Vmin. De lo contrario, los pasos de tiempo restantes tienen un precio pmax y un volumen insignificante. En el primer caso, el comprador en línea ha pagado al menos √ Rpmin /2 mientras que el VWAP es a lo sumo √ Rpmin /Q + pmin. Por lo tanto, en este caso la proporción competitiva es Ω(Q). En el segundo caso, el comprador en línea tiene que comprar al menos la mitad de las acciones a pmax, por lo que su costo promedio es al menos pmax/2. El VWAP del mercado es √ Rpmin = pmax / √ R, por lo tanto, la proporción competitiva es Ω( √ R). Para el límite superior, podemos obtener una proporción competitiva de √ R, comprando todas las acciones una vez que el precio caiga por debajo de √ Rpmin. El límite superior de Q se deriva ejecutando un algoritmo que asume que el volumen es Vmin. El comprador en línea paga un costo de p, mientras que el VWAP será al menos p/Q. 6.2 Pruebas de la Sección 4 Prueba. (Bosquejo del Teorema 10) Utilizamos la idea de adivinar el volumen total del Teorema 1, pero ahora permitimos la posibilidad de una distribución arbitraria (pero conocida) sobre el volumen total. En particular, considere construir una distribución Gbins vol sobre un conjunto de valores de volumen utilizando Pvol y úsela para estimar el volumen total V. Permita que el algoritmo adivine ˆV = Vmin 2i con probabilidad Gbins vol (i). Luego, observe que, para cualquier secuencia de precio-volumen S, si V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2. Esto implica un límite superior en RVWAP(A, Pvol) en términos de Gbins vol. Entonces obtenemos que Gbins vol (i) ∝ Pbins vol (i) minimiza el límite superior, lo que conduce al límite superior establecido en el teorema. Prueba. (Bosquejo del Teorema 11) Reemplace Pvol con ˜Pvol en la expresión de Gbins vol en el bosquejo de la prueba para el último resultado. 198 ",
            "candidates": [],
            "error": [
                [
                    "comercio de acciones",
                    "negociación de acciones"
                ]
            ]
        },
        "sequence of trade": {
            "translated_key": "secuencia de operaciones",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the <br>sequence of trade</br>s.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the <br>sequence of trade</br>s."
            ],
            "translated_annotated_samples": [
                "MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la <br>secuencia de operaciones</br>."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP. Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por acción. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la <br>secuencia de operaciones</br>. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading. Más precisamente, en este modelo en línea, observamos la secuencia de precio-volumen de a pares. Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt. Supongamos que nuestro objetivo es vender N acciones a lo largo del día. Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT. De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante. Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas. Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema). En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios. En el trading de VWAP, el objetivo de un algoritmo en línea A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado. El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt. Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N. Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo. El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo. Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales. Es fácil ver que esto lo convierte en un criterio más desafiante de seguir. A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado. En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes. En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día. Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques. Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S). Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio. Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto. Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin. Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones. Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1. En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo. En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo. Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP. Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)). Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios. Teorema 1. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q). Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier algoritmo en línea A para vender N acciones tiene RVWAP(A) = Ω(log(Q)). Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1]. Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día. Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones. Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1. Claramente, uno de los Ai tiene una proporción competitiva de 2. Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada). Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT. Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2. Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP. Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ). Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo. Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1. Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0. Suponga que el precio máximo en S es pmax. El VWAP de nuestra secuencia es al menos pmax /3. Dado que teníamos un algoritmo c competitivo, su venta promedio es al menos pmax /3c. El límite inferior ahora se sigue utilizando el límite inferior en [3]. Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT. Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191. En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)). Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)). Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT. Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo. Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R). Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen. Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt). Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario. Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso. Teorema 3. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)). Las pruebas de todos los resultados de esta subsección están en el Apéndice. Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones. En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender. Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución. El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo. Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1. Teorema 4. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S). En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2]. En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo. Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente. Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema. Teorema 5. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un algoritmo en línea A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}). Además, cualquier algoritmo en línea A para comprar N acciones tiene una proporción competitiva de compra VWAP Rbuy VWAP(A) = Ω(min{Q, √ R}). 3. Un modelo de trading de libro de órdenes limitadas. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado. Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la negociación de acciones es entre una orden limitada y una orden de mercado. Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT). En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado. Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 2, que muestra una captura de pantalla real de un libro de órdenes reciente de MSFT en Island (www.island.com), un conocido intercambio electrónico de acciones de NASDAQ), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos. Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta). Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (siendo las órdenes más antiguas las primeras en el libro). En el ejemplo proporcionado por la Figura 2, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra. De manera similar, se mantiene un libro de órdenes de venta para órdenes de límite de venta (por ejemplo, podríamos querer vender 500 acciones de MSFT a $24.10 o más) esta vez con el precio de venta más bajo ofrecido (a menudo denominado como el precio de venta). Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas. Los precios de oferta y demanda (que nuevamente, son simplemente los precios en las órdenes límite en la parte superior de los libros de compra y venta, respectivamente) a veces se denominan como el mercado interno, y la diferencia entre ellos como el spread. Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección. ¿Entonces, cómo se ejecutan las órdenes? Hay dos métodos. Primero, cada vez que llega una orden de mercado, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto. Por lo tanto, una orden de mercado para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones. Por ejemplo, en el ejemplo de la Figura 2, tal orden sería completada por las dos órdenes de venta límite de 500 acciones a $24.069, las 500 acciones a $24.07, las 200 acciones a $24.08, y luego 300 de las 1981 acciones a $24.09. Las 1681 acciones restantes de esta última orden límite permanecerían como el nuevo tope del libro de órdenes de venta límite. Segundo, si una orden de límite de compra (venta, respectivamente) entra por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con órdenes en los libros opuestos. Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato. Cada orden de mercado o límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que las órdenes llegan, y dos órdenes nunca pueden llegar simultáneamente. Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden. Es esta cantidad la que generalmente se quiere decir cuando la gente se refiere casualmente al precio de una acción (ticker). Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una orden de mercado. Por lo tanto, asumiremos sin pérdida de generalidad que todas las órdenes se colocan como órdenes límite. Aunque las órdenes límite que no se ejecutan pueden ser eliminadas por la parte que las colocó, para simplificar, asumimos que las órdenes límite nunca son eliminadas de los libros. Remitimos al lector a [4] para obtener más información sobre los intercambios electrónicos modernos y la microestructura del mercado. 3.2 El Modelo El modelo de negociación de libros de órdenes en línea tiene como objetivo capturar los detalles realistas de la microestructura del mercado recién discutidos en un entorno de relación competitiva. En este modelo refinado, la actividad del mercado de un día se describe por una secuencia de órdenes límite (pt, vt, bt). Aquí bt es un bit que indica si la orden es de compra o venta, mientras que pt es el precio de la orden límite y vt es el número de acciones deseado. Tras la llegada de cada orden límite de este tipo, se permite a un algoritmo de trading en línea colocar su propia orden límite. Estas dos fuentes entrelazadas (mercado y algoritmo) de órdenes límite son simplemente operadas de acuerdo con el proceso de emparejamiento descrito en la Sección 3.1. Cualquier orden límite que no sea ejecutable de inmediato según este proceso se coloca en el libro correspondiente (compra o venta) para una posible ejecución futura; las órdenes que llegan y pueden ser ejecutadas parcial o totalmente se ejecutan de esa manera, con cualquier acción residual que permanezca en el libro respectivo. El objetivo de un algoritmo de venta VWAP u OWT es esencialmente el mismo que en el modelo de precio-volumen, pero el contexto ha cambiado en las siguientes dos formas fundamentales. Primero, la suposición de liquidez infinita en el modelo de precio-volumen se elimina por completo. El número de acciones disponibles a cualquier precio dado está restringido al volumen total de órdenes límite que ofrecen ese precio. Segundo, se asume que todas las órdenes entrantes, y por lo tanto los libros completos de órdenes límite, son visibles para el algoritmo. Esto es coherente con los intercambios financieros electrónicos modernos, y de hecho es la fuente de mucho interés actual en Wall Street [4]. En general, la definición de las ratios competitivas en el modelo de libro de órdenes se complica por el hecho de que ahora nuestra actividad algorítmica influye en la secuencia de precios y volúmenes ejecutados. Por lo tanto, primero definimos la secuencia de ejecución determinada por una secuencia de órdenes límite (colocadas por el mercado y nuestro algoritmo). Sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por el mercado, y sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por nuestro algoritmo (a menos que se especifique lo contrario, todos los bt son de tipo venta). Sea merge(S, S) la secuencia fusionada (p1, v1, b1), (p1, v1, b1), . . . , (pT, vT, bT), (pT, vT, bT), que es la secuencia temporal de órdenes realizadas por el mercado y el algoritmo. Ten en cuenta que el algoritmo tiene la opción de no realizar un pedido, lo cual podemos considerar como un pedido de volumen cero. Si llevamos a cabo el mantenimiento del libro de órdenes y el proceso de ejecución de órdenes descrito en la Sección 3.1 en la fusión de secuencias (S, S), en intervalos irregulares se produce una operación de compra/venta de un cierto número de acciones a un determinado precio. En cada operación ejecutada, la parte vendedora es o bien el mercado o el algoritmo. Sea execM (S, S ) = (q1, w1), . . . , (qT , wT ) la secuencia de ejecuciones donde el mercado (es decir, una parte distinta al algoritmo) fue la parte vendedora, donde los qt son los precios de ejecución y wt los volúmenes de ejecución. De manera similar, definimos execA(S, S) = (r1, x1), . . . , (rT, xT) como la secuencia de ejecuciones en las que el algoritmo fue la parte vendedora. Por lo tanto, execA(S, S) ∪ execM(S, S) es el conjunto de todas las ejecuciones. Generalmente esperamos que T sea (posiblemente mucho) más pequeño que T. Los ingresos del algoritmo y del mercado se definen como: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt. Nótese que ambas cantidades están determinadas únicamente por las secuencias de ejecución execM (S, S ) y execA(S, S ), respectivamente. Para un algoritmo A que está limitado a vender exactamente N acciones, definimos la razón de competencia OWT de A, ROWT(A), como la razón máxima (bajo cualquier S ∈ Σ) de los ingresos obtenidos por A, en comparación con los ingresos obtenidos por un algoritmo óptimo fuera de línea A∗. De manera más formal, para A∗ que está limitado a vender exactamente N acciones, definimos ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) donde S∗ es la secuencia de órdenes límite colocadas por A∗ en S. Si el algoritmo A es aleatorio, entonces tomamos la expectativa apropiada con respecto a S ∼ A. Definimos la ratio competitiva VWAP, RVWAP(A), como la ratio máxima (bajo cualquier S ∈ Σ) entre los VWAPs del mercado y del algoritmo. Más formalmente, define VWAPM (S, S ) como REVM (S, S )/ T t=1 wt, donde el denominador es simplemente el volumen total ejecutado de órdenes colocadas por el mercado. De manera similar, definimos VWAPA(S, S) como REVA(S, S)/N, ya que asumimos que el algoritmo vende no más de N acciones (esta definición asume implícitamente que A obtiene un precio de 0 por las acciones no vendidas). El ratio competitivo VWAP de A es entonces: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} donde S es la secuencia en línea de órdenes límite generadas por A en respuesta a la secuencia S. 3.3 Resultados de OWT en el Modelo de Libro de Órdenes. Para el problema de OWT en el modelo de libro de órdenes, introducimos una versión más sutil de la suposición de variabilidad de precios. Esto se debe al hecho de que nuestro trading algorítmico puede afectar los precios altos y bajos del día. Para la suposición a continuación, tenga en cuenta que execM (S, ∅) es la secuencia de ejecuciones sin la interacción de nuestro algoritmo. 3.3.0.3 Suposición de Variabilidad del Precio del Libro de Órdenes. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios pt en la secuencia execM (S, ∅) cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Tenga en cuenta que esta suposición no implica que las ratios de precios altos a bajos bajo las secuencias execM (S, S ) o execA(S, S ) estén limitadas por R. De hecho, la ratio en la secuencia execA(S, S ) podría ser infinita si el algoritmo termina vendiendo algunas acciones a un precio de 0. Teorema 6. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de venta OWT ROWT(A) = 2 log(R) log(N). Prueba. El algoritmo A funciona al adivinar un precio p en el conjunto {pmin2i : 1 ≤ i ≤ log(R)} y colocar una orden de venta límite por todas las N acciones al precio p al comienzo del día. (Alternativamente, el algoritmo A puede colocar log(R) órdenes de venta límite, donde la i-ésima tiene un precio de 2i pmin y un volumen de N/ log(R).) Al realizar un pedido al comienzo del día, el algoritmo ofrece un precio más bajo que todos los pedidos de venta que se realizarán durante el día por un precio de p o superior, lo que significa que primero se deben completar las N acciones del algoritmo a este precio. Por lo tanto, si hubiera habido k acciones que se hubieran vendido a un precio p o superior sin nuestra actividad, entonces A vendería al menos kp acciones. Definimos {pj} como el multiconjunto de precios de acciones individuales que han sido ejecutadas o son acciones de órdenes de compra límite que permanecieron sin ejecutar, excluyendo la actividad de nuestro algoritmo (es decir, asumiendo que nuestro algoritmo no coloca órdenes). Suponga sin pérdida de generalidad que p1 ≥ p2 ≥ . . .. Considerar adivinar el k-ésimo precio más alto, pk. Si se coloca una orden de N acciones al comienzo del día a un precio pk, entonces estamos garantizados de obtener un retorno de kpk. Que k∗ = argmaxk{kpk}. Podemos ver nuestro algoritmo como intentando adivinar pk∗, y teniendo éxito si la suposición p satisface p ∈ [pk∗ /2, pk∗]. Por lo tanto, somos 2 log(R) competitivos con la cantidad max1≤k≤N kpk. Se debe tener en cuenta que ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk donde ρ se define como la suma de los N precios principales pi sin la participación de A. De manera similar, sea {pj} el multiconjunto de precios de las acciones individuales ejecutadas, o los precios de las acciones de órdenes de compra no ejecutadas, pero ahora incluyendo las órdenes realizadas por algún algoritmo de venta A. Ahora deseamos demostrar que para todos los algoritmos A que venden N acciones, REVA ≤ N i=1 pi ≤ ρ. Esencialmente, esta desigualdad establece la idea intuitiva de que un algoritmo de venta solo puede reducir los precios de las órdenes de compra ejecutadas o no coincidentes. Para demostrar esto, utilizamos la inducción para mostrar que la eliminación de la actividad de un algoritmo de venta hace que estos precios aumenten. Primero, elimine la última acción en la última orden de venta realizada por A o el mercado en una fusión de secuencia arbitraria merge(S, S) - con esto queremos decir, tome la última orden de venta realizada por A o el mercado y disminuya su volumen en una acción. Después de esta modificación, los N precios más altos p1 . . . pN no disminuirán. Esto se debe a que o bien esta orden de venta no se ejecutó, en cuyo caso la afirmación es trivialmente verdadera, o, si se ejecutó, la eliminación de esta orden de venta deja una orden de compra adicional no ejecutada de igual o mayor precio. Para la inducción, asumimos que si eliminamos una participación de cualquier orden de venta que se haya colocado, ya sea por A o por el mercado, en o después del tiempo t, entonces los N precios principales no disminuyen. Ahora demostramos que si eliminamos una participación de la última orden de venta que fue colocada por A o el mercado antes del tiempo t, entonces los N precios principales no disminuyen. Si esta orden de venta de acciones no se ejecutó, entonces la afirmación es trivialmente verdadera. De lo contrario, si la orden de venta se ejecutó, entonces la afirmación es verdadera porque al eliminar esta acción ejecutada de la orden de venta, o bien: i) la acción correspondiente de la orden de compra (de igual o mayor valor) no se empareja en el resto de la secuencia, en cuyo caso la afirmación es verdadera; o ii) esta orden de compra se empareja con alguna acción de una orden de venta a un precio igual o mayor, lo que tiene el efecto de eliminar una acción de una orden de venta en el resto de la secuencia y, por la suposición inductiva, esto solo puede aumentar los precios. Por lo tanto, hemos demostrado que para todos los A que venden N acciones, REVA ≤ ρ. Ahora hemos establecido que nuestra ganancia satisface 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), donde A realiza una secuencia arbitraria de N órdenes de venta límite. 3.4 Resultados de VWAP en el Modelo del Libro de Órdenes El algoritmo OWT del Teorema 6 se puede aplicar para obtener el siguiente resultado de VWAP: Corolario 7. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de VWAP de venta RVWAP(A) = O(log(R) log(N)). Ahora hacemos una suposición bastante diferente sobre las secuencias S. 3.4.0.4 Volumen de Orden Acotado y Suposición de Precio Máximo. El conjunto de secuencias Σ satisface las siguientes dos propiedades. Primero, asumimos que cada orden colocada en el mercado tiene un volumen menor que γ, lo cual consideramos como una suposición leve ya que típicamente las órdenes individuales en el mercado no tienen un alto volumen (debido a problemas de liquidez). Esta suposición permite que nuestro algoritmo coloque al menos una orden límite a la vez intercalada con aproximadamente γ ejecuciones de mercado. Segundo, asumimos que hay un gran volumen en los libros de órdenes de venta por debajo del precio pmax, lo que significa que ninguna orden colocada por el mercado se ejecutará por encima del precio pmax. La forma más sencilla de instanciar esta última suposición en el modelo de libro de órdenes es asumir que cada secuencia S ∈ Σ comienza colocando un gran número de órdenes de venta (más de Vmax) a un precio pmax. Aunque esta suposición tiene un parámetro de precio máximo, no implica que la proporción de precios R sea finita, ya que no implica ningún límite inferior en los precios de compra o de las acciones ejecutadas (aparte del trivial de 0). Teorema 8. Considera el modelo de libro de órdenes bajo la suposición de volumen de orden limitado y precio máximo. Existe un algoritmo A en el cual después de exactamente γN ejecuciones de mercado, entonces A ha vendido como máximo N acciones y REVA(S, S) ≤ N = VWAPA(S, S) ≥ (1 − ε)VWAPM(S, S) − pmax N donde S es una secuencia de N órdenes de venta límite generadas por A al observar S. Demostración. El algoritmo divide el día de negociación en intervalos de volumen cuya duración en tiempo real puede variar. Para cada período i en el que se hayan ejecutado acciones γ en el mercado, el algoritmo calcula el VWAP de mercado solo de aquellas acciones negociadas en el período i; denotémoslo como VWAPi. Tras este intervalo de volumen i-ésimo, el algoritmo coloca una orden límite para vender exactamente una acción a un precio cercano al VWAPi. Más precisamente, el algoritmo solo coloca órdenes a los precios discretos (1− )pmax , (1− )2 pmax , . . .. Tras el intervalo de volumen i, el algoritmo coloca una orden límite para vender una acción al precio discretizado que esté más cercano al VWAPi, pero que sea estrictamente menor. Para el análisis, comenzamos observando que si todas las órdenes límite de los algoritmos se ejecutan durante el día, los ingresos totales recibidos por el algoritmo serían al menos (1 − )VWAPM (S, S )N. Para ver esto, basta con notar que VWAPM (S, S ) es una mezcla uniforme de los VWAPi (ya que por definición cubren la misma cantidad de volumen de mercado); y si todas las órdenes límite de los algoritmos se ejecutaran, cada uno recibiría más de (1 − )VWAPi dólares por el intervalo i que siguieron. Ahora contamos el potencial de ingresos perdidos del algoritmo debido a órdenes límite no ejecutadas. Por la suposición de que los pedidos individuales se realizan con un volumen menor que γ, entonces nuestro algoritmo es capaz de colocar una orden límite durante cada bloque de γ acciones que se han negociado. Por lo tanto, después de que se hayan ejecutado γN órdenes de mercado, A ha colocado N órdenes en el mercado. Ten en cuenta que puede haber como máximo una orden límite (y por lo tanto, como máximo una acción) sin ejecutar en cada nivel de la escalera de precios discretizada definida anteriormente. Esto se debe a que después del intervalo i, el algoritmo coloca su orden límite estrictamente por debajo de VWAPi, por lo que si VWAPj ≥ VWAPi para j > i, esta orden límite debe haber sido ejecutada. Por lo tanto, las órdenes límite no ejecutadas limitaron los VWAPs del resto del día, resultando en un máximo de una orden no ejecutada por nivel de precio. Un límite en la pérdida de ingresos es, por lo tanto, la suma de los precios discretizados: ∞ i=1(1 − )i pmax ≤ pmax / . Claramente nuestro algoritmo ha vendido como máximo N acciones. Ten en cuenta que a medida que N se vuelve grande, VWAPA se acerca a 1 menos el VWAP del mercado. Si supiéramos que el volumen total final de las ejecuciones del mercado es V, entonces podríamos establecer γ = V/N, asumiendo que γ >> 1. Si solo tenemos un límite superior e inferior en V, deberíamos poder adivinar y incurrir en una pérdida logarítmica. La siguiente suposición intenta capturar la variabilidad del volumen del mercado. Suposición de Variabilidad del Volumen del Libro de Órdenes 3.4.0.5. Ahora asumimos que el volumen total (que incluye las operaciones ejecutadas tanto por nuestro algoritmo como por el mercado) es variable dentro de una región conocida y que el volumen del mercado será mayor que el volumen de nuestros algoritmos. De manera más formal, para todo S ∈ Σ, asumir que el volumen total V de acciones negociadas en execM (S, S), para cualquier secuencia S de N órdenes de venta límite, satisface 2N ≤ Vmin ≤ V ≤ Vmax. Que Q = Vmax / Vmin. El siguiente corolario se deriva utilizando una constante = 1/2 y observando que si establecemos γ de manera que V ≤ γN ≤ 2V entonces nuestro algoritmo colocará entre N y N/2 órdenes límite. Corolario 9. En el modelo de libro de órdenes, si se cumplen la suposición de volumen de orden acotado y precio máximo, y la suposición de variabilidad del volumen del libro de órdenes, existe un algoritmo en línea A para vender como máximo N acciones tal que VWAPA(S, S) ≥ 1 4 log(Q) VWAPM(S, S) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figura 3: Aquí presentamos límites de la Sección 4 basados en las distribuciones de volumen empíricas para cuatro acciones reales: QQQ, MCHP, JNPR y CHKP. Los gráficos muestran histogramas de los volúmenes totales diarios transados en Island para estas acciones, en el último año y medio, junto con los valores correspondientes de log(Q) y E(Pbins vol) (denotado por E). Suponemos que los volúmenes diarios mínimo y máximo en los datos corresponden a Vmin y Vmax, respectivamente. Los límites de la razón competitiva en el peor de los casos (que son dos veces el logaritmo de Q) de nuestro algoritmo para esas acciones son 9.42, 10.56, 11.32 y 13.20, respectivamente. Los límites correspondientes sobre el rendimiento de la proporción competitiva de nuestro algoritmo bajo el modelo de distribución de volumen (que son el doble de E(Pbins vol )) son mejores: 7.54, 7.72, 7.94 y 9.00, respectivamente (una mejora relativa del 20-40%). Usando una partición de volumen más fina junto con un límite ligeramente más refinado en la relación competitiva, podemos construir algoritmos que, utilizando la distribución de volumen empírica dada como correcta, garantizan relaciones competitivas aún mejores de 2.76, 2.73, 2.75 y 3.17, respectivamente para esas acciones (detalles omitidos). MODELOS DE DISTRIBUCIÓN MACROSCÓPICA Concluimos nuestros resultados con un regreso al modelo de precio-volumen, donde introduciremos algunos métodos refinados de análisis para algoritmos de trading en línea. Dejamos la generalización de estos métodos al modelo de libro de órdenes para trabajos futuros. Los ratios de competitividad definidos hasta ahora miden el rendimiento en relación con algún criterio de referencia en el peor caso sobre todas las secuencias de mercado S ∈ Σ. Se ha observado en muchos entornos en línea que tales métricas de peor caso pueden arrojar resultados pesimistas, y se han considerado varias relajaciones, como permitir una distribución de probabilidad sobre la secuencia de entrada. Ahora consideramos modelos de distribución que son considerablemente más débiles que asumir una distribución sobre secuencias de mercado completas S ∈ Σ. En el modelo de distribución de volumen, asumimos únicamente que existe una distribución Pvol sobre el volumen total V negociado en el mercado durante el día, y luego examinamos la peor relación competitiva en secuencias consistentes con el volumen elegido al azar. Más precisamente, definimos RVWAP(A, Pvol) = EV ∼Pvol max S∈seq(V) VWAPM(S) VWAPA(S). Aquí V ∼ Pvol denota que V es elegido con respecto a la distribución Pvol, y seq(V) ⊂ Σ es el conjunto de todas las secuencias de mercado (p1, v1), . . . , (pT, vT) que satisfacen T t=1 vt = V. De manera similar, para OWT, podemos definir ROWT(A, Pmaxprice) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S). Aquí Pmaxprice es una distribución solo sobre el precio máximo del día, y luego examinamos secuencias de peor caso consistentes con este precio (seq(p) ⊂ Σ es el conjunto de todas las secuencias de mercado que satisfacen max1≤t≤T pt = p). Se pueden proporcionar definiciones análogas del lado de compra. Enfatizamos que en estos modelos, solo la distribución del volumen máximo y el precio es conocida por el algoritmo. También observamos que nuestras suposiciones probabilísticas sobre S son considerablemente más débiles que los modelos típicos de finanzas estadísticas, los cuales postularían un modelo estocástico detallado para la evolución paso a paso de (pt, vt). Aquí permitimos únicamente una distribución sobre medidas crudas y macroscópicas de la actividad del mercado durante todo el día, como el volumen total y el precio máximo, y analizamos el rendimiento en el peor de los casos coherente con estas medidas crudas. Por esta razón, nos referimos a tales configuraciones como el modelo de distribución macroscópica. El trabajo de El-Yaniv et al. [3] examina supuestos de distribución similares a los nuestros, pero también enfatizan las elecciones de peor caso para las distribuciones, y muestran que esto conduce a resultados no mejores que el análisis de peor caso original sobre todas las secuencias. Por el contrario, consideramos que el análisis de las distribuciones específicas Pvol y Pmaxprice es natural en muchos contextos financieros y nuestros resultados experimentales preliminares muestran mejoras significativas cuando se tiene en cuenta esta información distribucional bastante rudimentaria (ver Figura 3). Nuestros resultados en el contexto de VWAP examinan los casos en los que estas distribuciones son conocidas exactamente o solo aproximadamente. Resultados similares pueden obtenerse para distribuciones macroscópicas del precio máximo diario en el escenario de negociación unidireccional. 4.1 Resultados en el Modelo de Distribución Macroscópica Comenzamos señalando que los algoritmos examinados hasta ahora funcionan dividiendo los volúmenes totales o los precios máximos en contenedores de tamaño exponencialmente creciente, y luego adivinando el índice del contenedor en el que cae la cantidad real. Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en análisis competitivos) pueda depender de la distribución del índice de contenedor real. En lo que resta, asumimos que Q es una potencia de 2 y la base del logaritmo es 2. Que Pvol denote la distribución del volumen total diario del mercado. Definimos la distribución relacionada Pbins vol sobre los índices de los contenedores i de la siguiente manera: para todo i = 1, . . . , log(Q) − 1, Pbins vol (i) es igual a la probabilidad, bajo Pvol, de que el volumen diario caiga en el intervalo [Vmin 2i−1 , Vmin 2i ), y Pbins vol (log(Q)) es para el último intervalo [Vmax /2, Vmax]. Definimos E como E(Pbins vol) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2. Dado que el soporte de Pbins vol tiene solo log(Q) elementos, E(Pbins vol ) puede variar desde 1 (para distribuciones Pvol que colocan todo su peso en solo uno de los log(Q) intervalos entre Vmin , Vmin 2, Vmin 4, . . . , Vmax ) hasta log(Q) (para distribuciones Pvol en las que el volumen diario total tiene igual probabilidad de caer en cualquiera de estos intervalos). Ten en cuenta que las distribuciones Pvol de este último tipo están lejos de ser uniformes en todo el rango [Vmin, Vmax]. Teorema 10. En el modelo de distribución de volumen bajo el supuesto de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando únicamente el conocimiento de la distribución total de volumen Pvol, logra RVWAP(A, Pvol) ≤ 2E(Pbins vol). Todas las pruebas en esta sección se proporcionan en el apéndice. Como ejemplo concreto, considera el caso en el que Pvol es la distribución uniforme sobre [Vmin, Vmax]. En ese caso, el volumen de Pbins está aumentando de forma exponencial y alcanza su punto máximo en el último bin, que, al tener el ancho más grande, también tiene el mayor peso. En este caso, E(Pbins vol) es una constante (es decir, independiente de Q), lo que conduce a una proporción competitiva constante. Por otro lado, si Pvol es exponencial, entonces Pbins vol es uniforme, lo que conduce a una proporción competitiva de O(log(Q)), al igual que en el entorno de precio-volumen más adversarial discutido anteriormente. En la Figura 3, proporcionamos límites específicos adicionales obtenidos para distribuciones empíricas de volumen diario total calculadas para algunas acciones reales. Ahora examinamos el escenario en el que Pvol es desconocido, pero se dispone de una aproximación ˜Pvol. Definamos C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) . C se minimiza en C(Pbins vol , Pbins vol ) = E(Pbins vol ), y C puede ser infinito si ˜Pbins vol (i) es 0 cuando Pbins vol (i) > 0. Teorema 11. En el modelo de distribución de volumen bajo la suposición de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando solo el conocimiento de una aproximación ˜Pvol de Pvol, logra que RVWAP(A, Pvol) ≤ 2C(Pbins vol, ˜Pbins vol). Como ejemplo de este resultado, supongamos que nuestra aproximación cumple (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) para todo i, para algún α > 1. Por lo tanto, nuestras probabilidades estimadas de índice de contenedor están todas dentro de un factor de α de la verdad. Entonces es fácil demostrar que C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), por lo tanto, según los Teoremas 10 y 11, nuestra penalización por usar la distribución aproximada es un factor de α en la proporción competitiva. 5. REFERENCIAS [1] B. Awerbuch, Y. Bartal, A. Fiat y A. Rosén. Control de llamadas competitivo no preemptivo. En Proc. 5to Simposio ACM-SIAM sobre Algoritmos Discretos, páginas 312-320, 1994. [2] A. Borodin y R. El-Yaniv. Computación en línea y análisis competitivo. Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp y G. Turpin. Algoritmos óptimos de búsqueda y comercio en línea unidireccional. Algorithmica, 30:101-139, 2001. [4] M. Kearns y L. Ortiz. El proyecto de trading automatizado Penn-Lehman. IEEE Intelligent Systems, 2003. \n\nSistemas Inteligentes de IEEE, 2003. Aparecer. 6. APÉNDICE 6.1 Pruebas de la Subsección 2.3 Prueba. (Bosquejo del Teorema 3) Sin pérdida de generalidad, asumir que Q = 1 y el volumen total es V. Considera el tiempo t donde el horario fijo f vende menos, entonces ft ≤ N/T. Considera las secuencias donde en el tiempo t tenemos pt = pmax, vt = V, y para los tiempos t = t tenemos pt = pmin y vt = 0. El VWAP es pmax y el promedio de horario fijo es (N/T)pmax + (N − N/T)pmin. Prueba. (Bosquejo del Teorema 4) El algoritmo simplemente vende ut = (vt/Vmin)N acciones en el tiempo t. El número total de acciones vendidas U es claramente mayor que N y U = t ut = t (vt/Vmin)N = (V/Vmin)N ≤ QN El precio promedio es V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), donde usamos el hecho de que ut/U = vt/V. 197 Prueba. (del Teorema 5) Comenzamos con la prueba del límite inferior. Considera el siguiente escenario. Durante las primeras T unidades de tiempo tenemos un precio de √ Rpmin y un volumen total de Vmin. Observamos cuántas acciones ha comprado el algoritmo en línea. Si ha comprado más de la mitad de las acciones, los pasos de tiempo restantes tienen un precio pmin y un volumen de Vmax − Vmin. De lo contrario, los pasos de tiempo restantes tienen un precio pmax y un volumen insignificante. En el primer caso, el comprador en línea ha pagado al menos √ Rpmin /2 mientras que el VWAP es a lo sumo √ Rpmin /Q + pmin. Por lo tanto, en este caso la proporción competitiva es Ω(Q). En el segundo caso, el comprador en línea tiene que comprar al menos la mitad de las acciones a pmax, por lo que su costo promedio es al menos pmax/2. El VWAP del mercado es √ Rpmin = pmax / √ R, por lo tanto, la proporción competitiva es Ω( √ R). Para el límite superior, podemos obtener una proporción competitiva de √ R, comprando todas las acciones una vez que el precio caiga por debajo de √ Rpmin. El límite superior de Q se deriva ejecutando un algoritmo que asume que el volumen es Vmin. El comprador en línea paga un costo de p, mientras que el VWAP será al menos p/Q. 6.2 Pruebas de la Sección 4 Prueba. (Bosquejo del Teorema 10) Utilizamos la idea de adivinar el volumen total del Teorema 1, pero ahora permitimos la posibilidad de una distribución arbitraria (pero conocida) sobre el volumen total. En particular, considere construir una distribución Gbins vol sobre un conjunto de valores de volumen utilizando Pvol y úsela para estimar el volumen total V. Permita que el algoritmo adivine ˆV = Vmin 2i con probabilidad Gbins vol (i). Luego, observe que, para cualquier secuencia de precio-volumen S, si V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2. Esto implica un límite superior en RVWAP(A, Pvol) en términos de Gbins vol. Entonces obtenemos que Gbins vol (i) ∝ Pbins vol (i) minimiza el límite superior, lo que conduce al límite superior establecido en el teorema. Prueba. (Bosquejo del Teorema 11) Reemplace Pvol con ˜Pvol en la expresión de Gbins vol en el bosquejo de la prueba para el último resultado. 198 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "trade sequence": {
            "translated_key": "secuencia de intercambio",
            "is_in_text": false,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [],
            "translated_text": "",
            "candidates": [],
            "error": [
                []
            ]
        },
        "share": {
            "translated_key": "acción",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per <br>share</br> during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-<br>share</br> price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-<br>share</br> price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per <br>share</br> is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per <br>share</br>.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per <br>share</br> pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per <br>share</br> over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per <br>share</br> received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average <br>share</br> per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold <br>share</br> is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a <br>share</br> (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a <br>share</br> or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order <br>share</br> prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last <br>share</br> in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one <br>share</br>.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order <br>share</br> was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order <br>share</br> leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a <br>share</br> from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a <br>share</br> from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order <br>share</br> was not executed, then the claim is trivially true.",
                "Else, if the sell order <br>share</br> was executed, then claim is true because by removing this executed <br>share</br> from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one <br>share</br> at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one <br>share</br> at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one <br>share</br>) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per <br>share</br> during that period, so the price of each transaction in the market is weighted by its volume.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-<br>share</br> price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-<br>share</br> price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per <br>share</br> is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per <br>share</br>.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per <br>share</br> pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval."
            ],
            "translated_annotated_samples": [
                "Informalmente, el VWAP de una <br>acción</br> durante un período de mercado especificado es simplemente el precio promedio pagado por <br>acción</br> durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen.",
                "La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un <br>precio por acción</br> vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un <br>precio por acción</br> del VWAP de los próximos meses menos 1 centavo.",
                "La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por <br>acción</br> en ganancias.",
                "Si pueden superar el VWAP por un centavo, ganan dos centavos por <br>acción</br>.",
                "El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por <br>acción</br> pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP. Informalmente, el VWAP de una <br>acción</br> durante un período de mercado especificado es simplemente el precio promedio pagado por <br>acción</br> durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un <br>precio por acción</br> vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un <br>precio por acción</br> del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por <br>acción</br> en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por <br>acción</br>. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por <br>acción</br> pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. ",
            "candidates": [],
            "error": [
                [
                    "acción",
                    "acción",
                    "precio por acción",
                    "precio por acción",
                    "acción",
                    "acción",
                    "acción"
                ]
            ]
        },
        "market order": {
            "translated_key": "orden de mercado",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a <br>market order</br>.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a <br>market order</br> arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a <br>market order</br> to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a <br>market order</br>.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a <br>market order</br>.",
                "First, any time a <br>market order</br> arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a <br>market order</br> to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a <br>market order</br>."
            ],
            "translated_annotated_samples": [
                "Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la negociación de acciones es entre una orden limitada y una <br>orden de mercado</br>.",
                "Primero, cada vez que llega una <br>orden de mercado</br>, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto.",
                "Por lo tanto, una <br>orden de mercado</br> para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones.",
                "Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una <br>orden de mercado</br>."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP. Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por acción. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading. Más precisamente, en este modelo en línea, observamos la secuencia de precio-volumen de a pares. Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt. Supongamos que nuestro objetivo es vender N acciones a lo largo del día. Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT. De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante. Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas. Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema). En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios. En el trading de VWAP, el objetivo de un algoritmo en línea A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado. El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt. Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N. Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo. El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo. Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales. Es fácil ver que esto lo convierte en un criterio más desafiante de seguir. A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado. En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes. En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día. Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques. Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S). Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio. Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto. Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin. Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones. Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1. En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo. En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo. Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP. Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)). Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios. Teorema 1. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q). Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier algoritmo en línea A para vender N acciones tiene RVWAP(A) = Ω(log(Q)). Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1]. Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día. Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones. Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1. Claramente, uno de los Ai tiene una proporción competitiva de 2. Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada). Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT. Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2. Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP. Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ). Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo. Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1. Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0. Suponga que el precio máximo en S es pmax. El VWAP de nuestra secuencia es al menos pmax /3. Dado que teníamos un algoritmo c competitivo, su venta promedio es al menos pmax /3c. El límite inferior ahora se sigue utilizando el límite inferior en [3]. Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT. Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191. En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)). Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)). Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT. Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo. Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R). Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen. Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt). Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario. Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso. Teorema 3. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)). Las pruebas de todos los resultados de esta subsección están en el Apéndice. Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones. En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender. Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución. El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo. Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1. Teorema 4. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S). En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2]. En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo. Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente. Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema. Teorema 5. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un algoritmo en línea A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}). Además, cualquier algoritmo en línea A para comprar N acciones tiene una proporción competitiva de compra VWAP Rbuy VWAP(A) = Ω(min{Q, √ R}). 3. Un modelo de trading de libro de órdenes limitadas. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado. Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la negociación de acciones es entre una orden limitada y una <br>orden de mercado</br>. Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT). En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado. Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 2, que muestra una captura de pantalla real de un libro de órdenes reciente de MSFT en Island (www.island.com), un conocido intercambio electrónico de acciones de NASDAQ), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos. Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta). Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (siendo las órdenes más antiguas las primeras en el libro). En el ejemplo proporcionado por la Figura 2, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra. De manera similar, se mantiene un libro de órdenes de venta para órdenes de límite de venta (por ejemplo, podríamos querer vender 500 acciones de MSFT a $24.10 o más) esta vez con el precio de venta más bajo ofrecido (a menudo denominado como el precio de venta). Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas. Los precios de oferta y demanda (que nuevamente, son simplemente los precios en las órdenes límite en la parte superior de los libros de compra y venta, respectivamente) a veces se denominan como el mercado interno, y la diferencia entre ellos como el spread. Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección. ¿Entonces, cómo se ejecutan las órdenes? Hay dos métodos. Primero, cada vez que llega una <br>orden de mercado</br>, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto. Por lo tanto, una <br>orden de mercado</br> para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones. Por ejemplo, en el ejemplo de la Figura 2, tal orden sería completada por las dos órdenes de venta límite de 500 acciones a $24.069, las 500 acciones a $24.07, las 200 acciones a $24.08, y luego 300 de las 1981 acciones a $24.09. Las 1681 acciones restantes de esta última orden límite permanecerían como el nuevo tope del libro de órdenes de venta límite. Segundo, si una orden de límite de compra (venta, respectivamente) entra por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con órdenes en los libros opuestos. Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato. Cada orden de mercado o límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que las órdenes llegan, y dos órdenes nunca pueden llegar simultáneamente. Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden. Es esta cantidad la que generalmente se quiere decir cuando la gente se refiere casualmente al precio de una acción (ticker). Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una <br>orden de mercado</br>. Por lo tanto, asumiremos sin pérdida de generalidad que todas las órdenes se colocan como órdenes límite. Aunque las órdenes límite que no se ejecutan pueden ser eliminadas por la parte que las colocó, para simplificar, asumimos que las órdenes límite nunca son eliminadas de los libros. Remitimos al lector a [4] para obtener más información sobre los intercambios electrónicos modernos y la microestructura del mercado. 3.2 El Modelo El modelo de negociación de libros de órdenes en línea tiene como objetivo capturar los detalles realistas de la microestructura del mercado recién discutidos en un entorno de relación competitiva. En este modelo refinado, la actividad del mercado de un día se describe por una secuencia de órdenes límite (pt, vt, bt). Aquí bt es un bit que indica si la orden es de compra o venta, mientras que pt es el precio de la orden límite y vt es el número de acciones deseado. Tras la llegada de cada orden límite de este tipo, se permite a un algoritmo de trading en línea colocar su propia orden límite. Estas dos fuentes entrelazadas (mercado y algoritmo) de órdenes límite son simplemente operadas de acuerdo con el proceso de emparejamiento descrito en la Sección 3.1. Cualquier orden límite que no sea ejecutable de inmediato según este proceso se coloca en el libro correspondiente (compra o venta) para una posible ejecución futura; las órdenes que llegan y pueden ser ejecutadas parcial o totalmente se ejecutan de esa manera, con cualquier acción residual que permanezca en el libro respectivo. El objetivo de un algoritmo de venta VWAP u OWT es esencialmente el mismo que en el modelo de precio-volumen, pero el contexto ha cambiado en las siguientes dos formas fundamentales. Primero, la suposición de liquidez infinita en el modelo de precio-volumen se elimina por completo. El número de acciones disponibles a cualquier precio dado está restringido al volumen total de órdenes límite que ofrecen ese precio. Segundo, se asume que todas las órdenes entrantes, y por lo tanto los libros completos de órdenes límite, son visibles para el algoritmo. Esto es coherente con los intercambios financieros electrónicos modernos, y de hecho es la fuente de mucho interés actual en Wall Street [4]. En general, la definición de las ratios competitivas en el modelo de libro de órdenes se complica por el hecho de que ahora nuestra actividad algorítmica influye en la secuencia de precios y volúmenes ejecutados. Por lo tanto, primero definimos la secuencia de ejecución determinada por una secuencia de órdenes límite (colocadas por el mercado y nuestro algoritmo). Sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por el mercado, y sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por nuestro algoritmo (a menos que se especifique lo contrario, todos los bt son de tipo venta). Sea merge(S, S) la secuencia fusionada (p1, v1, b1), (p1, v1, b1), . . . , (pT, vT, bT), (pT, vT, bT), que es la secuencia temporal de órdenes realizadas por el mercado y el algoritmo. Ten en cuenta que el algoritmo tiene la opción de no realizar un pedido, lo cual podemos considerar como un pedido de volumen cero. Si llevamos a cabo el mantenimiento del libro de órdenes y el proceso de ejecución de órdenes descrito en la Sección 3.1 en la fusión de secuencias (S, S), en intervalos irregulares se produce una operación de compra/venta de un cierto número de acciones a un determinado precio. En cada operación ejecutada, la parte vendedora es o bien el mercado o el algoritmo. Sea execM (S, S ) = (q1, w1), . . . , (qT , wT ) la secuencia de ejecuciones donde el mercado (es decir, una parte distinta al algoritmo) fue la parte vendedora, donde los qt son los precios de ejecución y wt los volúmenes de ejecución. De manera similar, definimos execA(S, S) = (r1, x1), . . . , (rT, xT) como la secuencia de ejecuciones en las que el algoritmo fue la parte vendedora. Por lo tanto, execA(S, S) ∪ execM(S, S) es el conjunto de todas las ejecuciones. Generalmente esperamos que T sea (posiblemente mucho) más pequeño que T. Los ingresos del algoritmo y del mercado se definen como: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt. Nótese que ambas cantidades están determinadas únicamente por las secuencias de ejecución execM (S, S ) y execA(S, S ), respectivamente. Para un algoritmo A que está limitado a vender exactamente N acciones, definimos la razón de competencia OWT de A, ROWT(A), como la razón máxima (bajo cualquier S ∈ Σ) de los ingresos obtenidos por A, en comparación con los ingresos obtenidos por un algoritmo óptimo fuera de línea A∗. De manera más formal, para A∗ que está limitado a vender exactamente N acciones, definimos ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) donde S∗ es la secuencia de órdenes límite colocadas por A∗ en S. Si el algoritmo A es aleatorio, entonces tomamos la expectativa apropiada con respecto a S ∼ A. Definimos la ratio competitiva VWAP, RVWAP(A), como la ratio máxima (bajo cualquier S ∈ Σ) entre los VWAPs del mercado y del algoritmo. Más formalmente, define VWAPM (S, S ) como REVM (S, S )/ T t=1 wt, donde el denominador es simplemente el volumen total ejecutado de órdenes colocadas por el mercado. De manera similar, definimos VWAPA(S, S) como REVA(S, S)/N, ya que asumimos que el algoritmo vende no más de N acciones (esta definición asume implícitamente que A obtiene un precio de 0 por las acciones no vendidas). El ratio competitivo VWAP de A es entonces: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} donde S es la secuencia en línea de órdenes límite generadas por A en respuesta a la secuencia S. 3.3 Resultados de OWT en el Modelo de Libro de Órdenes. Para el problema de OWT en el modelo de libro de órdenes, introducimos una versión más sutil de la suposición de variabilidad de precios. Esto se debe al hecho de que nuestro trading algorítmico puede afectar los precios altos y bajos del día. Para la suposición a continuación, tenga en cuenta que execM (S, ∅) es la secuencia de ejecuciones sin la interacción de nuestro algoritmo. 3.3.0.3 Suposición de Variabilidad del Precio del Libro de Órdenes. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios pt en la secuencia execM (S, ∅) cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Tenga en cuenta que esta suposición no implica que las ratios de precios altos a bajos bajo las secuencias execM (S, S ) o execA(S, S ) estén limitadas por R. De hecho, la ratio en la secuencia execA(S, S ) podría ser infinita si el algoritmo termina vendiendo algunas acciones a un precio de 0. Teorema 6. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de venta OWT ROWT(A) = 2 log(R) log(N). Prueba. El algoritmo A funciona al adivinar un precio p en el conjunto {pmin2i : 1 ≤ i ≤ log(R)} y colocar una orden de venta límite por todas las N acciones al precio p al comienzo del día. (Alternativamente, el algoritmo A puede colocar log(R) órdenes de venta límite, donde la i-ésima tiene un precio de 2i pmin y un volumen de N/ log(R).) Al realizar un pedido al comienzo del día, el algoritmo ofrece un precio más bajo que todos los pedidos de venta que se realizarán durante el día por un precio de p o superior, lo que significa que primero se deben completar las N acciones del algoritmo a este precio. Por lo tanto, si hubiera habido k acciones que se hubieran vendido a un precio p o superior sin nuestra actividad, entonces A vendería al menos kp acciones. Definimos {pj} como el multiconjunto de precios de acciones individuales que han sido ejecutadas o son acciones de órdenes de compra límite que permanecieron sin ejecutar, excluyendo la actividad de nuestro algoritmo (es decir, asumiendo que nuestro algoritmo no coloca órdenes). Suponga sin pérdida de generalidad que p1 ≥ p2 ≥ . . .. Considerar adivinar el k-ésimo precio más alto, pk. Si se coloca una orden de N acciones al comienzo del día a un precio pk, entonces estamos garantizados de obtener un retorno de kpk. Que k∗ = argmaxk{kpk}. Podemos ver nuestro algoritmo como intentando adivinar pk∗, y teniendo éxito si la suposición p satisface p ∈ [pk∗ /2, pk∗]. Por lo tanto, somos 2 log(R) competitivos con la cantidad max1≤k≤N kpk. Se debe tener en cuenta que ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk donde ρ se define como la suma de los N precios principales pi sin la participación de A. De manera similar, sea {pj} el multiconjunto de precios de las acciones individuales ejecutadas, o los precios de las acciones de órdenes de compra no ejecutadas, pero ahora incluyendo las órdenes realizadas por algún algoritmo de venta A. Ahora deseamos demostrar que para todos los algoritmos A que venden N acciones, REVA ≤ N i=1 pi ≤ ρ. Esencialmente, esta desigualdad establece la idea intuitiva de que un algoritmo de venta solo puede reducir los precios de las órdenes de compra ejecutadas o no coincidentes. Para demostrar esto, utilizamos la inducción para mostrar que la eliminación de la actividad de un algoritmo de venta hace que estos precios aumenten. Primero, elimine la última acción en la última orden de venta realizada por A o el mercado en una fusión de secuencia arbitraria merge(S, S) - con esto queremos decir, tome la última orden de venta realizada por A o el mercado y disminuya su volumen en una acción. Después de esta modificación, los N precios más altos p1 . . . pN no disminuirán. Esto se debe a que o bien esta orden de venta no se ejecutó, en cuyo caso la afirmación es trivialmente verdadera, o, si se ejecutó, la eliminación de esta orden de venta deja una orden de compra adicional no ejecutada de igual o mayor precio. Para la inducción, asumimos que si eliminamos una participación de cualquier orden de venta que se haya colocado, ya sea por A o por el mercado, en o después del tiempo t, entonces los N precios principales no disminuyen. Ahora demostramos que si eliminamos una participación de la última orden de venta que fue colocada por A o el mercado antes del tiempo t, entonces los N precios principales no disminuyen. Si esta orden de venta de acciones no se ejecutó, entonces la afirmación es trivialmente verdadera. De lo contrario, si la orden de venta se ejecutó, entonces la afirmación es verdadera porque al eliminar esta acción ejecutada de la orden de venta, o bien: i) la acción correspondiente de la orden de compra (de igual o mayor valor) no se empareja en el resto de la secuencia, en cuyo caso la afirmación es verdadera; o ii) esta orden de compra se empareja con alguna acción de una orden de venta a un precio igual o mayor, lo que tiene el efecto de eliminar una acción de una orden de venta en el resto de la secuencia y, por la suposición inductiva, esto solo puede aumentar los precios. Por lo tanto, hemos demostrado que para todos los A que venden N acciones, REVA ≤ ρ. Ahora hemos establecido que nuestra ganancia satisface 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), donde A realiza una secuencia arbitraria de N órdenes de venta límite. 3.4 Resultados de VWAP en el Modelo del Libro de Órdenes El algoritmo OWT del Teorema 6 se puede aplicar para obtener el siguiente resultado de VWAP: Corolario 7. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de VWAP de venta RVWAP(A) = O(log(R) log(N)). Ahora hacemos una suposición bastante diferente sobre las secuencias S. 3.4.0.4 Volumen de Orden Acotado y Suposición de Precio Máximo. El conjunto de secuencias Σ satisface las siguientes dos propiedades. Primero, asumimos que cada orden colocada en el mercado tiene un volumen menor que γ, lo cual consideramos como una suposición leve ya que típicamente las órdenes individuales en el mercado no tienen un alto volumen (debido a problemas de liquidez). Esta suposición permite que nuestro algoritmo coloque al menos una orden límite a la vez intercalada con aproximadamente γ ejecuciones de mercado. Segundo, asumimos que hay un gran volumen en los libros de órdenes de venta por debajo del precio pmax, lo que significa que ninguna orden colocada por el mercado se ejecutará por encima del precio pmax. La forma más sencilla de instanciar esta última suposición en el modelo de libro de órdenes es asumir que cada secuencia S ∈ Σ comienza colocando un gran número de órdenes de venta (más de Vmax) a un precio pmax. Aunque esta suposición tiene un parámetro de precio máximo, no implica que la proporción de precios R sea finita, ya que no implica ningún límite inferior en los precios de compra o de las acciones ejecutadas (aparte del trivial de 0). Teorema 8. Considera el modelo de libro de órdenes bajo la suposición de volumen de orden limitado y precio máximo. Existe un algoritmo A en el cual después de exactamente γN ejecuciones de mercado, entonces A ha vendido como máximo N acciones y REVA(S, S) ≤ N = VWAPA(S, S) ≥ (1 − ε)VWAPM(S, S) − pmax N donde S es una secuencia de N órdenes de venta límite generadas por A al observar S. Demostración. El algoritmo divide el día de negociación en intervalos de volumen cuya duración en tiempo real puede variar. Para cada período i en el que se hayan ejecutado acciones γ en el mercado, el algoritmo calcula el VWAP de mercado solo de aquellas acciones negociadas en el período i; denotémoslo como VWAPi. Tras este intervalo de volumen i-ésimo, el algoritmo coloca una orden límite para vender exactamente una acción a un precio cercano al VWAPi. Más precisamente, el algoritmo solo coloca órdenes a los precios discretos (1− )pmax , (1− )2 pmax , . . .. Tras el intervalo de volumen i, el algoritmo coloca una orden límite para vender una acción al precio discretizado que esté más cercano al VWAPi, pero que sea estrictamente menor. Para el análisis, comenzamos observando que si todas las órdenes límite de los algoritmos se ejecutan durante el día, los ingresos totales recibidos por el algoritmo serían al menos (1 − )VWAPM (S, S )N. Para ver esto, basta con notar que VWAPM (S, S ) es una mezcla uniforme de los VWAPi (ya que por definición cubren la misma cantidad de volumen de mercado); y si todas las órdenes límite de los algoritmos se ejecutaran, cada uno recibiría más de (1 − )VWAPi dólares por el intervalo i que siguieron. Ahora contamos el potencial de ingresos perdidos del algoritmo debido a órdenes límite no ejecutadas. Por la suposición de que los pedidos individuales se realizan con un volumen menor que γ, entonces nuestro algoritmo es capaz de colocar una orden límite durante cada bloque de γ acciones que se han negociado. Por lo tanto, después de que se hayan ejecutado γN órdenes de mercado, A ha colocado N órdenes en el mercado. Ten en cuenta que puede haber como máximo una orden límite (y por lo tanto, como máximo una acción) sin ejecutar en cada nivel de la escalera de precios discretizada definida anteriormente. Esto se debe a que después del intervalo i, el algoritmo coloca su orden límite estrictamente por debajo de VWAPi, por lo que si VWAPj ≥ VWAPi para j > i, esta orden límite debe haber sido ejecutada. Por lo tanto, las órdenes límite no ejecutadas limitaron los VWAPs del resto del día, resultando en un máximo de una orden no ejecutada por nivel de precio. Un límite en la pérdida de ingresos es, por lo tanto, la suma de los precios discretizados: ∞ i=1(1 − )i pmax ≤ pmax / . Claramente nuestro algoritmo ha vendido como máximo N acciones. Ten en cuenta que a medida que N se vuelve grande, VWAPA se acerca a 1 menos el VWAP del mercado. Si supiéramos que el volumen total final de las ejecuciones del mercado es V, entonces podríamos establecer γ = V/N, asumiendo que γ >> 1. Si solo tenemos un límite superior e inferior en V, deberíamos poder adivinar y incurrir en una pérdida logarítmica. La siguiente suposición intenta capturar la variabilidad del volumen del mercado. Suposición de Variabilidad del Volumen del Libro de Órdenes 3.4.0.5. Ahora asumimos que el volumen total (que incluye las operaciones ejecutadas tanto por nuestro algoritmo como por el mercado) es variable dentro de una región conocida y que el volumen del mercado será mayor que el volumen de nuestros algoritmos. De manera más formal, para todo S ∈ Σ, asumir que el volumen total V de acciones negociadas en execM (S, S), para cualquier secuencia S de N órdenes de venta límite, satisface 2N ≤ Vmin ≤ V ≤ Vmax. Que Q = Vmax / Vmin. El siguiente corolario se deriva utilizando una constante = 1/2 y observando que si establecemos γ de manera que V ≤ γN ≤ 2V entonces nuestro algoritmo colocará entre N y N/2 órdenes límite. Corolario 9. En el modelo de libro de órdenes, si se cumplen la suposición de volumen de orden acotado y precio máximo, y la suposición de variabilidad del volumen del libro de órdenes, existe un algoritmo en línea A para vender como máximo N acciones tal que VWAPA(S, S) ≥ 1 4 log(Q) VWAPM(S, S) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figura 3: Aquí presentamos límites de la Sección 4 basados en las distribuciones de volumen empíricas para cuatro acciones reales: QQQ, MCHP, JNPR y CHKP. Los gráficos muestran histogramas de los volúmenes totales diarios transados en Island para estas acciones, en el último año y medio, junto con los valores correspondientes de log(Q) y E(Pbins vol) (denotado por E). Suponemos que los volúmenes diarios mínimo y máximo en los datos corresponden a Vmin y Vmax, respectivamente. Los límites de la razón competitiva en el peor de los casos (que son dos veces el logaritmo de Q) de nuestro algoritmo para esas acciones son 9.42, 10.56, 11.32 y 13.20, respectivamente. Los límites correspondientes sobre el rendimiento de la proporción competitiva de nuestro algoritmo bajo el modelo de distribución de volumen (que son el doble de E(Pbins vol )) son mejores: 7.54, 7.72, 7.94 y 9.00, respectivamente (una mejora relativa del 20-40%). Usando una partición de volumen más fina junto con un límite ligeramente más refinado en la relación competitiva, podemos construir algoritmos que, utilizando la distribución de volumen empírica dada como correcta, garantizan relaciones competitivas aún mejores de 2.76, 2.73, 2.75 y 3.17, respectivamente para esas acciones (detalles omitidos). MODELOS DE DISTRIBUCIÓN MACROSCÓPICA Concluimos nuestros resultados con un regreso al modelo de precio-volumen, donde introduciremos algunos métodos refinados de análisis para algoritmos de trading en línea. Dejamos la generalización de estos métodos al modelo de libro de órdenes para trabajos futuros. Los ratios de competitividad definidos hasta ahora miden el rendimiento en relación con algún criterio de referencia en el peor caso sobre todas las secuencias de mercado S ∈ Σ. Se ha observado en muchos entornos en línea que tales métricas de peor caso pueden arrojar resultados pesimistas, y se han considerado varias relajaciones, como permitir una distribución de probabilidad sobre la secuencia de entrada. Ahora consideramos modelos de distribución que son considerablemente más débiles que asumir una distribución sobre secuencias de mercado completas S ∈ Σ. En el modelo de distribución de volumen, asumimos únicamente que existe una distribución Pvol sobre el volumen total V negociado en el mercado durante el día, y luego examinamos la peor relación competitiva en secuencias consistentes con el volumen elegido al azar. Más precisamente, definimos RVWAP(A, Pvol) = EV ∼Pvol max S∈seq(V) VWAPM(S) VWAPA(S). Aquí V ∼ Pvol denota que V es elegido con respecto a la distribución Pvol, y seq(V) ⊂ Σ es el conjunto de todas las secuencias de mercado (p1, v1), . . . , (pT, vT) que satisfacen T t=1 vt = V. De manera similar, para OWT, podemos definir ROWT(A, Pmaxprice) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S). Aquí Pmaxprice es una distribución solo sobre el precio máximo del día, y luego examinamos secuencias de peor caso consistentes con este precio (seq(p) ⊂ Σ es el conjunto de todas las secuencias de mercado que satisfacen max1≤t≤T pt = p). Se pueden proporcionar definiciones análogas del lado de compra. Enfatizamos que en estos modelos, solo la distribución del volumen máximo y el precio es conocida por el algoritmo. También observamos que nuestras suposiciones probabilísticas sobre S son considerablemente más débiles que los modelos típicos de finanzas estadísticas, los cuales postularían un modelo estocástico detallado para la evolución paso a paso de (pt, vt). Aquí permitimos únicamente una distribución sobre medidas crudas y macroscópicas de la actividad del mercado durante todo el día, como el volumen total y el precio máximo, y analizamos el rendimiento en el peor de los casos coherente con estas medidas crudas. Por esta razón, nos referimos a tales configuraciones como el modelo de distribución macroscópica. El trabajo de El-Yaniv et al. [3] examina supuestos de distribución similares a los nuestros, pero también enfatizan las elecciones de peor caso para las distribuciones, y muestran que esto conduce a resultados no mejores que el análisis de peor caso original sobre todas las secuencias. Por el contrario, consideramos que el análisis de las distribuciones específicas Pvol y Pmaxprice es natural en muchos contextos financieros y nuestros resultados experimentales preliminares muestran mejoras significativas cuando se tiene en cuenta esta información distribucional bastante rudimentaria (ver Figura 3). Nuestros resultados en el contexto de VWAP examinan los casos en los que estas distribuciones son conocidas exactamente o solo aproximadamente. Resultados similares pueden obtenerse para distribuciones macroscópicas del precio máximo diario en el escenario de negociación unidireccional. 4.1 Resultados en el Modelo de Distribución Macroscópica Comenzamos señalando que los algoritmos examinados hasta ahora funcionan dividiendo los volúmenes totales o los precios máximos en contenedores de tamaño exponencialmente creciente, y luego adivinando el índice del contenedor en el que cae la cantidad real. Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en análisis competitivos) pueda depender de la distribución del índice de contenedor real. En lo que resta, asumimos que Q es una potencia de 2 y la base del logaritmo es 2. Que Pvol denote la distribución del volumen total diario del mercado. Definimos la distribución relacionada Pbins vol sobre los índices de los contenedores i de la siguiente manera: para todo i = 1, . . . , log(Q) − 1, Pbins vol (i) es igual a la probabilidad, bajo Pvol, de que el volumen diario caiga en el intervalo [Vmin 2i−1 , Vmin 2i ), y Pbins vol (log(Q)) es para el último intervalo [Vmax /2, Vmax]. Definimos E como E(Pbins vol) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2. Dado que el soporte de Pbins vol tiene solo log(Q) elementos, E(Pbins vol ) puede variar desde 1 (para distribuciones Pvol que colocan todo su peso en solo uno de los log(Q) intervalos entre Vmin , Vmin 2, Vmin 4, . . . , Vmax ) hasta log(Q) (para distribuciones Pvol en las que el volumen diario total tiene igual probabilidad de caer en cualquiera de estos intervalos). Ten en cuenta que las distribuciones Pvol de este último tipo están lejos de ser uniformes en todo el rango [Vmin, Vmax]. Teorema 10. En el modelo de distribución de volumen bajo el supuesto de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando únicamente el conocimiento de la distribución total de volumen Pvol, logra RVWAP(A, Pvol) ≤ 2E(Pbins vol). Todas las pruebas en esta sección se proporcionan en el apéndice. Como ejemplo concreto, considera el caso en el que Pvol es la distribución uniforme sobre [Vmin, Vmax]. En ese caso, el volumen de Pbins está aumentando de forma exponencial y alcanza su punto máximo en el último bin, que, al tener el ancho más grande, también tiene el mayor peso. En este caso, E(Pbins vol) es una constante (es decir, independiente de Q), lo que conduce a una proporción competitiva constante. Por otro lado, si Pvol es exponencial, entonces Pbins vol es uniforme, lo que conduce a una proporción competitiva de O(log(Q)), al igual que en el entorno de precio-volumen más adversarial discutido anteriormente. En la Figura 3, proporcionamos límites específicos adicionales obtenidos para distribuciones empíricas de volumen diario total calculadas para algunas acciones reales. Ahora examinamos el escenario en el que Pvol es desconocido, pero se dispone de una aproximación ˜Pvol. Definamos C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) . C se minimiza en C(Pbins vol , Pbins vol ) = E(Pbins vol ), y C puede ser infinito si ˜Pbins vol (i) es 0 cuando Pbins vol (i) > 0. Teorema 11. En el modelo de distribución de volumen bajo la suposición de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando solo el conocimiento de una aproximación ˜Pvol de Pvol, logra que RVWAP(A, Pvol) ≤ 2C(Pbins vol, ˜Pbins vol). Como ejemplo de este resultado, supongamos que nuestra aproximación cumple (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) para todo i, para algún α > 1. Por lo tanto, nuestras probabilidades estimadas de índice de contenedor están todas dentro de un factor de α de la verdad. Entonces es fácil demostrar que C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), por lo tanto, según los Teoremas 10 y 11, nuestra penalización por usar la distribución aproximada es un factor de α en la proporción competitiva. 5. REFERENCIAS [1] B. Awerbuch, Y. Bartal, A. Fiat y A. Rosén. Control de llamadas competitivo no preemptivo. En Proc. 5to Simposio ACM-SIAM sobre Algoritmos Discretos, páginas 312-320, 1994. [2] A. Borodin y R. El-Yaniv. Computación en línea y análisis competitivo. Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp y G. Turpin. Algoritmos óptimos de búsqueda y comercio en línea unidireccional. Algorithmica, 30:101-139, 2001. [4] M. Kearns y L. Ortiz. El proyecto de trading automatizado Penn-Lehman. IEEE Intelligent Systems, 2003. \n\nSistemas Inteligentes de IEEE, 2003. Aparecer. 6. APÉNDICE 6.1 Pruebas de la Subsección 2.3 Prueba. (Bosquejo del Teorema 3) Sin pérdida de generalidad, asumir que Q = 1 y el volumen total es V. Considera el tiempo t donde el horario fijo f vende menos, entonces ft ≤ N/T. Considera las secuencias donde en el tiempo t tenemos pt = pmax, vt = V, y para los tiempos t = t tenemos pt = pmin y vt = 0. El VWAP es pmax y el promedio de horario fijo es (N/T)pmax + (N − N/T)pmin. Prueba. (Bosquejo del Teorema 4) El algoritmo simplemente vende ut = (vt/Vmin)N acciones en el tiempo t. El número total de acciones vendidas U es claramente mayor que N y U = t ut = t (vt/Vmin)N = (V/Vmin)N ≤ QN El precio promedio es V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), donde usamos el hecho de que ut/U = vt/V. 197 Prueba. (del Teorema 5) Comenzamos con la prueba del límite inferior. Considera el siguiente escenario. Durante las primeras T unidades de tiempo tenemos un precio de √ Rpmin y un volumen total de Vmin. Observamos cuántas acciones ha comprado el algoritmo en línea. Si ha comprado más de la mitad de las acciones, los pasos de tiempo restantes tienen un precio pmin y un volumen de Vmax − Vmin. De lo contrario, los pasos de tiempo restantes tienen un precio pmax y un volumen insignificante. En el primer caso, el comprador en línea ha pagado al menos √ Rpmin /2 mientras que el VWAP es a lo sumo √ Rpmin /Q + pmin. Por lo tanto, en este caso la proporción competitiva es Ω(Q). En el segundo caso, el comprador en línea tiene que comprar al menos la mitad de las acciones a pmax, por lo que su costo promedio es al menos pmax/2. El VWAP del mercado es √ Rpmin = pmax / √ R, por lo tanto, la proporción competitiva es Ω( √ R). Para el límite superior, podemos obtener una proporción competitiva de √ R, comprando todas las acciones una vez que el precio caiga por debajo de √ Rpmin. El límite superior de Q se deriva ejecutando un algoritmo que asume que el volumen es Vmin. El comprador en línea paga un costo de p, mientras que el VWAP será al menos p/Q. 6.2 Pruebas de la Sección 4 Prueba. (Bosquejo del Teorema 10) Utilizamos la idea de adivinar el volumen total del Teorema 1, pero ahora permitimos la posibilidad de una distribución arbitraria (pero conocida) sobre el volumen total. En particular, considere construir una distribución Gbins vol sobre un conjunto de valores de volumen utilizando Pvol y úsela para estimar el volumen total V. Permita que el algoritmo adivine ˆV = Vmin 2i con probabilidad Gbins vol (i). Luego, observe que, para cualquier secuencia de precio-volumen S, si V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2. Esto implica un límite superior en RVWAP(A, Pvol) en términos de Gbins vol. Entonces obtenemos que Gbins vol (i) ∝ Pbins vol (i) minimiza el límite superior, lo que conduce al límite superior establecido en el teorema. Prueba. (Bosquejo del Teorema 11) Reemplace Pvol con ˜Pvol en la expresión de Gbins vol en el bosquejo de la prueba para el último resultado. 198 ",
            "candidates": [],
            "error": [
                [
                    ""
                ]
            ]
        },
        "online trade": {
            "translated_key": "comercio en línea",
            "is_in_text": false,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [],
            "translated_text": "",
            "candidates": [],
            "error": [
                []
            ]
        },
        "competitive analysis": {
            "translated_key": "análisis competitivos",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for VWAP and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or VWAP, trading.",
                "Informally, the VWAP of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In VWAP trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the VWAP.",
                "Very large institutional trades constitute one of the main motivations behind VWAP activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the VWAP over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months VWAP minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the VWAP, a penny per share is earned in profits.",
                "If they can beat the VWAP by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the VWAP has led to many automated VWAP trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or VWAP criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the VWAP criterion.",
                "However, in the VWAP setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary VWAP trading technology.",
                "In this paper, we provide the first study of VWAP trading algorithms in an online, competitive ratio setting.",
                "We first formalize the VWAP trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide VWAP algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the VWAP trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and VWAP trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In VWAP trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market VWAP.",
                "The market VWAP for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the VWAP of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market VWAP does not include the shares that the algorithm sells.",
                "The VWAP competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the VWAP, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both VWAP and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In VWAP trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 VWAP Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the VWAP criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for VWAP under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) VWAP competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the VWAP and OWT problems.",
                "Any algorithm that is c-competitive in the VWAP setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the VWAP problem.",
                "The prices in the VWAP sequence are the same as in S. To construct the volumes in the VWAP sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the VWAP sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The VWAP of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to VWAP is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic VWAP competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the VWAP is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the VWAP algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule VWAP algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule VWAP algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule VWAP algorithm A for selling N shares has sell VWAP competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on VWAP algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate VWAP trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a VWAP competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the VWAP setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy VWAP(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy VWAP competitive ratio Rbuy VWAP(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy VWAP competitive ratio Rbuy VWAP(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and VWAP problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a VWAP or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the VWAP competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The VWAP competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 VWAP Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following VWAP result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell VWAP competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market VWAP of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market VWAP.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the VWAP setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in <br>competitive analysis</br>) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and <br>competitive analysis</br>.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The VWAP is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the VWAP is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market VWAP is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the VWAP will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in <br>competitive analysis</br>) might depend on the distribution of the true bin index.",
                "Online Computation and <br>competitive analysis</br>."
            ],
            "translated_annotated_samples": [
                "Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en <br>análisis competitivos</br>) pueda depender de la distribución del índice de contenedor real.",
                "Computación en línea y <br>análisis competitivo</br>."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de Precio Promedio Ponderado por Volumen y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de Precio Promedio Ponderado por Volumen, o VWAP. Informalmente, el VWAP de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de VWAP, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el VWAP. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de VWAP. Un escenario típico se desarrolla de la siguiente manera. Supongamos que un fondo mutuo muy grande posee el 3% de las acciones en circulación de una gran empresa de capital abierto, una fracción enorme de las acciones, y que el gestor de este fondo decide que le gustaría reducir esta participación al 2% en un período de 1 mes. (Tal decisión podría ser forzada por las regulaciones propias del fondo u otras consideraciones). Normalmente, un gestor de fondos estaría descalificado para vender una cantidad tan grande de acciones en el mercado abierto, ya que se requiere un corredor profesional para dividir inteligentemente la operación a lo largo del tiempo, posiblemente en múltiples bolsas, con el fin de minimizar el impacto en el mercado de una transacción tan considerable. Por lo tanto, el gestor del fondo se acercaría a las corredurías para pedir ayuda en la venta del 1%. La correduría generalmente resolverá el problema del gestor del fondo de inmediato simplemente comprando las acciones directamente al gestor del fondo, y luego vendiéndolas más tarde, pero ¿a qué precio debería la correduría pagar al gestor del fondo? Pagar el precio el día de la venta es demasiado arriesgado para la correduría, ya que necesitan vender las acciones ellos mismos durante un período prolongado, y eventos fuera de su control (como guerras) podrían hacer que el precio caiga drásticamente. La respuesta habitual es que la correduría ofrece comprar las acciones al gestor de fondos a un precio por acción vinculado al VWAP durante algún período futuro; en nuestro ejemplo, la correduría podría ofrecer comprar el 1% a un precio por acción del VWAP de los próximos meses menos 1 centavo. La correduría ahora tiene un desafío muy claro: al vender las acciones ellas mismas durante el próximo mes de una manera que coincida exactamente con el VWAP, se obtiene un centavo por acción en ganancias. Si pueden superar el VWAP por un centavo, ganan dos centavos por acción. Tales márgenes pequeños y altos volúmenes de ganancias pueden ser extremadamente lucrativos para una gran correduría. La importancia del VWAP ha llevado a muchos algoritmos de trading automatizado de VWAP: de hecho, cada correduría importante tiene al menos una caja VWAP, 189 Modelo de Volumen de Precio Modelo de Libro de Órdenes Modelo de Distribución Macroscópica OWT Θ(log(R)) (De [3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) para -aproximación de Pbins maxprice Θ(log(Q)) (igual que arriba más...) VWAP Θ(log(R)) O(log(R) log(N)) (de arriba) 2E(Pbins vol ) Ω(Q) horario fijo O(log(Q)) para N grande (1 + )2E(Pbins vol ) para -aproximación de Pbins vol 1 para volumen en [N, QN] Figura 1: La tabla resume los resultados presentados en este documento. Las filas representan resultados para el criterio OWT o VWAP. Las columnas representan en qué modelo estamos trabajando. La entrada en la tabla es la razón competitiva entre nuestro algoritmo y un algoritmo óptimo, y cuanto más cercano sea el ratio a 1, mejor. El parámetro R representa un límite en la fluctuación del precio máximo al mínimo y el parámetro Q representa un límite en la fluctuación del volumen máximo al mínimo en el modelo respectivo. (Consulte la Sección 4 para una descripción del Modelo de Distribución Macroscópica). Todos los resultados para el criterio de trading OWT (que es un criterio más fuerte) se traducen directamente al criterio VWAP. Sin embargo, en el entorno de VWAP, considerar una restricción en la fluctuación del volumen máximo al mínimo Q, conduce a una clase adicional de resultados que depende de Q, y algunas pequeñas empresas se centran exclusivamente en la tecnología de negociación VWAP propietaria. En este artículo, proporcionamos el primer estudio de algoritmos de trading VWAP en un entorno de ratio competitivo en línea. Primero formalizamos el problema de trading VWAP en un modelo en línea básico que llamamos modelo de precio-volumen, el cual puede ser visto como una generalización de modelos teóricos anteriores de trading en línea que incorporan información del volumen de mercado. En este modelo, proporcionamos algoritmos VWAP y ratios competitivos, y comparamos esta configuración con el problema de trading de una vía (OWT) estudiado en [3]. Nuestros resultados más interesantes, sin embargo, examinan el problema de trading VWAP en un nuevo modelo de trading en línea que captura el importante fenómeno reciente de los libros de órdenes limitadas en los mercados financieros. En resumen, una orden de compra o venta con límite especifica tanto la cantidad de acciones como el precio deseado, y solo se ejecutará si hay una contraparte coincidente en el lado opuesto, de acuerdo con un procedimiento de coincidencia bien definido utilizado por todas las principales bolsas. Si bien los libros de órdenes limitadas (la lista de órdenes limitadas en espera de una posible ejecución futura) han existido desde los inicios de los intercambios de acciones, solo recientemente estos libros se han vuelto visibles para los traders en tiempo real, abriendo así el camino a algoritmos de trading de todas las variedades que intentan explotar estos ricos datos de microestructura de mercado. Tales datos y algoritmos son un tema de gran interés actual en Wall Street [4]. Por lo tanto, introducimos un nuevo modelo de trading en línea que incorpora libros de órdenes limitadas, y examinamos tanto el problema de trading de una sola vía como el de VWAP en él. Nuestros resultados están resumidos en la Figura 1 (ver el pie de foto para un resumen). 2. MODELO DE NEGOCIACIÓN PRECIO-VOLUMEN Presentamos ahora un modelo de negociación que incluye información tanto sobre el precio como sobre el volumen de la secuencia de operaciones. Si bien este modelo es una generalización de formalismos anteriores para el comercio en línea, hace una suposición de liquidez infinita que no logra modelar el impacto negativo en el mercado que suele tener la negociación de un gran número de acciones. Esto se abordará en el modelo de libro de órdenes estudiado en la siguiente sección. Una nota sobre la terminología: a lo largo del documento (a menos que se especifique lo contrario), utilizaremos el término mercado para describir toda actividad u órdenes que no sean las del algoritmo en consideración. El escenario que consideramos se puede ver como un juego entre nuestro algoritmo y el mercado. 2.1 El Modelo En el modelo de trading de precio-volumen, asumimos que la actividad de trading intradía en una acción dada se resume en una secuencia discreta de pares de precio y volumen (pt, vt) para t = 1, . . . , T. Aquí t = 0 corresponde a la apertura del mercado, y t = T al cierre. Si bien no hay nada técnicamente especial sobre el horizonte temporal de un solo día, es particularmente consistente con el trading de libros de órdenes limitadas en Wall Street. El par (pt, vt) representa el hecho de que un total de vt acciones fueron intercambiadas a un precio (promedio) por acción pt en el mercado entre el tiempo t − 1 y t. Realísticamente, deberíamos imaginar que el número de intervalos T es razonablemente grande, de modo que tenga sentido asignar un precio aproximado común a todas las acciones intercambiadas dentro de un intervalo. En el modelo de precio-volumen, haremos una suposición de liquidez infinita para nuestros algoritmos de trading. Más precisamente, en este modelo en línea, observamos la secuencia de precio-volumen de a pares. Tras la observación de (pt, vt), se nos permite vender cualquier cantidad (posiblemente fraccionaria) de acciones nt al precio pt. Supongamos que nuestro objetivo es vender N acciones a lo largo del día. Por lo tanto, en cada momento, debemos seleccionar una cantidad (posiblemente fraccionaria) de acciones nt para vender a un precio pt, sujeto a la restricción global T t=1 nt = N. Se asume entonces que si nos quedan acciones por vender después del tiempo T − 1, estamos obligados a venderlas al precio de cierre del mercado, es decir, nT = N − T −1 t=1 nt se vende a pT. De esta manera estamos seguros de vender exactamente N acciones a lo largo del día; lo único que un algoritmo debe hacer es determinar el horario de venta basado en el flujo de precio-volumen del mercado entrante. Cualquier algoritmo que venda volúmenes fraccionarios puede convertirse en un algoritmo aleatorio que solo venda volúmenes enteros con el mismo número esperado de acciones vendidas. Si mantenemos la restricción estricta de vender exactamente N acciones, podríamos incurrir en una pérdida adicional leve en la conversión. (Tenga en cuenta que solo permitimos volúmenes fraccionales en el modelo de precio-volumen, donde la liquidez no es un problema). En el modelo de libro de órdenes que vamos a seguir, no permitimos volúmenes fraccionarios. En el trading de VWAP, el objetivo de un algoritmo en línea A que vende exactamente N acciones no es maximizar las ganancias en sí, sino seguir el VWAP del mercado. El VWAP de mercado para una secuencia de trading intradía S = (p1, v1), . . . , (pT , vT ) es simplemente el precio promedio pagado por acción durante el transcurso del día de trading, es decir, VWAPM (S) = T t=1 ptvt /V donde V es el volumen diario total, es decir, V = T t=1 vt. Si en la secuencia S, el algoritmo A vende sus N acciones utilizando la secuencia de volumen n1, . . . nT, entonces definimos de manera análoga el VWAP de A en la secuencia de mercado S como VWAPA(S) = Σ t=1 ptnt / N. Ten en cuenta que el VWAP del mercado no incluye las acciones que vende el algoritmo. El ratio competitivo de VWAP de A con respecto a un conjunto de secuencias Σ es entonces RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)}. En el caso de que A sea aleatorio, generalizamos la definición anterior tomando una esperanza sobre VWAPA(S) dentro del máximo. Observamos que a diferencia de Wall Street, nuestra definición de VWAPM no tiene en cuenta nuestras propias operaciones comerciales. Es fácil ver que esto lo convierte en un criterio más desafiante de seguir. A diferencia del VWAP, otra medida común del rendimiento de un algoritmo de venta en línea sería su ratio competitivo de trading unidireccional (OWT) [3] con respecto a un conjunto de secuencias Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} donde el rendimiento de los algoritmos se compara con el precio individual más alto que aparece en la secuencia S. Tanto en VWAP como en OWT, estamos comparando el precio promedio por acción recibido por un algoritmo de venta con alguna medida del rendimiento del mercado. En el caso de OWT, comparamos con el benchmark bastante ambicioso del precio más alto del día, ignorando por completo los volúmenes. En el trading de VWAP, tenemos el objetivo más modesto de compararnos favorablemente con el promedio general del mercado del día. Como veremos, hay algunas similitudes y diferencias importantes entre estos dos enfoques. Por ahora notamos un hecho simple: en cualquier secuencia específica S, VWAPA(S) puede ser mayor que VWAPM(S). Sin embargo, RVWAP(A) no puede ser menor que 1, ya que en cualquier secuencia S en la que todos los precios pt son idénticos, es imposible obtener un mejor promedio de participación por precio. Por lo tanto, para todos los algoritmos A, tanto RVWAP(A) como ROWT(A) son mayores que 1, y cuanto más cerca estén de 1, mejor A está siguiendo su respectiva medida de rendimiento. Los resultados de VWAP de 2.2 en el modelo de precio-volumen. Como en trabajos anteriores sobre trading en línea, generalmente no es posible obtener límites finitos en las razones competitivas sin ninguna suposición sobre el conjunto de secuencias Σ, se requieren límites en la variación máxima en precio o volumen, dependiendo del entorno exacto. Por lo tanto, introducimos las siguientes dos suposiciones. 2.2.0.1 Suposición de Variabilidad de Volumen... Sea 0 < Vmin ≤ Vmax constantes positivas conocidas, y definamos Q = Vmax /Vmin. Para todas las secuencias de operaciones intradía S ∈ Σ, el volumen diario total V ∈ [Vmin, Vmax]. 2.2.0.2 Suposición de Variabilidad de Precios. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Por lo general, las razones competitivas se toman sobre todos los conjuntos Σ consistentes con al menos una de estas suposiciones. Para obtener intuición, considera los dos casos triviales de R = 1 y Q = 1. En el caso de R = 1 (donde no hay fluctuación en el precio), cualquier horario es óptimo. En el caso de Q = 1 (donde se conoce el volumen total V durante el período de negociación), podemos obtener una proporción competitiva de 1 vendiendo vt V N acciones después de cada período de tiempo. Para el problema de OWT en el modelo de precio-volumen, los volúmenes son irrelevantes para el criterio de rendimiento, pero son centrales para el criterio de VWAP. Para el problema de OWT bajo la suposición de variabilidad de precios, los resultados de [3] establecieron que la proporción competitiva óptima era Θ(log(R)). Nuestro primer resultado establece que la proporción competitiva óptima para VWAP bajo la suposición de variabilidad del volumen es Θ(log(Q)) y es alcanzada por un algoritmo que ignora los datos de precios. Teorema 1. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) ≤ 2 log(Q). Además, si solo se cumple la suposición de variabilidad del volumen (y no de la variabilidad del precio), cualquier algoritmo en línea A para vender N acciones tiene RVWAP(A) = Ω(log(Q)). Prueba. (Bosquejo) Para el límite superior, la idea es similar al algoritmo de reserva de precio de [3] para el problema de OWT, y similar en espíritu a la técnica general de clasificar y seleccionar [1]. Considera algoritmos que utilizan un parámetro ˆV, el cual se interpreta como una estimación del volumen total para el día. Entonces, en cada momento t, si el precio y volumen de mercado son (pt, vt), el algoritmo vende una fracción vt/ ˆV de sus acciones. Consideramos una familia de algoritmos log(Q), donde el algoritmo Ai utiliza ˆV = Vmin 2i−1. Claramente, uno de los Ai tiene una proporción competitiva de 2. Podemos obtener una proporción competitiva de VWAP de O(log(Q)) ejecutando estos algoritmos en paralelo y dejando que cada algoritmo venda N/log(Q) acciones. (Alternativamente, podemos seleccionar aleatoriamente un Ai y garantizar la misma proporción competitiva esperada). Ahora esbozamos la prueba del límite inferior, que relaciona el rendimiento en los problemas de VWAP y OWT. Cualquier algoritmo que sea c-competitivo en el entorno de VWAP (con Q fijo) es 3c-competitivo en el entorno de OWT con R = Q/2. Para demostrar esto, tomamos cualquier secuencia S de precios para el problema de OWT, y la convertimos en una secuencia de precio-volumen para el problema de VWAP. Los precios en la secuencia VWAP son iguales a los de S. Para construir los volúmenes en la secuencia VWAP, segmentamos los precios en S en intervalos log(R) [2i−1 pmin , 2i pmin ). Supongamos que pt ∈ [2i−1 pmin , 2i pmin ), y esta es la primera vez en S que un precio ha caído en este intervalo. Entonces, en la secuencia VWAP establecemos el volumen vt = 2i−1. Si esta no es la primera visita al intervalo que contiene el punto pt, establecemos vt = 0. Suponga que el precio máximo en S es pmax. El VWAP de nuestra secuencia es al menos pmax /3. Dado que teníamos un algoritmo c competitivo, su venta promedio es al menos pmax /3c. El límite inferior ahora se sigue utilizando el límite inferior en [3]. Un enfoque alternativo al VWAP es ignorar los volúmenes a favor de los precios y aplicar un algoritmo para el problema de OWT. Ten en cuenta que el límite inferior en este teorema, a diferencia del anterior, solo asume un límite de variación de precios. Teorema 2, 191. En el modelo de precio-volumen bajo la suposición de variabilidad de precios, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva RVWAP(A) = O(log(R)). Además, si solo se cumple la suposición de variabilidad del precio (y no de la variabilidad del volumen), cualquier plataforma en línea A para vender N acciones tiene RVWAP(A) = Ω(log(R)). Prueba. (Bosquejo) Sigue inmediatamente de los resultados de [3] para OWT: el límite superior del simple hecho de que para cualquier secuencia S, VWAPA(S) es menor que max1≤t≤T {pt}, y el límite inferior de una reducción a OWT. Los teoremas 1 y 2 demuestran que se pueden lograr ratios competitivos de VWAP logarítmicos bajo la suposición de una variabilidad acotada del volumen total o una variabilidad acotada del precio máximo. Si ambas suposiciones se cumplen, es posible dar un algoritmo que logre el mínimo entre log(Q) y log(R). Esta flexibilidad de enfoque se deriva del hecho de que el VWAP es una cantidad en la que tanto los precios como los volúmenes importan, a diferencia de OWT. 2.3 Resultados Relacionados en el Modelo de Precio-Volumen Todos los algoritmos de VWAP que hemos discutido hasta ahora hacen uso de los datos diarios (pt, vt) a medida que se desarrollan, utilizando ya sea la información de precios o de volumen. Por el contrario, un algoritmo VWAP con horario fijo tiene una distribución predeterminada {f1, f2, . . . fT}, y simplemente vende ftN acciones en el tiempo t, independientemente de (pt, vt). Los algoritmos VWAP con horarios fijos, o variantes ligeras de los mismos, son sorprendentemente comunes en Wall Street, y el horario suele derivarse de datos históricos de volumen intradiario. Nuestro próximo resultado demuestra que tales algoritmos pueden rendir considerablemente peor que los algoritmos adaptativos dinámicamente en términos de la proporción competitiva en el peor caso. Teorema 3. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, cualquier algoritmo fijo de VWAP programado para vender N acciones tiene una proporción competitiva de venta VWAP RVWAP(A) = Ω(min(T, R)). Las pruebas de todos los resultados de esta subsección están en el Apéndice. Hasta ahora, nuestro énfasis ha estado en algoritmos VWAP que deben vender exactamente N acciones. En muchas circunstancias realistas, sin embargo, existe cierta flexibilidad en el número exacto de acciones que se van a vender. Por ejemplo, esto es cierto en las grandes corredurías, donde muchas operaciones VWAP separadas pueden ser agrupadas y ejecutadas por un algoritmo común, y la empresa estaría bastante dispuesta a mantener una pequeña posición de acciones no vendidas durante la noche si resultara en mejores precios de ejecución. El siguiente teorema (que curiosamente no tiene un análogo para el problema de OWT) demuestra que este equilibrio entre las acciones vendidas y el rendimiento puede ser realizado de manera dramática en nuestro modelo. Se establece que si estamos dispuestos a permitir que el número de acciones vendidas varíe con Q, de hecho podemos lograr una proporción competitiva de VWAP de 1. Teorema 4. En el modelo de precio-volumen bajo la suposición de variabilidad del volumen, existe un algoritmo A que siempre vende entre N y QN acciones y que el precio promedio por acción vendida es exactamente VWAPM (S). En muchos problemas en línea, hay una clara distinción entre problemas de beneficio y problemas de costo [2]. En el entorno de VWAP, vender acciones es un problema de beneficio, y comprar acciones es un problema de costo. Las definiciones de las razones de competitividad, Rbuy VWAP(A) y Rbuy OWT(A), para algoritmos que compran exactamente N acciones son maxS∈Σ{VWAPA(S)/VWAPM (S)} y maxS∈Σ maxt{VWAPA(S)/pt} respectivamente. Aunque el Teorema 4 también es válido para la compra, en general, la proporción competitiva del problema de compra (costo) es mucho mayor, como se indica en el siguiente teorema. Teorema 5. En el modelo de precio-volumen bajo las suposiciones de variabilidad de volumen y precio, existe un algoritmo en línea A para comprar N acciones logrando una proporción competitiva de VWAP de compra Rbuy VWAP(A) = O(min{Q, √ R}). Además, cualquier algoritmo en línea A para comprar N acciones tiene una proporción competitiva de compra VWAP Rbuy VWAP(A) = Ω(min{Q, √ R}). 3. Un modelo de trading de libro de órdenes limitadas. Antes de definir nuestro modelo de trading en línea basado en libros de órdenes limitadas, proporcionamos antecedentes necesarios sobre la mecánica detallada de los mercados financieros, a veces denominada microestructura del mercado. Luego proporcionamos resultados y algoritmos para los problemas de OWT y VWAP. 192 3.1 Antecedentes sobre los libros de órdenes limitadas y la microestructura del mercado. Una distinción fundamental en la negociación de acciones es entre una orden limitada y una orden de mercado. Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT). En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado. Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 2, que muestra una captura de pantalla real de un libro de órdenes reciente de MSFT en Island (www.island.com), un conocido intercambio electrónico de acciones de NASDAQ), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos. Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta). Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (siendo las órdenes más antiguas las primeras en el libro). En el ejemplo proporcionado por la Figura 2, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra. De manera similar, se mantiene un libro de órdenes de venta para órdenes de límite de venta (por ejemplo, podríamos querer vender 500 acciones de MSFT a $24.10 o más) esta vez con el precio de venta más bajo ofrecido (a menudo denominado como el precio de venta). Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas. Los precios de oferta y demanda (que nuevamente, son simplemente los precios en las órdenes límite en la parte superior de los libros de compra y venta, respectivamente) a veces se denominan como el mercado interno, y la diferencia entre ellos como el spread. Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección. ¿Entonces, cómo se ejecutan las órdenes? Hay dos métodos. Primero, cada vez que llega una orden de mercado, se empareja inmediatamente con las órdenes límite más competitivas en el libro opuesto. Por lo tanto, una orden de mercado para comprar 2000 acciones se empareja con suficiente volumen en el libro de órdenes de venta para completar las 2000 acciones. Por ejemplo, en el ejemplo de la Figura 2, tal orden sería completada por las dos órdenes de venta límite de 500 acciones a $24.069, las 500 acciones a $24.07, las 200 acciones a $24.08, y luego 300 de las 1981 acciones a $24.09. Las 1681 acciones restantes de esta última orden límite permanecerían como el nuevo tope del libro de órdenes de venta límite. Segundo, si una orden de límite de compra (venta, respectivamente) entra por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con órdenes en los libros opuestos. Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato. Cada orden de mercado o límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que las órdenes llegan, y dos órdenes nunca pueden llegar simultáneamente. Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden. Es esta cantidad la que generalmente se quiere decir cuando la gente se refiere casualmente al precio de una acción (ticker). Ten en cuenta que una orden de compra (venta, respectivamente) con un precio de infinito (0, respectivamente) es efectivamente una orden de mercado. Por lo tanto, asumiremos sin pérdida de generalidad que todas las órdenes se colocan como órdenes límite. Aunque las órdenes límite que no se ejecutan pueden ser eliminadas por la parte que las colocó, para simplificar, asumimos que las órdenes límite nunca son eliminadas de los libros. Remitimos al lector a [4] para obtener más información sobre los intercambios electrónicos modernos y la microestructura del mercado. 3.2 El Modelo El modelo de negociación de libros de órdenes en línea tiene como objetivo capturar los detalles realistas de la microestructura del mercado recién discutidos en un entorno de relación competitiva. En este modelo refinado, la actividad del mercado de un día se describe por una secuencia de órdenes límite (pt, vt, bt). Aquí bt es un bit que indica si la orden es de compra o venta, mientras que pt es el precio de la orden límite y vt es el número de acciones deseado. Tras la llegada de cada orden límite de este tipo, se permite a un algoritmo de trading en línea colocar su propia orden límite. Estas dos fuentes entrelazadas (mercado y algoritmo) de órdenes límite son simplemente operadas de acuerdo con el proceso de emparejamiento descrito en la Sección 3.1. Cualquier orden límite que no sea ejecutable de inmediato según este proceso se coloca en el libro correspondiente (compra o venta) para una posible ejecución futura; las órdenes que llegan y pueden ser ejecutadas parcial o totalmente se ejecutan de esa manera, con cualquier acción residual que permanezca en el libro respectivo. El objetivo de un algoritmo de venta VWAP u OWT es esencialmente el mismo que en el modelo de precio-volumen, pero el contexto ha cambiado en las siguientes dos formas fundamentales. Primero, la suposición de liquidez infinita en el modelo de precio-volumen se elimina por completo. El número de acciones disponibles a cualquier precio dado está restringido al volumen total de órdenes límite que ofrecen ese precio. Segundo, se asume que todas las órdenes entrantes, y por lo tanto los libros completos de órdenes límite, son visibles para el algoritmo. Esto es coherente con los intercambios financieros electrónicos modernos, y de hecho es la fuente de mucho interés actual en Wall Street [4]. En general, la definición de las ratios competitivas en el modelo de libro de órdenes se complica por el hecho de que ahora nuestra actividad algorítmica influye en la secuencia de precios y volúmenes ejecutados. Por lo tanto, primero definimos la secuencia de ejecución determinada por una secuencia de órdenes límite (colocadas por el mercado y nuestro algoritmo). Sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por el mercado, y sea S = (p1, v1, b1), . . . , (pT , vT , bT ) una secuencia de órdenes límite colocada por nuestro algoritmo (a menos que se especifique lo contrario, todos los bt son de tipo venta). Sea merge(S, S) la secuencia fusionada (p1, v1, b1), (p1, v1, b1), . . . , (pT, vT, bT), (pT, vT, bT), que es la secuencia temporal de órdenes realizadas por el mercado y el algoritmo. Ten en cuenta que el algoritmo tiene la opción de no realizar un pedido, lo cual podemos considerar como un pedido de volumen cero. Si llevamos a cabo el mantenimiento del libro de órdenes y el proceso de ejecución de órdenes descrito en la Sección 3.1 en la fusión de secuencias (S, S), en intervalos irregulares se produce una operación de compra/venta de un cierto número de acciones a un determinado precio. En cada operación ejecutada, la parte vendedora es o bien el mercado o el algoritmo. Sea execM (S, S ) = (q1, w1), . . . , (qT , wT ) la secuencia de ejecuciones donde el mercado (es decir, una parte distinta al algoritmo) fue la parte vendedora, donde los qt son los precios de ejecución y wt los volúmenes de ejecución. De manera similar, definimos execA(S, S) = (r1, x1), . . . , (rT, xT) como la secuencia de ejecuciones en las que el algoritmo fue la parte vendedora. Por lo tanto, execA(S, S) ∪ execM(S, S) es el conjunto de todas las ejecuciones. Generalmente esperamos que T sea (posiblemente mucho) más pequeño que T. Los ingresos del algoritmo y del mercado se definen como: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt. Nótese que ambas cantidades están determinadas únicamente por las secuencias de ejecución execM (S, S ) y execA(S, S ), respectivamente. Para un algoritmo A que está limitado a vender exactamente N acciones, definimos la razón de competencia OWT de A, ROWT(A), como la razón máxima (bajo cualquier S ∈ Σ) de los ingresos obtenidos por A, en comparación con los ingresos obtenidos por un algoritmo óptimo fuera de línea A∗. De manera más formal, para A∗ que está limitado a vender exactamente N acciones, definimos ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) donde S∗ es la secuencia de órdenes límite colocadas por A∗ en S. Si el algoritmo A es aleatorio, entonces tomamos la expectativa apropiada con respecto a S ∼ A. Definimos la ratio competitiva VWAP, RVWAP(A), como la ratio máxima (bajo cualquier S ∈ Σ) entre los VWAPs del mercado y del algoritmo. Más formalmente, define VWAPM (S, S ) como REVM (S, S )/ T t=1 wt, donde el denominador es simplemente el volumen total ejecutado de órdenes colocadas por el mercado. De manera similar, definimos VWAPA(S, S) como REVA(S, S)/N, ya que asumimos que el algoritmo vende no más de N acciones (esta definición asume implícitamente que A obtiene un precio de 0 por las acciones no vendidas). El ratio competitivo VWAP de A es entonces: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} donde S es la secuencia en línea de órdenes límite generadas por A en respuesta a la secuencia S. 3.3 Resultados de OWT en el Modelo de Libro de Órdenes. Para el problema de OWT en el modelo de libro de órdenes, introducimos una versión más sutil de la suposición de variabilidad de precios. Esto se debe al hecho de que nuestro trading algorítmico puede afectar los precios altos y bajos del día. Para la suposición a continuación, tenga en cuenta que execM (S, ∅) es la secuencia de ejecuciones sin la interacción de nuestro algoritmo. 3.3.0.3 Suposición de Variabilidad del Precio del Libro de Órdenes. Deje que 0 < pmin ≤ pmax sean constantes positivas conocidas, y defina R = pmax/pmin. Para todas las secuencias de trading intradía S ∈ Σ, los precios pt en la secuencia execM (S, ∅) cumplen pt ∈ [pmin, pmax], para todo t = 1, . . . , T. Tenga en cuenta que esta suposición no implica que las ratios de precios altos a bajos bajo las secuencias execM (S, S ) o execA(S, S ) estén limitadas por R. De hecho, la ratio en la secuencia execA(S, S ) podría ser infinita si el algoritmo termina vendiendo algunas acciones a un precio de 0. Teorema 6. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de venta OWT ROWT(A) = 2 log(R) log(N). Prueba. El algoritmo A funciona al adivinar un precio p en el conjunto {pmin2i : 1 ≤ i ≤ log(R)} y colocar una orden de venta límite por todas las N acciones al precio p al comienzo del día. (Alternativamente, el algoritmo A puede colocar log(R) órdenes de venta límite, donde la i-ésima tiene un precio de 2i pmin y un volumen de N/ log(R).) Al realizar un pedido al comienzo del día, el algoritmo ofrece un precio más bajo que todos los pedidos de venta que se realizarán durante el día por un precio de p o superior, lo que significa que primero se deben completar las N acciones del algoritmo a este precio. Por lo tanto, si hubiera habido k acciones que se hubieran vendido a un precio p o superior sin nuestra actividad, entonces A vendería al menos kp acciones. Definimos {pj} como el multiconjunto de precios de acciones individuales que han sido ejecutadas o son acciones de órdenes de compra límite que permanecieron sin ejecutar, excluyendo la actividad de nuestro algoritmo (es decir, asumiendo que nuestro algoritmo no coloca órdenes). Suponga sin pérdida de generalidad que p1 ≥ p2 ≥ . . .. Considerar adivinar el k-ésimo precio más alto, pk. Si se coloca una orden de N acciones al comienzo del día a un precio pk, entonces estamos garantizados de obtener un retorno de kpk. Que k∗ = argmaxk{kpk}. Podemos ver nuestro algoritmo como intentando adivinar pk∗, y teniendo éxito si la suposición p satisface p ∈ [pk∗ /2, pk∗]. Por lo tanto, somos 2 log(R) competitivos con la cantidad max1≤k≤N kpk. Se debe tener en cuenta que ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk donde ρ se define como la suma de los N precios principales pi sin la participación de A. De manera similar, sea {pj} el multiconjunto de precios de las acciones individuales ejecutadas, o los precios de las acciones de órdenes de compra no ejecutadas, pero ahora incluyendo las órdenes realizadas por algún algoritmo de venta A. Ahora deseamos demostrar que para todos los algoritmos A que venden N acciones, REVA ≤ N i=1 pi ≤ ρ. Esencialmente, esta desigualdad establece la idea intuitiva de que un algoritmo de venta solo puede reducir los precios de las órdenes de compra ejecutadas o no coincidentes. Para demostrar esto, utilizamos la inducción para mostrar que la eliminación de la actividad de un algoritmo de venta hace que estos precios aumenten. Primero, elimine la última acción en la última orden de venta realizada por A o el mercado en una fusión de secuencia arbitraria merge(S, S) - con esto queremos decir, tome la última orden de venta realizada por A o el mercado y disminuya su volumen en una acción. Después de esta modificación, los N precios más altos p1 . . . pN no disminuirán. Esto se debe a que o bien esta orden de venta no se ejecutó, en cuyo caso la afirmación es trivialmente verdadera, o, si se ejecutó, la eliminación de esta orden de venta deja una orden de compra adicional no ejecutada de igual o mayor precio. Para la inducción, asumimos que si eliminamos una participación de cualquier orden de venta que se haya colocado, ya sea por A o por el mercado, en o después del tiempo t, entonces los N precios principales no disminuyen. Ahora demostramos que si eliminamos una participación de la última orden de venta que fue colocada por A o el mercado antes del tiempo t, entonces los N precios principales no disminuyen. Si esta orden de venta de acciones no se ejecutó, entonces la afirmación es trivialmente verdadera. De lo contrario, si la orden de venta se ejecutó, entonces la afirmación es verdadera porque al eliminar esta acción ejecutada de la orden de venta, o bien: i) la acción correspondiente de la orden de compra (de igual o mayor valor) no se empareja en el resto de la secuencia, en cuyo caso la afirmación es verdadera; o ii) esta orden de compra se empareja con alguna acción de una orden de venta a un precio igual o mayor, lo que tiene el efecto de eliminar una acción de una orden de venta en el resto de la secuencia y, por la suposición inductiva, esto solo puede aumentar los precios. Por lo tanto, hemos demostrado que para todos los A que venden N acciones, REVA ≤ ρ. Ahora hemos establecido que nuestra ganancia satisface 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), donde A realiza una secuencia arbitraria de N órdenes de venta límite. 3.4 Resultados de VWAP en el Modelo del Libro de Órdenes El algoritmo OWT del Teorema 6 se puede aplicar para obtener el siguiente resultado de VWAP: Corolario 7. En el modelo de libro de órdenes bajo la suposición de variabilidad de precios del libro de órdenes, existe un algoritmo en línea A para vender N acciones logrando una proporción competitiva de VWAP de venta RVWAP(A) = O(log(R) log(N)). Ahora hacemos una suposición bastante diferente sobre las secuencias S. 3.4.0.4 Volumen de Orden Acotado y Suposición de Precio Máximo. El conjunto de secuencias Σ satisface las siguientes dos propiedades. Primero, asumimos que cada orden colocada en el mercado tiene un volumen menor que γ, lo cual consideramos como una suposición leve ya que típicamente las órdenes individuales en el mercado no tienen un alto volumen (debido a problemas de liquidez). Esta suposición permite que nuestro algoritmo coloque al menos una orden límite a la vez intercalada con aproximadamente γ ejecuciones de mercado. Segundo, asumimos que hay un gran volumen en los libros de órdenes de venta por debajo del precio pmax, lo que significa que ninguna orden colocada por el mercado se ejecutará por encima del precio pmax. La forma más sencilla de instanciar esta última suposición en el modelo de libro de órdenes es asumir que cada secuencia S ∈ Σ comienza colocando un gran número de órdenes de venta (más de Vmax) a un precio pmax. Aunque esta suposición tiene un parámetro de precio máximo, no implica que la proporción de precios R sea finita, ya que no implica ningún límite inferior en los precios de compra o de las acciones ejecutadas (aparte del trivial de 0). Teorema 8. Considera el modelo de libro de órdenes bajo la suposición de volumen de orden limitado y precio máximo. Existe un algoritmo A en el cual después de exactamente γN ejecuciones de mercado, entonces A ha vendido como máximo N acciones y REVA(S, S) ≤ N = VWAPA(S, S) ≥ (1 − ε)VWAPM(S, S) − pmax N donde S es una secuencia de N órdenes de venta límite generadas por A al observar S. Demostración. El algoritmo divide el día de negociación en intervalos de volumen cuya duración en tiempo real puede variar. Para cada período i en el que se hayan ejecutado acciones γ en el mercado, el algoritmo calcula el VWAP de mercado solo de aquellas acciones negociadas en el período i; denotémoslo como VWAPi. Tras este intervalo de volumen i-ésimo, el algoritmo coloca una orden límite para vender exactamente una acción a un precio cercano al VWAPi. Más precisamente, el algoritmo solo coloca órdenes a los precios discretos (1− )pmax , (1− )2 pmax , . . .. Tras el intervalo de volumen i, el algoritmo coloca una orden límite para vender una acción al precio discretizado que esté más cercano al VWAPi, pero que sea estrictamente menor. Para el análisis, comenzamos observando que si todas las órdenes límite de los algoritmos se ejecutan durante el día, los ingresos totales recibidos por el algoritmo serían al menos (1 − )VWAPM (S, S )N. Para ver esto, basta con notar que VWAPM (S, S ) es una mezcla uniforme de los VWAPi (ya que por definición cubren la misma cantidad de volumen de mercado); y si todas las órdenes límite de los algoritmos se ejecutaran, cada uno recibiría más de (1 − )VWAPi dólares por el intervalo i que siguieron. Ahora contamos el potencial de ingresos perdidos del algoritmo debido a órdenes límite no ejecutadas. Por la suposición de que los pedidos individuales se realizan con un volumen menor que γ, entonces nuestro algoritmo es capaz de colocar una orden límite durante cada bloque de γ acciones que se han negociado. Por lo tanto, después de que se hayan ejecutado γN órdenes de mercado, A ha colocado N órdenes en el mercado. Ten en cuenta que puede haber como máximo una orden límite (y por lo tanto, como máximo una acción) sin ejecutar en cada nivel de la escalera de precios discretizada definida anteriormente. Esto se debe a que después del intervalo i, el algoritmo coloca su orden límite estrictamente por debajo de VWAPi, por lo que si VWAPj ≥ VWAPi para j > i, esta orden límite debe haber sido ejecutada. Por lo tanto, las órdenes límite no ejecutadas limitaron los VWAPs del resto del día, resultando en un máximo de una orden no ejecutada por nivel de precio. Un límite en la pérdida de ingresos es, por lo tanto, la suma de los precios discretizados: ∞ i=1(1 − )i pmax ≤ pmax / . Claramente nuestro algoritmo ha vendido como máximo N acciones. Ten en cuenta que a medida que N se vuelve grande, VWAPA se acerca a 1 menos el VWAP del mercado. Si supiéramos que el volumen total final de las ejecuciones del mercado es V, entonces podríamos establecer γ = V/N, asumiendo que γ >> 1. Si solo tenemos un límite superior e inferior en V, deberíamos poder adivinar y incurrir en una pérdida logarítmica. La siguiente suposición intenta capturar la variabilidad del volumen del mercado. Suposición de Variabilidad del Volumen del Libro de Órdenes 3.4.0.5. Ahora asumimos que el volumen total (que incluye las operaciones ejecutadas tanto por nuestro algoritmo como por el mercado) es variable dentro de una región conocida y que el volumen del mercado será mayor que el volumen de nuestros algoritmos. De manera más formal, para todo S ∈ Σ, asumir que el volumen total V de acciones negociadas en execM (S, S), para cualquier secuencia S de N órdenes de venta límite, satisface 2N ≤ Vmin ≤ V ≤ Vmax. Que Q = Vmax / Vmin. El siguiente corolario se deriva utilizando una constante = 1/2 y observando que si establecemos γ de manera que V ≤ γN ≤ 2V entonces nuestro algoritmo colocará entre N y N/2 órdenes límite. Corolario 9. En el modelo de libro de órdenes, si se cumplen la suposición de volumen de orden acotado y precio máximo, y la suposición de variabilidad del volumen del libro de órdenes, existe un algoritmo en línea A para vender como máximo N acciones tal que VWAPA(S, S) ≥ 1 4 log(Q) VWAPM(S, S) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figura 3: Aquí presentamos límites de la Sección 4 basados en las distribuciones de volumen empíricas para cuatro acciones reales: QQQ, MCHP, JNPR y CHKP. Los gráficos muestran histogramas de los volúmenes totales diarios transados en Island para estas acciones, en el último año y medio, junto con los valores correspondientes de log(Q) y E(Pbins vol) (denotado por E). Suponemos que los volúmenes diarios mínimo y máximo en los datos corresponden a Vmin y Vmax, respectivamente. Los límites de la razón competitiva en el peor de los casos (que son dos veces el logaritmo de Q) de nuestro algoritmo para esas acciones son 9.42, 10.56, 11.32 y 13.20, respectivamente. Los límites correspondientes sobre el rendimiento de la proporción competitiva de nuestro algoritmo bajo el modelo de distribución de volumen (que son el doble de E(Pbins vol )) son mejores: 7.54, 7.72, 7.94 y 9.00, respectivamente (una mejora relativa del 20-40%). Usando una partición de volumen más fina junto con un límite ligeramente más refinado en la relación competitiva, podemos construir algoritmos que, utilizando la distribución de volumen empírica dada como correcta, garantizan relaciones competitivas aún mejores de 2.76, 2.73, 2.75 y 3.17, respectivamente para esas acciones (detalles omitidos). MODELOS DE DISTRIBUCIÓN MACROSCÓPICA Concluimos nuestros resultados con un regreso al modelo de precio-volumen, donde introduciremos algunos métodos refinados de análisis para algoritmos de trading en línea. Dejamos la generalización de estos métodos al modelo de libro de órdenes para trabajos futuros. Los ratios de competitividad definidos hasta ahora miden el rendimiento en relación con algún criterio de referencia en el peor caso sobre todas las secuencias de mercado S ∈ Σ. Se ha observado en muchos entornos en línea que tales métricas de peor caso pueden arrojar resultados pesimistas, y se han considerado varias relajaciones, como permitir una distribución de probabilidad sobre la secuencia de entrada. Ahora consideramos modelos de distribución que son considerablemente más débiles que asumir una distribución sobre secuencias de mercado completas S ∈ Σ. En el modelo de distribución de volumen, asumimos únicamente que existe una distribución Pvol sobre el volumen total V negociado en el mercado durante el día, y luego examinamos la peor relación competitiva en secuencias consistentes con el volumen elegido al azar. Más precisamente, definimos RVWAP(A, Pvol) = EV ∼Pvol max S∈seq(V) VWAPM(S) VWAPA(S). Aquí V ∼ Pvol denota que V es elegido con respecto a la distribución Pvol, y seq(V) ⊂ Σ es el conjunto de todas las secuencias de mercado (p1, v1), . . . , (pT, vT) que satisfacen T t=1 vt = V. De manera similar, para OWT, podemos definir ROWT(A, Pmaxprice) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S). Aquí Pmaxprice es una distribución solo sobre el precio máximo del día, y luego examinamos secuencias de peor caso consistentes con este precio (seq(p) ⊂ Σ es el conjunto de todas las secuencias de mercado que satisfacen max1≤t≤T pt = p). Se pueden proporcionar definiciones análogas del lado de compra. Enfatizamos que en estos modelos, solo la distribución del volumen máximo y el precio es conocida por el algoritmo. También observamos que nuestras suposiciones probabilísticas sobre S son considerablemente más débiles que los modelos típicos de finanzas estadísticas, los cuales postularían un modelo estocástico detallado para la evolución paso a paso de (pt, vt). Aquí permitimos únicamente una distribución sobre medidas crudas y macroscópicas de la actividad del mercado durante todo el día, como el volumen total y el precio máximo, y analizamos el rendimiento en el peor de los casos coherente con estas medidas crudas. Por esta razón, nos referimos a tales configuraciones como el modelo de distribución macroscópica. El trabajo de El-Yaniv et al. [3] examina supuestos de distribución similares a los nuestros, pero también enfatizan las elecciones de peor caso para las distribuciones, y muestran que esto conduce a resultados no mejores que el análisis de peor caso original sobre todas las secuencias. Por el contrario, consideramos que el análisis de las distribuciones específicas Pvol y Pmaxprice es natural en muchos contextos financieros y nuestros resultados experimentales preliminares muestran mejoras significativas cuando se tiene en cuenta esta información distribucional bastante rudimentaria (ver Figura 3). Nuestros resultados en el contexto de VWAP examinan los casos en los que estas distribuciones son conocidas exactamente o solo aproximadamente. Resultados similares pueden obtenerse para distribuciones macroscópicas del precio máximo diario en el escenario de negociación unidireccional. 4.1 Resultados en el Modelo de Distribución Macroscópica Comenzamos señalando que los algoritmos examinados hasta ahora funcionan dividiendo los volúmenes totales o los precios máximos en contenedores de tamaño exponencialmente creciente, y luego adivinando el índice del contenedor en el que cae la cantidad real. Es natural que el rendimiento del modelo de distribución macroscópica de tales algoritmos (comunes en <br>análisis competitivos</br>) pueda depender de la distribución del índice de contenedor real. En lo que resta, asumimos que Q es una potencia de 2 y la base del logaritmo es 2. Que Pvol denote la distribución del volumen total diario del mercado. Definimos la distribución relacionada Pbins vol sobre los índices de los contenedores i de la siguiente manera: para todo i = 1, . . . , log(Q) − 1, Pbins vol (i) es igual a la probabilidad, bajo Pvol, de que el volumen diario caiga en el intervalo [Vmin 2i−1 , Vmin 2i ), y Pbins vol (log(Q)) es para el último intervalo [Vmax /2, Vmax]. Definimos E como E(Pbins vol) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2. Dado que el soporte de Pbins vol tiene solo log(Q) elementos, E(Pbins vol ) puede variar desde 1 (para distribuciones Pvol que colocan todo su peso en solo uno de los log(Q) intervalos entre Vmin , Vmin 2, Vmin 4, . . . , Vmax ) hasta log(Q) (para distribuciones Pvol en las que el volumen diario total tiene igual probabilidad de caer en cualquiera de estos intervalos). Ten en cuenta que las distribuciones Pvol de este último tipo están lejos de ser uniformes en todo el rango [Vmin, Vmax]. Teorema 10. En el modelo de distribución de volumen bajo el supuesto de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando únicamente el conocimiento de la distribución total de volumen Pvol, logra RVWAP(A, Pvol) ≤ 2E(Pbins vol). Todas las pruebas en esta sección se proporcionan en el apéndice. Como ejemplo concreto, considera el caso en el que Pvol es la distribución uniforme sobre [Vmin, Vmax]. En ese caso, el volumen de Pbins está aumentando de forma exponencial y alcanza su punto máximo en el último bin, que, al tener el ancho más grande, también tiene el mayor peso. En este caso, E(Pbins vol) es una constante (es decir, independiente de Q), lo que conduce a una proporción competitiva constante. Por otro lado, si Pvol es exponencial, entonces Pbins vol es uniforme, lo que conduce a una proporción competitiva de O(log(Q)), al igual que en el entorno de precio-volumen más adversarial discutido anteriormente. En la Figura 3, proporcionamos límites específicos adicionales obtenidos para distribuciones empíricas de volumen diario total calculadas para algunas acciones reales. Ahora examinamos el escenario en el que Pvol es desconocido, pero se dispone de una aproximación ˜Pvol. Definamos C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) . C se minimiza en C(Pbins vol , Pbins vol ) = E(Pbins vol ), y C puede ser infinito si ˜Pbins vol (i) es 0 cuando Pbins vol (i) > 0. Teorema 11. En el modelo de distribución de volumen bajo la suposición de variabilidad de volumen, existe un algoritmo en línea A para vender N acciones que, utilizando solo el conocimiento de una aproximación ˜Pvol de Pvol, logra que RVWAP(A, Pvol) ≤ 2C(Pbins vol, ˜Pbins vol). Como ejemplo de este resultado, supongamos que nuestra aproximación cumple (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) para todo i, para algún α > 1. Por lo tanto, nuestras probabilidades estimadas de índice de contenedor están todas dentro de un factor de α de la verdad. Entonces es fácil demostrar que C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), por lo tanto, según los Teoremas 10 y 11, nuestra penalización por usar la distribución aproximada es un factor de α en la proporción competitiva. 5. REFERENCIAS [1] B. Awerbuch, Y. Bartal, A. Fiat y A. Rosén. Control de llamadas competitivo no preemptivo. En Proc. 5to Simposio ACM-SIAM sobre Algoritmos Discretos, páginas 312-320, 1994. [2] A. Borodin y R. El-Yaniv. Computación en línea y <br>análisis competitivo</br>. Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp y G. Turpin. Algoritmos óptimos de búsqueda y comercio en línea unidireccional. Algorithmica, 30:101-139, 2001. [4] M. Kearns y L. Ortiz. El proyecto de trading automatizado Penn-Lehman. IEEE Intelligent Systems, 2003. \n\nSistemas Inteligentes de IEEE, 2003. Aparecer. 6. APÉNDICE 6.1 Pruebas de la Subsección 2.3 Prueba. (Bosquejo del Teorema 3) Sin pérdida de generalidad, asumir que Q = 1 y el volumen total es V. Considera el tiempo t donde el horario fijo f vende menos, entonces ft ≤ N/T. Considera las secuencias donde en el tiempo t tenemos pt = pmax, vt = V, y para los tiempos t = t tenemos pt = pmin y vt = 0. El VWAP es pmax y el promedio de horario fijo es (N/T)pmax + (N − N/T)pmin. Prueba. (Bosquejo del Teorema 4) El algoritmo simplemente vende ut = (vt/Vmin)N acciones en el tiempo t. El número total de acciones vendidas U es claramente mayor que N y U = t ut = t (vt/Vmin)N = (V/Vmin)N ≤ QN El precio promedio es V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), donde usamos el hecho de que ut/U = vt/V. 197 Prueba. (del Teorema 5) Comenzamos con la prueba del límite inferior. Considera el siguiente escenario. Durante las primeras T unidades de tiempo tenemos un precio de √ Rpmin y un volumen total de Vmin. Observamos cuántas acciones ha comprado el algoritmo en línea. Si ha comprado más de la mitad de las acciones, los pasos de tiempo restantes tienen un precio pmin y un volumen de Vmax − Vmin. De lo contrario, los pasos de tiempo restantes tienen un precio pmax y un volumen insignificante. En el primer caso, el comprador en línea ha pagado al menos √ Rpmin /2 mientras que el VWAP es a lo sumo √ Rpmin /Q + pmin. Por lo tanto, en este caso la proporción competitiva es Ω(Q). En el segundo caso, el comprador en línea tiene que comprar al menos la mitad de las acciones a pmax, por lo que su costo promedio es al menos pmax/2. El VWAP del mercado es √ Rpmin = pmax / √ R, por lo tanto, la proporción competitiva es Ω( √ R). Para el límite superior, podemos obtener una proporción competitiva de √ R, comprando todas las acciones una vez que el precio caiga por debajo de √ Rpmin. El límite superior de Q se deriva ejecutando un algoritmo que asume que el volumen es Vmin. El comprador en línea paga un costo de p, mientras que el VWAP será al menos p/Q. 6.2 Pruebas de la Sección 4 Prueba. (Bosquejo del Teorema 10) Utilizamos la idea de adivinar el volumen total del Teorema 1, pero ahora permitimos la posibilidad de una distribución arbitraria (pero conocida) sobre el volumen total. En particular, considere construir una distribución Gbins vol sobre un conjunto de valores de volumen utilizando Pvol y úsela para estimar el volumen total V. Permita que el algoritmo adivine ˆV = Vmin 2i con probabilidad Gbins vol (i). Luego, observe que, para cualquier secuencia de precio-volumen S, si V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2. Esto implica un límite superior en RVWAP(A, Pvol) en términos de Gbins vol. Entonces obtenemos que Gbins vol (i) ∝ Pbins vol (i) minimiza el límite superior, lo que conduce al límite superior establecido en el teorema. Prueba. (Bosquejo del Teorema 11) Reemplace Pvol con ˜Pvol en la expresión de Gbins vol en el bosquejo de la prueba para el último resultado. 198 ",
            "candidates": [],
            "error": [
                [
                    "análisis competitivos",
                    "análisis competitivo"
                ]
            ]
        },
        "vwap": {
            "translated_key": "VWAP",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Competitive Algorithms for <br>vwap</br> and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "We provide an extensive study of competitive algorithms in these models and relate them to earlier online algorithms for stock trading.",
                "Categories and Subject Descriptors F.2 [Analysis of Algorithms and Problem Complexity]: Miscellaneous; J.4 [Social and Behavioral Sciences]: Economics General Terms Algorithms, Economics 1.",
                "INTRODUCTION While popular images of Wall Street often depict swashbuckling traders boldly making large gambles on just their market intuitions, the vast majority of trading is actually considerably more technical and constrained.",
                "The constraints often derive from a complex combination of business, regulatory and institutional issues, and result in certain kinds of standard trading strategies or criteria that invite algorithmic analysis.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or <br>vwap</br>, trading.",
                "Informally, the <br>vwap</br> of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In <br>vwap</br> trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the <br>vwap</br>.",
                "Very large institutional trades constitute one of the main motivations behind <br>vwap</br> activity.",
                "A typical scenario goes as follows.",
                "Suppose a very large mutual fund holds 3% of the outstanding shares of a large, publicly traded company - a huge fraction of the shares - and that this funds manager decides he would like to reduce this holding to 2% over a 1-month period. (Such a decision might be forced by the funds own regulations or other considerations.)",
                "Typically, such a fund manager would be unqualified to sell such a large number of shares in the open market - it requires a professional broker to intelligently break the trade up over time, and possibly over multiple exchanges, in order to minimize the market impact of such a sizable transaction.",
                "Thus, the fund manager would approach brokerages for help in selling the 1%.",
                "The brokerage will typically alleviate the fund managers problem immediately by simply buying the shares directly from the fund manager, and then selling them off laterbut what price should the brokerage pay the fund manager?",
                "Paying the price on the day of the sale is too risky for the brokerage, as they need to sell the shares themselves over an extended period, and events beyond their control (such as wars) could cause the price to fall dramatically.",
                "The usual answer is that the brokerage offers to buy the shares from the fund manager at a per-share price tied to the <br>vwap</br> over some future period - in our example, the brokerage might offer to buy the 1% at a per-share price of the coming months <br>vwap</br> minus 1 cent.",
                "The brokerage now has a very clean challenge: by selling the shares themselves over the next month in a way that exactly matches the <br>vwap</br>, a penny per share is earned in profits.",
                "If they can beat the <br>vwap</br> by a penny, they make two cents per share.",
                "Such small-margin, high-volume profits can be extremely lucrative for a large brokerage.",
                "The importance of the <br>vwap</br> has led to many automated <br>vwap</br> trading algorithms - indeed, every major brokerage has at least one VWAP box, 189 Price Volume Model Order Book Model Macroscopic Distribution Model OWT Θ(log(R)) (From[3]) O(log(R) log(N)) 2E(Pbins maxprice ) 2(1 + )E(Pbins maxprice ) for -approx of Pbins maxprice Θ(log(Q)) (same as above plus...) VWAP Θ(log(R)) O(log(R) log(N)) (from above) 2E(Pbins vol ) Ω(Q) fixed schedule O(log(Q)) for large N (1 + )2E(Pbins vol ) for -approx. of Pbins vol 1 for volume in [N, QN] Figure 1: The table summarizes the results presented in this paper.",
                "The rows represent results for either the OWT or <br>vwap</br> criterion.",
                "The columns represent which model we are working in.",
                "The entry in the table is the competitive ratio between our algorithm and an optimal algorithm, and the closer the ratio is to 1 the better.",
                "The parameter R represents a bound on the maximum to the minimum price fluctuation and the parameter Q represents a bound on the maximum to minimum volume fluctuation in the respective model. (See Section 4 for a description of the Macroscopic Distribution Model.)",
                "All the results for the OWT trading criterion (which is a stronger criterion) directly translate to the <br>vwap</br> criterion.",
                "However, in the <br>vwap</br> setting, considering a restriction on the maximum to the minimum volume fluctuation Q, leads to an additional class of results which depends on Q. and some small companies focus exclusively on proprietary <br>vwap</br> trading technology.",
                "In this paper, we provide the first study of <br>vwap</br> trading algorithms in an online, competitive ratio setting.",
                "We first formalize the <br>vwap</br> trading problem in a basic online model we call the price-volume model, which can be viewed as a generalization of previous theoretical online trading models incorporating market volume information.",
                "In this model, we provide <br>vwap</br> algorithms and competitive ratios, and compare this setting with the one-way trading (OWT) problem studied in [3].",
                "Our most interesting results, however, examine the <br>vwap</br> trading problem in a new online trading model capturing the important recent phenomenon of limit order books in financial markets.",
                "Briefly, a limit buy or sell order specifies both the number of shares and the desired price, and will only be executed if there is a matching party on the opposing side, according to a well-defined matching procedure used by all the major exchanges.",
                "While limit order books (the list of limit orders awaiting possible future execution) have existed since the dawn of equity exchanges, only very recently have these books become visible to traders in real time, thus opening the way to trading algorithms of all varieties that attempt to exploit this rich market microstructure data.",
                "Such data and algorithms are a topic of great current interest on Wall Street [4].",
                "We thus introduce a new online trading model incorporating limit order books, and examine both the one-way and <br>vwap</br> trading problems in it.",
                "Our results are summarized in Figure 1 (see the caption for a summary). 2.",
                "THEPRICE-VOLUMETRADINGMODEL We now present a trading model which includes both price and volume information about the sequence of trades.",
                "While this model is a generalization of previous formalisms for online trading, it makes an infinite liquidity assumption which fails to model the negative market impact that trading a large number of shares typically has.",
                "This will be addressed in the order book model studied in the next section.",
                "A note on terminology: throughout the paper (unless otherwise specified), we shall use the term market to describe all activity or orders other than those of the algorithm under consideration.",
                "The setting we consider can be viewed as a game between our algorithm and the market. 2.1 The Model In the price-volume trading model, we assume that the intraday trading activity in a given stock is summarized by a discrete sequence of price and volume pairs (pt, vt) for t = 1, . . . , T. Here t = 0 corresponds to the days market open, and t = T to the close.",
                "While there is nothing technically special about the time horizon of a single day, it is particularly consistent with limit order book trading on Wall Street.",
                "The pair (pt, vt) represents the fact that a total of vt shares were traded at an (average) price per share pt in the market between time t − 1 and t. Realistically, we should imagine the number of intervals T being reasonably large, so that it is sensible to assign a common approximate price to all shares traded within an interval.",
                "In the price-volume model, we shall make an infinite liquidity assumption for our trading algorithms.",
                "More precisely, in this online model, we see the price-volume sequence one pair at a time.",
                "Following the observation of (pt, vt), we are permitted to sell any (possibly fractional) number of shares nt at the price pt.",
                "Let us assume that our goal is to sell N shares over the course of the day.",
                "Hence, at each time, we must select a (possibly fractional) number of shares nt to sell at price pt, subject to the global constraint T t=1 nt = N. It is thus assumed that if we have left over shares to sell after time T − 1, we are forced to sell them at the closing price of the market - that is, nT = N − T −1 t=1 nt is sold at pT .",
                "In this way we are certain to sell exactly N shares over the course of the day; the only thing an algorithm must do is determine the schedule of selling based on the incoming market price-volume stream.",
                "Any algorithm which sells fractional volumes can be converted to a randomized algorithm which only sells integral volumes with the same expected number of shares sold.",
                "If we keep the hard constraint of selling exactly N shares, we might incur an additional slight loss in the conversion. (Note that we only allow fractional volumes in the price-volume model, where liquidity is not an issue.",
                "In the order book model to follow, we do not allow fractional volumes.)",
                "In <br>vwap</br> trading, the goal of an online algorithm A which sells exactly N shares is not to maximize profits per se, but to track the market <br>vwap</br>.",
                "The market <br>vwap</br> for an intraday trading sequence S = (p1, v1), . . . , (pT , vT ) is simply the average price paid per share over the course of the trading 190 day, ie VWAPM (S) = T t=1 ptvt /V where V is the total daily volume, i.e., V = T t=1 vt.",
                "If on the sequence S, the algorithm A sells its N stocks using the volume sequence n1, . . . nT , then we analogously define the <br>vwap</br> of A on market sequence S by VWAPA(S) = T t=1 ptnt /N .",
                "Note that the market <br>vwap</br> does not include the shares that the algorithm sells.",
                "The <br>vwap</br> competitive ratio of A with respect to a set of sequences Σ is then RVWAP(A) = max S∈Σ {VWAPM (S)/VWAPA(S)} In the case that A is randomized, we generalize the definition above by taking an expectation over VWAPA(S) inside the max.",
                "We note that unlike on Wall Street, our definition of VWAPM does not take our own trading into account.",
                "It is easy to see that this makes it a more challenging criterion to track.",
                "In contrast to the <br>vwap</br>, another common measure of the performance of an online selling algorithm would be its one-way trading (OWT) competitive ratio [3] with respect to a set of sequences Σ: ROWT(A) = max S∈Σ max 1≤t≤T {pt/VWAPA(S)} where the algorithms performance is compared to the largest individual price appearing in the sequence S. In both <br>vwap</br> and OWT, we are comparing the average price per share received by a selling algorithm to some measure of market performance.",
                "In the case of OWT, we compare to the rather ambitious benchmark of the high price of the day, ignoring volumes entirely.",
                "In <br>vwap</br> trading, we have the more modest goal of comparing favorably to the overall market average of the day.",
                "As we shall see, there are some important commonalities and differences to these two approaches.",
                "For now we note one simple fact: on any specific sequence S, VWAPA(S) may be larger that VWAPM (S).",
                "However, RVWAP(A) cannot be smaller than 1, since on any sequence S in which all price pt are identical, it is impossible to get a better average share per price.",
                "Thus, for all algorithms A, both RVWAP(A) and ROWT(A) are larger than 1, and the closer to 1 they are, the better A is tracking its respective performance measure. 2.2 <br>vwap</br> Results in the Price-Volume Model As in previous work on online trading, it is generally not possible to obtain finite bounds on competitive ratios with absolutely no assumptions on the set of sequences Σbounds on the maximum variation in price or volume are required, depending on the exact setting.",
                "We thus introduce the following two assumptions. 2.2.0.1 Volume Variability Assumption.. Let 0 < Vmin ≤ Vmax be known positive constants, and define Q = Vmax /Vmin .",
                "For all intraday trading sequences S ∈ Σ, the total daily volume V ∈ [Vmin , Vmax ]. 2.2.0.2 Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Competitive ratios are generally taken over all sets Σ consistent with at least one of these assumptions.",
                "To gain some intuition consider the two trivial cases of R = 1 and Q = 1.",
                "In the case of R = 1 (where there is no fluctuation in price), any schedule is optimal.",
                "In the case of Q = 1 (where the total volume V over the trading period is known), we can gain a competitive ratio of 1 by selling vt V N shares after each time period.",
                "For the OWT problem in the price-volume model, volumes are irrelevant for the performance criterion, but for the <br>vwap</br> criterion they are central.",
                "For the OWT problem under the price variability assumption, the results of [3] established that the optimal competitive ratio was Θ(log(R)).",
                "Our first result establishes that the optimal competitive ratio for <br>vwap</br> under the volume variability assumption is Θ(log(Q)) and is achieved by an algorithm that ignores the price data.",
                "Theorem 1.",
                "In the price-volume model under the volume variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) ≤ 2 log(Q).",
                "In addition, if only the volume variability (and not the price variability) assumption holds, any online algorithm A for selling N shares has RVWAP(A) = Ω(log(Q)).",
                "Proof. (Sketch) For the upper bound, the idea is similar to the price reservation algorithm of [3] for the OWT problem, and similar in spirit to the general technique of classify and select [1].",
                "Consider algorithms which use a parameter ˆV , which is interpreted as an estimate for the total volume for the day.",
                "Then at each time t, if the market price and volume is (pt, vt), the algorithm sells a fraction vt/ ˆV of its shares.",
                "We consider a family of log(Q) such algorithms, where algorithm Ai uses ˆV = Vmin 2i−1 .",
                "Clearly, one of the Ai has a competitive ratio of 2.",
                "We can derive an O(log(Q)) <br>vwap</br> competitive ratio by running these algorithms in parallel, and letting each algorithm sell N/ log(Q) shares. (Alternatively, we can randomly select one Ai and guarantee the same expected competitive ratio.)",
                "We now sketch the proof of the lower bound, which relates performance in the <br>vwap</br> and OWT problems.",
                "Any algorithm that is c-competitive in the <br>vwap</br> setting (under fixed Q) is 3c-competitive in the OWT setting with R = Q/2.",
                "To show this, we take any sequence S of prices for the OWT problem, and convert it into a price-volume sequence for the <br>vwap</br> problem.",
                "The prices in the <br>vwap</br> sequence are the same as in S. To construct the volumes in the <br>vwap</br> sequence, we segment the prices in S into log(R) intervals [2i−1 pmin , 2i pmin ).",
                "Suppose pt ∈ [2i−1 pmin , 2i pmin ), and this is the first time in S that a price has fallen in this interval.",
                "Then in the <br>vwap</br> sequence we set the volume vt = 2i−1 .",
                "If this is not the first visit to the interval containing pt, we set vt = 0.",
                "Assume that the maximum price in S is pmax .",
                "The <br>vwap</br> of our sequence is at least pmax /3.",
                "Since we had a c competitive algorithm, its average sell is at least pmax /3c.",
                "The lower bound now follows using the lower bound in [3].",
                "An alternative approach to <br>vwap</br> is to ignore the volumes in favor of prices, and apply an algorithm for the OWT problem.",
                "Note that the lower bound in this theorem, unlike in the previous one, only assumes a price variation bound. 191 Theorem 2.",
                "In the price-volume model under the price variability assumption, there exists an online algorithm A for selling N shares achieving competitive ratio RVWAP(A) = O(log(R)).",
                "In addition, if only the price variability (and not the volume variability) assumption holds, any online A for selling N shares has RVWAP(A) = Ω(log(R)).",
                "Proof. (Sketch) Follows immediately from the results of [3] for OWT: the upper bound from the simple fact that for any sequence S, VWAPA(S) is less than max1≤t≤T {pt}, and the lower bound from a reduction to OWT.",
                "Theorems 1 and 2 demonstrate that one can achieve logarithmic <br>vwap</br> competitive ratios under the assumption of either bounded variability of total volume or bounded variability of maximum price.",
                "If both assumptions hold, it is possible to give an algorithm accomplishing the minimum of log(Q) and log(R).",
                "This flexibility of approach derives from the fact that the <br>vwap</br> is a quantity in which both prices and volumes matter, as opposed to OWT. 2.3 RelatedResultsinthePrice-VolumeModel All of the <br>vwap</br> algorithms we have discussed so far make some use of the daily data (pt, vt) as it unfolds, using either the price or volume information.",
                "In contrast, a fixed schedule <br>vwap</br> algorithm has a predetermined distribution {f1, f2, . . . fT }, and simply sells ftN shares at time t, independent of (pt, vt).",
                "Fixed schedule <br>vwap</br> algorithms, or slight variants of them, are surprisingly common on Wall Street, and the schedule is usually derived from historical intraday volume data.",
                "Our next result demonstrates that such algorithms can perform considerably worse than dynamically adaptive algorithms in terms of the worst case competitive ratio.",
                "Theorem 3.",
                "In the price-volume model under both the volume and price variability assumptions, any fixed schedule <br>vwap</br> algorithm A for selling N shares has sell <br>vwap</br> competitive ratio RVWAP(A) = Ω(min(T, R)).",
                "The proofs of all the results in this subsection are in the Appendix.",
                "So far our emphasis has been on <br>vwap</br> algorithms that must sell exactly N shares.",
                "In many realistic circumstances, however, there is actually some flexibility in the precise number of shares to be sold.",
                "For instance, this is true at large brokerages, where many separate <br>vwap</br> trades may be pooled and executed by a common algorithm, and the firm would be quite willing to carry a small position of unsold shares overnight if it resulted in better execution prices.",
                "The following theorem (which interestingly has no analogue for the OWT problem) demonstrates that this trade-off in shares sold and performance can be realized dramatically in our model.",
                "It states that if we are willing to let the number of shares sold vary with Q, we can in fact achieve a <br>vwap</br> competitive ratio of 1.",
                "Theorem 4.",
                "In the price-volume model under the volume variability assumption, there exists an algorithm A that always sells between N and QN shares and that the average price per sold share is exactly VWAPM (S).",
                "In many online problems, there is a clear distinction between benefit problems and cost problems [2].",
                "In the <br>vwap</br> setting, selling shares is a benefit problem, and buying shares is a cost problem.",
                "The definitions of the competitive ratios, Rbuy <br>vwap</br>(A) and Rbuy OWT(A), for algorithms which Figure 2: Sample Island order books for MSFT. buy exactly N shares are maxS∈Σ{VWAPA(S)/VWAPM (S)} and maxS∈Σ maxt{VWAPA(S)/pt} respectively.",
                "Eventhough Theorem 4 also holds for buying, in general, the competitive ratio of the buy (cost) problem is much higher, as stated in the following theorem.",
                "Theorem 5.",
                "In the price-volume model under the volume and price variability assumptions, there exists an online algorithm A for buying N shares achieving buy <br>vwap</br> competitive ratio Rbuy <br>vwap</br>(A) = O(min{Q, √ R}).",
                "In addition any online algorithm A for buying N shares has buy <br>vwap</br> competitive ratio Rbuy <br>vwap</br>(A) = Ω(min{Q, √ R}). 3.",
                "A LIMIT ORDER BOOK TRADING MODEL Before we can define our online trading model based on limit order books, we give some necessary background on the detailed mechanics of financial markets, which are sometimes referred to as market microstructure.",
                "We then provide results and algorithms for both the OWT and <br>vwap</br> problems. 192 3.1 Background on Limit Order Books and Market Microstructure A fundamental distinction in stock trading is that between a limit order and a market order.",
                "Suppose we wish to purchase 1000 shares of Microsoft (MSFT) stock.",
                "In a limit order, we specify not only the desired volume (1000 shares), but also the desired price.",
                "Suppose that MSFT is currently trading at roughly $24.07 a share (see Figure 2, which shows an actual snapshot of a recent MSFT order book on Island (www.island.com), a well-known electronic exchange for NASDAQ stocks), but we are only willing to buy the 1000 shares at $24.04 a share or lower.",
                "We can choose to submit a limit order with this specification, and our order will be placed in a queue called the buy order book, which is ordered by price, with the highest offered unexecuted buy price at the top (often referred to as the bid).",
                "If there are multiple limit orders at the same price, they are ordered by time of arrival (with older orders higher in the book).",
                "In the example provided by Figure 2, our order would be placed immediately after the extant order for 5,503 shares at $24.04; though we offer the same price, this order has arrived before ours.",
                "Similarly, a sell order book for sell limit orders (for instance, we might want to sell 500 shares of MSFT at $24.10 or higher) is maintained, this time with the lowest sell price offered (often referred to as the ask).",
                "Thus, the order books are sorted from the most competitive limit orders at the top (high buy prices and low sell prices) down to less competitive limit orders.",
                "The bid and ask prices (which again, are simply the prices in the limit orders at the top of the buy and sell books, respectively) together are sometimes referred to as the inside market, and the difference between them as the spread.",
                "By definition, the order books always consist exclusively of unexecuted orders - they are queues of orders hopefully waiting for the price to move in their direction.",
                "How then do orders get executed?",
                "There are two methods.",
                "First, any time a market order arrives, it is immediately matched with the most competitive limit orders on the opposing book.",
                "Thus, a market order to buy 2000 shares is matched with enough volume on the sell order book to fill the 2000 shares.",
                "For instance, in the example of Figure 2, such an order would be filled by the two limit sell orders for 500 shares at $24.069, the 500 shares at $24.07, the 200 shares at $24.08, and then 300 of the 1981 shares at $24.09.",
                "The remaining 1681 shares of this last limit order would remain as the new top of the sell limit order book.",
                "Second, if a buy (sell, respectively) limit order comes in above the ask (below the bid, respectively) price, then the order is matched with orders on the opposing books.",
                "It is important to note that the prices of executions are the prices specified in the limit orders already in the books, not the prices of the incoming order that is immediately executed.",
                "Every market or limit order arrives atomically and instantaneously - there is a strict temporal sequence in which orders arrive, and two orders can never arrive simultaneously.",
                "This gives rise to the definition of the last price of the exchange, which is simply the last price at which the exchange executed an order.",
                "It is this quantity that is usually meant when people casually refer to the (ticker) price of a stock.",
                "Note that a limit buy (sell, respectively) order with a price of infinity (0, respectively) is effectively a market order.",
                "We shall thus assume without loss of generality that all orders are placed as limit order.",
                "Although limit orders which are unexecuted may be removed by the party which placed them, for simplicity, we assume that limit orders are never removed from the books.",
                "We refer the reader to [4] for further discussion of modern electronic exchanges and market microstructure. 3.2 The Model The online order book trading model is intended to capture the realistic details of market microstructure just discussed in a competitive ratio setting.",
                "In this refined model, a days market activity is described by a sequence of limit orders (pt, vt, bt).",
                "Here bt is a bit indicating whether the order is a buy or sell order, while pt is the limit order price and vt the number of shares desired.",
                "Following the arrival of each such limit order, an online trading algorithm is permitted to place its own limit order.",
                "These two interleaved sources (market and algorithm) of limit orders are then simply operated on according to the matching process described in Section 3.1.",
                "Any limit order that is not immediately executable according to this process is placed in the appropriate (buy or sell) book for possible future execution; arriving orders that can be partially or fully executed are so executed, with any residual shares remaining on the respective book.",
                "The goal of a <br>vwap</br> or OWT selling algorithm is essentially the same as in the price-volume model, but the context has changed in the following two fundamental ways.",
                "First, the assumption of infinite liquidity in the price-volume model is eliminated entirely.",
                "The number of shares available at any given price is restricted to the total volume of limit orders offering that price.",
                "Second, all incoming orders, and therefore the complete limit order books, are assumed to be visible to the algorithm.",
                "This is consistent with modern electronic financial exchanges, and indeed is the source of much current interest on Wall Street [4].",
                "In general, the definition of competitive ratios in the order book model is complicated by the fact that now our algorithms activity influences the sequence of executed prices and volumes.",
                "We thus first define the execution sequence determined by a limit order sequence (placed by the market and our algorithm).",
                "Let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by the market, and let S = (p1, v1, b1), . . . , (pT , vT , bT ) be a limit order sequence placed by our algorithm (unless otherwise specified, all bt are of the sell type).",
                "Let merge(S, S ) be the merged sequence (p1, v1, b1), (p1, v1, b1), . . . , (pT , vT , bT ), (pT , vT , bT ), which is the time sequence of orders placed by the market and algorithm.",
                "Note that the algorithm has the option of not placing an order, which we can view as a zero volume order.",
                "If we conducted the order book maintenance and order execution process described in Section 3.1 on the sequence merge(S, S ), at irregular intervals a trade occurs for some number of shares and some price.",
                "In each executed trade, the selling party is either the market or the algorithm.",
                "Let execM (S, S ) = (q1, w1), . . . , (qT , wT ) be the sequence of executions where the market (that is, a party other than the algorithm) was the selling party, where the qt are the execution prices and wt the execution volumes.",
                "Similarly, we define execA(S, S ) = (r1, x1), . . . , (rT , xT ) to be the sequence of executions in which the algorithm was the selling party.",
                "Thus, execA(S, S ) ∪ execM (S, S ) is the set of all executions.",
                "We generally expect T to be (possibly much) smaller than T .",
                "The revenue of the algorithm and the market are defined 193 as: REVM (S, S ) ≡ T t=1 qtwt , REVA(S, S ) ≡ T t=1 rtxt Note that both these quantities are solely determined by the execution sequences execM (S, S ) and execA(S, S ), respectively.",
                "For an algorithm A which is constrained to sell exactly N shares, we define the OWT competitive ratio of A, ROWT(A), as the maximum ratio (under any S ∈ Σ) of the revenue obtained by A, as compared to the revenue obtained by an optimal oﬄine algorithm A∗ .",
                "More formally, for A∗ which is constrained to sell exactly N shares, we define ROWT(A) = max S∈Σ max A∗ REVA∗ (S S∗ ) REVA(S, S ) where S∗ is the limit order sequence placed by A∗ on S. If the algorithm A is randomized then we take the appropriate expectation with respect to S ∼ A.",
                "We define the <br>vwap</br> competitive ratio, RVWAP(A), as the maximum ratio (under any S ∈ Σ) between the market and algorithm VWAPs.",
                "More formally, define VWAPM (S, S ) as REVM (S, S )/ T t=1 wt, where the denominator is just the total executed volume of orders placed by the market.",
                "Similarly, we define VWAPA(S, S ) as REVA(S, S )/N, since we assume the algorithm sells no more than N shares (this definition implicitly assumes that A gets a 0 price for unsold shares).",
                "The <br>vwap</br> competitive ratio of A is then: RVWAP(A) = max S∈Σ {VWAPM (S, S )/VWAPA(S, S )} where S is the online sequence of limit orders generated by A in response to the sequence S. 3.3 OWT Results in the Order Book Model For the OWT problem in the order book model, we introduce a more subtle version of the price variability assumption.",
                "This is due to the fact that our algorithms trading can impact the high and low prices of the day.",
                "For the assumption below, note that execM (S, ∅) is the sequence of executions without the interaction of our algorithm. 3.3.0.3 Order Book Price Variability Assumption.. Let 0 < pmin ≤ pmax be known positive constants, and define R = pmax/pmin.",
                "For all intraday trading sequences S ∈ Σ, the prices pt in the sequence execM (S, ∅) satisfy pt ∈ [pmin, pmax], for all t = 1, . . . , T. Note that this assumption does not imply that the ratios of high to low prices under the sequences execM (S, S ) or execA(S, S ) are bounded by R. In fact, the ratio in the sequence execA(S, S ) could be infinite if the algorithm ends up selling some stocks at a 0 price.",
                "Theorem 6.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell OWT competitive ratio ROWT(A) = 2 log(R) log(N).",
                "Proof.",
                "The algorithm A works by guessing a price p in the set {pmin2i : 1 ≤ i ≤ log(R)} and placing a sell limit order for all N shares at the price p at the beginning of the day. (Alternatively, algorithm A can place log(R) sell limit orders, where the i-th one has price 2i pmin and volume N/ log(R).)",
                "By placing an order at the beginning of the day, the algorithm undercuts all sell orders that will be placed during the day for a price of p or higher, meaning the algorithms N shares must be filled first at this price.",
                "Hence, if there were k shares that would have been sold at price p or higher without our activity, then A would sell at least kp shares.",
                "We define {pj} to be the multiset of prices of individual shares that are either executed or are buy limit order shares that remained unexecuted, excluding the activity of our algorithm (that is, assuming our algorithm places no orders).",
                "Assume without loss of generality that p1 ≥ p2 ≥ . . ..",
                "Consider guessing the kth highest such price, pk.",
                "If an order for N shares is placed at the days start at price pk, then we are guaranteed to obtain a return of kpk.",
                "Let k∗ = argmaxk{kpk}.",
                "We can view our algorithm as attempting to guess pk∗ , and succeeding if the guess p satisfies p ∈ [pk∗ /2, pk∗ ].",
                "Hence, we are 2 log(R) competitive with the quantity max1≤k≤N kpk.",
                "Note that ρ ≡ N i=1 pi = N i=1 1 i ipi ≤ max 1≤k≤N kpk N i=1 1 i ≤ log(N) max 1≤k≤N kpk where ρ is defined as the sum of the top N prices pi without As involvement.",
                "Similarly, let {pj} be the multiset of prices of individual executed shares, or the prices of unexecuted buy order shares, but now including the orders placed by some selling algorithm A .",
                "We now wish to show that for all algorithms A which sell N shares, REVA ≤ N i=1 pi ≤ ρ.",
                "Essentially, this inequality states the intuitive idea that a selling algorithm can only lower executed or unmatched buy order share prices.",
                "To prove this, we use induction to show that the removal of the activity of a selling algorithm causes these prices to increase.",
                "First, remove the last share in the last sell order placed by either A or the market on an arbitrary sequence merge(S, S ) - by this we mean, take the last sell order placed by A or the market and decrease its volume by one share.",
                "After this modification, the top N prices p1 . . . pN will not decrease.",
                "This is because either this sell order share was not executed, in which case the claim is trivially true, or, if it was executed, the removal of this sell order share leaves an additional unexecuted buy order share of equal or higher price.",
                "For induction, assume that if we remove a share from any sell order that was placed, by A or the market, at or after time t then the top N prices do not decrease.",
                "We now show that if we remove a share from the last sell order that was placed by A or the market before time t, then the top N prices do not decrease.",
                "If this sell order share was not executed, then the claim is trivially true.",
                "Else, if the sell order share was executed, then claim is true because by removing this executed share from the sell order either: i) the corresponding buy order share (of equal or higher value) is unmatched on the remainder of the sequence, in which case the claim is true; or ii) this buy 194 order matches some sell order share at an equal or higher price, which has the effect of removing a share from a sell order on the remainder of the sequence, and, by the inductive assumption, this can only increase prices.",
                "Hence, we have proven that for all A which sell N shares REVA ≤ ρ.",
                "We have now established that our revenue satisfies 2 log(R)ES ∼A[REVA(S, S )] ≥ max 1≤k≤N {kpk} ≥ ρ/ log(N) ≥ max A {REVA }/ log(N), where A performs an arbitrary sequence of N sell limit orders. 3.4 <br>vwap</br> Results in the Order Book Model The OWT algorithm from Theorem 6 can be applied to obtain the following <br>vwap</br> result: Corollary 7.",
                "In the order book model under the order book price variability assumption, there exists an online algorithm A for selling N shares achieving sell <br>vwap</br> competitive ratio RVWAP(A) = O(log(R) log(N)).",
                "We now make a rather different assumption on the sequences S. 3.4.0.4 Bounded Order Volume and Max Price Assumption.",
                "The set of sequences Σ satisfies the following two properties.",
                "First, we assume that each order placed by the market is of volume less than γ, which we view as a mild assumption since typically single orders on the market are not of high volume (due to liquidity issues).",
                "This assumption allows our algorithm to place at least one limit order at a time interleaved with approximately γ market executions.",
                "Second, we assume that there is large volume in the sell order books below the price pmax , which means that no orders placed by the market will be executed above the price pmax .",
                "The simplest way to instantiate this latter assumption in the order book model is to assume that each sequence S ∈ Σ starts by placing a huge number of sell orders (more than Vmax ) at price pmax .",
                "Although this assumption has a maximum price parameter, it does not imply that the price ratio R is finite, since it does not imply any lower bound on the prices of buy or executed shares (aside from the trivial one of 0).",
                "Theorem 8.",
                "Consider the order book model under the bounded order volume and max price assumption.",
                "There exists an algorithm A in which after exactly γN market executions have occurred, then A has sold at most N shares and REVA(S, S ) N = VWAPA(S, S ) ≥ (1 − )VWAPM (S, S ) − pmax N where S is a sequence of N sell limit orders generated by A when observing S. Proof.",
                "The algorithm divides the trading day into volume intervals whose real-time duration may vary.",
                "For each period i in which γ shares have been executed in the market, the algorithm computes the market <br>vwap</br> of only those shares traded in period i; let us denote this by VWAPi.",
                "Following this ith volume interval, the algorithm places a limit order to sell exactly one share at a price close to VWAPi.",
                "More precisely, the algorithm only places orders at the discrete prices (1− )pmax , (1− )2 pmax , . . ..",
                "Following volume interval i, the algorithm places a limit order to sell one share at the discretized price that is closest to VWAPi, but which is strictly smaller.",
                "For the analysis, we begin by noting that if all of the algorithms limit orders are executed during the day, the total revenue received by the algorithm would be at least (1 − )VWAPM (S, S )N. To see this, it suffices to note that VWAPM (S, S ) is a uniform mixture of the VWAPi (since by definition they each cover the same amount of market volume); and if all the algorithms limit orders were executed, they each received more than (1 − )VWAPi dollars for the interval i they followed.",
                "We now count the potential lost revenue of the algorithm due to unexecuted limit orders.",
                "By the assumption that individual orders are placed with volume less than γ, then our algorithm is able to place a limit order during every block of γ shares have been traded.",
                "Hence, after γN market orders have been executed, A has placed N orders in the market.",
                "Note that there can be at most one limit order (and thus, at most one share) left unexecuted at each level of the discretized price ladder defined above.",
                "This is because following interval i, the algorithm places its limit order strictly below VWAPi, so if VWAPj ≥ VWAPi for j > i, this limit order must have been executed.",
                "Thus unexecuted limit orders bound the VWAPs of the remainder of the day, resulting in at most one unexecuted order per price level.",
                "A bound on the lost revenue is thus the sum of the discretized prices: ∞ i=1(1 − )i pmax ≤ pmax / .",
                "Clearly our algorithm has sold at most N shares.",
                "Note that as N becomes large, VWAPA approaches 1 − times the market <br>vwap</br>.",
                "If we knew that the final total volume of the market executions is V , then we can set γ = V/N, assuming that γ >> 1.",
                "If we have only an upper and lower bound on V we should be able to guess and incur a logarithmic loss.",
                "The following assumption tries to capture the market volume variability. 3.4.0.5 Order Book Volume Variability Assumption.",
                "We now assume that the total volume (which includes the shares executed by both our algorithm and the market) is variable within some known region and that the market volume will be greater than our algorithms volume.",
                "More formally, for all S ∈ Σ, assume that the total volume V of shares traded in execM (S, S ), for any sequence S of N sell limit orders, satisfies 2N ≤ Vmin ≤ V ≤ Vmax .",
                "Let Q = Vmax /Vmin .",
                "The following corollary is derived using a constant = 1/2 and observing that if we set γ such that V ≤ γN ≤ 2V then our algorithm will place between N and N/2 limit orders.",
                "Corollary 9.",
                "In the order book model, if the bounded order volume and max price assumption, and the order book volume variability assumption hold, there exists an online algorithm A for selling at most N shares such that VWAPA(S, S ) ≥ 1 4 log(Q) VWAPM (S, S ) − 2pmax N 195 0 2 4 6 8 x 10 7 0 20 40 60 80 100 QQQ: log(Q)=4.71, E=3.77 0 2 4 6 8 10 x 10 6 0 20 40 60 80 JNPR: log(Q)=5.66, E=3.97 0 0.5 1 1.5 2 x 10 6 0 10 20 30 40 50 60 70 MCHP: log(Q)=5.28, E=3.86 0 2 4 6 8 10 x 10 6 0 50 100 150 200 250 CHKP: log(Q)=6.56, E=4.50 Figure 3: Here we present bounds from Section 4 based on the empirical volume distributions for four real stocks: QQQ, MCHP, JNPR, and CHKP.",
                "The plots show histograms for the total daily volumes transacted on Island for these stocks, in the last year and a half, along with the corresponding values of log(Q) and E(Pbins vol ) (denoted by E).",
                "We assume that the minimum and maximum daily volumes in the data correspond to Vmin and Vmax , respectively.",
                "The worst-case competitive ratio bounds (which are twice log(Q)) of our algorithm for those stocks are 9.42, 10.56, 11.32, and 13.20, respectively.",
                "The corresponding bounds on the competitive ratio performance of our algorithm under the volume distribution model (which are twice E(Pbins vol )) are better: 7.54, 7.72, 7.94, and 9.00, respectively (a 20−40% relative improvement).",
                "Using a finer volume binning along with a slightly more refined bound on the competitive ratio, we can construct algorithms that, using the empirical volume distribution given as correct, guarantee even better competitive ratios of 2.76, 2.73, 2.75, and 3.17, respectively for those stocks (details omitted). 4.",
                "MACROSCOPIC DISTRIBUTION MODELS We conclude our results with a return to the price-volume model, where we shall introduce some refined methods of analysis for online trading algorithms.",
                "We leave the generalization of these methods to the order book model for future work.",
                "The competitive ratios defined so far measure performance relative to some baseline criterion in the worst case over all market sequences S ∈ Σ.",
                "It has been observed in many online settings that such worst-case metrics can yield pessimistic results, and various relaxations have been considered, such as permitting a probability distribution over the input sequence.",
                "We now consider distributional models that are considerably weaker than assuming a distribution over complete market sequences S ∈ Σ.",
                "In the volume distribution model, we assume only that there exists a distribution Pvol over the total volume V traded in the market for the day, and then examine the worst-case competitive ratio over sequences consistent with the randomly chosen volume.",
                "More precisely, we define RVWAP(A, Pvol ) = EV ∼Pvol max S∈seq(V ) VWAPM (S) VWAPA(S) .",
                "Here V ∼ Pvol denotes that V is chosen with respect to distribution Pvol , and seq(V ) ⊂ Σ is the set of all market sequences (p1, v1), . . . , (pT , vT ) satisfying T t=1 vt = V .",
                "Similarly, for OWT, we can define ROWT(A, Pmaxprice ) = Ep∼Pmaxprice max S∈seq(p) p VWAPA(S) .",
                "Here Pmaxprice is a distribution over just the maximum price of the day, and we then examine worst-case sequences consistent with this price (seq(p) ⊂ Σ is the set of all market sequences satisfying max1≤t≤T pt = p).",
                "Analogous buy-side definitions can be given.",
                "We emphasize that in these models, only the distribution of maximum volume and price is known to the algorithm.",
                "We also note that our probabilistic assumptions on S are considerably weaker than typical statistical finance models, which would posit a detailed stochastic model for the step-by-step evolution of (pt, vt).",
                "Here we instead permit only a distribution over crude, macroscopic measures of the entire days market activity, such as the total volume and high price, and analyze the worst-case performance consistent with these crude measures.",
                "For this reason, we refer to such settings as the macroscopic distribution model.",
                "The work of El-Yaniv et al. [3] examines distributional assumptions similar to ours, but they emphasize the worst196 case choices for the distributions as well, and show that this leads to results no better than the original worst-case analysis over all sequences.",
                "In contrast, we feel that the analysis of specific distributions Pvol and Pmaxprice is natural in many financial contexts and our preliminary experimental results show significant improvements when this rather crude distributional information is taken into account (see Figure 3).",
                "Our results in the <br>vwap</br> setting examine the cases where these distributions are known exactly or only approximately.",
                "Similar results can be obtained for macroscopic distributions of maximum daily price for the one-way trading setting. 4.1 Results in the Macroscopic Distribution Model We begin by noting that the algorithms examined so far work by binning total volumes or maximum prices into bins of exponentially increasing size, and then guessing the index of the bin in which the actual quantity falls.",
                "It is thus natural that the macroscopic distribution model performance of such algorithms (which are common in competitive analysis) might depend on the distribution of the true bin index.",
                "In the remaining, we assume that Q is a power of 2 and the base of the logarithm is 2.",
                "Let Pvol denote the distribution of total daily market volume.",
                "We define the related distribution Pbins vol over bin indices i as follows: for all i = 1, . . . , log(Q) − 1, Pbins vol (i) is equal to the probability, under Pvol , that the daily volume falls in the interval [Vmin 2i−1 , Vmin 2i ), and Pbins vol (log(Q)) is for the last interval [Vmax /2, Vmax ] .",
                "We define E as E(Pbins vol ) ≡ Ei∼P bins vol 1/Pbins vol (i) 2 =   log(Q) i=1 Pbins vol (i)   2 .",
                "Since the support of Pbins vol has only log(Q) elements, E(Pbins vol ) can vary from 1 (for distributions Pvol that place all of their weight in only one of the log(Q) intervals between Vmin , Vmin 2, Vmin 4, . . . , Vmax ) to log(Q) (for distributions Pvol in which the total daily volume is equally likely to fall in any one of these intervals).",
                "Note that distributions Pvol of this latter type are far from uniform over the entire range [Vmin , Vmax ].",
                "Theorem 10.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that, using only knowledge of the total volume distribution Pvol , achieves RVWAP(A, Pvol ) ≤ 2E(Pbins vol ).",
                "All proofs in this section are provided in the appendix.",
                "As a concrete example, consider the case in which Pvol is the uniform distribution over [Vmin , Vmax ].",
                "In that case, Pbins vol is exponentially increasing and peaks at the last bin, which, having the largest width, also has the largest weight.",
                "In this case E(Pbins vol ) is a constant (i.e., independent of Q), leading to a constant competitive ratio.",
                "On the other hand, if Pvol is exponential, then Pbins vol is uniform, leading to an O(log(Q)) competitive ratio, just as in the more adversarial price-volume setting discussed earlier.",
                "In Figure 3, we provide additional specific bounds obtained for empirical total daily volume distributions computed for some real stocks.",
                "We now examine the setting in which Pvol is unknown, but an approximation ˜Pvol is available.",
                "Let us define C(Pbins vol , ˜Pbins vol ) = log(Q) j=1 ˜Pbins vol (j) log(Q) i=1 P bins vol (i) √ ˜P bins vol (i) .",
                "C is minimized at C(Pbins vol , Pbins vol ) = E(Pbins vol ), and C may be infinite if ˜Pbins vol (i) is 0 when Pbins vol (i) > 0.",
                "Theorem 11.",
                "In the volume distribution model under the volume variability assumption, there exists an online algorithm A for selling N shares that using only knowledge of an approximation ˜Pvol of Pvol achieves RVWAP(A, Pvol ) ≤ 2C(Pbins vol , ˜Pbins vol ).",
                "As an example of this result, suppose our approximation obeys (1/α)Pbins vol (i) ≤ ˜Pbins vol (i) ≤ αPbins vol (i) for all i, for some α > 1.",
                "Thus our estimated bin index probabilities are all within a factor of α of the truth.",
                "Then it is easy to show that C(Pbins vol , ˜Pbins vol ) ≤ αE(Pbins vol ), so according to Theorems 10 and 11 our penalty for using the approximate distribution is a factor of α in competitive ratio. 5.",
                "REFERENCES [1] B. Awerbuch, Y. Bartal, A. Fiat, and A. Ros´en.",
                "Competitive non-preemptive call control.",
                "In Proc. 5th ACM-SIAM Symp. on Discrete Algorithms, pages 312-320, 1994. [2] A. Borodin and R. El-Yaniv.",
                "Online Computation and Competitive Analysis.",
                "Cambridge University Press, 1998. [3] R. El-Yaniv, A. Fiat, R. M. Karp, and G. Turpin.",
                "Optimal search and one-way trading online algorithms.",
                "Algorithmica, 30:101-139, 2001. [4] M. Kearns and L. Ortiz.",
                "The Penn-Lehman automated trading project.",
                "IEEE Intelligent Systems, 2003.",
                "To appear. 6.",
                "APPENDIX 6.1 Proofs from Subsection 2.3 Proof. (Sketch of Theorem 3) W.l.o.g., assume that Q = 1 and the total volume is V .",
                "Consider the time t where the fixed schedule f sells the least, then ft ≤ N/T.",
                "Consider the sequences where at time t we have pt = pmax , vt = V , and for times t = t we have pt = pmin and vt = 0.",
                "The <br>vwap</br> is pmax and the fixed schedule average is (N/T)pmax + (N − N/T)pmin .",
                "Proof. (Sketch of Theorem 4) The algorithm simply sells ut = (vt/Vmin )N shares at time t. The total number of shares sold U is clearly more than N and U = t ut = t (vt/Vmin )N = (V/Vmin )N ≤ QN The average price is V WAPA(S) = ( t ptut)/U = t pt(vt/V ) = V WAPM (S), where we used the fact that ut/U = vt/V . 197 Proof. (of Theorem 5) We start with the proof of the lower bound.",
                "Consider the following scenario.",
                "For the first T time units we have a price of √ Rpmin , and a total volume of Vmin .",
                "We observe how many shares the online algorithm has bought.",
                "If it has bought more than half of the shares, the remaining time steps have price pmin and volume Vmax − Vmin .",
                "Otherwise, the remaining time steps have price pmax and negligible volume.",
                "In the first case the online has paid at least √ Rpmin /2 while the <br>vwap</br> is at most √ Rpmin /Q + pmin .",
                "Therefore, in this case the competitive ratio is Ω(Q).",
                "In the second case the online has to buy at least half of the shares at pmax , so its average cost is at least pmax /2.",
                "The market <br>vwap</br> is√ Rpmin = pmax / √ R, hence the competitive ratio is Ω( √ R).",
                "For the upper bound, we can get a √ R competitive ratio, by buying all the shares once the price drops below √ Rpmin .",
                "The Q upper bound is derive by running an algorithm that assumes the volume is Vmin .",
                "The online pays a cost of p, while the <br>vwap</br> will be at least p/Q. 6.2 Proofs from Section 4 Proof. (Sketch of Theorem 10) We use the idea of guessing the total volume from Theorem 1, but now allow for the possibility of an arbitrary (but known) distribution over the total volume.",
                "In particular, consider constructing a distribution Gbins vol over a set of volume values using Pvol and use it to guess the total volume V .",
                "Let the algorithm guess ˆV = Vmin 2i with probability Gbins vol (i).",
                "Then note that, for any price-volume sequence S, if V ∈ [Vmin 2i−1 , Vmin 2i ], VWAPA(S) ≥ Gbins vol (i)VWAPM (S)/2.",
                "This implies an upper bound on RVWAP(A, Pvol ) in terms of Gbins vol .",
                "We then get that Gbins vol (i) ∝ Pbins vol (i) minimizes the upper bound, which leads to the upper bound stated in the theorem.",
                "Proof. (Sketch of Theorem 11) Replace Pvol with ˜Pvol in the expression for Gbins vol in the proof sketch for the last result. 198"
            ],
            "original_annotated_samples": [
                "Competitive Algorithms for <br>vwap</br> and Limit Order Trading Sham M. Kakade Computer and Information Science University of Pennsylvania kakade@linc.cis.upenn.edu Michael Kearns Computer and Information Science University of Pennsylvania mkearns@cis.upenn.edu Yishay Mansour Computer Science Tel Aviv University mansour@post.tau.ac.il Luis E. Ortiz Computer and Information Science University of Pennsylvania leortiz@linc.cis.upenn.edu ABSTRACT We introduce new online models for two important aspects of modern financial markets: Volume Weighted Average Price trading and limit order books.",
                "One of the most common activities in modern financial markets is known as Volume Weighted Average Price, or <br>vwap</br>, trading.",
                "Informally, the <br>vwap</br> of a stock over a specified market period is simply the average price paid per share during that period, so the price of each transaction in the market is weighted by its volume.",
                "In <br>vwap</br> trading, one attempts to buy or sell a fixed number of shares at a price that closely tracks the <br>vwap</br>.",
                "Very large institutional trades constitute one of the main motivations behind <br>vwap</br> activity."
            ],
            "translated_annotated_samples": [
                "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de <br>Precio Promedio Ponderado por Volumen</br> y los libros de órdenes límite.",
                "Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de <br>Precio Promedio Ponderado por Volumen</br>, o VWAP.",
                "Informalmente, el <br>VWAP</br> de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen.",
                "En el trading de <br>VWAP</br>, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el <br>VWAP</br>.",
                "Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de <br>VWAP</br>."
            ],
            "translated_text": "Algoritmos competitivos para VWAP y trading de órdenes límite Sham M. Kakade Ciencias de la Computación e Informática Universidad de Pensilvania kakade@linc.cis.upenn.edu Michael Kearns Ciencias de la Computación e Informática Universidad de Pensilvania mkearns@cis.upenn.edu Yishay Mansour Ciencias de la Computación Universidad de Tel Aviv mansour@post.tau.ac.il Luis E. Ortiz Ciencias de la Computación e Informática Universidad de Pensilvania leortiz@linc.cis.upenn.edu RESUMEN Introducimos nuevos modelos en línea para dos aspectos importantes de los mercados financieros modernos: el trading de <br>Precio Promedio Ponderado por Volumen</br> y los libros de órdenes límite. Proporcionamos un estudio exhaustivo de algoritmos competitivos en estos modelos y los relacionamos con algoritmos en línea anteriores para el comercio de acciones. Categorías y Descriptores de Asignaturas F.2 [Análisis de Algoritmos y Complejidad de Problemas]: Varios; J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Algoritmos, Economía 1. INTRODUCCIÓN Si bien las imágenes populares de Wall Street a menudo representan a comerciantes intrépidos haciendo grandes apuestas basadas únicamente en sus intuiciones de mercado, la gran mayoría de las operaciones en realidad son considerablemente más técnicas y limitadas. Las limitaciones suelen derivar de una compleja combinación de cuestiones comerciales, regulatorias e institucionales, y resultan en ciertos tipos de estrategias comerciales estándar o criterios que invitan al análisis algorítmico. Una de las actividades más comunes en los mercados financieros modernos se conoce como trading de <br>Precio Promedio Ponderado por Volumen</br>, o VWAP. Informalmente, el <br>VWAP</br> de una acción durante un período de mercado especificado es simplemente el precio promedio pagado por acción durante ese período, por lo que el precio de cada transacción en el mercado se pondera por su volumen. En el trading de <br>VWAP</br>, se intenta comprar o vender una cantidad fija de acciones a un precio que siga de cerca el <br>VWAP</br>. Las operaciones institucionales de gran tamaño constituyen una de las principales motivaciones detrás de la actividad de <br>VWAP</br>. ",
            "candidates": [],
            "error": [
                [
                    "Precio Promedio Ponderado por Volumen",
                    "Precio Promedio Ponderado por Volumen",
                    "VWAP",
                    "VWAP",
                    "VWAP",
                    "VWAP"
                ]
            ]
        }
    }
}