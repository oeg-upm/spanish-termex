{
    "id": "C-48",
    "original_text": "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes. Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query. An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15. Such queries are useful for correlating events occurring within the network. In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries. Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm. Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)). In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network. Finally, experiments on a small scale testbed validate the feasibility of DIMs. Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1. INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3]. Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc. In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes. For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20. Such range queries can be used in two distinct ways. They can help users efficiently drill-down their search for events of interest. The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms. More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions. For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras. In traditional database systems, such range queries are supported using pre-computed indices. Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability. For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network). Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries. In this paper, we present just such a data structure, that we call a DIM1 . DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network. DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3). DIMs trace their lineage to datacentric storage systems [23]. The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events. Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes. DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion. We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3). We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6). Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)). In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network. Experiments on a small scale testbed validate the feasibility of DIMs (Section 6). Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity. We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks. DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18]. All such systems will likely be integrated to a sensor network database system such as TinyDB [17]. Application designers could then choose the appropriate method of information access. For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots. Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2. RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques. The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature. Indexing techniques essentially trade-off some data insertion cost to enable efficient querying. Indexing has, for long, been a classical research problem in the database community [5, 2]. Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space. Our approach essentially represents a geographic embedding of such structures in a sensor field. There is one important difference. The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]). The index structure is decided not only by the data, but also by the order in which data is inserted. Our current design is not data dependent. Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11]. While there has been some work on distributed indexing, the problem has not been extensively explored. There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries. Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19]. Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network. The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology. More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context. Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17]. Our work is similar in spirit to this body of literature. In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17]. Our work departs from prior work in this area in two significant respects. Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations. This hashing is the key to scaling multi-dimensional range searches. In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system. Our work avoids query flooding by an appropriate choice of hashing. Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT). This index is used to direct queries to nodes that have detected relevant data. Our work differs from SRT in three key aspects. First, SRT is built on single attributes while DIM supports mulitple attributes. Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values. Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node. A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25]. These approaches work well for relatively long-lived queries. Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous. GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location. We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries. DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3. THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment. In these networks, nodes (either individually or collaboratively) will generate events. An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level). The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk . Such a query returns all events whose attribute values fall into the corresponding ranges. Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries. As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network. It is possible to implement range queries by flooding a query within the network. However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently. The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries. Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes. The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme. The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby. The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function. Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later. Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node. Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries. This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location. The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X. In GPSR, this is called greedy-mode forwarding. When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids. GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation. For all of this to work, DIMs make two assumptions that are consistent with the literature [23]. First, all nodes know the approximate geographic boundaries of the network. These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol. Second, each node knows its geographic location. Node locations can be automatically determined by a localization system or by other means. Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles. We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone. Intuitively, a zone is a subdivision of the geographic extent of a sensor field. A zone is defined by the following constructive procedure. Consider a rectangle R on the x-y plane. Intuitively, R is the bounding rectangle that contains all sensors withing the network. We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles. If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis). That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on. We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z). The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows. If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1. If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1. The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings. Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111. Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree. The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z. The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known. Two zones are called sibling zones if their zone codes are the same except for the last bit. For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones. The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree. We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree. For a zone Z, let p be the first level(Z) − 1 digits of code(Z). Let backup(Z) be the backup zone of zone Z. If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences). If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field. Now we describe how zones are mapped to nodes. Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node. If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone. In general, however, the node placements within a sensor field are likely to be less regular than the grid. For some k, some zones may be empty and other zones might have more than one node situated within them. One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest). Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones. To precisely understand the associations between zones and nodes, we define the notion of zone ownership. For any given placement of network nodes, consider a node A. Let ZA to be the largest zone that includes only node A and no other node. Then, we say that A owns ZA. Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node. For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner. To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z). In our example, that empty zones owner would also be the node that owns 1110, its backup zone. Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network? In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone. In practice, however, communication voids and obstacles make the algorithm much more challenging. In particular, resolving the ownership of zones that do not contain any nodes is complicated. Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone. Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted. The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary). These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed. We now describe the algorithm, and illustrate it using examples. In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes). When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network. The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range. Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly. In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A). Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors. Figure 2 illustrates the results of applying this algorithm for the network in Figure 1. Figure 3 describes the corresponding zone tree. Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM. Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1. This binary tree forms the index that we will use in the following event and query processing procedures. We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes. Notice that in Figure 2, there is an empty zone whose code should be 110. In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction. As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent. We describe event insertion in the next step. Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up. We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM. There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone. As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field. We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . . Am. For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node. We will relax this assumption shortly. Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1. Our hashing scheme assigns a k bit zone code to an event as follows. For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1. For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1). We repeat this procedure until all k bits have been assigned. As an example, consider event E = 0.3, 0.8 . For this event, the 5-bit zone code is code(ZA) = 01110. Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code. This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees. In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes. Rather, suppose the encoding node is A and its own zone code is of length kA. Then, given an event E, node A only hashes E to a zone code of length kA. We denote the zone code assigned to an event E by code(E). As we describe below, as the event is routed, code(E) is refined by intermediate nodes. This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone. We call this node the owner of the event. Consider an event E that has just been generated at a node A. After encoding event E, node A compares code(E) with code(A). If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner. To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored. A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1). The message contains the event E, code(E), and the target geographic location for storing the event. In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes. GPSR now delivers this message to the next hop towards addr(Z ) from A. This next hop node (call it B) does not immediately forward the message. Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have. Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings. DIM treats NULL as an extreme value for range comparisons. As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E). B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message. In this manner, as the event wends its way to its owner, its zone code gets refined. Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message. If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next). If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided. When this condition holds, C knows for sure that no other nodes have overlapped zones with it. In this case, we call C an internal node. Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided. If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap. To do this, C now sets itself to be the owner of E and continues forwarding the message. Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary. Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message. If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally. If this does not happen, there are two possibilities. The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code. This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone. Figures 6 through 8 show an example of this data-driven zone shrinking. Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other. Suppose that A inserts an event E = 0.4, 0.8, 0.9 . A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own. B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A. Upon receiving this request, A also shrinks its zone from 0 to 00. A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code). Let us label this node D. D now tries to initiate delivery to the centroid of the new zone. This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone. A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows). A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking. Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone). However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own. X will shrink its zone to resolve the overlap. If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary. In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm. The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 . Figure 6 also works as an example where the outer perimeter is traversed. Event E inserted by A will eventually be stored in node B. Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node. But if Bs nominal radio range intersects the network boundary, it then has two choices. It can assume that there will not be any nodes outside the network boundary and so B is an internal node. This is an aggressive approach. On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet. B will then force the message walking another perimeter before storing it. In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone. The event will end up being stored at a different node than the real owner. In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery. Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event. To do this, a node C, say, needs to know the zone codes of its neighboring nodes. We deploy GPSRs beaconing message to piggyback the zone codes for nodes. So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism. The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries. In Section 3.5, we address robustness of event insertion to packet loss or to node failures. Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure. In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message. Procedure Send-Message is used to send either an event message or a query message. If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries. Routing a point query is identical to routing an event. Thus, the rest of this section details how range queries are routed. The key challenge in routing zone queries is brought out by the following strawman design. If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones. This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined. Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries. We describe this algorithm here. The first step of the algorithm is to map a range query to a zone code prefix. Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do. The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree. The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)). Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q). Our approach to split a query Q into subqueries is as follows. If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1. Then A decides the half that overlaps with its own zone. Lets call it QA. If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it. For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 . The splitting steps is shown in Figure 2. After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 . This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting. A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above. More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split. Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split). Figure 10 describes the pseudo-code for the zone splitting algorithm. As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier. Every query message contains 4 By point queries, we mean the equality condition on all indexed keys. DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator. Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting. We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms. Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure. We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided. These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above. When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries. At this time, those zones can also transfer to the new node those events they store but which should belong to the new node. Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node. Node deletion may also cause zone expansion. In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1). The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone. Now, we turn our attention to node failures. Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node. But how does a node decide if its sibling has failed? If the sibling is within radio range, the absence of GPSR beaconing messages can detect this. Once it detects this, the node can expand its zone. A different approach is needed for detecting siblings who are not within radio range. These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship. In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives. Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B. A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal. A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead. If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data. To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes. Mirror replication is conceptually easy. Suppose an event E has a zone code code(E). Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E). This technique essentially creates a mirror DIM. A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed. Clearly, the trade-off here is an approximate doubling of both insertion and query costs. There exists a far cheaper technique to ensure resilience to random node failures. Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails. This node is defined as the node responsible for As zones backup zone (see Section 3.1). The basic idea is that A replicates each data item it has in this node. We call this node As local replica. Let As local replica be B. Often B will be a radio neighbor of A and can be detected from GPSR beacons. Sometimes, however, this is not the case, and B will have to be explicitly discovered. We use an explicit message for discovering the local replica. Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion. Node A sends a message whose geographic destination is a random nearby location chosen by A. The location is close enough to A such that GPSR will guarantee that the message will delivered back to A. In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A). Then the packet will be delivered in GPSR perimeter mode. Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location. Once the packet comes back to A, it will know the location of its local replica and can start to send replicas. In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic. However, a nodes local replica itself may fail. There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas. The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss. For event insertion, a simple ACK scheme suffices. Of course, queries and responses can be lost as well. In this case, there exists an efficient approach for error recovery. This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment). After a conservative timeout, the querier can re-issue the queries selectively to these zones. If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4. DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks. In the next section, we validate these analyses using detailed packet-level simulations. Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network. Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network. It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against. In DIMs, event insertion essentially uses geographic routing. In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23]. On the other hand, the query delivery cost depends upon the size of ranges specified in the query. Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range. Thus, when the querier is far from the queried zone, there are two components to the query delivery cost. The first, which is proportional to √ N, is the cost to deliver the query near the covering zone. If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes. Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx. To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely. In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query. For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . . N is equally likely, the average query delivery cost of uniformly distributed queries is O(N). Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding. However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic. Somewhat more realistic is a situation where all query sizes are bounded by a constant B. In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B). Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone. Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N). The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ). In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N). Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)). Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions). How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries? A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network. This scheme incurs an insertion cost of O( √ N), and a zero query cost. However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot. A second alternative implementation would store events at the node where they are generated. Queries are flooded 71 throughout the network, and nodes that have matching data respond. Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17]. The flooding scheme incurs a zero insertion cost, but an O(N) query cost. It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]). In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute. A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute. Each sub-query is then hashed to the appropriate location. The nodes that receive a sub-query only return events that match all other attribute ranges. In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N). Suppose that the range of the first attribute contains r discrete values. Then the cost to deliver queries is O(r √ N). Thus, asymptotically, GHT-Rs perform similarly to DIMs. In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5. DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries. In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations. Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2. We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter. This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query. In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3. Of those mechanisms, the only one we did not implement is mirror replication. We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work. Our DIM implementation in ns-2 is 2800 lines of code. Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2. This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals. Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R). For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes. Each node has a radio range of 40m. For the results presented here, each node has on average 20 nodes within its nominal radio range. We have conducted experiments at other node densities; they are in agreement with the results presented here. In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event). We have conducted experiments for three different event value distributions. Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely. Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range. The normal event distribution represents a skewed data set. Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network. As we shall see, this represents a fairly skewed data set. Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries. The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential. Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed. For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time. Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results. The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space. Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero). DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events). The reason for this is interesting. In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20]. By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided. Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs. Figure 13 plots the average query cost for a bounded uniform query size distribution. For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost. For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion. Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4. Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 . Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding). Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range. Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query). The superior scaling of DIMs is evident in these graphs. Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare. This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations. As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low. Figure 12 describes the efficacy of local replication. To obtain this figure, we conducted the following experiment. On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers. Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query. The figure plots the fraction of expected responses actually received, with and without replication. As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect. We note that DIMs (as currently designed) are not perfect. When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck. This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.) This is a standard problem that the database indices have dealt with by tree re-balancing. In our case, simpler solutions might be possible (and we discuss this in Section 7). However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions. Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space). Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way. As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely. For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution. For normally distributed events, the insertion costs be much better than this. Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution. Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range). We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones. We leave an understanding of this to future work. Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms. Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6. IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines. To implement DIMs, we had to develop and test an independent implementation of GPSR. Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented. The software architecture of DIM/GPSR system is shown in Figure 16. The entire system (about 5000 lines of code) is event-driven and multi-threaded. The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions. The GPSR system is implemented as user-level daemon process. Applications are executed as clients. For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination. We tested our implementation on a testbed consisting of 8 PC-104 class machines. Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication. These boxes are laid out in an office building with a total spatial separation of over a hundred feet. We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location. The network topology is approximately a chain. On this testbed, we inserted queries and events from a single designated node. Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all). Our queries span four sizes, returning 1, 4, 9 and 16 events respectively. Figure 17 plots the number of events received for different sized queries. It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier. With that adjustment, the number of responses matches our expectation. Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed. While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs. Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7. CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks. Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR. We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future. There are several interesting future directions that we intend to pursue. One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots. Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution. Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves. A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range. Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8. REFERENCES [1] J. Aspnes and G. Shah. Skip Graphs. In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley. Multidimensional Binary Search Trees Used for Associative Searching. Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri. Towards Sensor Database Systems. In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong. Freenet: A Distributed Anonymous Information Storage and Retrieval System. In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability. Springer, New York, 2001. [5] D. Comer. The Ubiquitous B-tree. ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley. Quad Trees: A Data Structure for Retrieval on Composite Keys. Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann. DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks? In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani. Similarity Search in High Dimensions via Hashing. In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker. The Sensor Network as a Database. Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker. DIFS: A Distributed Index for Features in Sensor Networks. In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman. R-trees: A Dynamic Index Structure for Spatial Searching. In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica. Complex Queries in DHT-based Peer-to-Peer Networks. In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002. Springer-Verlag. [13] P. Indyk and R. Motwani. Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality. In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala. Locality-preserving Hashing in Multidimensional Spaces. In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997. ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin. Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks. In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung. GPSR: Greedy Perimeter Stateless Routing for Wireless Networks. In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong. The Design of an Acquisitional Query Processor for Sensor Networks. In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong. TAG: a Tiny AGregation Service for ad-hoc Sensor Networks. In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker. A Scalable Content-Addressable Network. In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker. GHT: A Geographic Hash Table for Data-Centric Storage. In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet. Spatial Data Structures. In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385. Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan. On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks. In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin. Data-Centric Storage in Sensornets. In Proc. ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan. Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications. In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang. A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks. In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75",
    "original_translation": "Consultas de rango multidimensional en redes de sensores ∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ Resumen en muchas redes de sensores, datos o eventos se nombran por atributos. Muchos de estos atributos tienen valores escalares, por lo que una forma natural de consultar eventos de interés es utilizar una consulta de rango multidimensional. Un ejemplo es: enumerar todos los eventos cuya temperatura se encuentra entre 50 ° y 60 °, y cuyos niveles de luz se encuentran entre 10 y 15. Dichas consultas son útiles para correlacionar los eventos que ocurren dentro de la red. En este documento, describimos el diseño de un índice distribuido que admite consultas de rango multidimensionales. Nuestro índice distribuido para datos multidimensionales (o DIM) utiliza una nueva incrustación geográfica de una estructura de datos de índice clásico, y se basa en el algoritmo de enrutamiento geográfico GPSR. Nuestro análisis revela que, bajo suposiciones razonables sobre las distribuciones de consultas, Dims se escala bastante bien con el tamaño de la red (tanto la inserción como los costos de consulta como o (√ n)). En simulaciones detalladas, mostramos que en la práctica, los costos de inserción y consulta de otras alternativas son a veces un orden de magnitud más que los costos de los DIM, incluso para la red de tamaño moderado. Finalmente, los experimentos en un lecho de prueba a pequeña escala validan la viabilidad de los dims. Categorías y descriptores de sujetos C.2.4 [Redes de comunicación informática]: sistemas distribuidos;C.3 [Sistemas de uso especial y basados en aplicaciones]: Sistemas integrados Términos generales Sistemas integrados, redes de sensores, almacenamiento 1. La introducción en redes de sensores inalámbricas, datos o eventos será nombrado por atributos [15] o representado como relaciones virtuales en una base de datos distribuida [18, 3]. Muchos de estos atributos tendrán valores escalares: por ejemplo, niveles de temperatura y luz, condiciones de humedad del suelo, etc. En estos sistemas, argumentamos, una forma natural de consultar para eventos de interés será utilizar consultas de rango multidimensional en estos atributos. Por ejemplo, los científicos que analizan el crecimiento de microorganismos marinos podrían estar interesados en eventos que ocurrieron dentro de ciertas condiciones de temperatura y luz: enumere todos los eventos que tienen temperaturas entre 50 ° F y 60 ° F, y niveles de luz entre 10 y 20. Dichas consultas de rango se pueden usar de dos maneras distintas. Pueden ayudar a los usuarios a desestimar eficientemente su búsqueda de eventos de interés. La consulta descrita anteriormente ilustra esto, donde el científico presumiblemente está interesado en descubrir, y tal vez mapear el efecto combinado de la temperatura y la luz sobre el crecimiento de los microorganismos marinos. Más importante aún, el software de aplicación se ejecuta dentro de una red de sensores para correlacionar eventos y activar acciones. Por ejemplo, si en una aplicación de monitoreo de hábitat, un ave que se cae en su nido está indicado en una cierta gama de lecturas de sensores de termopil, y una cierta gama de lecturas de micrófono, una consulta de rango multidimensional en esos atributos permite una mayor detección de confianza de losLlegada de una bandada de pájaros, y puede activar un sistema de cámaras. En los sistemas de bases de datos tradicionales, tales consultas de rango son compatibles con índices precomputados. La compensación de índices algunos costos de precomputación inicial para lograr una capacidad de consulta significativamente más eficiente. Para las redes de sensores, afirmamos que un índice centralizado para consultas de rango multidimensional puede no ser factible por razones de eficiencia energética (así como el hecho de que el ancho de banda de acceso a este índice central será limitado, particularred). Más bien, creemos, habrá situaciones en las que sea más apropiado construir una estructura de datos distribuidas inneces para responder eficientemente consultas de rango multidimensional. En este artículo, presentamos tal estructura de datos, que llamamos un Dim1. Los DIM están inspirados en los índices de base de datos clásicos, y son esencialmente incrustaciones de tales índices dentro de la red de sensores. Dims aprovecha dos ideas clave: índice distribuido en la red 1 para datos multidimensionales.63 Almacenamiento centrado en datos y un nuevo hash geográfico que presenta la localidad (Sección 3). Dims traza su linaje a los sistemas de almacenamiento de datos datacénicos [23]. El mecanismo subyacente en estos sistemas permite que los nodos hash constantemente un evento en algún lugar dentro de la red, lo que permite una recuperación eficiente de eventos. Sobre la base de esto, los DIMS usan una técnica por la cual los eventos cuyos valores de atributos están cerca pueden almacenarse en los mismos nodos o cercanos. Los DIMS luego usan un algoritmo de enrutamiento geográfico subyacente (GPSR [16]) para enrutar eventos y consultas a sus nodos correspondientes de manera completamente distribuida. Discutimos el diseño de un algoritmos DIM, presentando la inserción y consulta de eventos, para mantener un DIM en caso de falla del nodo y para hacer que las DIMS sean robustas a los datos o la pérdida de paquetes (Sección 3). Luego evaluamos ampliamente los DIMS utilizando el análisis (Sección 4), la simulación (Sección 5) y la implementación real (Sección 6). Nuestro análisis revela que, bajo suposiciones razonables sobre las distribuciones de consultas, Dims se escala bastante bien con el tamaño de la red (tanto la inserción como los costos de consulta como o (√ n)). En simulaciones detalladas, mostramos que en la práctica, la inserción del evento y la consulta de los costos de otras alternativas son a veces un orden de magnitud los costos de DIMS, incluso para una red de tamaño moderado. Los experimentos en un lecho de prueba a pequeña escala validan la viabilidad de los DIM (Sección 6). Queda mucho trabajo, incluido el soporte eficiente para distribuciones de datos sesgadas, consultas existenciales y heterogeneidad de nodos. Creemos que los DIMS serán una estructura de datos distribuida esencial, pero quizás no necesariamente la única estructura de datos distribuida que respalda consultas eficientes en redes de sensores. Los DIMS formarán parte de un conjunto de tales sistemas que habilitan la extracción de características [7], consulta de rango simple [10], consultas de combate exacto [23] o consultas continuas [15, 18]. Es probable que todos estos sistemas se integren a un sistema de base de datos de red de sensores, como TinyDB [17]. Los diseñadores de aplicaciones podrían elegir el método apropiado de acceso a la información. Por ejemplo, una aplicación de seguimiento de incendios usaría DIM para detectar los puntos de acceso, y luego usaría mecanismos que permitan consultas continuas [15, 18] para rastrear el progreso espacio-temporal de los puntos de acceso. Finalmente, observamos que los DIMS son aplicables no solo a las redes de sensores, sino también a otros sistemas profundamente distribuidos (redes integradas para la automatización del hogar y la fábrica).2. Trabajo relacionado El problema básico que aborda este documento, consultas de rango multidimensional, generalmente se resuelve en los sistemas de bases de datos utilizando técnicas de indexación. La comunidad de la base de datos se ha centrado principalmente en índices centralizados, pero la indexación distribuida ha recibido cierta atención en la literatura. Las técnicas de indexación esencialmente intercambian algunos costos de inserción de datos para permitir una consulta eficiente. La indexación ha sido, por mucho tiempo, un problema de investigación clásica en la comunidad de bases de datos [5, 2]. Nuestro trabajo se inspira en la clase de estructuras de índice de ramificación constante múltiple, ejemplificada por los árboles K-D [2], donde K representa la dimensionalidad del espacio de datos. Nuestro enfoque esencialmente representa una incrustación geográfica de tales estructuras en un campo de sensores. Hay una diferencia importante. Las estructuras de indexación clásica dependen de datos (al igual que algunos esquemas de indexación que utilizan hashes de preservación de la localidad y se desarrollan en la literatura teórica [14, 8, 13]). La estructura del índice se decide no solo por los datos, sino también por el orden en que se insertan los datos. Nuestro diseño actual no depende de los datos. Finalmente, tangencialmente relacionado con nuestro trabajo está la clase de sistemas de indexación espacial [21, 6, 11]. Si bien ha habido algo de trabajo en la indexación distribuida, el problema no se ha explorado ampliamente. Existen índices distribuidos de un tipo restringido, que permiten consultas exactas de coincidencia de prefijo o de prefijo parcial. Ejemplos de tales sistemas, por supuesto, son el sistema de nombres de dominio de Internet, y la clase de sistemas de tabla hash distribuida (DHT) ejemplificados por Freenet [4], Chord [24] y Can [19]. Nuestro trabajo es superficialmente similar a CAN en que ambos construyen una superposición basada en la zona sobre la red física subyacente. Los detalles subyacentes hacen que los dos sistemas sean muy diferentes: la superposición de CANS es puramente lógica, mientras que nuestra superposición es consistente con la topología física subyacente. El trabajo más reciente en el contexto de Internet ha abordado el soporte para consultas de rango en los sistemas DHT [1, 12], pero no está claro si estos se traducen directamente en el contexto de la red de sensores. Varios esfuerzos de investigación han expresado la visión de una interfaz de base de datos a las redes de sensores [9, 3, 18], y hay ejemplos de sistemas que contribuyen a esta visión [18, 3, 17]. Nuestro trabajo es similar en espíritu a este cuerpo de literatura. De hecho, los DIMS podrían convertirse en un componente importante de un sistema de base de datos de red de sensores como TinyDB [17]. Nuestro trabajo aparta del trabajo anterior en esta área en dos aspectos significativos. A diferencia de estos enfoques, en nuestro trabajo, los datos generados en un nodo están hash (en general) a diferentes ubicaciones. Este hashing es la clave para escalar las búsquedas de rango multidimensional. En todos los otros sistemas descritos anteriormente, las consultas se inundan en toda la red y pueden dominar el costo total del sistema. Nuestro trabajo evita la inundación de consultas mediante una opción apropiada de hashing. Madden et al.[17] también describe un índice distribuido, llamado árboles de enrutamiento semántico (SRT). Este índice se utiliza para dirigir consultas a nodos que han detectado datos relevantes. Nuestro trabajo difiere de SRT en tres aspectos clave. Primero, SRT se basa en atributos individuales, mientras que DIM admite múltiples atributos. En segundo lugar, SRT construye un árbol de enrutamiento basado en lecturas de sensores históricos y, por lo tanto, funciona bien solo para los valores del sensor lento. Finalmente, en las consultas SRT se emiten desde un nodo fijo, mientras que en las consultas DIM se pueden emitir desde cualquier nodo. Una diferenciación similar se aplica con respecto al trabajo en el enrutamiento centrado en los datos en las redes de sensores [15, 25], donde se supone que los datos generados en un nodo se almacenan en el nodo, y las consultas se inundan en toda la red [15], oCada fuente establece una superposición de toda la red que anuncia su presencia para que los sumideros móviles puedan encontrarse con fuentes en el nodo más cercano en la superposición [25]. Estos enfoques funcionan bien para consultas de larga vida. Finalmente, nuestro trabajo está más relacionado con los sistemas de almacenamiento centrado en datos [23], que incluyen tablas de hash geográficas (GHT) [20], dimensiones [7] y DIFS [10].Nombre a una ubicación dentro de la red, permitiendo una cita altamente eficiente. Los GHT se basan en el protocolo GPSR [16] y aprovechan algunas propiedades interesantes de ese protocolo, como la capacidad de enrutar a un nodo más cercano a una ubicación determinada. También aprovechamos las propiedades en GPSR (como describimos más adelante), pero utilizamos un hash que presenta la localidad para almacenar datos, permitiendo consultas eficientes de rango multidimensional. Se pueden considerar que las dimensiones y los difs usan el mismo conjunto de primitivas que la GHT (almacenamiento con hashing consistente), pero para diferentes extremos: las dimensiones permiten la búsqueda de características de Drill64 en una red de sensores, mientras que DIF permite consultas de rango en una sola clave en una sola clave enAdición a otras operaciones.3. El diseño de DIMS La mayoría de las redes de sensores se implementan para recopilar datos del entorno. En estas redes, los nodos (individualmente o en colaboración) generarán eventos. Un evento generalmente se puede describir como una tupla de valores de atributo, A1, A2, · · ·, AK, donde cada atributo AI representa una lectura de sensor, o algún valor correspondiente a una detección (por ejemplo, un nivel de confianza). El enfoque de este documento es el diseño de sistemas para responder eficientemente consultas de rango multidimensional de la forma: x1-y1, x2-y2, · · ·, xk-yk. Tal consulta devuelve todos los eventos cuyos valores de atributo caen en los rangos correspondientes. Observe que las consultas de puntos, es decir, consultas que solicitan eventos con valores especificados para cada atributo, son un caso especial de consultas de rango. Como hemos discutido en la Sección 1, las consultas de rango pueden permitir una correlación eficiente y activación dentro de la red. Es posible implementar consultas de rango inundando una consulta dentro de la red. Sin embargo, como mostramos en secciones posteriores, esta alternativa puede ser ineficiente, particularmente a medida que el sistema escala, y si los nodos dentro de la red emiten tales consultas con relativa frecuencia. La otra alternativa, enviando todos los eventos a un nodo de almacenamiento externo, el enlace de acceso es un cuello de botella, especialmente si los nodos dentro de las consultas de problemas de red. Shenker et al.[23] también hacen argumentos similares con respecto a los esquemas de almacenamiento centrados en datos en general;Los DIM son una instancia de tales esquemas. El sistema que presentamos en este documento, el DIM, se basa en dos bases: un hash geográfico que presenta la localidad y un esquema de enrutamiento geográfico subyacente. La clave para resolver consultas de rango de manera eficiente es la localidad de datos: es decir, los eventos con valores de atributos comparables se almacenan cerca. La información básica subyacente al DIM es que la localidad de datos se puede obtener mediante una función hash geográfica que presenta la localidad. Nuestra función de hash geográfica encuentra un mapeo de conservación de la localidad desde el espacio multidimensional (descrito por el conjunto de atributos) a un espacio geográfico en 2-D;Este mapeo está inspirado en los árboles K-D [2] y se describe más adelante. Además, cada nodo en la red se organiza autoorganizado para reclamar parte del espacio de atributos para sí mismo (decimos que cada nodo posee una zona), por lo que los eventos que caen en ese espacio se enrutan y almacenan en ese nodo. Habiendo establecido el mapeo y la estructura de la zona, los DIMS utilizan un algoritmo de enrutamiento geográfico desarrollado previamente en la literatura para enrutar los eventos a sus nodos correspondientes, o para resolver consultas. Este algoritmo, GPSR [16], esencialmente permite la entrega de un paquete a un nodo en una ubicación específica. El mecanismo de enrutamiento es simple: cuando un nodo recibe un paquete destinado a un nodo en la ubicación X, reenvía el paquete al vecino más cercano a X. En GPSR, esto se llama reenvío de modo codicioso. Cuando no existe tal vecino (como cuando existe un vacío en la red), el nodo inicia el paquete en un transversal de modo perimetral, utilizando la regla de mano derecha bien conocida para circunnavegar los vacíos. GPSR incluye técnicas eficientes para el recorrido perimetral que se basan en algoritmos de planarización gráfica susceptibles de implementación distribuida. Para que todo esto funcione, los DIMS hacen dos suposiciones que son consistentes con la literatura [23]. Primero, todos los nodos conocen los límites geográficos aproximados de la red. Estos límites pueden configurarse en nodos en el momento de la implementación, o pueden descubrirse utilizando un protocolo simple. En segundo lugar, cada nodo conoce su ubicación geográfica. Las ubicaciones de los nodos se pueden determinar automáticamente por un sistema de localización o por otros medios. Aunque la idea básica de DIMS puede parecer directa, es un desafío diseñar una estructura de datos completamente distribuida que debe ser robusta para las pérdidas de paquetes y fallas de nodos, pero debe admitir una distribución eficiente de consultas y tratar con los vacíos y obstáculos de la comunicación. Ahora describimos el diseño completo de DIMS.3.1 Zonas La idea clave detrás de Dims, como hemos discutido, es un hash que presenta la localidad geográfica que mapea un evento de atributo múltiple a una zona geográfica. Intuitivamente, una zona es una subdivisión de la extensión geográfica de un campo de sensor. Una zona se define por el siguiente procedimiento constructivo. Considere un rectángulo R en el plano X-Y. Intuitivamente, R es el rectángulo delimitador que contiene todos los sensores con la red. Llamamos a un sub-rectángulo Z de R A Zone, si Z se obtiene dividiendo R K Times, K ≥ 0, utilizando un procedimiento que satisface la siguiente propiedad: después de la división I-Th, 0 ≤ I ≤ k, R esdividido en 2i rectángulos de igual tamaño. Si yo es un número impar (par), la división i-th es paralela al eje y (eje x). Es decir, el rectángulo rimerante R se subdivide primero en dos zonas en el nivel 0 por una línea vertical que divide R en dos piezas iguales, cada una de estas subzones se puede dividir en dos zonas en el nivel 1 por una línea horizontal,etcétera. Llamamos al entero no negativo K el nivel de la zona Z, es decir, el nivel (z) = k.Se puede identificar una zona por un código de código de zona (z) o mediante una dirección de dirección (z). El código del código (z) es una cadena de nivel de longitud de 0-1 (z), y se define de la siguiente manera. Si Z se encuentra en la mitad izquierda de R, el primero (desde la izquierda) de código (z) es 0, de lo contrario 1. Si Z se encuentra en la mitad inferior de R, el segundo bit de código (z) es 0, de lo contrario 1. Los bits de código restantes (z) se definen recursivamente en cada uno de los cuatro cuadrantes de R. Esta definición del código de zona coincide con la definición de zonas dadas anteriormente, codificando divisiones de la geografía del campo del sensor por cadenas de bits. Por lo tanto, en la Figura 2, la zona en la esquina superior derecha del Rectángulo R tiene un código de zona de 1111. Tenga en cuenta que los códigos de zona definen colectivamente un árbol de zona de tal manera que las zonas individuales están en las hojas de este árbol. La dirección de una zona Z, ADDR (Z), se define como el centroide del rectángulo definido por Z. Las dos representaciones de una zona (su código y su dirección) se pueden calcular a partir de la otra, suponiendo que se conoce el nivel de la zona. Dos zonas se llaman zonas hermanas si sus códigos de zona son los mismos, excepto el último bit. Por ejemplo, si el código (Z1) = 01101 y el código (Z2) = 01100, entonces Z1 y Z2 son zonas de hermanos. El subárbol de hermanos de una zona es el subárbol enraizado en el hermano izquierdo o derecho de la zona en el árbol de la zona. Definimos de manera única una zona de respaldo para cada zona de la siguiente manera: si el subárbol de hermanos de la zona está a la izquierda, la zona de respaldo es la zona más derecha en el subárbol de hermanos;De lo contrario, la zona de respaldo es la zona más izquierda en el subárbol de hermanos. Para una Zona Z, Sea P el primer nivel (z) - 1 dígitos de código (z). Deja que la copia de seguridad (z) sea la zona de respaldo de la zona Z. If código (z) = p1, código (copia de seguridad (z)) = P01 ∗ con el mayor número de 1s finales (∗ significa 0 o 1 ocurrencias). Si 65 código (z) = P0, código (copia de seguridad (z)) = P10 ∗ con la mayor cantidad de 0s finales.3.2 Zonas asociadas con nodos Nuestra definición de una zona es independiente de la distribución real de nodos en el campo del sensor, y solo depende de la extensión geográfica (el rectángulo limitado) del campo del sensor. Ahora describimos cómo se asignan las zonas a los nodos. Conceptualmente, el campo del sensor se divide lógicamente en zonas y cada zona se asigna a un solo nodo. Si la red de sensores se implementó de manera similar a la red (es decir, muy regular), entonces es fácil ver que existe una k tal que cada nodo se asigna a una zona de nivel de nivel distinta. En general, sin embargo, es probable que las ubicaciones de los nodos dentro de un campo de sensor sean menos regulares que la cuadrícula. Para algunos K, algunas zonas pueden estar vacías y otras zonas pueden tener más de un nodo situado dentro de ellas. Una alternativa habría sido elegir una K fija para el sistema general, y luego asociar los nodos con las zonas en las que se encuentran (y si una zona está vacía, asocie el nodo más cercano con él, para alguna definición de más cercano). Debido a que hace que nuestro sistema de enrutamiento de consultas general sea más simple, permitimos nodos en un mapa de mapa a zonas de diferentes tamaños. Para comprender con precisión las asociaciones entre zonas y nodos, definimos la noción de propiedad de la zona. Para cualquier colocación dada de nodos de red, considere un nodo A. Deje que ZA sea la zona más grande que incluye solo el nodo A y ningún otro nodo. Entonces, decimos que A posee ZA. Observe que esta definición de propiedad puede dejar algunas secciones del campo del sensor no asociado con un nodo. Por ejemplo, en la Figura 2, la Zona 110 no contiene ningún nodo y no tendría un propietario. Para remediar esto, para cualquier zona vacía Z, definimos al propietario como el propietario de Backup (Z). En nuestro ejemplo, ese propietario de zonas vacías también sería el nodo que posee 1110, su zona de respaldo. Habiendo definido la asociación entre nodos y zonas, el siguiente problema que abordamos es: dada una colocación de nodo, ¿existe un algoritmo distribuido que permite a cada nodo determinar qué zonas posee, sabiendo solo el límite general de la red de sensores? En principio, esto debe ser relativamente sencillo, ya que cada nodo puede determinar simplemente la ubicación de sus vecinos y aplicar métodos geométricos simples para determinar la zona más grande a su alrededor, de modo que ningún otro nodo reside en esa zona. En la práctica, sin embargo, los vacíos y obstáculos de la comunicación hacen que el algoritmo sea mucho más desafiante. En particular, resolver la propiedad de las zonas que no contienen ningún nodo es complicado. Igualmente complicado es el caso en el que la zona de un nodo es mayor que su radio de comunicación y el nodo no puede determinar los límites de su zona solo por comunicación local. Nuestro algoritmo de construcción de zona distribuida defiende la resolución de tales zonas hasta que se inicia una consulta o cuando se inserta un evento. La idea básica detrás de nuestro algoritmo es que cada nodo construye tentativamente una idea de la zona en la que reside simplemente comunicándose con sus vecinos (recordando qué límites de la zona están indecisos porque no hay vecino de radio que pueda ayudar a resolver ese límite). Estos límites indecisos se resuelven más tarde por un transversal perímetro GPSR cuando los mensajes de datos realmente se enrutan. Ahora describimos el algoritmo y lo ilustramos usando ejemplos. En nuestro algoritmo, cada nodo utiliza un límite de matriz [0..3] para mantener los cuatro límites de la zona que posee (Rememfigure 1: una red, donde los círculos representan nodos de sensores y líneas discontinuas marcan el límite de red. 1111 011 00 110100 101 1110 010 Figura 2: El código de zona y los límites. 0 1 0 1 10 10 1 1 10 00 Figura 3: El árbol de zona correspondiente ber que en este algoritmo, el nodo solo intenta determinar la zona en la que reside, no elOtras zonas pueden poseer porque esas zonas están desprovistas de nodos). Cuando se inicia un nodo, cada nodo inicializa esta matriz como el límite de la red, es decir, inicialmente cada nodo asume que su zona contiene toda la red. El algoritmo de límite de zona ahora se basa en los mensajes de baliza GPSRS para aprender las ubicaciones de los vecinos dentro del rango de radio. Al enterarse de dicho vecino, el nodo llama al algoritmo en la Figura 4 para actualizar sus límites de zona y su código en consecuencia. En este algoritmo, suponemos que A es el nodo en el que se ejecuta el algoritmo, ZA es su zona y A es un vecino recientemente descubierto de A. (el procedimiento contiene (ZA, A) se usa para decidir si se encuentra el nodo A.Dentro de los límites de la zona actual del nodo a). Usando este algoritmo, cada nodo puede decidir de forma independiente y asincrónica su propia zona tentativa basada en la ubicación de sus vecinos. La Figura 2 ilustra los resultados de aplicar este algoritmo para la red en la Figura 1. La Figura 3 describe el árbol de la zona correspondiente. Cada zona reside en un nodo de hoja y el código de una zona es la ruta desde la raíz hasta la zona si representamos la rama a la zona de construcción 66 izquierda (a) 1 mientras contiene (za, a) 2 do si longitud (código (za)) Mod 2 = 0 3 Entonces nuevo Bound ← (Bound [0] + Bound [1])/2 4 Si A.x <nuevo Bound 5 luego Bound [1] ← New Bound 6 más Bound [0] ← NUEVOBound 7 más nuevo Bound ← (Bound [2] + Bound [3])/2 8 if A.Y <nuevo Bound 9 entonces Bound [3] ← New Bound 10 más Bound [2] ← Código de código de zona de actualización de New Bound 11 (ZA ZA) Figura 4: Determinación del límite de zona, donde A.x y A.y representan la coordenada geográfica del nodo A. Insertar-Evento (E) 1 C ← Codificar (E) 2 Si contiene (ZA, C) = True y es interno () = True3 luego almacene E y Salir 4 Enviar mensajes (C, E) Enviar mensaje (C, M) 1 Si ∃ vecino y, cerrador (y, propietario (m), m) = verdadero 2 entonces addr (m) ← addr(Y) 3 de lo contrario si longitud (c)> longitud (código (m)) 4 luego actualice el código (m) y addr (m) 5 fuente (m) ← que llama 6 if es propietario (msg) = true 7 entonces propietario (propietario (m) ← Código de llamadas 8 Enviar (M) Figura 5: Insertar un evento en un DIM. El procedimiento más cercano (a, b, m) devuelve verdadero si el código (a) está más cerca del código (m) que el código (b).La fuente (m) se utiliza para establecer la dirección de origen del mensaje m.niño por 0 y la rama al niño derecho por 1. Este árbol binario forma el índice que utilizaremos en el siguiente evento y procedimientos de procesamiento de consultas. Vemos que los tamaños de zona son diferentes y dependen de las densidades locales y también lo son las longitudes de los códigos de zona para diferentes nodos. Tenga en cuenta que en la Figura 2, hay una zona vacía cuyo código debe ser 110. En este caso, si el nodo en la zona 1111 solo puede escuchar el nodo en la zona 1110, establece su límite con la zona vacía a indeciso, porque no escuchó de ningún nodo vecino desde esa dirección. Como hemos mencionado anteriormente, los límites indecisos se resuelven utilizando el modo perimetral GPSRS cuando se inserta un evento o se envía una consulta. Describimos la inserción del evento en el siguiente paso. Finalmente, esta descripción no describe cómo se ajustan los códigos de zona de nodos cuando fallan los nodos vecinos, o surgen nuevos nodos. Regresamos a esto en la Sección 3.5.3.3 Insertando un evento en esta sección, describimos cómo se insertan los eventos en un DIM. Hay dos algoritmos de interés: una técnica de hashing consistente para mapear un evento a una zona y un algoritmo de enrutamiento para almacenar el evento en la zona apropiada. Como veremos, estos dos algoritmos están interrelacionados.3.3.1 Hashing un evento a una zona en la Sección 3.1, describimos una teselación recursiva de la extensión geográfica de un campo de sensor. Ahora describimos un esquema de hashing consistente para un DIM que respalda las consultas de rango en M distintos atributos2, denotemos estos atributos A1... Soy. Por simplicidad, suponga por ahora que la profundidad de cada zona de la red es K, K es un múltiplo de M, y que este valor de K se conoce en cada nodo. Releccionaremos esta suposición en breve. Además, para facilitar la discusión, suponemos que todos los valores de atributos se han normalizado para ser entre 0 y 1. Nuestro esquema de Hashing asigna un código de zona K Bit a un evento de la siguiente manera. Para i entre 1 y m, si ai <0.5, el bit i-th bit del código de zona se asigna 0, de lo contrario 1. Para I entre m + 1 y 2m, si ai-m <0.25 o ai-m ∈ [0.5, 0.75), el bit i-° en la zona se asigna 0, de lo contrario 1, porque las divisiones de siguiente nivel están en 0.25 y0.75 que dividen los rangos a [0, 0.25), [0.25, 0.5), [0.5, 0.75) y [0.75, 1). Repetimos este procedimiento hasta que se hayan asignado todos los k bits. Como ejemplo, considere el evento E = 0.3, 0.8. Para este evento, el código de zona de 5 bits es el código (ZA) = 01110. Esencialmente, nuestro esquema de hash usa los valores de los atributos en forma de round-robin en el árbol de zona (como el de la Figura 3), para asignar un evento de atributo M a un código de zona. Esto recuerda a los árboles K-D [2], pero es bastante diferente de esa estructura de datos: los árboles de zona son integridades espaciales y no incorporan los algoritmos de re-balanceado en los árboles K-D. En nuestro diseño de DIMS, no requerimos que los nodos tengan códigos de zona de la misma longitud, ni esperamos que un nodo conozca los códigos de zona de otros nodos. Más bien, suponga que el nodo de codificación es A y su propio código de zona es de longitud KA. Luego, dado un evento E, nodo un solo hashes e a un código de zona de longitud ka. Denotamos el código de zona asignado a un evento E por código (E). Como describimos a continuación, a medida que se enruta el evento, el código (E) se refina por nodos intermedios. Esta evaluación perezosa de los códigos de zona permite que diferentes nodos usen códigos de zona de diferentes longitud sin ninguna coordinación explícita.3.3.2 Enrutamiento de un evento a su propietario El objetivo de haber logrado un evento a un código de zona es almacenar el evento en el nodo dentro del nodo de red que posee esa zona. Llamamos a este nodo el propietario del evento. Considere un evento E que acaba de generar en un nodo A. Después de codificar el evento E, el nodo A compara el código (E) con el código (a). Si los dos son idénticos, nodo un evento de tienda e localmente;De lo contrario, el nodo A intentará enrutar el evento a su propietario. Para hacer esto, tenga en cuenta que el código (e) corresponde a alguna zona Z, que es como suposición actual para la zona en la que se debe almacenar el evento E. A ahora invoca GPSR para enviar un mensaje a ADDR (Z) (el centroide de Z, Sección 3.1). El mensaje contiene el evento E, el código (E) y la ubicación geográfica objetivo para almacenar el evento. En el mensaje, también se marca como el propietario del evento E. Como veremos más adelante, la Zona Adivinada Z, la dirección de dirección (z) y el propietario de E, todos ellos contenidos en el mensaje, se refinaránpor nodos de reenvío intermedio. GPSR ahora entrega este mensaje al siguiente salto hacia Adr (Z) desde A. Este Next Hop Node (Llámalo B) no reenvía inmediatamente el mensaje. Más bien, intenta COM2 Dim no supone que todos los nodos son homogéneos en términos de los sensores que tienen. Por lo tanto, en un DIM dimensional M, un nodo que no posee todos los sensores M puede usar valores nulos para las lecturas correspondientes. Dim trata a NULL como un valor extremo para las comparaciones de rango. Como aparte, una red puede tener muchas instancias tenues ejecutándose simultáneamente.67 Puse un nuevo código de zona para que E obtenga un nuevo código de código (E). B actualizará el código contenido en el mensaje (y también el destino geográfico del mensaje) si CodeNew (E) es más largo que el código de evento en el mensaje. De esta manera, a medida que el evento se abre camino hacia su propietario, su código de zona se refina. Ahora, B compara su propio código de código (b) con el propietario del código del propietario (e) contenido en el mensaje entrante. Si el código (b) tiene una coincidencia más larga con el código (e) que el propietario actual del propietario (E), entonces B se establece para ser el propietario actual de E, lo que significa que si nadie es elegible para almacenar E, entonces B almacenará elEvento (veremos cómo sucede esto a continuación). Si el código de zona BS no coincide exactamente con el código (E), B invocará GPSR para entregar E al siguiente salto.3.3.3 Resolución de límites de zona indecisos durante la inserción Suponga que algún nodo, por ejemplo, C se considera el destino (o propietario eventual) de E.Recomputando localmente un código para E. En ese caso, C almacena E localmente, pero solo si se deciden los cuatro límites de la zona CS. Cuando esta condición se mantiene, C sabe con certeza que ningún otro nodo ha superado las zonas con ella. En este caso, llamamos a C un nodo interno. Recuerde, sin embargo, que debido a que el algoritmo de descubrimiento de zona de la Sección 3.2 solo utiliza información de vecinos inmediatos, uno o más de los límites de CS pueden estar indecisos. Si es así, C asume que otros nodos tienen una zona que se superpone con la suya y se propone resolver esta superposición. Para hacer esto, C ahora se establece para ser el propietario de E y continúa reenviando el mensaje. Aquí confiamos en el enrutamiento del modo perimetral GPSRS para sondear alrededor del vacío que causa el límite indeciso. Dado que el mensaje comienza desde C y está destinado a una ubicación geográfica cerca de C, GPSR garantiza que el mensaje se entregará a C si ningún otro nodo actualizará la información en el mensaje. Si el mensaje vuelve a C consigo mismo para ser el propietario, C infiere que debe ser el verdadero propietario de la zona y almacena E localmente. Si esto no sucede, hay dos posibilidades. El primero es que a medida que el evento atraviesa el perímetro, algún nodo intermedio, digamos B, cuya zona se superpone con CS se marca para ser el propietario del evento, pero de lo contrario no cambia el código de zona de eventos. Este nodo también reconoce que su propia zona se superpone con CS e inicia un intercambio de mensajes que hace que cada uno de ellos reduzca adecuadamente su zona. Las figuras 6 a 8 muestran un ejemplo de esta zona de zona basada en datos. Inicialmente, tanto el nodo A como el nodo B han reclamado la misma zona 0 porque están fuera del rango de radio entre sí. Supongamos que A inserta un evento E = 0.4, 0.8, 0.9. A codifica E a 0 y se afirma que es el propietario de E. Dado que A no es un nodo interno, envía E, buscando a otros candidatos al propietario de E. Una vez que E llegue al nodo B, B verá en el propietario de los mensajescampo como código que es el mismo que el suyo. B luego encoge su zona de 0 a 01 de acuerdo con la ubicación de AS que también se registra en el mensaje y envía una solicitud de contracción a A. Al recibir esta solicitud, A también encoge su zona de 0 a 00. Una segunda posibilidad es si algún nodo intermedio cambia el código de destino de E a un valor más específico (es decir, código de zona más largo). Etiquetemos este nodo D. D ahora intenta iniciar la entrega al centroide de la nueva zona. Esto a B 0 0 110 100 1111 1110 101 Figura 6: Los nodos A y B han reclamado la misma zona. A B <0.4,0.8,0.9> Figura 7: un mensaje de evento/consulta (flechas llenas) desencadena la zona de la zona (flechas huecas). A B 01 00 110 100 1111 1110 101 Figura 8: El diseño de la zona después de encogerse. Ahora el nodo A y B se han asignado a diferentes zonas.Podría dar lugar a una nueva caminata perimetral que regrese a D (si, por ejemplo, D es geográficamente más cercana al centroide de la zona). Sin embargo, D no sería el propietario del evento, lo que aún sería C. En el enrutamiento al centroide de esta zona, el mensaje puede atravesar el perímetro y regresar a D. ahora D avisos de que C era el propietario original, por lo queEncapsula el evento y lo dirige a C. En caso de que haya otro nodo, digamos X, que posee una zona superpuesta con C, X notará este hecho al encontrar en el mensaje el mismo prefijo del código de una de sus zonas, pero con una ubicación geográfica diferente desde su cuenta. X encogerá su zona para resolver la superposición. Si la zona XS es más pequeña o igual a la zona CS, X también enviará una solicitud de contracción a C. Una vez que C reciba una solicitud de contracción, reducirá su zona de manera adecuada y arreglará su límite indeciso. De esta manera, el proceso de formación de la zona se resuelve a pedido de una manera basada en datos.68 Hay varios efectos interesantes con respecto a la caminata perímetro que surgen en nuestro algoritmo. El primero es que hay algunos casos en los que una inserción de eventos puede causar que todo el perímetro exterior de la red se atraviese3. La Figura 6 también funciona como un ejemplo en el que se atraviesa el perímetro exterior. El evento E insertado por A se almacenará eventualmente en el nodo B. Antes de que el nodo B almacene el evento E, si el rango de radio nominal BS no se cruza con el límite de la red, debe enviar E nuevamente como A, porque B en este caso no es un nodo interno. Pero si la gama de radio nominal de BS se cruza con el límite de la red, tiene dos opciones. Puede suponer que no habrá nodos fuera del límite de la red y, por lo tanto, B es un nodo interno. Este es un enfoque agresivo. Por otro lado, B también puede tomar una decisión conservadora suponiendo que pueda haber otros nodos de los que aún no haya oído hablar. B forzará el mensaje caminar a otro perímetro antes de almacenarlo. En algunas situaciones, especialmente para grandes zonas donde el nodo que posee una zona está lejos del centroide de la zona de propiedad, puede existir un pequeño perímetro alrededor del destino que no incluye al propietario de la zona. El evento terminará siendo almacenado en un nodo diferente al propietario real. Para lidiar con este problema, agregamos una operación adicional en el reenvío de eventos, llamado Discovery de vecinos eficientes. Antes de invocar GPSR, un nodo debe verificar si existe un vecino que sea elegible para ser el verdadero propietario del evento. Para hacer esto, un nodo C, por ejemplo, necesita conocer los códigos de zona de sus nodos vecinos. Implementamos un mensaje de baliza de GPSR para aprovechar los códigos de zona para los nodos. Entonces, al comparar el código de eventos y el código de vecinos, un nodo puede decidir si existe un vecino que es más probable que sea el propietario del evento E. C entrega e a Y, lo que simplemente sigue el procedimiento de toma de decisiones discutido anteriormente.3.3.4 Resumen y pseudocódigo En resumen, nuestro procedimiento de inserción de eventos está diseñado para interactuar muy bien con el mecanismo de descubrimiento de zona y el mecanismo de hash de eventos. Los dos últimos mecanismos se mantienen simples, mientras que el mecanismo de inserción del evento utiliza una evaluación perezosa en cada salto para refinar el código de zona de eventos, y aprovecha el mecanismo de caminar perimetral GPSRS para fijar los límites de zona indecisos. En la Sección 3.5, abordamos la robustez de la inserción del evento a la pérdida de paquetes o a las fallas de nodo. La Figura 5 muestra el pseudocódigo para insertar y reenviar un evento e.En este pseudo código, hemos omitido una descripción del procedimiento de reducción de la zona. En el código pseudo, el procedimiento es interno () se usa para determinar si la persona que llama es un nodo interno y el procedimiento es propietario () se utiliza para determinar si la persona que llama es más elegible para ser propietario del evento de lo que actualmente se reclama propietario comograbado en el mensaje. Procedimiento Send-Message se usa para enviar un mensaje de evento o un mensaje de consulta. Si la dirección de destino del mensaje se ha cambiado, la dirección de origen del paquete también debe cambiarse para evitar ser abandonada por GPSR, ya que GPSR no permite que un nodo vea el mismo paquete en modo codicioso dos veces.3 Esto sucede con menos frecuencia que para los GHT, donde insertar un evento en una ubicación fuera del límite real (pero dentro del nominal) de la red siempre invocará una caminata perimetral externa.3.4 Las consultas de resolución y enrutamiento Dimes admiten consultas de puntos4 y consultas de rango. Enrutar una consulta de puntos es idéntica al enrutamiento de un evento. Por lo tanto, el resto de esta sección detalla cómo se enrutan las consultas de rango. El desafío clave en las consultas de la zona de enrutamiento es presentado por el siguiente diseño de Strawman. Si toda la red se dividió uniformemente en zonas de profundidad k (para alguna constante K), entonces el consulta (el nodo emitido la consulta) podría subdividir una consulta de rango dado en las subzonas relevantes y las solicitudes individuales de ruta a cada una de las solicitudes de cada uno de loszonas. Esto puede ser ineficiente para consultas de rango grande y también difícil de implementar en nuestro diseño donde los tamaños de zona no están predefinidos. En consecuencia, utilizamos una técnica ligeramente diferente donde una consulta de rango se enruta inicialmente a una zona correspondiente a todo el rango, y luego se divide progresivamente en subconsules más pequeñas. Describimos este algoritmo aquí. El primer paso del algoritmo es asignar una consulta de rango a un prefijo de código de zona. Conceptualmente, esto es fácil;En un árbol de zona (Figura 3), existe algún nodo que contiene toda la consulta de rango en su sub-árbol, y ninguno de sus hijos en el árbol sí. El código de zona inicial que elegimos para la consulta es el código de zona correspondiente al nodo de árbol, y es un prefijo de los códigos de zona de todas las zonas (tenga en cuenta que estas zonas pueden no ser geográficamente contiguas) en el subárbol. El Querier calcula el código de zona de Q, denotado por el código (Q) y luego comienza a enrutar una consulta a ADDR (código (Q)). Al recibir una consulta de rango Q, un nodo A (donde A es cualquier nodo en la ruta de propagación de la consulta) lo divide en múltiples subconsules de menor tamaño si hay una superposición entre la zona de A, Zone (a) y el código de zona asociado conQ, código (Q). Nuestro enfoque para dividir una consulta Q en las subconsules es el siguiente. Si el rango del atributo QS primero contiene el valor 0.5, un divide Q en dos subteres una de cuyos primer atributo varía de 0 a 0.5, y el otro de 0.5 a 1. Luego decide la mitad que se superpone con su propia zona. Vamos a llamarlo QA. Si QA no existe, entonces un deja de dividir;De lo contrario, continúa dividiendo (usando el segundo rango de atributos) y recomputando el control de calidad hasta que el control de calidad sea lo suficientemente pequeño como para que caiga por completo en la zona (a) y, por lo tanto, A ahora puede resolverlo. Por ejemplo, suponga que el nodo A, cuyo código es 0110, es dividir una consulta de rango Q = 0.3 - 0.8, 0.6 - 0.9. Los pasos de división se muestran en la Figura 2. Después de la división, obtenemos tres consultas más pequeñas Q0 = 0.3 - 0.5, 0.6 - 0.75, Q1 = 0.3 - 0.5, 0.75 - 0.9 y Q2 = 0.5 - 0.8, 0.6 - 0.9. Este procedimiento de división se ilustra en la Figura 9 que también muestra los códigos de cada subconsulta después de la división. A luego responde a la subconsulta Q0 con datos almacenados localmente y envía subconsules Q1 y Q2 utilizando el procedimiento descrito anteriormente. En términos más generales, si el nodo A se encuentra dentro del subárbol de zona que cubre al máximo Q, enviará las subconsules que resultaron de la división. De lo contrario, si no hay superposición entre A y Q, entonces una Q ADDENS Q como está (en este caso Q es la consulta original o un producto de una división anterior). La Figura 10 describe el pseudocódigo para el algoritmo de división de zona. Como se muestra en el algoritmo anterior, una vez que se ha reconocido una subconsulta como perteneciente a la zona de llamadas, se invoca la resolución del procedimiento para resolver la subconsulta y enviar una respuesta a la pregunta. Cada mensaje de consulta contiene 4 por consultas de puntos, nos referimos a la condición de igualdad en todas las claves indexadas. Los atributos de índice DIM no son necesariamente claves primarias.69 La ubicación geográfica de su iniciador, por lo que el mensaje de respuesta correspondiente se puede entregar directamente al iniciador. Finalmente, en el proceso de resolución de consultas, las zonas pueden encogerse de manera similar a la contracción durante la inserción. Omitimos esto en el código pseudo.3.5 Robustez Hasta ahora, no hemos discutido el impacto de las fallas de nodos y las pérdidas de paquetes, o las llegadas de nodos y las salidas en nuestros algoritmos. Las pérdidas de paquetes pueden afectar la inserción de la consulta y los eventos, y las fallas de nodos pueden dar lugar a datos perdidos, mientras que las llegadas y salidas de nodos pueden afectar la estructura de la zona. Ahora discutimos cómo los DIMS se pueden hacer robustos para este tipo de dinámica.3.5.1 Mantenimiento de zonas en secciones anteriores, describimos cómo el algoritmo de descubrimiento de zona podría dejar los límites de la zona indecisos. Estos límites indecisos se resuelven durante la inserción o consulta, utilizando el procedimiento de reducción de la zona descrito anteriormente. Cuando un nuevo nodo se une a la red, el mecanismo de descubrimiento de zona (Sección 3.2) hará que las zonas vecinas ajusten adecuadamente sus límites de zona. En este momento, esas zonas también pueden transferirse al nuevo nodo aquellos eventos que almacenan pero que deben pertenecer al nuevo nodo. Antes de que un nodo se apague (si esto es realmente posible), sabe que su nodo de respaldo (Sección 3.1) se apoderará de su zona, y simplemente enviará todos sus eventos a su nodo de respaldo. La eliminación de nodos también puede causar expansión de zona. Para mantener el mapeo entre las zonas binarias, árboles, nodos de hoja y zonas, permitimos que la expansión de la zona solo ocurra entre las zonas de hermanos (Sección 3.1). La regla es: si la zona de la zona (a) la zona de hermanos se vuelve vacía, entonces una puede expandir su propia zona para incluir su zona de hermanos. Ahora, dirigimos nuestra atención a las fallas de nodo. Las fallas de nodos son como deleciones de nodos, excepto que un nodo fallido no tiene la oportunidad de mover sus eventos a otro nodo. Pero, ¿cómo decide un nodo si su hermano ha fallado? Si el hermano está dentro del rango de radio, la ausencia de mensajes de baliza GPSR puede detectar esto. Una vez que detecta esto, el nodo puede expandir su zona. Se necesita un enfoque diferente para detectar hermanos que no están dentro del rango de radio. Estos son los casos en los que dos nodos poseen sus zonas después de intercambiar un mensaje contrario;No intercambian mensajes periódicamente a partir de entonces para mantener esta relación de zona. En este caso, detectamos la falla de manera basada en datos, con beneficios de eficiencia obvios en comparación con los mantenidos periódicos. Una vez que un nodo B ha fallado, un evento o mensaje de consulta que anteriormente debería haber sido propiedad del nodo fallido ahora se entregará al nodo A que posee la zona vacía dejada por el nodo B. A puede ver este mensaje porque A se encuentra justo alrededor del área vacía dejada por B y se garantiza que se visitará en un recorrido perimetral GPSR. A se estableció para ser el propietario del mensaje, y cualquier nodo que hubiera eliminado este mensaje debido a un bucle perimetral redirigirá el mensaje a A. Si la zona es el hermano de la zona BS, A puede expandir de manera segura su propia zona y notificar su zona ampliada a sus vecinos a través de mensajes de baliza GPSR.3.5.2 Prevención de la pérdida de datos por falla del nodo Los algoritmos descritos anteriormente son robustos en términos de formación de la zona, pero la falla del nodo puede borrar los datos. Para evitar esto, los DIM pueden emplear dos tipos de replicación: la replicación local para ser resistente a las fallas de nodos aleatorios y la replicación reflejada para la resiliencia a la falla concurrente de los nodos geográficamente contiguos. La replicación de espejo es conceptualmente fácil. Supongamos que un evento E tiene un código de código de zona (E). Luego, el nodo que inserta E almacenaría dos copias de E;uno en la zona denotada por el código (e) y el otro en la zona correspondiente al complemento de código (e). Esta técnica esencialmente crea un espejo tenue. Una pregunta necesitaría, en paralelo, consultar tanto el DIM original como el espejo ya que no hay forma de saber si una colección de nodos ha fallado. Claramente, la compensación aquí es una duplicación aproximada de la inserción y los costos de consulta. Existe una técnica mucho más barata para garantizar la resiliencia a las fallas de nodos aleatorios. Nuestra técnica de replicación local se basa en la observación de que, para cada nodo A, existe un nodo único que se apoderará de su zona cuando A falle. Este nodo se define como el nodo responsable de la zona de respaldo de zonas (ver Sección 3.1). La idea básica es que una replica cada elemento de datos que tiene en este nodo. Llamamos a este nodo como réplica local. Deje que como réplica local sea B. A menudo, B será un vecino de radio de A y se puede detectar a partir de balizas GPSR. A veces, sin embargo, este no es el caso, y B tendrá que ser descubierto explícitamente. Utilizamos un mensaje explícito para descubrir la réplica local. Descubrir la réplica local está basada en datos y utiliza un mecanismo similar al de la inserción del evento. El nodo A envía un mensaje cuyo destino geográfico es una ubicación cercana aleatoria elegida por A. La ubicación está lo suficientemente cerca de un tal que GPSR garantizará que el mensaje se entregará a A. Además, el mensaje tiene tres campos, uno para el código de zona de A, código (a), uno para el propietario del propietario (a) de la zona (a) que está establecida y otra para la ubicación geográfica del propietario(A). Luego, el paquete se entregará en modo perimetral GPSR. Cada nodo que reciba este mensaje comparará su código de zona y código (a) en el mensaje, y si es más elegible ser el propietario de la zona (a) que el propietario actual (a) registrado en el mensaje, se actualizaráEl propietario del campo (a) y la ubicación geográfica correspondiente. Una vez que el paquete vuelva a A, sabrá la ubicación de su réplica local y puede comenzar a enviar réplicas. En una red de sensores densos, la réplica local de un nodo generalmente está muy cerca del nodo, ya sea su vecino directo o 1-2 saltos de distancia, por lo que el costo de enviar réplicas a la replicación local no dominará el tráfico de la red. Sin embargo, una réplica local de nodos puede fallar. Hay dos formas de lidiar con esta situación;Actualizaciones periódicas o descubrimiento repetido de réplicas locales. El primero tiene una sobrecarga más alta, pero descubre más rápidamente réplicas fallidas.3.5.3 Robustez a la pérdida de paquetes Finalmente, los mecanismos para la consulta y la inserción del evento se pueden hacer fácilmente resistente a la pérdida de paquetes. Para la inserción de eventos, un esquema ACK simple es suficiente. Por supuesto, las consultas y las respuestas también se pueden perder. En este caso, existe un enfoque eficiente para la recuperación de errores. Esto se basa en la observación de que el Querier sabe qué zonas caen dentro de su consulta y deberían haber respondido (suponemos que un nodo que no tiene datos que coincidan con una consulta, pero cuya zona cae dentro de la consulta, responde con un reconocimiento negativo). Después de un tiempo de espera conservador, el Querier puede volver a emitir las consultas selectivamente a estas zonas. Si DIM no puede obtener ninguna respuesta (positiva o negativa) de 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <<0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figura 9: Un ejemplo de consulta de rango dividiendo la quirera de rango de resolución (Q) 1QSUB ← Nil 2 Q0, QSUB ← Split-Query (Q) 3 Si q0 = nil 4 entonces c ← codifica (q) 5 si contiene (c, código (a)) = verdadero 6 entonces vaya al paso 12 7 más envío-Mensaje (c, q0) 8 más resuelve (q0) 9 si es interno () = true 10 entonces absorbe (q0) 11 más o más o más Q0 a QSUB 12 Si qsub = nil 13 entonces para cada subconterrado q ∈ QSUB 14 do c ← codificar(q) 15 envío de mensajes (c, q) Figura 10: Algoritmo de resolución de consulta ciertas zonas Después de tiempos de espera repetidos, al menos puede devolver los resultados de la consulta parcial a la aplicación junto con la información sobre las zonas de las que faltan datos.4. DIMS: un análisis en esta sección, presentamos una evaluación de rendimiento analítica simple de DIMS y comparamos su rendimiento con otros enfoques posibles para implementar consultas de rango multidimensional en redes de sensores. En la siguiente sección, validamos estos análisis utilizando simulaciones detalladas a nivel de paquete. Nuestras métricas principales para el rendimiento de un DIM son: el costo de inserción promedio mide el número promedio de mensajes necesarios para insertar un evento en la red. El costo promedio de entrega de consultas Mide el número promedio de mensajes necesarios para enrutar un mensaje de consulta a todos los nodos relevantes en la red. No mide el número de mensajes requeridos para transmitir respuestas al consulta;Este último número depende de la distribución precisa de los datos y es el mismo para muchos de los esquemas con los que comparamos DIMS. En Dims, la inserción del evento esencialmente utiliza el enrutamiento geográfico. En una densa red de nodo N donde la probabilidad de atravesar perímetros es pequeña, el costo promedio de inserción del evento proporcional a √ n [23]. Por otro lado, el costo de entrega de consultas depende del tamaño de los rangos especificados en la consulta. Recuerde que nuestro mecanismo de entrega de consultas es cuidadoso al dividir una consulta en subteres, hacerlo solo cuando la consulta se acerca a la zona que cubre el rango de consulta. Por lo tanto, cuando el Querier está lejos de la zona consultada, hay dos componentes para el costo de entrega de consultas. El primero, que es proporcional a √ n, es el costo de entregar la consulta cerca de la zona de cobertura. Si dentro de esta zona de cobertura, hay M nodos, el costo de entrega de mensajes de dividir la consulta es proporcional a M. El costo promedio de la entrega de consultas depende de la distribución de los tamaños de rango de consulta. Ahora, supongamos que los tamaños de consulta siguen la función de densidad F (x), entonces el costo promedio de resolver una consulta puede ser aproximado por ê n 1 xf (x) dx. Para dar cierta intuición para el rendimiento de DIMS, consideramos cuatro formas diferentes para F (x): la distribución uniforme donde un rango de consulta que abarca toda la red es tan probable como una consulta puntual;Una distribución uniforme limitada donde todos los tamaños de hasta una B con límite son igualmente probables;Una distribución algebraica en la que la mayoría de las consultas son pequeñas, pero las consultas grandes son algo probables;y una distribución exponencial donde la mayoría de las consultas son pequeñas y grandes consultas son poco probables. En todos nuestros análisis, hacemos la suposición simplificadora de que el tamaño de una consulta es proporcional a la cantidad de nodos que pueden responder esa consulta. Para la distribución uniforme P (x) ∝ c para alguna constante c.Si cada tamaño de consulta de 1... N es igualmente probable, el costo promedio de entrega de consultas de consultas distribuidas uniformemente es o (n). Por lo tanto, para las consultas distribuidas uniformemente, el rendimiento de DIMS es comparable al de las inundaciones. Sin embargo, para las aplicaciones que imaginamos, donde los nodos dentro de la red están tratando de correlacionar los eventos, la distribución uniforme es altamente poco realista. Algo más realista es una situación en la que todos los tamaños de consulta están limitados por un B. constante B. En este caso, el costo promedio para resolver dicha consulta es aproximadamente ê b 1 xf (x) dx = o (b). Recuerde ahora que todas las consultas tienen que pagar un costo aproximado de O (√ n) para entregar la consulta cerca de la zona de cobertura. Por lo tanto, si Dim limitó consultas a un tamaño proporcional a √ n, el costo promedio de consulta sería o (√ n). La distribución algebraica, donde f (x) ∝ x - K, para un k constante entre 1 y 2, tiene un costo de resolución de consulta promedio dado por ê n 1 xf (x) dx = o (n2 -k). En este caso, si K> 1.5, el costo promedio de la entrega de consultas está dominado por el costo de entregar la consulta a cerca de la zona de cobertura, dada por O (√ n). Finalmente, para la distribución exponencial, f (x) = ce - cx para una c constante, y el costo promedio es solo la media de la distribución correspondiente, es decir, o (1) para N. grande asintóticamente, entonces, el costo deLa consulta para la distribución exponencial está dominada por el costo de entregar la consulta cerca de la zona de cobertura (O (√ n)). Por lo tanto, vemos que si las consultas siguen la distribución uniforme limitada, la distribución algebraica o la distribución exponencial, el costo de consulta se escala como el costo de inserción (para la elección apropiada de constantes para el uniforme limitado y las distribuciones algebraicas). ¿Qué tan bien se compara el rendimiento de DIMS con opciones alternativas para implementar consultas multidimensionales? Una alternativa simple se llama almacenamiento externo [23], donde todos los eventos se almacenan centralmente en un nodo fuera de la red de sensores. Este esquema incurre en un costo de inserción de O (√ n) y un costo de consulta cero. Sin embargo, como señala [23], dichos sistemas pueden no ser prácticos en las redes de sensores, ya que el enlace de acceso al nodo externo se convierte en un punto de acceso. Una segunda implementación alternativa almacenaría eventos en el nodo donde se generan. Las consultas se inundan 71 en toda la red, y los nodos que tienen datos coincidentes responden. Los ejemplos de sistemas que pueden usarse para esto (aunque, hasta donde sabemos, estos sistemas no implementan consultas de rango multidimensional) se dirigen difusión [15] y TinyDB [17]. El esquema de inundación incurre en un costo de inserción cero, pero un costo de consulta O (n). Es fácil demostrar que DIMS superan las inundaciones siempre que la relación entre el número de inserciones al número de consultas sea inferior a √ N. Una alternativa final sería usar una tabla de hash geográfica (GHT [20]). En este enfoque, se supone que los valores de los atributos son enteros (en realidad, es una suposición bastante razonable ya que los valores de atributos a menudo se cuantifican), y los eventos se cuestionan en algunos (por ejemplo, el primero) atributo. Una consulta de rango se subdivide en varias subteres, una para cada entero en el rango del primer atributo. Cada subcontrol se ha asaltado a la ubicación apropiada. Los nodos que reciben un subcrefery solo devuelven eventos que coinciden con todos los demás rangos de atributos. En este enfoque, que llamamos GHT-R (GHTS para consultas de rango) el costo de inserción es o (√ n). Suponga que el rango del primer atributo contiene valores discretos. Entonces el costo de entregar consultas es o (r √ n). Por lo tanto, asintóticamente, los GHT-R se desempeñan de manera similar a los DIM. En la práctica, sin embargo, las constantes de proporcionalidad son significativamente diferentes, y las atenuadas superan a los GHT-R, como mostraremos utilizando simulaciones detalladas.5. DIMS: Resultados de simulación Nuestro análisis nos da una idea del comportamiento asintótico de varios enfoques para consultas de rango multidimensional. En esta sección, utilizamos la simulación para comparar los DIMS con las inundaciones y GHT-R;Esta comparación nos brinda una comprensión más detallada de estos enfoques para redes de tamaño moderado, y nos da una visión matizada de las diferencias mecanicistas entre algunos de estos enfoques.5.1 Metodología de simulación Usamos NS-2 para nuestras simulaciones. Dado que los DIM se implementan sobre GPSR, primero portamos una implementación anterior de GPSR a la última versión de NS-2. Modificamos el módulo GPSR para llamar a nuestra implementación tenue cuando recibe cualquier mensaje de datos en tránsito o cuando está a punto de soltar un mensaje porque ese mensaje atravesó todo el perímetro. Esto permite un DIM para modificar los códigos de zona de mensajes en el vuelo (Sección 3) y determinar el propietario real de un evento o consulta. Además, a esto, implementamos en NS-2 la mayoría de los mecanismos DIM descritos en la Sección 3. De esos mecanismos, el único que no implementamos es la replicación de espejo. Hemos implementado la retransmisión de consultas selectivas para la resiliencia a la pérdida de paquetes, pero hemos dejado la evaluación de este mecanismo para el trabajo futuro. Nuestra implementación DIM en NS-2 es 2800 líneas de código. Finalmente, implementamos GHT-R, nuestro mecanismo de consulta de rango multidimensional basado en GHT en NS-2. Esta implementación fue relativamente directa, dado que habíamos portado GPSR y modificamos GPSR para detectar la finalización de los recorridos del modo perimetral. Usando esta implementación, realizamos una evaluación bastante extensa de DIM y dos alternativas (inundaciones y nuestro GHT-R). Para todos nuestros experimentos, utilizamos nodos sensores colocados uniformemente con tamaños de red que van desde 50 nodos hasta 300 nodos. Cada nodo tiene un rango de radio de 40 m. Para los resultados presentados aquí, cada nodo tiene en promedio 20 nodos dentro de su rango de radio nominal. Hemos realizado experimentos en otras densidades de nodo;Están de acuerdo con los resultados presentados aquí. En todos nuestros experimentos, cada nodo genera primero 3 eventos5 en promedio (más precisamente, para una topología de tamaño N, tenemos eventos 3n, y es igualmente probable que cada nodo genere un evento). Hemos realizado experimentos para tres distribuciones de valor de eventos diferentes. Nuestra distribución de eventos uniformes genera eventos bidimensionales y, para cada dimensión, cada valor de atributo es igualmente probable. Nuestra distribución normal de eventos genera eventos bidimensionales y, para cada dimensión, el valor del atributo normalmente se distribuye con una media correspondiente al punto medio del rango de valor de atributo. La distribución normal del evento representa un conjunto de datos sesgado. Finalmente, nuestra distribución de eventos traza es una colección de eventos 4 dimensionales obtenidos de una red de monitoreo de hábitat. Como veremos, esto representa un conjunto de datos bastante sesgado. Habiendo generado eventos, para cada simulación generamos consultas de tal manera que, en promedio, cada nodo genera 2 consultas. Los tamaños de consulta se determinan utilizando las cuatro distribuciones de tamaño que discutimos en la Sección 4: Uniforme, Boundeduniform, Algebraico y Exponencial. Una vez que se ha determinado un tamaño de consulta, la ubicación de la consulta (es decir, los límites reales de la zona) se distribuyen uniformemente. Para nuestros experimentos GHT-R, el rango dinámico de los atributos tenía 100 valores discretos, pero restringimos el rango de consulta para cualquier atributo a 50 valores discretos para permitir que esas simulaciones se completen en un tiempo razonable. Finalmente, utilizando un conjunto de simulaciones evaluamos la eficacia de la replicación local desactivando las fracciones aleatorias de los nodos y midiendo la fidelidad de los resultados devueltos. Las métricas principales para nuestras simulaciones son la consulta promedio y los costos de inserción, como se define en la Sección 4. 5.2 Resultados, aunque hemos examinado casi todas las combinaciones de factores descritos anteriormente, discutimos solo los más destacados aquí, por falta de espacio. La Figura 11 traza los costos de inserción promedio para DIM y GHT-R (para las inundaciones, por supuesto, los costos de inserción son cero). DIM incurre menos por sobrecarga de eventos en la inserción de eventos (independientemente de la distribución real del evento; la Figura 11 muestra el costo de eventos distribuidos uniformemente). La razón de esto es interesante. En GHT-R, almacenar casi todos los eventos incurre en un recorrido perimetral, y almacenar algunos eventos requiere atravesar el perímetro exterior de la red [20]. Por el contrario, en DIM, el almacenamiento de un evento incurre en un transversal perimetral solo cuando los límites de los nodos están indecisos. Además, una inserción o una consulta en un tenue puede atravesar el perímetro externo (Sección 3.3), pero con menos frecuencia que en los GHT. La Figura 13 traza el costo promedio de consulta para una distribución de tamaño de consulta uniforme limitada. Para este gráfico (y el siguiente) utilizamos una distribución de eventos uniformes, ya que la distribución de eventos no afecta el costo de entrega de consultas. Para esta simulación, nuestro límite fue 1 4º del tamaño del más grande posible 5 nuestras métricas se eligen para que el número exacto de eventos y consultas no sea importante para nuestra discusión. Por supuesto, el rendimiento general del sistema dependerá de la frecuencia relativa de eventos y consultas, como discutimos en la Sección 4. Como no tenemos relaciones realistas para estos, nos centramos en los costos microscópicos, en lugar de en los costos generales del sistema.72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AVERAGECTPERINSERTION Tamaño de la red DIM GHT-R Figura 11: Costo de inserción promedio para DIM y GHT.0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 FRACCIÓNFREPLIESCOMAREDINEWITHNON-FAILURECASE Fracción de nodos fallidos (%) Sin replicación Replicación local Figura 12: rendimiento de replicación local.consulta (por ejemplo, una consulta de la forma 0 - 0.5, 0 - 0.5. Incluso para este generoso tamaño de consulta, los dims funcionan bastante bien (casi un tercio del costo de las inundaciones). Observe, sin embargo, que los GHTR incurren en un alto costo de consulta, ya que casi cualquier consulta requiere tantas subconsules como el ancho del primer rango de atributos. La Figura 14 traza el costo promedio de consulta para la distribución exponencial (el tamaño promedio de la consulta para esta distribución se estableció en el 1 16º la mayor consulta posible). La escala superior de DIMS es evidente en estos gráficos. Claramente, este es el régimen en el que uno podría esperar que los DIM funcionen mejor, cuando la mayoría de las consultas son pequeñas y las consultas grandes son relativamente raras. Este es también el régimen en el que uno esperaría usar consultas de rango multidimensionales: realizar correlaciones relativamente estrictas. Al igual que con la distribución uniforme limitada, el costo de la consulta de GHT está dominado por el costo de enviar subcenerías;Para DIMS, la estrategia de división de consultas funciona bastante bien para mantener bajos los costos generales de entrega de consultas. La Figura 12 describe la eficacia de la replicación local. Para obtener esta cifra, realizamos el siguiente experimento. En una red de 100 nodos, insertamos una serie de eventos distribuidos de manera uniforme en toda la red, luego emitimos una consulta que cubre toda la red y registramos las respuestas. Conociendo las respuestas esperadas para esta consulta, luego eliminamos sucesivamente una fracción F de los nodos al azar y volvimos a emitir la misma consulta. La figura traza la fracción de las respuestas esperadas realmente recibidas, con y sin replicación. Como muestra el gráfico, la replicación local funciona bien para fallas aleatorias, devolviendo casi el 90% de las respuestas cuando hasta el 30% de los nodos han fallado simultáneamente 6. En ausencia de replicación local, por supuesto, cuando 6 en la práctica, el rendimiento del rendimientode la replicación local es probable que 0 100 200 200 300 400 500 600 700 50 100 150 200 250 300 AVERAGECESTERQUERYINInBoundedededUnifdistribution Tamaño de red Dim inundación Dim GHT-R Figura 13: Costo de consulta promedio con una distribución de consultas uniformes limitadas 0 50 100 150 200 250 300 350 400 400 450 450 45050 100 150 200 250 300 AveraGecostperQueryinExponentIndistribution Tamaño de la red Dim inundación GHT-R Figura 14: Costo promedio de consulta con una distribución de consultas exponencial El 30% de los nodos fallan, la tasa de respuesta es solo el 70% como se esperaría. Observamos que DIMS (según lo diseñado actualmente) no son perfectos. Cuando los datos están altamente sesgados, como lo fue para nuestro conjunto de datos de rastreo de la aplicación de monitoreo de hábitat, donde la mayoría de los valores de eventos cayeron dentro del 10% de los atributos que rango, unos pocos nodos tenues se convertirán claramente en el cuello de botella. Esto se representa en la Figura 15, que muestra que para DIMS y GHT-RS, el número máximo de transmisiones en cualquier nodo de red (los puntos calientes) es bastante alto.(Para distribuciones de datos menos sesgadas y distribuciones de tamaño de consulta razonables, las curvas de punto de acceso para los tres esquemas son comparables). Este es un problema estándar que los índices de la base de datos han tratado mediante el reequilibrio de los árboles. En nuestro caso, pueden ser posibles soluciones más simples (y discutimos esto en la Sección 7). Sin embargo, nuestro uso de los datos de rastreo demuestra que las DIMS funcionan para eventos que tienen más de dos dimensiones. El aumento del número de dimensiones no degrada notablemente el costo de la consulta Dims (omitido por falta de espacio). También se omiten experimentos que examinan el impacto de varios otros factores, ya que no afectan nuestras conclusiones de ninguna manera. Como esperábamos, los DIM son comparables en el rendimiento de las inundaciones cuando todos los tamaños de consultas son igualmente probables. Para una distribución algebraica de los tamaños de consulta, el rendimiento relativo es cercano a la de la distribución exponencial. Para eventos normalmente distribuidos, los costos de inserción serán mucho mejores que esto. Suponiendo que un nodo y su réplica no fallan simultáneamente a menudo, un nodo casi siempre detectará una falla de réplica y replicará, lo que lleva a tasas de respuesta cercanas al 100%.73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MÁXIMUMHOTSPOTONTRACEDACIÓN Tamaño de red Tamaño de red Dim inundación Dim Ght-R Figura 15: Uso de Hotspot Manager Dim Zone Consulta Consulta Procesador de consultas Event Manager Event Router Interface GPSR (basado en eventos/hilo basado) Actualización Useuse Useuse UseusInterfaz superior GPSR (basado en eventos basado/basado en hilos) Interfaz inferior (basado en eventos/basado en hilos) Reenvío avanzado Reenvío de reenvío Beaconing Actualización de la lista de la lista de vecinos Use el socket IP de Motenic (Micaradio) (802.11b/Ethernet) Figura 16: Arquitectura de software de DIM sobre GPSRson comparables a la de la distribución uniforme. Finalmente, observamos que en todas nuestras evaluaciones solo hemos utilizado consultas de listas (aquellos que solicitan todos los eventos que coincidan con el rango especificado). Esperamos que para consultas sumarias (aquellas que esperan un agregado sobre los eventos coincidentes), el costo general de los DIM podría ser menor porque es probable que los datos coincidentes se encuentren en una o un pequeño número de zonas. Dejamos una comprensión de esto para el trabajo futuro. También se queda al trabajo futuro una comprensión detallada del impacto del error de ubicación en los mecanismos DIMS. El trabajo reciente [22] ha examinado el impacto de la información de ubicación imprecisa sobre otros mecanismos de almacenamiento centrados en datos, como GHT, y descubrió que existen correcciones relativamente simples para GPSR que mejoran los efectos del error de ubicación.6. Implementación Hemos implementado DIMS en una plataforma Linux adecuada para la experimentación en PDA y máquinas de clase PC-104. Para implementar DIMS, tuvimos que desarrollar y probar una implementación independiente de GPSR. Nuestra implementación de GPSR es completa, mientras que nuestra implementación tenue tiene la mayoría de los algoritmos discutidos en la Sección 3;Algunas de las extensiones de robustez solo tienen variantes más simples implementadas. La arquitectura de software del sistema DIM/GPSR se muestra en la Figura 16. Todo el sistema (aproximadamente 5000 líneas de código) está impulsado por eventos y múltiples. El subsistema DIM consta de seis componentes lógicos: gestión de zonas, mantenimiento de eventos, enrutamiento de eventos, enrutamiento de consultas, procesamiento de consultas e interacciones GPSR. El sistema GPSR se implementa como proceso de demonio a nivel de usuario. Las solicitudes se ejecutan como clientes. Para el subsistema DIM, el módulo GPSR 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Tamaño de la consulta N.0 2 4 6 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Consulta SizetotalnumberOfMessages Sólo Forsing the Query Figura 18: El costo de distribución de consultas proporciona varias extensiones: exporta información sobre los vecinos y proporciona devoluciones de llamada durante el reenvío de paquetes durante los paquetes.y terminación del modo perimetral. Probamos nuestra implementación en un Bed de prueba que consta de 8 máquinas de clase PC-104. Cada una de estas cajas ejecuta Linux y usa una mota de mica (unida a través de un cable serie) para la comunicación. Estas cajas se establecen en un edificio de oficinas con una separación espacial total de más de cien pies. Medimos manualmente las ubicaciones de estos nodos en relación con algún sistema de coordenadas y configuramos los nodos con su ubicación. La topología de la red es aproximadamente una cadena. En esta prueba de prueba, insertamos consultas y eventos de un solo nodo designado. Nuestros eventos tienen dos atributos que abarcan todas las combinaciones de los cuatro valores [0, 0.25, 0.75, 1] (dieciséis eventos en total). Nuestras consultas abarcan cuatro tamaños, devolviendo 1, 4, 9 y 16 eventos respectivamente. La Figura 17 traza el número de eventos recibidos para consultas de diferentes tamaños. Puede parecer que recibimos menos eventos de lo esperado, pero este gráfico no cuenta los eventos que ya estaban almacenados en la Quera. Con ese ajuste, el número de respuestas coincide con nuestra expectativa. Finalmente, la Figura 18 muestra el número total de mensajes requeridos para diferentes tamaños de consulta en nuestro Bed de prueba. Si bien estos experimentos no revelan tanto sobre el rango de rendimiento de DIMS como nuestras simulaciones, sin embargo, sirven como prueba de concepto para DIMS. Nuestro siguiente paso en la implementación es portuar las tenencias de las motas de mica e integrarlas en el motor de la base de datos del sensor TinyDB [17] en las motas.74 7. Conclusiones En este documento, hemos discutido el diseño y la evaluación de una estructura de datos distribuida llamada DIM para resolver eficientemente consultas de rango multidimensional en redes de sensores. Nuestro diseño de DIMS se basa en un nuevo hash que presenta la localidad inspirada en el trabajo temprano en la indexación de bases de datos, y se basa en GPSR. Tenemos un prototipo de trabajo, tanto de GPSR como DIM, y planeamos realizar experimentos a mayor escala en el futuro. Hay varias direcciones futuras interesantes que tenemos la intención de seguir. Uno es la adaptación a las distribuciones de datos sesgadas, ya que pueden causar puntos calientes de almacenamiento y transmisión. A diferencia de los índices de base de datos tradicionales que reequilibran los árboles en la inserción de datos, en las redes de sensores podría ser factible reestructurar las zonas en una escala de tiempo mucho mayor después de obtener una estimación global aproximada de la distribución de datos. Otra dirección es el soporte para la heterogeneidad del nodo en el proceso de construcción de la zona;Los nodos con espacio de almacenamiento más grande afirman zonas de mayor tamaño para ellos. Un tercero es el soporte para la resolución eficiente de las consultas existenciales, ya sea que exista un evento que coincide con un rango multidimensional. Agradecimientos Este trabajo se benefició enormemente de las discusiones con Fang Bian, Hui Zhang y otros miembros del Lab Lab, así como de los comentarios proporcionados por los revisores y nuestro pastor Feng Zhao.8. Referencias [1] J. Aspnes y G. Shah. Omita gráficos. En Actas del 14º Simposio ACM-SIAM anual sobre algoritmos discretos (SODA), Baltimore, MD, enero de 2003. [2] J. L. Bentley. Árboles de búsqueda binarios multidimensionales utilizados para la búsqueda asociativa. Comunicaciones de la ACM, 18 (9): 475-484, 1975. [3] P. Bonnet, J. E. Gehrke y P. Seshadri. Hacia sistemas de bases de datos de sensores. En Actas de la Segunda Conferencia Internacional sobre Gestión de datos móviles, Hong Kong, enero de 2001. [4] I. Clarke, O. Sandberg, B. Wiley y T. W. Hong. Freenet: un sistema distribuido de almacenamiento y recuperación de información anónima. En el diseño de tecnologías de mejora de la privacidad: taller internacional sobre temas de diseño en anonimato y no observabilidad. Springer, Nueva York, 2001. [5] D. Comer. El ubicuo árbol B. ACM Computing Surveys, 11 (2): 121-137, 1979. [6] R. A. Finkel y J. L. Bentley. Quadreos: una estructura de datos para recuperar las claves compuestas. Acta Informatica, 4: 1-9, 1974. [7] D. Ganesan, D. Estrin y J. Heidemann. Dimensiones: ¿Por qué necesitamos una nueva arquitectura de manejo de datos para redes de sensores? En Actas del primer taller sobre temas calientes en redes (Hotnets-I), Princeton, NJ, octubre de 2002. [8] A. Gionis, P. Indyk y R. Motwani. Búsqueda de similitud en altas dimensiones a través del hashing. En Actas de la 25ª Conferencia VLDB, Edimburgo, Escocia, septiembre de 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin y S. Shenker. La red de sensores como base de datos. Informe técnico 02-771, Departamento de Ciencias de la Computación, Universidad del Sur de California, septiembre de 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy y S. Shenker. DIFS: un índice distribuido para características en redes de sensores. En Actas del 1er Taller Internacional IEEE sobre protocolos y aplicaciones de la red de sensores, Anchorage, AK, mayo de 2003. [11] A. Guttman. R-TRES: una estructura de índice dinámico para la búsqueda espacial. En Actas del ACM Sigmod, Boston, MA, junio de 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker e I. Stoica. Consultas complejas en redes entre pares basadas en DHT. En P. Druschel, F. Kaashoek y A. Rowstron, editores, Actas del 1er Taller Internacional sobre Sistemas de Pesos (IPTPS02), Volumen 2429 de LNCS, Página 242, Cambridge, MA, marzo de 2002. Springer-Verlag.[13] P. Indyk y R. Motwani. Vecinos aproximados más cercanos: hacia la eliminación de la maldición de la dimensionalidad. En Actas del 30º Simposio ACM anual sobre teoría de la computación, Dallas, Texas, mayo de 1998. [14] P. Indyk, R. Motwani, P. Raghavan y S. Vempala. El hashing de preservación de la localidad en espacios multidimensionales. En Actas del 29º Simposio ACM anual sobre teoría de la computación, páginas 618 - 625, El Paso, Texas, mayo de 1997. ACM Press.[15] C. Intanagonwiwat, R. Govindan y D. Estrin. Difusión dirigida: un paradigma de comunicación escalable y robusto para redes de sensores. En Actas de la Sexta Conferencia Internacional Anual de ACM/IEEE sobre informática móvil y redes (Mobicom 2000), Boston, MA, agosto de 2000. [16] B. Karp y H. T. Kung. GPSR: enrutamiento de estado de estado perimetral codicioso para redes inalámbricas. En Actas de la Sexta Conferencia Internacional Anual de ACM/IEEE sobre computación y redes móviles (Mobicom 2000), Boston, MA, agosto de 2000. [17] S. Madden, M. Franklin, J. Hellerstein y W. Hong. El diseño de un procesador de consulta adquisición para redes de sensores. En Actas de ACM Sigcmod, San Diego, CA, junio de 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein y W. Hong. Etiqueta: un pequeño servicio de agregación para redes de sensores ad-hoc. En Actas del 5º Simposio anual sobre el diseño e implementación de sistemas operativos (OSDI), Boston, MA, diciembre de 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp y S. Shenker. Una red escalable de contenido directo. En Actas de ACM Sigcomm, San Diego, CA, agosto de 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan y S. Shenker. GHT: una tabla de hash geográfica para el almacenamiento centrado en los datos. En Actas del primer Taller Internacional de ACM sobre redes y aplicaciones de sensores inalámbricos, Atlanta, GA, septiembre de 2002. [21] H. Samet. Estructuras de datos espaciales. En W. Kim, editor, Sistemas de base de datos modernos: el modelo de objetos, interoperabilidad y más allá, páginas 361-385. Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy y R. Govindan. Sobre el efecto de los errores de localización en el enrutamiento de la cara geográfica en las redes de sensores. En Sub Submisión, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan y D. Estrin. Almacenamiento centrado en los datos en Sensornets. En Proc. Taller ACM Sigcomm sobre temas calientes en redes, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek y H. Balakrishnan. Acorde: un servicio de búsqueda de pares escalable para aplicaciones de Internet. En Actas de ACM Sigcomm, San Diego, CA, agosto de 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu y L. Zhang. Un modelo de difusión de datos de dos niveles para redes de sensores inalámbricos a gran escala. En Actas de la octava Conferencia Internacional ACM/IEEE sobre computación y redes móviles (Mobicom02), Atlanta, GA, septiembre de 2002. 75",
    "original_sentences": [
        "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
        "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
        "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
        "Such queries are useful for correlating events occurring within the network.",
        "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
        "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
        "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
        "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
        "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
        "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
        "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
        "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
        "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
        "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
        "Such range queries can be used in two distinct ways.",
        "They can help users efficiently drill-down their search for events of interest.",
        "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
        "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
        "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
        "In traditional database systems, such range queries are supported using pre-computed indices.",
        "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
        "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
        "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
        "In this paper, we present just such a data structure, that we call a DIM1 .",
        "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
        "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
        "DIMs trace their lineage to datacentric storage systems [23].",
        "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
        "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
        "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
        "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
        "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
        "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
        "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
        "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
        "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
        "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
        "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
        "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
        "Application designers could then choose the appropriate method of information access.",
        "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
        "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
        "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
        "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
        "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
        "Indexing has, for long, been a classical research problem in the database community [5, 2].",
        "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
        "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
        "There is one important difference.",
        "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
        "The index structure is decided not only by the data, but also by the order in which data is inserted.",
        "Our current design is not data dependent.",
        "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
        "While there has been some work on distributed indexing, the problem has not been extensively explored.",
        "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
        "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
        "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
        "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
        "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
        "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
        "Our work is similar in spirit to this body of literature.",
        "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
        "Our work departs from prior work in this area in two significant respects.",
        "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
        "This hashing is the key to scaling multi-dimensional range searches.",
        "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
        "Our work avoids query flooding by an appropriate choice of hashing.",
        "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
        "This index is used to direct queries to nodes that have detected relevant data.",
        "Our work differs from SRT in three key aspects.",
        "First, SRT is built on single attributes while DIM supports mulitple attributes.",
        "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
        "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
        "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
        "These approaches work well for relatively long-lived queries.",
        "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
        "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
        "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
        "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
        "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
        "In these networks, nodes (either individually or collaboratively) will generate events.",
        "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
        "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
        "Such a query returns all events whose attribute values fall into the corresponding ranges.",
        "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
        "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
        "It is possible to implement range queries by flooding a query within the network.",
        "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
        "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
        "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
        "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
        "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
        "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
        "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
        "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
        "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
        "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
        "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
        "In GPSR, this is called greedy-mode forwarding.",
        "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
        "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
        "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
        "First, all nodes know the approximate geographic boundaries of the network.",
        "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
        "Second, each node knows its geographic location.",
        "Node locations can be automatically determined by a localization system or by other means.",
        "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
        "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
        "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
        "A zone is defined by the following constructive procedure.",
        "Consider a rectangle R on the x-y plane.",
        "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
        "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
        "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
        "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
        "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
        "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
        "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
        "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
        "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
        "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
        "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
        "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
        "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
        "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
        "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
        "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
        "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
        "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
        "Let backup(Z) be the backup zone of zone Z.",
        "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
        "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
        "Now we describe how zones are mapped to nodes.",
        "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
        "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
        "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
        "For some k, some zones may be empty and other zones might have more than one node situated within them.",
        "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
        "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
        "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
        "For any given placement of network nodes, consider a node A.",
        "Let ZA to be the largest zone that includes only node A and no other node.",
        "Then, we say that A owns ZA.",
        "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
        "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
        "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
        "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
        "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
        "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
        "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
        "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
        "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
        "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
        "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
        "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
        "We now describe the algorithm, and illustrate it using examples.",
        "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
        "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
        "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
        "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
        "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
        "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
        "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
        "Figure 3 describes the corresponding zone tree.",
        "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
        "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
        "This binary tree forms the index that we will use in the following event and query processing procedures.",
        "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
        "Notice that in Figure 2, there is an empty zone whose code should be 110.",
        "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
        "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
        "We describe event insertion in the next step.",
        "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
        "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
        "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
        "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
        "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
        "Am.",
        "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
        "We will relax this assumption shortly.",
        "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
        "Our hashing scheme assigns a k bit zone code to an event as follows.",
        "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
        "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
        "We repeat this procedure until all k bits have been assigned.",
        "As an example, consider event E = 0.3, 0.8 .",
        "For this event, the 5-bit zone code is code(ZA) = 01110.",
        "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
        "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
        "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
        "Rather, suppose the encoding node is A and its own zone code is of length kA.",
        "Then, given an event E, node A only hashes E to a zone code of length kA.",
        "We denote the zone code assigned to an event E by code(E).",
        "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
        "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
        "We call this node the owner of the event.",
        "Consider an event E that has just been generated at a node A.",
        "After encoding event E, node A compares code(E) with code(A).",
        "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
        "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
        "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
        "The message contains the event E, code(E), and the target geographic location for storing the event.",
        "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
        "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
        "This next hop node (call it B) does not immediately forward the message.",
        "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
        "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
        "DIM treats NULL as an extreme value for range comparisons.",
        "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
        "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
        "In this manner, as the event wends its way to its owner, its zone code gets refined.",
        "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
        "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
        "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
        "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
        "In this case, we call C an internal node.",
        "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
        "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
        "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
        "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
        "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
        "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
        "If this does not happen, there are two possibilities.",
        "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
        "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
        "Figures 6 through 8 show an example of this data-driven zone shrinking.",
        "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
        "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
        "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
        "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
        "Upon receiving this request, A also shrinks its zone from 0 to 00.",
        "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
        "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
        "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
        "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
        "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
        "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
        "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
        "X will shrink its zone to resolve the overlap.",
        "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
        "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
        "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
        "Figure 6 also works as an example where the outer perimeter is traversed.",
        "Event E inserted by A will eventually be stored in node B.",
        "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
        "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
        "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
        "This is an aggressive approach.",
        "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
        "B will then force the message walking another perimeter before storing it.",
        "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
        "The event will end up being stored at a different node than the real owner.",
        "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
        "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
        "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
        "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
        "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
        "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
        "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
        "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
        "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
        "Procedure Send-Message is used to send either an event message or a query message.",
        "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
        "Routing a point query is identical to routing an event.",
        "Thus, the rest of this section details how range queries are routed.",
        "The key challenge in routing zone queries is brought out by the following strawman design.",
        "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
        "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
        "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
        "We describe this algorithm here.",
        "The first step of the algorithm is to map a range query to a zone code prefix.",
        "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
        "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
        "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
        "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
        "Our approach to split a query Q into subqueries is as follows.",
        "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
        "Then A decides the half that overlaps with its own zone.",
        "Lets call it QA.",
        "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
        "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
        "The splitting steps is shown in Figure 2.",
        "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
        "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
        "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
        "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
        "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
        "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
        "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
        "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
        "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
        "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
        "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
        "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
        "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
        "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
        "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
        "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
        "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
        "Node deletion may also cause zone expansion.",
        "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
        "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
        "Now, we turn our attention to node failures.",
        "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
        "But how does a node decide if its sibling has failed?",
        "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
        "Once it detects this, the node can expand its zone.",
        "A different approach is needed for detecting siblings who are not within radio range.",
        "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
        "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
        "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
        "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
        "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
        "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
        "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
        "Mirror replication is conceptually easy.",
        "Suppose an event E has a zone code code(E).",
        "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
        "This technique essentially creates a mirror DIM.",
        "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
        "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
        "There exists a far cheaper technique to ensure resilience to random node failures.",
        "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
        "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
        "The basic idea is that A replicates each data item it has in this node.",
        "We call this node As local replica.",
        "Let As local replica be B.",
        "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
        "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
        "We use an explicit message for discovering the local replica.",
        "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
        "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
        "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
        "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
        "Then the packet will be delivered in GPSR perimeter mode.",
        "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
        "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
        "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
        "However, a nodes local replica itself may fail.",
        "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
        "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
        "For event insertion, a simple ACK scheme suffices.",
        "Of course, queries and responses can be lost as well.",
        "In this case, there exists an efficient approach for error recovery.",
        "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
        "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
        "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
        "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
        "In the next section, we validate these analyses using detailed packet-level simulations.",
        "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
        "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
        "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
        "In DIMs, event insertion essentially uses geographic routing.",
        "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
        "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
        "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
        "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
        "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
        "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
        "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
        "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
        "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
        "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
        "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
        "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
        "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
        "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
        "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
        "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
        "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
        "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
        "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
        "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
        "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
        "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
        "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
        "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
        "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
        "A second alternative implementation would store events at the node where they are generated.",
        "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
        "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
        "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
        "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
        "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
        "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
        "Each sub-query is then hashed to the appropriate location.",
        "The nodes that receive a sub-query only return events that match all other attribute ranges.",
        "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
        "Suppose that the range of the first attribute contains r discrete values.",
        "Then the cost to deliver queries is O(r √ N).",
        "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
        "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
        "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
        "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
        "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
        "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
        "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
        "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
        "Of those mechanisms, the only one we did not implement is mirror replication.",
        "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
        "Our DIM implementation in ns-2 is 2800 lines of code.",
        "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
        "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
        "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
        "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
        "Each node has a radio range of 40m.",
        "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
        "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
        "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
        "We have conducted experiments for three different event value distributions.",
        "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
        "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
        "The normal event distribution represents a skewed data set.",
        "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
        "As we shall see, this represents a fairly skewed data set.",
        "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
        "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
        "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
        "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
        "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
        "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
        "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
        "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
        "The reason for this is interesting.",
        "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
        "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
        "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
        "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
        "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
        "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
        "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
        "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
        "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
        "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
        "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
        "The superior scaling of DIMs is evident in these graphs.",
        "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
        "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
        "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
        "Figure 12 describes the efficacy of local replication.",
        "To obtain this figure, we conducted the following experiment.",
        "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
        "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
        "The figure plots the fraction of expected responses actually received, with and without replication.",
        "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
        "We note that DIMs (as currently designed) are not perfect.",
        "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
        "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
        "This is a standard problem that the database indices have dealt with by tree re-balancing.",
        "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
        "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
        "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
        "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
        "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
        "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
        "For normally distributed events, the insertion costs be much better than this.",
        "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
        "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
        "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
        "We leave an understanding of this to future work.",
        "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
        "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
        "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
        "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
        "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
        "The software architecture of DIM/GPSR system is shown in Figure 16.",
        "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
        "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
        "The GPSR system is implemented as user-level daemon process.",
        "Applications are executed as clients.",
        "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
        "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
        "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
        "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
        "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
        "The network topology is approximately a chain.",
        "On this testbed, we inserted queries and events from a single designated node.",
        "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
        "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
        "Figure 17 plots the number of events received for different sized queries.",
        "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
        "With that adjustment, the number of responses matches our expectation.",
        "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
        "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
        "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
        "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
        "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
        "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
        "There are several interesting future directions that we intend to pursue.",
        "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
        "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
        "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
        "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
        "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
        "REFERENCES [1] J. Aspnes and G. Shah.",
        "Skip Graphs.",
        "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
        "Multidimensional Binary Search Trees Used for Associative Searching.",
        "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
        "Towards Sensor Database Systems.",
        "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
        "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
        "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
        "Springer, New York, 2001. [5] D. Comer.",
        "The Ubiquitous B-tree.",
        "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
        "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
        "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
        "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
        "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
        "Similarity Search in High Dimensions via Hashing.",
        "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
        "The Sensor Network as a Database.",
        "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
        "DIFS: A Distributed Index for Features in Sensor Networks.",
        "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
        "R-trees: A Dynamic Index Structure for Spatial Searching.",
        "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
        "Complex Queries in DHT-based Peer-to-Peer Networks.",
        "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
        "Springer-Verlag. [13] P. Indyk and R. Motwani.",
        "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
        "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
        "Locality-preserving Hashing in Multidimensional Spaces.",
        "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
        "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
        "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
        "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
        "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
        "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
        "The Design of an Acquisitional Query Processor for Sensor Networks.",
        "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
        "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
        "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
        "A Scalable Content-Addressable Network.",
        "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
        "GHT: A Geographic Hash Table for Data-Centric Storage.",
        "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
        "Spatial Data Structures.",
        "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
        "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
        "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
        "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
        "Data-Centric Storage in Sensornets.",
        "In Proc.",
        "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
        "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
        "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
        "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
        "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
    ],
    "error_count": 0,
    "keys": {
        "sensor network": {
            "translated_key": "red de sensores",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a <br>sensor network</br> for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the <br>sensor network</br>.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a <br>sensor network</br> database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the <br>sensor network</br> context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a <br>sensor network</br> database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a <br>sensor network</br>, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the <br>sensor network</br> were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the <br>sensor network</br>?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense <br>sensor network</br>, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the <br>sensor network</br>.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The <br>sensor network</br> as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on <br>sensor network</br> Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Más importante aún, el software de aplicación se ejecuta dentro de una \"red de sensores\" para correlacionar eventos y activar acciones.",
                "Los DIM están inspirados en los índices de base de datos clásicos, y son esencialmente incrustaciones de tales índices dentro de la \"red de sensores\".",
                "Es probable que todos estos sistemas se integren a un sistema de base de datos de \"red de sensores\", como TinyDB [17].",
                "El trabajo más reciente en el contexto de Internet ha abordado el soporte para consultas de rango en los sistemas DHT [1, 12], pero no está claro si estos se traducen directamente al contexto de \"red de sensores\".",
                "De hecho, los DIMS podrían convertirse en un componente importante de un sistema de base de datos de \"red de sensores\", como TinyDB [17].",
                "Se pueden considerar que las dimensiones y los difs utilizan el mismo conjunto de primitivas que GHT (almacenamiento con hashing consistente), pero para diferentes extremos: las dimensiones permiten la búsqueda de características de Drill64 en una \"red de sensores\", mientras que DIFS permite consultas de rango en una solaClave además de otras operaciones.3.",
                "Si la \"red de sensores\" se implementó de manera similar a la red (es decir, muy regular), entonces es fácil ver que existe una k tal que cada nodo se asigna a una zona de nivel de nivel distinta.",
                "Habiendo definido la asociación entre nodos y zonas, el siguiente problema que abordamos es: dada una colocación de nodo, ¿existe un algoritmo distribuido que permite a cada nodo determinar qué zonas posee, sabiendo solo el límite general de la \"red de sensores\"?",
                "En una densa \"red de sensores\", la réplica local de un nodo generalmente está muy cerca del nodo, ya sea su vecino directo o 1-2 saltos de distancia, por lo que el costo de enviar réplicas a la replicación local no dominará el tráfico de la red.",
                "Una alternativa simple se llama almacenamiento externo [23], donde todos los eventos se almacenan centralmente en un nodo fuera de la \"red de sensores\".",
                "La \"red de sensores\" como una base de datos.",
                "En Actas del 1º Taller Internacional IEEE sobre protocolos y aplicaciones de \"Red de Sensores\", Anchorage, AK, mayo de 2003. [11] A. Guttman."
            ],
            "translated_text": "",
            "candidates": [
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "Red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "red de sensores",
                "Red de Sensores"
            ],
            "error": []
        },
        "multidimensional range query": {
            "translated_key": "consulta de rango multidimensional",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a <br>multidimensional range query</br>.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based <br>multidimensional range query</br> mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Muchos de estos atributos tienen valores escalares, por lo que una forma natural de consultar eventos de interés es utilizar una \"consulta de rango multidimensional\".",
                "Finalmente, implementamos GHT-R, nuestro mecanismo de \"consulta de rango multidimensional\" basado en GHT en NS-2."
            ],
            "translated_text": "",
            "candidates": [
                "consulta de rango multidimensional",
                "consulta de rango multidimensional",
                "consulta de rango multidimensional",
                "consulta de rango multidimensional"
            ],
            "error": []
        },
        "distributed index": {
            "translated_key": "índice distribuido",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a <br>distributed index</br> that scalably supports multi-dimensional range queries.",
                "Our <br>distributed index</br> for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 <br>distributed index</br> for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a <br>distributed index</br>, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A <br>distributed index</br> for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "En este documento, describimos el diseño de un \"índice distribuido\" que admite consultas de rango multidimensionales.",
                "Nuestro \"índice distribuido\" para datos multidimensionales (o DIM) utiliza una nueva incrustación geográfica de una estructura de datos de índice clásico, y se basa en el algoritmo de enrutamiento geográfico GPSR.",
                "Dims aprovecha dos ideas clave: In-Network 1 \"Índice distribuido\" para datos multidimensionales.63 Almacenamiento centrado en datos y un nuevo hash geográfico que presenta la localidad (Sección 3).",
                "Madden et al.[17] también describe un \"índice distribuido\", llamado árboles de enrutamiento semántico (SRT).",
                "DIFS: un \"índice distribuido\" para características en redes de sensores."
            ],
            "translated_text": "",
            "candidates": [
                "índice distribuido",
                "índice distribuido",
                "índice distribuido",
                "índice distribuido",
                "índice distribuido",
                "Índice distribuido",
                "índice distribuido",
                "índice distribuido",
                "índice distribuido",
                "índice distribuido"
            ],
            "error": []
        },
        "centralized index": {
            "translated_key": "índice centralizado",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a <br>centralized index</br> for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Para las redes de sensores, afirmamos que un \"índice centralizado\" para consultas de rango multidimensional puede no ser factible por razones de eficiencia energética (así como el hecho de que el ancho de banda de acceso a este índice central será limitado, particularmente para consultas que emanan desdedentro de la red)."
            ],
            "translated_text": "",
            "candidates": [
                "índice centralizado",
                "índice centralizado"
            ],
            "error": []
        },
        "distributed datum structure": {
            "translated_key": "Estructura de dato distribuida",
            "is_in_text": false,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [],
            "translated_text": "",
            "candidates": [],
            "error": []
        },
        "datacentric storage system": {
            "translated_key": "",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to <br>datacentric storage system</br>s [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Dims traza su linaje al \"Sistema de almacenamiento de datos de datos\" S [23]."
            ],
            "translated_text": "",
            "candidates": [
                "sistema de almacenamiento datacéntrico",
                "Sistema de almacenamiento de datos de datos"
            ],
            "error": []
        },
        "geographic routing": {
            "translated_key": "enrutamiento geográfico",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR <br>geographic routing</br> algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying <br>geographic routing</br> algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying <br>geographic routing</br> scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a <br>geographic routing</br> algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses <br>geographic routing</br>.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Nuestro índice distribuido para datos multidimensionales (o DIM) utiliza una nueva incrustación geográfica de una estructura de datos de índice clásico, y se basa en el algoritmo de \"enrutamiento geográfico\" GPSR.",
                "Dims luego usa un algoritmo subyacente de \"enrutamiento geográfico\" (GPSR [16]) para enrutar eventos y consultas a sus nodos correspondientes de manera completamente distribuida.",
                "El sistema que presentamos en este documento, el DIM, se basa en dos bases: un hash geográfico que presenta la localidad y un esquema subyacente de \"enrutamiento geográfico\".",
                "Habiendo establecido el mapeo y la estructura de la zona, los DIMS utilizan un algoritmo de \"enrutamiento geográfico\" desarrollado previamente en la literatura para enrutar los eventos a sus nodos correspondientes, o para resolver consultas.",
                "En Dims, la inserción del evento esencialmente usa \"enrutamiento geográfico\"."
            ],
            "translated_text": "",
            "candidates": [
                "enrutamiento geográfico",
                "enrutamiento geográfico",
                "enrutamiento geográfico",
                "enrutamiento geográfico",
                "enrutamiento geográfico",
                "enrutamiento geográfico",
                "enrutamiento geográfico",
                "enrutamiento geográfico",
                "enrutamiento geográfico",
                "enrutamiento geográfico"
            ],
            "error": []
        },
        "event insertion": {
            "translated_key": "",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for <br>event insertion</br> and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the <br>event insertion</br> and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe <br>event insertion</br> in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an <br>event insertion</br> might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our <br>event insertion</br> procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the <br>event insertion</br> mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of <br>event insertion</br> to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and <br>event insertion</br>, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of <br>event insertion</br>.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and <br>event insertion</br> can be easily made resilient to packet loss.",
                "For <br>event insertion</br>, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, <br>event insertion</br> essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average <br>event insertion</br> cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Discutimos el diseño de un algoritmos tenues y presentes para la \"inserción de eventos\" y la consulta, para mantener un DIM en caso de falla del nodo y para hacer que las tenues seas robustas a los datos o la pérdida de paquetes (Sección 3).",
                "En simulaciones detalladas, mostramos que en la práctica, la \"inserción del evento\" y la consulta de los costos de otras alternativas son a veces un orden de magnitud los costos de los DIMS, incluso para la red de tamaño moderado.",
                "Describimos la \"inserción del evento\" en el siguiente paso.",
                "El primero es que hay algunos casos en los que una \"inserción del evento\" podría causar que todo el perímetro externo de la red se atravese3.",
                "Entonces, al comparar el código de eventos y el código de vecinos, un nodo puede decidir si existe un vecino que es más probable que sea el propietario del evento E. C entrega e a Y, lo que simplemente sigue el procedimiento de toma de decisiones discutido anteriormente.3.3.4 Resumen y pseudocódigo En resumen, nuestro procedimiento de \"inserción de eventos\" está diseñado para interactuar muy bien con el mecanismo de descubrimiento de zona y el mecanismo de hash de eventos.",
                "Los dos últimos mecanismos se mantienen simples, mientras que el mecanismo de \"inserción de eventos\" utiliza una evaluación perezosa en cada salto para refinar el código de la zona de eventos, y aprovecha el mecanismo de caminar perimetral GPSR para fijar los límites de la zona indecisos.",
                "En la Sección 3.5, abordamos la robustez de la \"inserción del evento\" a la pérdida de paquetes o a las fallas de nodo.",
                "Las pérdidas de paquetes pueden afectar la consulta y la \"inserción del evento\", y las fallas de nodos pueden dar lugar a datos perdidos, mientras que las llegadas y salidas de nodos pueden afectar la estructura de la zona.",
                "Descubrir la réplica local está basada en datos y utiliza un mecanismo similar al de \"inserción de eventos\".",
                "El primero tiene una sobrecarga más alta, pero descubre más rápidamente réplicas fallidas.3.5.3 Robustez a la pérdida de paquetes Finalmente, los mecanismos para la consulta y la \"inserción del evento\" se pueden hacer fácilmente resistentes a la pérdida de paquetes.",
                "Para \"inserción de eventos\", un esquema ACK simple es suficiente.",
                "En Dims, la \"inserción del evento\" esencialmente utiliza el enrutamiento geográfico.",
                "En una densa red de nodos N donde la probabilidad de atravesar perímetros es pequeña, el costo promedio de \"inserción de eventos\" proporcional a √ n [23]."
            ],
            "translated_text": "",
            "candidates": [
                "inserción del evento",
                "inserción de eventos",
                "inserción del evento",
                "inserción del evento",
                "inserción del evento",
                "inserción del evento",
                "inserción del evento",
                "inserción del evento",
                "inserción del evento",
                "inserción de eventos",
                "inserción del evento",
                "inserción de eventos",
                "inserción del evento",
                "inserción del evento",
                "inserción del evento",
                "inserción del evento",
                "inserción del evento",
                "inserción de eventos",
                "inserción del evento",
                "inserción del evento",
                "inserción del evento",
                "inserción de eventos",
                "inserción del evento",
                "inserción del evento",
                "inserción del evento",
                "inserción de eventos"
            ],
            "error": []
        },
        "querying cost": {
            "translated_key": "",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and <br>querying cost</br>s of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "En simulaciones detalladas, mostramos que en la práctica, la inserción del evento y los \"costos de consulta\" de otras alternativas son a veces un orden de magnitud los costos de los DIMS, incluso para una red de tamaño moderado."
            ],
            "translated_text": "",
            "candidates": [
                "costo de consulta",
                "costos de consulta"
            ],
            "error": []
        },
        "indexing technique": {
            "translated_key": "técnica de indexación",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using <br>indexing technique</br>s.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Trabajo relacionado El problema básico que aborda este documento, consultas de rango multidimensional, generalmente se resuelve en los sistemas de bases de datos utilizando \"técnica de indexación\" s."
            ],
            "translated_text": "",
            "candidates": [
                "técnica de indexación",
                "técnica de indexación"
            ],
            "error": []
        },
        "query flooding": {
            "translated_key": "inundación de consulta",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids <br>query flooding</br> by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Nuestro trabajo evita la \"inundación de consulta\" por una opción apropiada de hashing."
            ],
            "translated_text": "",
            "candidates": [
                "inundación de consulta",
                "inundación de consulta"
            ],
            "error": []
        },
        "efficient correlation": {
            "translated_key": "correlación eficiente",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable <br>efficient correlation</br> and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Como hemos discutido en la Sección 1, las consultas de rango pueden habilitar la \"correlación eficiente\" y activarse dentro de la red."
            ],
            "translated_text": "",
            "candidates": [
                "correlación eficiente",
                "correlación eficiente"
            ],
            "error": []
        },
        "locality-preserving geographic hash": {
            "translated_key": "",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel <br>locality-preserving geographic hash</br> (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a <br>locality-preserving geographic hash</br>, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a <br>locality-preserving geographic hash</br> function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Dims aprovecha dos ideas clave: índice distribuido en la red 1 para datos multidimensionales.63 Almacenamiento centrado en datos y un nuevo \"hash geográfico que presenta la localidad\" (Sección 3).",
                "El sistema que presentamos en este documento, el DIM, se basa en dos bases: un \"hash geográfico que presenta la localidad\" y un esquema de enrutamiento geográfico subyacente.",
                "La visión básica subyacente al DIM es que la localidad de datos se puede obtener mediante una función de \"hash geográfico que presenta la localidad\"."
            ],
            "translated_text": "",
            "candidates": [
                "hash geográfica preservando la localidad",
                "hash geográfico que presenta la localidad",
                "hash geográfica preservando la localidad",
                "hash geográfico que presenta la localidad",
                "hash geográfica preservando la localidad",
                "hash geográfico que presenta la localidad"
            ],
            "error": []
        },
        "asymptotic behavior": {
            "translated_key": "comportamiento asintótico",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the <br>asymptotic behavior</br> of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "DIMS: Resultados de simulación Nuestro análisis nos da una idea del \"comportamiento asintótico\" de varios enfoques para consultas de rango multidimensional."
            ],
            "translated_text": "",
            "candidates": [
                "comportamiento asintótico",
                "comportamiento asintótico"
            ],
            "error": []
        },
        "normal event distribution": {
            "translated_key": "",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our <br>normal event distribution</br> generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The <br>normal event distribution</br> represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Nuestra \"distribución normal de eventos\" genera eventos bidimensionales y, para cada dimensión, el valor del atributo normalmente se distribuye con una media correspondiente al punto medio del rango de valor de atributo.",
                "La \"distribución normal de eventos\" representa un conjunto de datos sesgado."
            ],
            "translated_text": "",
            "candidates": [
                "Distribución de eventos normal",
                "distribución normal de eventos",
                "Distribución de eventos normal",
                "distribución normal de eventos"
            ],
            "error": []
        },
        "dim": {
            "translated_key": "",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or <br>dim</br>) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a multi-dimensional range query on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a <br>dim</br>, presenting algorithms for event insertion and querying, for maintaining a <br>dim</br> in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use <br>dim</br> to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while <br>dim</br> supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in <br>dim</br> queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the <br>dim</br>, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying <br>dim</br> is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a <br>dim</br> to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a <br>dim</br>.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a <br>dim</br>.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a <br>dim</br> that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 <br>dim</br> does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional <br>dim</br>, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "<br>dim</br> treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many <br>dim</br> instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "<br>dim</br> index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror <br>dim</br>.",
                "A querier would need, in parallel, to query both the original <br>dim</br> and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If <br>dim</br> cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a <br>dim</br> are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if <br>dim</br> limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our <br>dim</br> implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a <br>dim</br> to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the <br>dim</br> mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our <br>dim</br> implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of <br>dim</br> and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for <br>dim</br> and GHT-R (for flooding, of course, the insertion costs are zero).",
                "<br>dim</br> incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in <br>dim</br>, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a <br>dim</br> can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size <br>dim</br> GHT-R Figure 11: Average insertion cost for <br>dim</br> and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size <br>dim</br> flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size <br>dim</br> flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few <br>dim</br> nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size <br>dim</br> flooding GHT-R Figure 15: Hotspot usage <br>dim</br> Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our <br>dim</br> implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of <br>dim</br>/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The <br>dim</br> subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the <br>dim</br> subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called <br>dim</br> for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and <br>dim</br>, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Nuestro índice distribuido para datos multidimensionales (o \"dim\") utiliza una nueva incrustación geográfica de una estructura de datos de índice clásico, y se basa en el algoritmo de enrutamiento geográfico GPSR.",
                "Discutimos el diseño de un \"tenue\", presentando algoritmos para la inserción y consulta de eventos, para mantener un \"tenue\" en caso de falla del nodo y para hacer que las tenues de los datos o la pérdida de paquetes (Sección 3).",
                "Por ejemplo, una aplicación de seguimiento de incendios usaría \"DIM\" para detectar los puntos de acceso, y luego usaría mecanismos que permitan consultas continuas [15, 18] para rastrear el progreso espacio-temporal de los puntos de acceso.",
                "Primero, SRT se basa en atributos individuales, mientras que \"DIM\" admite múltiples atributos.",
                "Finalmente, en las consultas SRT se emiten desde un nodo fijo, mientras que en las consultas \"Dim\" se pueden emitir desde cualquier nodo.",
                "El sistema que presentamos en este documento, el \"DIM\", se basa en dos bases: un hash geográfico que presenta la localidad y un esquema de enrutamiento geográfico subyacente.",
                "La visión básica subyacente \"DIM\" es que la localidad de datos puede obtenerse mediante una función hash geográfica que presenta la localidad.",
                "Debido a que hace que nuestro sistema de enrutamiento de consultas general sea más simple, permitimos que los nodos en un \"tenue\" se asignen a zonas de diferentes tamaños.",
                "Cada zona reside en un nodo de hoja y el código de una zona es la ruta desde la raíz hasta la zona si representamos la rama a la zona de construcción 66 izquierda (a) 1 mientras contiene (za, a) 2 do si longitud (código (za)) Mod 2 = 0 3 Entonces nuevo Bound ← (Bound [0] + Bound [1])/2 4 Si A.x <nuevo Bound 5 luego Bound [1] ← New Bound 6 más Bound [0] ← NUEVOBound 7 más nuevo Bound ← (Bound [2] + Bound [3])/2 8 if A.Y <nuevo Bound 9 entonces Bound [3] ← New Bound 10 más Bound [2] ← Código de código de zona de actualización de New Bound 11 (ZA ZA) Figura 4: Determinación del límite de zona, donde A.x y A.y representan la coordenada geográfica del nodo A. Insertar-Evento (E) 1 C ← Codificar (E) 2 Si contiene (ZA, C) = True y es interno () = True3 luego almacene E y Salir 4 Enviar mensajes (C, E) Enviar mensaje (C, M) 1 Si ∃ vecino y, cerrador (y, propietario (m), m) = verdadero 2 entonces addr (m) ← addr(Y) 3 de lo contrario si longitud (c)> longitud (código (m)) 4 luego actualice el código (m) y addr (m) 5 fuente (m) ← que llama 6 if es propietario (msg) = true 7 entonces propietario (propietario (m) ← Código de llamadas 8 Enviar (M) Figura 5: Insertar un evento en un \"Dim\".",
                "Regresamos a esto en la Sección 3.5.3.3 Insertando un evento en esta sección, describimos cómo se insertan los eventos en un \"tenue\".",
                "Ahora describimos un esquema de hashing consistente para un \"tenue\" que respalda las consultas de rango en m distintos atributos2, denotemos estos atributos A1...",
                "Más bien, intenta COM2 \"Dim\" no supone que todos los nodos son homogéneos en términos de los sensores que tienen.",
                "Por lo tanto, en un \"dim\" m dimensional, un nodo que no posee todos los sensores M puede usar valores nulos para las lecturas correspondientes.",
                "\"Dim\" trata NULL como un valor extremo para las comparaciones de rango.",
                "Como aparte, una red puede tener muchas instancias \"tenues\" que se ejecutan simultáneamente.67 Puse un nuevo código de zona para que E obtenga un nuevo código de código (E).",
                "Los atributos de índice \"DIM\" no son necesariamente claves primarias.69 La ubicación geográfica de su iniciador, por lo que el mensaje de respuesta correspondiente se puede entregar directamente al iniciador.",
                "Esta técnica esencialmente crea un espejo \"DIM\".",
                "Un Querier necesitaría, en paralelo, consultar tanto el \"Dim\" original como su espejo ya que no hay forma de saber si una colección de nodos ha fallado.",
                "",
                "Nuestras métricas principales para el rendimiento de un \"DIM\" son: el costo de inserción promedio mide el número promedio de mensajes necesarios para insertar un evento en la red.",
                "Por lo tanto, si las consultas limitadas \"tenues\" a un tamaño proporcional a √ n, el costo promedio de consulta sería o (√ n).",
                "Modificamos el módulo GPSR para llamar a nuestra implementación \"tenue\" cuando recibe cualquier mensaje de datos en tránsito o cuando está a punto de soltar un mensaje porque ese mensaje atravesó todo el perímetro.",
                "Esto permite que un \"tenue\" modifique los códigos de zona de mensaje en el vuelo (Sección 3) y determine el propietario real de un evento o consulta.",
                "Además, a esto, implementamos en NS-2, la mayoría de los mecanismos \"DIM\" descritos en la Sección 3.",
                "Nuestra implementación \"dim\" en NS-2 es 2800 líneas de código.",
                "Usando esta implementación, realizamos una evaluación bastante extensa de \"Dim\" y dos alternativas (inundaciones y nuestro GHT-R).",
                "La Figura 11 traza los costos de inserción promedio para \"DIM\" y GHT-R (para inundaciones, por supuesto, los costos de inserción son cero).",
                "\"Dim\" incurre menos por sobrecarga por evento en la inserción de eventos (independientemente de la distribución de eventos real; la Figura 11 muestra el costo de eventos distribuidos uniformemente).",
                "Por el contrario, en \"Dim\", el almacenamiento de un evento incurre en un transversal perimetral solo cuando los límites de los nodos están indecisos.",
                "Además, una inserción o una consulta en un \"tenue\" puede atravesar el perímetro exterior (Sección 3.3), pero con menos frecuencia que en GHTS.",
                "Como no tenemos relaciones realistas para estos, nos centramos en los costos microscópicos, en lugar de en los costos generales del sistema.72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AveraGostperinsertion Tamaño de la red \"Dim\" GHT-R Figura 11: Costo de inserción promedio para \"Dim\" y GHT.0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 FRACCIÓNFREPLIESCOMAREDINEWITHNON-FAILURECASE Fracción de nodos fallidos (%) Sin replicación Replicación local Figura 12: rendimiento de replicación local.consulta (por ejemplo, una consulta de la forma 0 - 0.5, 0 - 0.5.",
                "Como muestra el gráfico, la replicación local funciona bien para fallas aleatorias, devolviendo casi el 90% de las respuestas cuando hasta el 30% de los nodos han fallado simultáneamente 6. En ausencia de replicación local, por supuesto, cuando 6 en la práctica, el rendimiento del rendimientoEs probable que la replicación local sea 0 100 200 200 300 400 500 600 700 50 100 150 200 250 300 AVERAGECESTPERQUERYINInBoundededUnifdistribution Tamaño de la red \"Dim\" GHT-R Figura 13: Costo de consulta promedio con una distribución de consultas uniforme limitada 0 50 100 150 2000 300 350 350400 450 50 100 150 150 200 250 300 AveragecostperQueryinExponentIldistribution Tamaño de la red \"Dim\" inundación GHT-R Figura 14: Costo promedio de consulta con una distribución de consulta exponencial El 30% de los nodos fallan, la tasa de respuesta es solo del 70% como se esperaría.",
                "Cuando los datos están altamente sesgados, como lo fue para nuestro conjunto de datos de rastreo de la aplicación de monitoreo de hábitat, donde la mayoría de los valores de eventos cayeron dentro del 10% de los atributos, un rango de los pocos nodos \"tenues\" se convertirán claramente en el cuello de botella.",
                "Suponiendo que un nodo y su réplica no fallan simultáneamente a menudo, un nodo casi siempre detectará una falla de réplica y replicará, lo que lleva a tasas de respuesta cercanas al 100%.73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MÁXIMUMHOTSPOTOTRACEDACEDACIÓN Tamaño de la red \"Dim\" inundación GHT-R Figura 15: Interfaz GPSR de consulta de consulta de consulta de consulta de consulta de la consulta de la zona \"dim\") Actualizar UseSe UseSe GPSR Interfaz superior (basado en eventos basado/hilo) Interfaz inferior (basado en eventos basado/hilo) Reenvío de reenvío codicioso reenvío Beaconing Beaconing Vecin Manager Actualización Use Motenic (Micaradio) IP Socket (802.11b/Ethernet) Figura 16: Arquitectura de softwarede DIM sobre GPSR son comparables a la de la distribución uniforme.",
                "Nuestra implementación de GPSR es completa, mientras que nuestra implementación \"tenue\" tiene la mayoría de los algoritmos discutidos en la Sección 3;Algunas de las extensiones de robustez solo tienen variantes más simples implementadas.",
                "La arquitectura de software del sistema \"dim\"/GPSR se muestra en la Figura 16.",
                "El subsistema \"DIM\" consta de seis componentes lógicos: gestión de zonas, mantenimiento de eventos, enrutamiento de eventos, enrutamiento de consultas, procesamiento de consultas e interacciones GPSR.",
                "Para el subsistema \"Dim\", el módulo GPSR 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Tamaño de la consulta Promedio#OfReceivedResponses Perquery Figura 17: Número de eventos recibidos para diferentesTamaños de consulta 0 2 4 6 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Consulta SizetotalnumberOfMessages Sólo Forsing TheQuery Figura 18: El costo de distribución de consultas proporciona varias extensiones: exporta información sobre los vecinos y proporciona devoluciones de llamadas duranteReenvío de paquetes y terminación del modo perímetro.",
                "Conclusiones En este documento, hemos discutido el diseño y la evaluación de una estructura de datos distribuida llamada \"Dim\" para resolver eficientemente consultas de rango multidimensional en redes de sensores.",
                "Tenemos un prototipo de trabajo, tanto de GPSR como de \"Dim\", y planeamos realizar experimentos a mayor escala en el futuro."
            ],
            "translated_text": "",
            "candidates": [
                "oscuro",
                "dim",
                "oscuro",
                "tenue",
                "tenue",
                "oscuro",
                "DIM",
                "oscuro",
                "DIM",
                "oscuro",
                "Dim",
                "oscuro",
                "DIM",
                "oscuro",
                "DIM",
                "oscuro",
                "tenue",
                "oscuro",
                "Dim",
                "oscuro",
                "tenue",
                "oscuro",
                "tenue",
                "oscuro",
                "Dim",
                "oscuro",
                "dim",
                "oscuro",
                "Dim",
                "oscuro",
                "tenues",
                "oscuro",
                "DIM",
                "oscuro",
                "DIM",
                "oscuro",
                "Dim",
                "",
                "Dim",
                "oscuro",
                "DIM",
                "oscuro",
                "tenues",
                "oscuro",
                "tenue",
                "oscuro",
                "tenue",
                "Dim",
                "DIM",
                "oscuro",
                "dim",
                "oscuro",
                "Dim",
                "oscuro",
                "DIM",
                "oscuro",
                "Dim",
                "oscuro",
                "Dim",
                "oscuro",
                "tenue",
                "Dim",
                "Dim",
                "Dim",
                "oscuro",
                "Dim",
                "Dim",
                "oscuro",
                "tenues",
                "oscuro",
                "Dim",
                "dim",
                "oscuro",
                "tenue",
                "Dim",
                "dim",
                "oscuro",
                "DIM",
                "oscuro",
                "Dim",
                "oscuro",
                "Dim",
                "oscuro",
                "Dim"
            ],
            "error": []
        },
        "multi-dimensional range query": {
            "translated_key": "Consulta de rango multidimensional",
            "is_in_text": true,
            "original_annotated_sentences": [
                "Multi-dimensional Range Queries in Sensor Networks∗ Xin Li † Young Jin Kim † Ramesh Govindan † Wei Hong ‡ ABSTRACT In many sensor networks, data or events are named by attributes.",
                "Many of these attributes have scalar values, so one natural way to query events of interest is to use a multidimensional range query.",
                "An example is: List all events whose temperature lies between 50◦ and 60◦ , and whose light levels lie between 10 and 15.",
                "Such queries are useful for correlating events occurring within the network.",
                "In this paper, we describe the design of a distributed index that scalably supports multi-dimensional range queries.",
                "Our distributed index for multi-dimensional data (or DIM) uses a novel geographic embedding of a classical index data structure, and is built upon the GPSR geographic routing algorithm.",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the insertion and query costs of other alternatives are sometimes an order of magnitude more than the costs of DIMs, even for moderately sized network.",
                "Finally, experiments on a small scale testbed validate the feasibility of DIMs.",
                "Categories and Subject Descriptors C.2.4 [Computer Communication Networks]: Distributed Systems; C.3 [Special-Purpose and Application-Based Systems]: Embedded Systems General Terms Embedded Systems, Sensor Networks, Storage 1.",
                "INTRODUCTION In wireless sensor networks, data or events will be named by attributes [15] or represented as virtual relations in a distributed database [18, 3].",
                "Many of these attributes will have scalar values: e.g., temperature and light levels, soil moisture conditions, etc.",
                "In these systems, we argue, one natural way to query for events of interest will be to use multi-dimensional range queries on these attributes.",
                "For example, scientists analyzing the growth of marine microorganisms might be interested in events that occurred within certain temperature and light conditions: List all events that have temperatures between 50◦ F and 60◦ F, and light levels between 10 and 20.",
                "Such range queries can be used in two distinct ways.",
                "They can help users efficiently drill-down their search for events of interest.",
                "The query described above illustrates this, where the scientist is presumably interested in discovering, and perhaps mapping the combined effect of temperature and light on the growth of marine micro-organisms.",
                "More importantly, they can be used by application software running within a sensor network for correlating events and triggering actions.",
                "For example, if in a habitat monitoring application, a bird alighting on its nest is indicated by a certain range of thermopile sensor readings, and a certain range of microphone readings, a <br>multi-dimensional range query</br> on those attributes enables higher confidence detection of the arrival of a flock of birds, and can trigger a system of cameras.",
                "In traditional database systems, such range queries are supported using pre-computed indices.",
                "Indices trade-off some initial pre-computation cost to achieve a significantly more efficient querying capability.",
                "For sensor networks, we assert that a centralized index for multi-dimensional range queries may not be feasible for energy-efficiency reasons (as well as the fact that the access bandwidth to this central index will be limited, particularly for queries emanating from within the network).",
                "Rather, we believe, there will be situations when it is more appropriate to build an innetwork distributed data structure for efficiently answering multi-dimensional range queries.",
                "In this paper, we present just such a data structure, that we call a DIM1 .",
                "DIMs are inspired by classical database indices, and are essentially embeddings of such indices within the sensor network.",
                "DIMs leverage two key ideas: in-network 1 Distributed Index for Multi-dimensional data. 63 data centric storage, and a novel locality-preserving geographic hash (Section 3).",
                "DIMs trace their lineage to datacentric storage systems [23].",
                "The underlying mechanism in these systems allows nodes to consistently hash an event to some location within the network, which allows efficient retrieval of events.",
                "Building upon this, DIMs use a technique whereby events whose attribute values are close are likely to be stored at the same or nearby nodes.",
                "DIMs then use an underlying geographic routing algorithm (GPSR [16]) to route events and queries to their corresponding nodes in an entirely distributed fashion.",
                "We discuss the design of a DIM, presenting algorithms for event insertion and querying, for maintaining a DIM in the event of node failure, and for making DIMs robust to data or packet loss (Section 3).",
                "We then extensively evaluate DIMs using analysis (Section 4), simulation (Section 5), and actual implementation (Section 6).",
                "Our analysis reveals that, under reasonable assumptions about query distributions, DIMs scale quite well with network size (both insertion and query costs scale as O( √ N)).",
                "In detailed simulations, we show that in practice, the event insertion and querying costs of other alternatives are sometimes an order of magnitude the costs of DIMs, even for moderately sized network.",
                "Experiments on a small scale testbed validate the feasibility of DIMs (Section 6).",
                "Much work remains, including efficient support for skewed data distributions, existential queries, and node heterogeneity.",
                "We believe that DIMs will be an essential, but perhaps not necessarily the only, distributed data structure supporting efficient queries in sensor networks.",
                "DIMs will be part of a suite of such systems that enable feature extraction [7], simple range querying [10], exact-match queries [23], or continuous queries [15, 18].",
                "All such systems will likely be integrated to a sensor network database system such as TinyDB [17].",
                "Application designers could then choose the appropriate method of information access.",
                "For instance, a fire tracking application would use DIM to detect the hotspots, and would then use mechanisms that enable continuous queries [15, 18] to track the spatio-temporal progress of the hotspots.",
                "Finally, we note that DIMs are applicable not just to sensor networks, but to other deeply distributed systems (embedded networks for home and factory automation) as well. 2.",
                "RELATED WORK The basic problem that this paper addresses - multidimensional range queries - is typically solved in database systems using indexing techniques.",
                "The database community has focused mostly on centralized indices, but distributed indexing has received some attention in the literature.",
                "Indexing techniques essentially trade-off some data insertion cost to enable efficient querying.",
                "Indexing has, for long, been a classical research problem in the database community [5, 2].",
                "Our work draws its inspiration from the class of multi-key constant branching index structures, exemplified by k-d trees [2], where k represents the dimensionality of the data space.",
                "Our approach essentially represents a geographic embedding of such structures in a sensor field.",
                "There is one important difference.",
                "The classical indexing structures are data-dependent (as are some indexing schemes that use locality preserving hashes, and developed in the theory literature [14, 8, 13]).",
                "The index structure is decided not only by the data, but also by the order in which data is inserted.",
                "Our current design is not data dependent.",
                "Finally, tangentially related to our work is the class of spatial indexing systems [21, 6, 11].",
                "While there has been some work on distributed indexing, the problem has not been extensively explored.",
                "There exist distributed indices of a restricted kind-those that allow exact match or partial prefix match queries.",
                "Examples of such systems, of course, are the Internet Domain Name System, and the class of distributed hash table (DHT) systems exemplified by Freenet[4], Chord[24], and CAN[19].",
                "Our work is superficially similar to CAN in that both construct a zone-based overlay atop of the underlying physical network.",
                "The underlying details make the two systems very different: CANs overlay is purely logical while our overlay is consistent with the underlying physical topology.",
                "More recent work in the Internet context has addressed support for range queries in DHT systems [1, 12], but it is unclear if these directly translate to the sensor network context.",
                "Several research efforts have expressed the vision of a database interface to sensor networks [9, 3, 18], and there are examples of systems that contribute to this vision [18, 3, 17].",
                "Our work is similar in spirit to this body of literature.",
                "In fact, DIMs could become an important component of a sensor network database system such as TinyDB [17].",
                "Our work departs from prior work in this area in two significant respects.",
                "Unlike these approaches, in our work the data generated at a node are hashed (in general) to different locations.",
                "This hashing is the key to scaling multi-dimensional range searches.",
                "In all the other systems described above, queries are flooded throughout the network, and can dominate the total cost of the system.",
                "Our work avoids query flooding by an appropriate choice of hashing.",
                "Madden et al. [17] also describe a distributed index, called Semantic Routing Trees (SRT).",
                "This index is used to direct queries to nodes that have detected relevant data.",
                "Our work differs from SRT in three key aspects.",
                "First, SRT is built on single attributes while DIM supports mulitple attributes.",
                "Second, SRT constructs a routing tree based on historical sensor readings, and therefore works well only for slowlychanging sensor values.",
                "Finally, in SRT queries are issued from a fixed node while in DIM queries can be issued from any node.",
                "A similar differentiation applies with respect to work on data-centric routing in sensor networks [15, 25], where data generated at a node is assumed to be stored at the node, and queries are either flooded throughout the network [15], or each source sets up a network-wide overlay announcing its presence so that mobile sinks can rendezvous with sources at the nearest node on the overlay [25].",
                "These approaches work well for relatively long-lived queries.",
                "Finally, our work is most close related to data-centric storage [23] systems, which include geographic hash-tables (GHTs) [20], DIMENSIONS [7], and DIFS [10].In a GHT, data is hashed by name to a location within the network, enabling highly efficient rendezvous.",
                "GHTs are built upon the GPSR [16] protocol and leverage some interesting properties of that protocol, such as the ability to route to a node nearest to a given location.",
                "We also leverage properties in GPSR (as we describe later), but we use a locality-preserving hash to store data, enabling efficient multi-dimensional range queries.",
                "DIMENSIONS and DIFS can be thought of as using the same set of primitives as GHT (storage using consistent hashing), but for different ends: DIMENSIONS allows drill64 down search for features within a sensor network, while DIFS allows range queries on a single key in addition to other operations. 3.",
                "THE DESIGN OF DIMS Most sensor networks are deployed to collect data from the environment.",
                "In these networks, nodes (either individually or collaboratively) will generate events.",
                "An event can generally be described as a tuple of attribute values, A1, A2, · · · , Ak , where each attribute Ai represents a sensor reading, or some value corresponding to a detection (e.g., a confidence level).",
                "The focus of this paper is the design of systems to efficiently answer multi-dimensional range queries of the form: x1 − y1, x2 − y2, · · · , xk − yk .",
                "Such a query returns all events whose attribute values fall into the corresponding ranges.",
                "Notice that point queries, i.e., queries that ask for events with specified values for each attribute, are a special case of range queries.",
                "As we have discussed in Section 1, range queries can enable efficient correlation and triggering within the network.",
                "It is possible to implement range queries by flooding a query within the network.",
                "However, as we show in later sections, this alternative can be inefficient, particularly as the system scales, and if nodes within the network issue such queries relatively frequently.",
                "The other alternative, sending all events to an external storage node results in the access link being a bottleneck, especially if nodes within the network issue queries.",
                "Shenker et al. [23] also make similar arguments with respect to data-centric storage schemes in general; DIMs are an instance of such schemes.",
                "The system we present in this paper, the DIM, relies upon two foundations: a locality-preserving geographic hash, and an underlying geographic routing scheme.",
                "The key to resolving range queries efficiently is data locality: i.e., events with comparable attribute values are stored nearby.",
                "The basic insight underlying DIM is that data locality can be obtained by a locality-preserving geographic hash function.",
                "Our geographic hash function finds a localitypreserving mapping from the multi-dimensional space (described by the set of attributes) to a 2-d geographic space; this mapping is inspired by k-d trees [2] and is described later.",
                "Moreover, each node in the network self-organizes to claim part of the attribute space for itself (we say that each node owns a zone), so events falling into that space are routed to and stored at that node.",
                "Having established the mapping, and the zone structure, DIMs use a geographic routing algorithm previously developed in the literature to route events to their corresponding nodes, or to resolve queries.",
                "This algorithm, GPSR [16], essentially enables the delivery of a packet to a node at a specified location.",
                "The routing mechanism is simple: when a node receives a packet destined to a node at location X, it forwards the packet to the neighbor closest to X.",
                "In GPSR, this is called greedy-mode forwarding.",
                "When no such neighbor exists (as when there exists a void in the network), the node starts the packet on a perimeter mode traversal, using the well known right-hand rule to circumnavigate voids.",
                "GPSR includes efficient techniques for perimeter traversal that are based on graph planarization algorithms amenable to distributed implementation.",
                "For all of this to work, DIMs make two assumptions that are consistent with the literature [23].",
                "First, all nodes know the approximate geographic boundaries of the network.",
                "These boundaries may either be configured in nodes at the time of deployment, or may be discovered using a simple protocol.",
                "Second, each node knows its geographic location.",
                "Node locations can be automatically determined by a localization system or by other means.",
                "Although the basic idea of DIMs may seem straightforward, it is challenging to design a completely distributed data structure that must be robust to packet losses and node failures, yet must support efficient query distribution and deal with communication voids and obstacles.",
                "We now describe the complete design of DIMs. 3.1 Zones The key idea behind DIMs, as we have discussed, is a geographic locality-preserving hash that maps a multi-attribute event to a geographic zone.",
                "Intuitively, a zone is a subdivision of the geographic extent of a sensor field.",
                "A zone is defined by the following constructive procedure.",
                "Consider a rectangle R on the x-y plane.",
                "Intuitively, R is the bounding rectangle that contains all sensors withing the network.",
                "We call a sub-rectangle Z of R a zone, if Z is obtained by dividing R k times, k ≥ 0, using a procedure that satisfies the following property: After the i-th division, 0 ≤ i ≤ k, R is partitioned into 2i equal sized rectangles.",
                "If i is an odd (even) number, the i-th division is parallel to the y-axis (x-axis).",
                "That is, the bounding rectangle R is first sub-divided into two zones at level 0 by a vertical line that splits R into two equal pieces, each of these sub-zones can be split into two zones at level 1 by a horizontal line, and so on.",
                "We call the non-negative integer k the level of zone Z, i.e. level(Z) = k. A zone can be identified either by a zone code code(Z) or by an address addr(Z).",
                "The code code(Z) is a 0-1 bit string of length level(Z), and is defined as follows.",
                "If Z lies in the left half of R, the first (from the left) bit of code(Z) is 0, else 1.",
                "If Z lies in the bottom half of R, the second bit of code(Z) is 0, else 1.",
                "The remaining bits of code(Z) are then recursively defined on each of the four quadrants of R. This definition of the zone code matches the definition of zones given above, encoding divisions of the sensor field geography by bit strings.",
                "Thus, in Figure 2, the zone in the top-right corner of the rectangle R has a zone code of 1111.",
                "Note that the zone codes collectively define a zone tree such that individual zones are at the leaves of this tree.",
                "The address of a zone Z, addr(Z), is defined to be the centroid of the rectangle defined by Z.",
                "The two representations of a zone (its code and its address) can each be computed from the other, assuming the level of the zone is known.",
                "Two zones are called sibling zones if their zone codes are the same except for the last bit.",
                "For example, if code(Z1) = 01101 and code(Z2) = 01100, then Z1 and Z2 are sibling zones.",
                "The sibling subtree of a zone is the subtree rooted at the left or right sibling of the zone in the zone tree.",
                "We uniquely define a backup zone for each zone as follows: if the sibling subtree of the zone is on the left, the backup zone is the right-most zone in the sibling subtree; otherwise, the backup zone is the left-most zone in the sibling subtree.",
                "For a zone Z, let p be the first level(Z) − 1 digits of code(Z).",
                "Let backup(Z) be the backup zone of zone Z.",
                "If code(Z) = p1, code(backup(Z)) = p01∗ with the most number of trailing 1s (∗ means 0 or 1 occurrences).",
                "If 65 code(Z) = p0, code(backup(Z)) = p10∗ with the most number of trailing 0s. 3.2 Associating Zones with Nodes Our definition of a zone is independent of the actual distribution of nodes in the sensor field, and only depends upon the geographic extent (the bounding rectangle) of the sensor field.",
                "Now we describe how zones are mapped to nodes.",
                "Conceptually, the sensor field is logically divided into zones and each zone is assigned to a single node.",
                "If the sensor network were deployed in a grid-like (i.e., very regular) fashion, then it is easy to see that there exists a k such that each node maps into a distinct level-k zone.",
                "In general, however, the node placements within a sensor field are likely to be less regular than the grid.",
                "For some k, some zones may be empty and other zones might have more than one node situated within them.",
                "One alternative would have been to choose a fixed k for the overall system, and then associate nodes with the zones they are in (and if a zone is empty, associate the nearest node with it, for some definition of nearest).",
                "Because it makes our overall query routing system simpler, we allow nodes in a DIM to map to different-sized zones.",
                "To precisely understand the associations between zones and nodes, we define the notion of zone ownership.",
                "For any given placement of network nodes, consider a node A.",
                "Let ZA to be the largest zone that includes only node A and no other node.",
                "Then, we say that A owns ZA.",
                "Notice that this definition of ownership may leave some sections of the sensor field un-associated with a node.",
                "For example, in Figure 2, the zone 110 does not contain any nodes and would not have an owner.",
                "To remedy this, for any empty zone Z, we define the owner to be the owner of backup(Z).",
                "In our example, that empty zones owner would also be the node that owns 1110, its backup zone.",
                "Having defined the association between nodes and zones, the next problem we tackle is: given a node placement, does there exist a distributed algorithm that enables each node to determine which zones it owns, knowing only the overall boundary of the sensor network?",
                "In principle, this should be relatively straightforward, since each node can simply determine the location of its neighbors, and apply simple geometric methods to determine the largest zone around it such that no other node resides in that zone.",
                "In practice, however, communication voids and obstacles make the algorithm much more challenging.",
                "In particular, resolving the ownership of zones that do not contain any nodes is complicated.",
                "Equally complicated is the case where the zone of a node is larger than its communication radius and the node cannot determine the boundaries of its zone by local communication alone.",
                "Our distributed zone building algorithm defers the resolution of such zones until when either a query is initiated, or when an event is inserted.",
                "The basic idea behind our algorithm is that each node tentatively builds up an idea of the zone it resides in just by communicating with its neighbors (remembering which boundaries of the zone are undecided because there is no radio neighbor that can help resolve that boundary).",
                "These undecided boundaries are later resolved by a GPSR perimeter traversal when data messages are actually routed.",
                "We now describe the algorithm, and illustrate it using examples.",
                "In our algorithm, each node uses an array bound[0..3] to maintain the four boundaries of the zone it owns (rememFigure 1: A network, where circles represent sensor nodes and dashed lines mark the network boundary. 1111 011 00 110 100 101 1110 010 Figure 2: The zone code and boundaries. 0 1 0 1 10 10 1 1 10 00 Figure 3: The Corresponding Zone Tree ber that in this algorithm, the node only tries to determine the zone it resides in, not the other zones it might own because those zones are devoid of nodes).",
                "When a node starts up, each node initializes this array to be the network boundary, i.e., initially each node assumes its zone contains the whole network.",
                "The zone boundary algorithm now relies upon GPSRs beacon messages to learn the locations of neighbors within radio range.",
                "Upon hearing of such a neighbor, the node calls the algorithm in Figure 4 to update its zone boundaries and its code accordingly.",
                "In this algorithm, we assume that A is the node at which the algorithm is executed, ZA is its zone, and a is a newly discovered neighbor of A. (Procedure Contain(ZA, a) is used to decide if node a is located within the current zone boundaries of node A).",
                "Using this algorithm, then, each node can independently and asynchronously decide its own tentative zone based on the location of its neighbors.",
                "Figure 2 illustrates the results of applying this algorithm for the network in Figure 1.",
                "Figure 3 describes the corresponding zone tree.",
                "Each zone resides at a leaf node and the code of a zone is the path from the root to the zone if we represent the branch to the left 66 Build-Zone(a) 1 while Contain(ZA, a) 2 do if length(code(ZA)) mod 2 = 0 3 then new bound ← (bound[0] + bound[1])/2 4 if A.x < new bound 5 then bound[1] ← new bound 6 else bound[0] ← new bound 7 else new bound ← (bound[2] + bound[3])/2 8 if A.y < new bound 9 then bound[3] ← new bound 10 else bound[2] ← new bound 11 Update zone code code(ZA) Figure 4: Zone Boundary Determination, where A.x and A.y represent the geographic coordinate of node A. Insert-Event(e) 1 c ← Encode(e) 2 if Contain(ZA, c) = true and is Internal() = true 3 then Store e and exit 4 Send-Message(c, e) Send-Message(c, m) 1 if ∃ neighbor Y, Closer(Y, owner(m), m) = true 2 then addr(m) ← addr(Y ) 3 else if length(c) > length(code(m)) 4 then Update code(m) and addr(m) 5 source(m) ← caller 6 if is Owner(msg) = true 7 then owner(m) ← callers code 8 Send(m) Figure 5: Inserting an event in a DIM.",
                "Procedure Closer(A, B, m) returns true if code(A) is closer to code(m) than code(B). source(m) is used to set the source address of message m. child by 0 and the branch to the right child by 1.",
                "This binary tree forms the index that we will use in the following event and query processing procedures.",
                "We see that the zone sizes are different and depend on the local densities and so are the lengths of zone codes for different nodes.",
                "Notice that in Figure 2, there is an empty zone whose code should be 110.",
                "In this case, if the node in zone 1111 can only hear the node in zone 1110, it sets its boundary with the empty zone to undecided, because it did not hear from any neighboring nodes from that direction.",
                "As we have mentioned before, the undecided boundaries are resolved using GPSRs perimeter mode when an event is inserted, or a query sent.",
                "We describe event insertion in the next step.",
                "Finally, this description does not describe how a nodes zone codes are adjusted when neighboring nodes fail, or new nodes come up.",
                "We return to this in Section 3.5. 3.3 Inserting an Event In this section, we describe how events are inserted into a DIM.",
                "There are two algorithms of interest: a consistent hashing technique for mapping an event to a zone, and a routing algorithm for storing the event at the appropriate zone.",
                "As we shall see, these two algorithms are inter-related. 3.3.1 Hashing an Event to a Zone In Section 3.1, we described a recursive tessellation of the geographic extent of a sensor field.",
                "We now describe a consistent hashing scheme for a DIM that supports range queries on m distinct attributes2 Let us denote these attributes A1 . . .",
                "Am.",
                "For simplicity, assume for now that the depth of every zone in the network is k, k is a multiple of m, and that this value of k is known to every node.",
                "We will relax this assumption shortly.",
                "Furthermore, for ease of discussion, we assume that all attribute values have been normalized to be between 0 and 1.",
                "Our hashing scheme assigns a k bit zone code to an event as follows.",
                "For i between 1 and m, if Ai < 0.5, the i-th bit of the zone code is assigned 0, else 1.",
                "For i between m + 1 and 2m, if Ai−m < 0.25 or Ai−m ∈ [0.5, 0.75), the i-th bit of the zone is assigned 0, else 1, because the next level divisions are at 0.25 and 0.75 which divide the ranges to [0, 0.25), [0.25, 0.5), [0.5, 0.75), and [0.75, 1).",
                "We repeat this procedure until all k bits have been assigned.",
                "As an example, consider event E = 0.3, 0.8 .",
                "For this event, the 5-bit zone code is code(ZA) = 01110.",
                "Essentially, our hashing scheme uses the values of the attributes in round-robin fashion on the zone tree (such as the one in Figure 3), in order to map an m-attribute event to a zone code.",
                "This is reminiscent of k-d trees [2], but is quite different from that data structure: zone trees are spatial embeddings and do not incorporate the re-balancing algorithms in k-d trees.",
                "In our design of DIMs, we do not require nodes to have zone codes of the same length, nor do we expect a node to know the zone codes of other nodes.",
                "Rather, suppose the encoding node is A and its own zone code is of length kA.",
                "Then, given an event E, node A only hashes E to a zone code of length kA.",
                "We denote the zone code assigned to an event E by code(E).",
                "As we describe below, as the event is routed, code(E) is refined by intermediate nodes.",
                "This lazy evaluation of zone codes allows different nodes to use different length zone codes without any explicit coordination. 3.3.2 Routing an Event to its Owner The aim of hashing an event to a zone code is to store the event at the node within the network node that owns that zone.",
                "We call this node the owner of the event.",
                "Consider an event E that has just been generated at a node A.",
                "After encoding event E, node A compares code(E) with code(A).",
                "If the two are identical, node A store event E locally; otherwise, node A will attempt to route the event to its owner.",
                "To do this, note that code(E) corresponds to some zone Z , which is As current guess for the zone at which event E should be stored.",
                "A now invokes GPSR to send a message to addr(Z ) (the centroid of Z , Section 3.1).",
                "The message contains the event E, code(E), and the target geographic location for storing the event.",
                "In the message, A also marks itself as the owner of event E. As we will see later, the guessed zone Z , the address addr(Z ), and the owner of E, all of them contained in the message, will be refined by intermediate forwarding nodes.",
                "GPSR now delivers this message to the next hop towards addr(Z ) from A.",
                "This next hop node (call it B) does not immediately forward the message.",
                "Rather, it attempts to com2 DIM does not assume that all nodes are homogeneous in terms of the sensors they have.",
                "Thus, in an m dimensional DIM, a node that does not possess all m sensors can use NULL values for the corresponding readings.",
                "DIM treats NULL as an extreme value for range comparisons.",
                "As an aside, a network may have many DIM instances running concurrently. 67 pute a new zone code for E to get a new code codenew(E).",
                "B will update the code contained in the message (and also the geographic destination of the message) if codenew(E) is longer than the event code in the message.",
                "In this manner, as the event wends its way to its owner, its zone code gets refined.",
                "Now, B compares its own code code(B) against the owner code owner(E) contained in the incoming message.",
                "If code(B) has a longer match with code(E) than the current owner owner(E), then B sets itself to be the current owner of E, meaning that if nobody is eligible to store E, then B will store the event (we shall see how this happens next).",
                "If Bs zone code does not exactly match code(E), B will invoke GPSR to deliver E to the next hop. 3.3.3 Resolving undecided zone boundaries during insertion Suppose that some node, say C, finds itself to be the destination (or eventual owner) of an event E. It does so by noticing that code code(C) equals code(E) after locally recomputing a code for E. In that case, C stores E locally, but only if all four of Cs zone boundaries are decided.",
                "When this condition holds, C knows for sure that no other nodes have overlapped zones with it.",
                "In this case, we call C an internal node.",
                "Recall, though, that because the zone discovery algorithm Section 3.2 only uses information from immediate neighbors, one or more of Cs boundaries may be undecided.",
                "If so, C assumes that some other nodes have a zone that overlaps with its own, and sets out to resolve this overlap.",
                "To do this, C now sets itself to be the owner of E and continues forwarding the message.",
                "Here we rely on GPSRs perimeter mode routing to probe around the void that causes the undecided boundary.",
                "Since the message starts from C and is destined for a geographic location near C, GPSR guarantees that the message will be delivered back to C if no other nodes will update the information in the message.",
                "If the message comes back to C with itself to be the owner, C infers that it must be the true owner of the zone and stores E locally.",
                "If this does not happen, there are two possibilities.",
                "The first is that as the event traverses the perimeter, some intermediate node, say B whose zone overlaps with Cs marks itself to be the owner of the event, but otherwise does not change the events zone code.",
                "This node also recognizes that its own zone overlaps with Cs and initiates a message exchange which causes each of them to appropriately shrink their zone.",
                "Figures 6 through 8 show an example of this data-driven zone shrinking.",
                "Initially, both node A and node B have claimed the same zone 0 because they are out of radio range of each other.",
                "Suppose that A inserts an event E = 0.4, 0.8, 0.9 .",
                "A encodes E to 0 and claims itself to be the owner of E. Since A is not an internal node, it sends out E, looking for other owner candidates of E. Once E gets to node B, B will see in the messages owner field As code that is the same as its own.",
                "B then shrinks its zone from 0 to 01 according to As location which is also recorded in the message and send a shrink request to A.",
                "Upon receiving this request, A also shrinks its zone from 0 to 00.",
                "A second possibility is if some intermediate node changes the destination code of E to a more specific value (i.e., longer zone code).",
                "Let us label this node D. D now tries to initiate delivery to the centroid of the new zone.",
                "This A B 0 0 110 100 1111 1110 101 Figure 6: Nodes A and B have claimed the same zone.",
                "A B <0.4,0.8,0.9> Figure 7: An event/query message (filled arrows) triggers zone shrinking (hollow arrows).",
                "A B 01 00 110 100 1111 1110 101 Figure 8: The zone layout after shrinking.",
                "Now node A and B have been mapped to different zones. might result in a new perimeter walk that returns to D (if, for example, D happens to be geographically closest to the centroid of the zone).",
                "However, D would not be the owner of the event, which would still be C. In routing to the centroid of this zone, the message may traverse the perimeter and return to D. Now D notices that C was the original owner, so it encapsulates the event and directs it to C. In case that there indeed is another node, say X, that owns an overlapped zone with C, X will notice this fact by finding in the message the same prefix of the code of one of its zones, but with a different geographic location from its own.",
                "X will shrink its zone to resolve the overlap.",
                "If Xs zone is smaller than or equal to Cs zone, X will also send a shrink request to C. Once C receives a shrink request, it will reduce its zone appropriately and fix its undecided boundary.",
                "In this manner, the zone formation process is resolved on demand in a data-driven way. 68 There are several interesting effects with respect to perimeter walking that arise in our algorithm.",
                "The first is that there are some cases where an event insertion might cause the entire outer perimeter of the network to be traversed3 .",
                "Figure 6 also works as an example where the outer perimeter is traversed.",
                "Event E inserted by A will eventually be stored in node B.",
                "Before node B stores event E, if Bs nominal radio range does not intersect the network boundary, it needs to send out E again as A did, because B in this case is not an internal node.",
                "But if Bs nominal radio range intersects the network boundary, it then has two choices.",
                "It can assume that there will not be any nodes outside the network boundary and so B is an internal node.",
                "This is an aggressive approach.",
                "On the other hand, B can also make a conservative decision assuming that there might be some other nodes it have not heard of yet.",
                "B will then force the message walking another perimeter before storing it.",
                "In some situations, especially for large zones where the node that owns a zone is far away from the centroid of the owned zone, there might exist a small perimeter around the destination that does not include the owner of the zone.",
                "The event will end up being stored at a different node than the real owner.",
                "In order to deal with this problem, we add an extra operation in event forwarding, called efficient neighbor discovery.",
                "Before invoking GPSR, a node needs to check if there exists a neighbor who is eligible to be the real owner of the event.",
                "To do this, a node C, say, needs to know the zone codes of its neighboring nodes.",
                "We deploy GPSRs beaconing message to piggyback the zone codes for nodes.",
                "So by simply comparing the events code and neighbors code, a node can decide whether there exists a neighbor Y which is more likely to be the owner of event E. C delivers E to Y , which simply follows the decision making procedure discussed above. 3.3.4 Summary and Pseudo-code In summary, our event insertion procedure is designed to nicely interact with the zone discovery mechanism, and the event hashing mechanism.",
                "The latter two mechanisms are kept simple, while the event insertion mechanism uses lazy evaluation at each hop to refine the events zone code, and it leverages GPSRs perimeter walking mechanism to fix undecided zone boundaries.",
                "In Section 3.5, we address robustness of event insertion to packet loss or to node failures.",
                "Figure 5 shows the pseudo-code for inserting and forwarding an event e. In this pseudo code, we have omitted a description of the zone shrinking procedure.",
                "In the pseudo code, procedure is Internal() is used to determine if the caller is an internal node and procedure is Owner() is used to determine if the caller is more eligible to be the owner of the event than is currently claimed owner as recorded in the message.",
                "Procedure Send-Message is used to send either an event message or a query message.",
                "If the message destination address has been changed, the packet source address needs also to be changed in order to avoid being dropped by GPSR, since GPSR does not allow a node to see the same packet in greedy mode twice. 3 This happens less frequently than for GHTs, where inserting an event to a location outside the actual (but inside the nominal) boundary of the network will always invoke an external perimeter walk. 3.4 Resolving and Routing Queries DIMs support both point queries4 and range queries.",
                "Routing a point query is identical to routing an event.",
                "Thus, the rest of this section details how range queries are routed.",
                "The key challenge in routing zone queries is brought out by the following strawman design.",
                "If the entire network was divided evenly into zones of depth k (for some pre-defined constant k), then the querier (the node issuing the query) could subdivide a given range query into the relevant subzones and route individual requests to each of the zones.",
                "This can be inefficient for large range queries and also hard to implement in our design where zone sizes are not predefined.",
                "Accordingly, we use a slightly different technique where a range query is initially routed to a zone corresponding to the entire range, and is then progressively split into smaller subqueries.",
                "We describe this algorithm here.",
                "The first step of the algorithm is to map a range query to a zone code prefix.",
                "Conceptually, this is easy; in a zone tree (Figure 3), there exists some node which contains the entire range query in its sub-tree, and none of its children in the tree do.",
                "The initial zone code we choose for the query is the zone code corresponding to that tree node, and is a prefix of the zone codes of all zones (note that these zones may not be geographically contiguous) in the subtree.",
                "The querier computes the zone code of Q, denoted by code(Q) and then starts routing a query to addr(code(Q)).",
                "Upon receiving a range query Q, a node A (where A is any node on the query propagation path) divides it into multiple smaller sized subqueries if there is an overlap between the zone of A, zone(A) and the zone code associated with Q, code(Q).",
                "Our approach to split a query Q into subqueries is as follows.",
                "If the range of Qs first attribute contains the value 0.5, A divides Q into two sub-queries one of whose first attribute ranges from 0 to 0.5, and the other from 0.5 to 1.",
                "Then A decides the half that overlaps with its own zone.",
                "Lets call it QA.",
                "If QA does not exist, then A stops splitting; otherwise, it continues splitting (using the second attribute range) and recomputing QA until QA is small enough so that it completely falls into zone(A) and hence A can now resolve it.",
                "For example, suppose that node A, whose code is 0110, is to split a range query Q = 0.3 − 0.8, 0.6 − 0.9 .",
                "The splitting steps is shown in Figure 2.",
                "After splitting, we obtain three smaller queries q0 = 0.3 − 0.5, 0.6 − 0.75 , q1 = 0.3 − 0.5, 0.75 − 0.9 , and q2 = 0.5 − 0.8, 0.6 − 0.9 .",
                "This splitting procedure is illustrated in Figure 9 which also shows the codes of each subquery after splitting.",
                "A then replies to subquery q0 with data stored locally and sends subqueries q1 and q2 using the procedure outlined above.",
                "More generally, if node A finds itself to be inside the zone subtree that maximally covers Q, it will send the subqueries that resulted from the split.",
                "Otherwise, if there is no overlap between A and Q, then A forwards Q as is (in this case Q is either the original query, or a product of an earlier split).",
                "Figure 10 describes the pseudo-code for the zone splitting algorithm.",
                "As shown in the above algorithm, once a subquery has been recognized as belonging to the callers zone, procedure Resolve is invoked to resolve the subquery and send a reply to the querier.",
                "Every query message contains 4 By point queries, we mean the equality condition on all indexed keys.",
                "DIM index attributes are not necessarily primary keys. 69 the geographic location of its initiator, so the corresponding reply message can be delivered directly back to the initiator.",
                "Finally, in the process of query resolution, zones might shrink similar to shrinkage during inserting.",
                "We omit this in the pseudo code. 3.5 Robustness Until now, we have not discussed the impact of node failures and packet losses, or node arrivals and departures on our algorithms.",
                "Packet losses can affect query and event insertion, and node failures can result in lost data, while node arrivals and departures can impact the zone structure.",
                "We now discuss how DIMs can be made robust to these kinds of dynamics. 3.5.1 Maintaining Zones In previous sections, we described how the zone discovery algorithm could leave zone boundaries undecided.",
                "These undecided boundaries are resolved during insertion or querying, using the zone shrinking procedure describe above.",
                "When a new node joins the network, the zone discovery mechanism (Section 3.2) will cause neighboring zones to appropriately adjust their zone boundaries.",
                "At this time, those zones can also transfer to the new node those events they store but which should belong to the new node.",
                "Before a node turns itself off (if this is indeed possible), it knows that its backup node (Section 3.1) will take over its zone, and will simply send all its events to its backup node.",
                "Node deletion may also cause zone expansion.",
                "In order to keep the mapping between the binary zone trees leaf nodes and zones, we allow zone expansion to only occur among sibling zones (Section 3.1).",
                "The rule is: if zone(A)s sibling zone becomes empty, then A can expand its own zone to include its sibling zone.",
                "Now, we turn our attention to node failures.",
                "Node failures are just like node deletions except that a failed node does not have a chance to move its events to another node.",
                "But how does a node decide if its sibling has failed?",
                "If the sibling is within radio range, the absence of GPSR beaconing messages can detect this.",
                "Once it detects this, the node can expand its zone.",
                "A different approach is needed for detecting siblings who are not within radio range.",
                "These are the cases where two nodes own their zones after exchanging a shrink message; they do not periodically exchange messages thereafter to maintain this zone relationship.",
                "In this case, we detect the failure in a data-driven fashion, with obvious efficiency benefits compared to periodic keepalives.",
                "Once a node B has failed, an event or query message that previously should have been owned by the failed node will now be delivered to the node A that owns the empty zone left by node B.",
                "A can see this message because A stands right around the empty area left by B and is guaranteed to be visited in a GPSR perimeter traversal.",
                "A will set itself to be the owner of the message, and any node which would have dropped this message due to a perimeter loop will redirect the message to A instead.",
                "If As zone happens to be the sibling of Bs zone, A can safely expand its own zone and notify its expanded zone to its neighbors via GPSR beaconing messages. 3.5.2 Preventing Data Loss from Node Failure The algorithms described above are robust in terms of zone formation, but node failure can erase data.",
                "To avoid this, DIMs can employ two kinds of replication: local replication to be resilient to random node failures, and mirror replication for resilience to concurrent failure of geographically contiguous nodes.",
                "Mirror replication is conceptually easy.",
                "Suppose an event E has a zone code code(E).",
                "Then, the node that inserts E would store two copies of E; one at the zone denoted by code(E), and the other at the zone corresponding to the ones complement of code(E).",
                "This technique essentially creates a mirror DIM.",
                "A querier would need, in parallel, to query both the original DIM and its mirror since there is no way of knowing if a collection of nodes has failed.",
                "Clearly, the trade-off here is an approximate doubling of both insertion and query costs.",
                "There exists a far cheaper technique to ensure resilience to random node failures.",
                "Our local replication technique rests on the observation that, for each node A, there exists a unique node which will take over its zone when A fails.",
                "This node is defined as the node responsible for As zones backup zone (see Section 3.1).",
                "The basic idea is that A replicates each data item it has in this node.",
                "We call this node As local replica.",
                "Let As local replica be B.",
                "Often B will be a radio neighbor of A and can be detected from GPSR beacons.",
                "Sometimes, however, this is not the case, and B will have to be explicitly discovered.",
                "We use an explicit message for discovering the local replica.",
                "Discovering the local replica is data-driven, and uses a mechanism similar to that of event insertion.",
                "Node A sends a message whose geographic destination is a random nearby location chosen by A.",
                "The location is close enough to A such that GPSR will guarantee that the message will delivered back to A.",
                "In addition, the message has three fields, one for the zone code of A, code(A), one for the owner owner(A) of zone(A) which is set to be empty, and one for the geographic location of owner(A).",
                "Then the packet will be delivered in GPSR perimeter mode.",
                "Each node that receives this message will compare its zone code and code(A) in the message, and if it is more eligible to be the owner of zone(A) than the current owner(A) recorded in the message, it will update the field owner(A) and the corresponding geographic location.",
                "Once the packet comes back to A, it will know the location of its local replica and can start to send replicas.",
                "In a dense sensor network, the local replica of a node is usually very near to the node, either its direct neighbor or 1-2 hops away, so the cost of sending replicas to local replication will not dominate the network traffic.",
                "However, a nodes local replica itself may fail.",
                "There are two ways to deal with this situation; periodic refreshes, or repeated datadriven discovery of local replicas.",
                "The former has higher overhead, but more quickly discovers failed replicas. 3.5.3 Robustness to Packet Loss Finally, the mechanisms for querying and event insertion can be easily made resilient to packet loss.",
                "For event insertion, a simple ACK scheme suffices.",
                "Of course, queries and responses can be lost as well.",
                "In this case, there exists an efficient approach for error recovery.",
                "This rests on the observation that the querier knows which zones fall within its query and should have responded (we assume that a node that has no data matching a query, but whose zone falls within the query, responds with a negative acknowledgment).",
                "After a conservative timeout, the querier can re-issue the queries selectively to these zones.",
                "If DIM cannot get any answers (positive or negative) from 70 <0.3-0.8, 0.6-0.9> <0.5-0.8, 0.6-0.9><0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.9> <0.3-0.5, 0.6-0.75> <0.3-0.5, 0.75-0.9> 0 0 1 1 1 1 Figure 9: An example of range query splitting Resolve-Range-Query(Q) 1 Qsub ← nil 2 q0, Qsub ← Split-Query(Q) 3 if q0 = nil 4 then c ← Encode(Q) 5 if Contain(c, code(A)) = true 6 then go to step 12 7 else Send-Message(c, q0) 8 else Resolve(q0) 9 if is Internal() = true 10 then Absorb (q0) 11 else Append q0 to Qsub 12 if Qsub = nil 13 then for each subquery q ∈ Qsub 14 do c ← Encode(q) 15 Send-Message(c, q) Figure 10: Query resolving algorithm certain zones after repeated timeouts, it can at least return the partial query results to the application together with the information about the zones from which data is missing. 4.",
                "DIMS: AN ANALYSIS In this section, we present a simple analytic performance evaluation of DIMs, and compare their performance against other possible approaches for implementing multi-dimensional range queries in sensor networks.",
                "In the next section, we validate these analyses using detailed packet-level simulations.",
                "Our primary metrics for the performance of a DIM are: Average Insertion Cost measures the average number of messages required to insert an event into the network.",
                "Average Query Delivery Cost measures the average number of messages required to route a query message to all the relevant nodes in the network.",
                "It does not measure the number of messages required to transmit responses to the querier; this latter number depends upon the precise data distribution and is the same for many of the schemes we compare DIMs against.",
                "In DIMs, event insertion essentially uses geographic routing.",
                "In a dense N-node network where the likelihood of traversing perimeters is small, the average event insertion cost proportional to √ N [23].",
                "On the other hand, the query delivery cost depends upon the size of ranges specified in the query.",
                "Recall that our query delivery mechanism is careful about splitting a query into sub-queries, doing so only when the query nears the zone that covers the query range.",
                "Thus, when the querier is far from the queried zone, there are two components to the query delivery cost.",
                "The first, which is proportional to √ N, is the cost to deliver the query near the covering zone.",
                "If within this covering zone, there are M nodes, the message delivery cost of splitting the query is proportional to M. The average cost of query delivery depends upon the distribution of query range sizes.",
                "Now, suppose that query sizes follow some density function f(x), then the average cost of resolve a query can be approximated by Ê N 1 xf(x)dx.",
                "To give some intuition for the performance of DIMs, we consider four different forms for f(x): the uniform distribution where a query range encompassing the entire network is as likely as a point query; a bounded uniform distribution where all sizes up to a bound B are equally likely; an algebraic distribution in which most queries are small, but large queries are somewhat likely; and an exponential distribution where most queries are small and large queries are unlikely.",
                "In all our analyses, we make the simplifying assumption that the size of a query is proportional to the number of nodes that can answer that query.",
                "For the uniform distribution P(x) ∝ c for some constant c. If each query size from 1 . . .",
                "N is equally likely, the average query delivery cost of uniformly distributed queries is O(N).",
                "Thus, for uniformly distributed queries, the performance of DIMs is comparable to that of flooding.",
                "However, for the applications we envision, where nodes within the network are trying to correlate events, the uniform distribution is highly unrealistic.",
                "Somewhat more realistic is a situation where all query sizes are bounded by a constant B.",
                "In this case, the average cost for resolving such a query is approximately Ê B 1 xf(x)dx = O(B).",
                "Recall now that all queries have to pay an approximate cost of O( √ N) to deliver the query near the covering zone.",
                "Thus, if DIM limited queries to a size proportional to√ N, the average query cost would be O( √ N).",
                "The algebraic distribution, where f(x) ∝ x−k , for some constant k between 1 and 2, has an average query resolution cost given by Ê N 1 xf(x)dx = O(N2−k ).",
                "In this case, if k > 1.5, the average cost of query delivery is dominated by the cost to deliver the query to near the covering zone, given by O( √ N).",
                "Finally, for the exponential distribution, f(x) = ce−cx for some constant c, and the average cost is just the mean of the corresponding distribution, i.e., O(1) for large N. Asymptotically, then, the cost of the query for the exponential distribution is dominated by the cost to deliver the query near the covering zone (O( √ N)).",
                "Thus, we see that if queries follow either the bounded uniform distribution, the algebraic distribution, or the exponential distribution, the query cost scales as the insertion cost (for appropriate choice of constants for the bounded uniform and the algebraic distributions).",
                "How well does the performance of DIMs compare against alternative choices for implementing multi-dimensional queries?",
                "A simple alternative is called external storage [23], where all events are stored centrally in a node outside the sensor network.",
                "This scheme incurs an insertion cost of O( √ N), and a zero query cost.",
                "However, as [23] points out, such systems may be impractical in sensor networks since the access link to the external node becomes a hotspot.",
                "A second alternative implementation would store events at the node where they are generated.",
                "Queries are flooded 71 throughout the network, and nodes that have matching data respond.",
                "Examples of systems that can be used for this (although, to our knowledge, these systems do not implement multi-dimensional range queries) are Directed Diffusion [15] and TinyDB [17].",
                "The flooding scheme incurs a zero insertion cost, but an O(N) query cost.",
                "It is easy to show that DIMs outperform flooding as long as the ratio of the number of insertions to the number of queries is less than √ N. A final alternative would be to use a geographic hash table (GHT [20]).",
                "In this approach, attribute values are assumed to be integers (this is actually quite a reasonable assumption since attribute values are often quantized), and events are hashed on some (say, the first) attribute.",
                "A range query is sub-divided into several sub-queries, one for each integer in the range of the first attribute.",
                "Each sub-query is then hashed to the appropriate location.",
                "The nodes that receive a sub-query only return events that match all other attribute ranges.",
                "In this approach, which we call GHT-R (GHTs for range queries) the insertion cost is O( √ N).",
                "Suppose that the range of the first attribute contains r discrete values.",
                "Then the cost to deliver queries is O(r √ N).",
                "Thus, asymptotically, GHT-Rs perform similarly to DIMs.",
                "In practice, however, the proportionality constants are significantly different, and DIMs outperform GHT-Rs, as we shall show using detailed simulations. 5.",
                "DIMS: SIMULATION RESULTS Our analysis gives us some insight into the asymptotic behavior of various approaches for multi-dimensional range queries.",
                "In this section, we use simulation to compare DIMs against flooding and GHT-R; this comparison gives us a more detailed understanding of these approaches for moderate size networks, and gives us a nuanced view of the mechanistic differences between some of these approaches. 5.1 Simulation Methodology We use ns-2 for our simulations.",
                "Since DIMs are implemented on top of GPSR, we first ported an earlier GPSR implementation to the latest version of ns-2.",
                "We modified the GPSR module to call our DIM implementation when it receives any data message in transit or when it is about to drop a message because that message traversed the entire perimeter.",
                "This allows a DIM to modify message zone codes in flight (Section 3), and determine the actual owner of an event or query.",
                "In addition, to this, we implemented in ns-2 most of the DIM mechanisms described in Section 3.",
                "Of those mechanisms, the only one we did not implement is mirror replication.",
                "We have implemented selective query retransmission for resiliency to packet loss, but have left the evaluation of this mechanism to future work.",
                "Our DIM implementation in ns-2 is 2800 lines of code.",
                "Finally, we implemented GHT-R, our GHT-based multidimensional range query mechanism in ns-2.",
                "This implementation was relatively straightforward, given that we had ported GPSR, and modified GPSR to detect the completion of perimeter mode traversals.",
                "Using this implementation, we conducted a fairly extensive evaluation of DIM and two alternatives (flooding, and our GHT-R).",
                "For all our experiments, we use uniformly placed sensor nodes with network sizes ranging from 50 nodes to 300 nodes.",
                "Each node has a radio range of 40m.",
                "For the results presented here, each node has on average 20 nodes within its nominal radio range.",
                "We have conducted experiments at other node densities; they are in agreement with the results presented here.",
                "In all our experiments, each node first generates 3 events5 on average (more precisely, for a topology of size N, we have 3N events, and each node is equally likely to generate an event).",
                "We have conducted experiments for three different event value distributions.",
                "Our uniform event distribution generates 2-dimensional events and, for each dimension, every attribute value is equally likely.",
                "Our normal event distribution generates 2-dimensional events and, for each dimension, the attribute value is normally distributed with a mean corresponding to the mid-point of the attribute value range.",
                "The normal event distribution represents a skewed data set.",
                "Finally, our trace event distribution is a collection of 4-dimensional events obtained from a habitat monitoring network.",
                "As we shall see, this represents a fairly skewed data set.",
                "Having generated events, for each simulation we generate queries such that, on average, each node generates 2 queries.",
                "The query sizes are determined using the four size distributions we discussed in Section 4: uniform, boundeduniform, algebraic and exponential.",
                "Once a query size has been determined, the location of the query (i.e., the actual boundaries of the zone) are uniformly distributed.",
                "For our GHT-R experiments, the dynamic range of the attributes had 100 discrete values, but we restricted the query range for any one attribute to 50 discrete values to allow those simulations to complete in reasonable time.",
                "Finally, using one set of simulations we evaluate the efficacy of local replication by turning off random fractions of nodes and measuring the fidelity of the returned results.",
                "The primary metrics for our simulations are the average query and insertion costs, as defined in Section 4. 5.2 Results Although we have examined almost all the combinations of factors described above, we discuss only the most salient ones here, for lack of space.",
                "Figure 11 plots the average insertion costs for DIM and GHT-R (for flooding, of course, the insertion costs are zero).",
                "DIM incurs less per event overhead in inserting events (regardless of the actual event distribution; Figure 11 shows the cost for uniformly distributed events).",
                "The reason for this is interesting.",
                "In GHT-R, storing almost every event incurs a perimeter traversal, and storing some events require traversing the outer perimeter of the network [20].",
                "By contrast, in DIM, storing an event incurs a perimeter traversal only when a nodes boundaries are undecided.",
                "Furthermore, an insertion or a query in a DIM can traverse the outer perimeter (Section 3.3), but less frequently than in GHTs.",
                "Figure 13 plots the average query cost for a bounded uniform query size distribution.",
                "For this graph (and the next) we use a uniform event distribution, since the event distribution does not affect the query delivery cost.",
                "For this simulation, our bound was 1 4 th the size of the largest possible 5 Our metrics are chosen so that the exact number of events and queries is unimportant for our discussion.",
                "Of course, the overall performance of the system will depend on the relative frequency of events and queries, as we discuss in Section 4.",
                "Since we dont have realistic ratios for these, we focus on the microscopic costs, rather than on the overall system costs. 72 0 2 4 6 8 10 12 14 16 18 20 50 100 150 200 250 300 AverageCostperInsertion Network Size DIM GHT-R Figure 11: Average insertion cost for DIM and GHT. 0.4 0.5 0.6 0.7 0.8 0.9 1 5 10 15 20 25 30 Fractionofrepliescomparedwithnon-failurecase Fraction of failed nodes (%) No Replication Local Replication Figure 12: Local replication performance. query (e.g., a query of the form 0 − 0.5, 0 − 0.5 .",
                "Even for this generous query size, DIMs perform quite well (almost a third the cost of flooding).",
                "Notice, however, that GHTRs incur high query cost since almost any query requires as many subqueries as the width of the first attributes range.",
                "Figure 14 plots the average query cost for the exponential distribution (the average query size for this distribution was set to be 1 16 th the largest possible query).",
                "The superior scaling of DIMs is evident in these graphs.",
                "Clearly, this is the regime in which one might expect DIMs to perform best, when most of the queries are small and large queries are relatively rare.",
                "This is also the regime in which one would expect to use multi-dimensional range queries: to perform relatively tight correlations.",
                "As with the bounded uniform distribution, GHT query cost is dominated by the cost of sending sub-queries; for DIMs, the query splitting strategy works quite well in keep overall query delivery costs low.",
                "Figure 12 describes the efficacy of local replication.",
                "To obtain this figure, we conducted the following experiment.",
                "On a 100-node network, we inserted a number of events uniformly distributed throughout the network, then issued a query covering the entire network and recorded the answers.",
                "Knowing the expected answers for this query, we then successively removed a fraction f of nodes randomly, and re-issued the same query.",
                "The figure plots the fraction of expected responses actually received, with and without replication.",
                "As the graph shows, local replication performs well for random failures, returning almost 90% of the responses when up to 30% of the nodes have failed simultaneously 6 .In the absence of local replication, of course, when 6 In practice, the performance of local replication is likely to 0 100 200 300 400 500 600 700 50 100 150 200 250 300 AverageCostperQueryinBoundedUnifDistribution Network Size DIM flooding GHT-R Figure 13: Average query cost with a bounded uniform query distribution 0 50 100 150 200 250 300 350 400 450 50 100 150 200 250 300 AverageCostperQueryinExponentialDistribution Network Size DIM flooding GHT-R Figure 14: Average query cost with an exponential query distribution 30% of the nodes fail, the response rate is only 70% as one would expect.",
                "We note that DIMs (as currently designed) are not perfect.",
                "When the data is highly skewed-as it was for our trace data set from the habitat monitoring application where most of the event values fell into within 10% of the attributes range-a few DIM nodes will clearly become the bottleneck.",
                "This is depicted in Figure 15, which shows that for DIMs, and GHT-Rs, the maximum number of transmissions at any network node (the hotspots) is rather high. (For less skewed data distributions, and reasonable query size distributions, the hotspot curves for all three schemes are comparable.)",
                "This is a standard problem that the database indices have dealt with by tree re-balancing.",
                "In our case, simpler solutions might be possible (and we discuss this in Section 7).",
                "However, our use of the trace data demonstrates that DIMs work for events which have more than two dimensions.",
                "Increasing the number of dimensions does not noticeably degrade DIMs query cost (omitted for lack of space).",
                "Also omitted are experiments examining the impact of several other factors, as they do not affect our conclusions in any way.",
                "As we expected, DIMs are comparable in performance to flooding when all sizes of queries are equally likely.",
                "For an algebraic distribution of query sizes, the relative performance is close to that for the exponential distribution.",
                "For normally distributed events, the insertion costs be much better than this.",
                "Assuming a node and its replica dont simultaneously fail often, a node will almost always detect a replica failure and re-replicate, leading to near 100% response rates. 73 0 2000 4000 6000 8000 10000 12000 50 100 150 200 250 300 MaximumHotspotonTraceDataSet Network Size DIM flooding GHT-R Figure 15: Hotspot usage DIM Zone Manager Query Router Query Processor Event Manager Event Router GPSR interface(Event driven/Thread based) update useuse update GPSR Upper interface(Event driven/Thread based) Lower interface(Event driven/Thread based) Greedy Forwarding Perimeter Forwarding Beaconing Neighbor List Manager update use MoteNIC (MicaRadio) IP Socket (802.11b/Ethernet) Figure 16: Software architecture of DIM over GPSR are comparable to that for the uniform distribution.",
                "Finally, we note that in all our evaluations we have only used list queries (those that request all events matching the specified range).",
                "We expect that for summary queries (those that expect an aggregate over matching events), the overall cost of DIMs could be lower because the matching data are likely to be found in one or a small number of zones.",
                "We leave an understanding of this to future work.",
                "Also left to future work is a detailed understanding of the impact of location error on DIMs mechanisms.",
                "Recent work [22] has examined the impact of imprecise location information on other data-centric storage mechanisms such as GHTs, and found that there exist relatively simple fixes to GPSR that ameliorate the effects of location error. 6.",
                "IMPLEMENTATION We have implemented DIMs on a Linux platform suitable for experimentation on PDAs and PC-104 class machines.",
                "To implement DIMs, we had to develop and test an independent implementation of GPSR.",
                "Our GPSR implementation is full-featured, while our DIM implementation has most of the algorithms discussed in Section 3; some of the robustness extensions have only simpler variants implemented.",
                "The software architecture of DIM/GPSR system is shown in Figure 16.",
                "The entire system (about 5000 lines of code) is event-driven and multi-threaded.",
                "The DIM subsystem consists of six logical components: zone management, event maintenance, event routing, query routing, query processing, and GPSR interactions.",
                "The GPSR system is implemented as user-level daemon process.",
                "Applications are executed as clients.",
                "For the DIM subsystem, the GPSR module 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query size Average#ofreceivedresponses perquery Figure 17: Number of events received for different query sizes 0 2 4 6 8 10 12 14 16 0.25x0.25 0.50x0.50 0.75x0.75 1.0x1.0 Query sizeTotalnumberofmessages onlyforsendingthequery Figure 18: Query distribution cost provides several extensions: it exports information about neighbors, and provides callbacks during packet forwarding and perimeter-mode termination.",
                "We tested our implementation on a testbed consisting of 8 PC-104 class machines.",
                "Each of these boxes runs Linux and uses a Mica mote (attached through a serial cable) for communication.",
                "These boxes are laid out in an office building with a total spatial separation of over a hundred feet.",
                "We manually measured the locations of these nodes relative to some coordinate system and configured the nodes with their location.",
                "The network topology is approximately a chain.",
                "On this testbed, we inserted queries and events from a single designated node.",
                "Our events have two attributes which span all combinations of the four values [0, 0.25, 0.75, 1] (sixteen events in all).",
                "Our queries span four sizes, returning 1, 4, 9 and 16 events respectively.",
                "Figure 17 plots the number of events received for different sized queries.",
                "It might appear that we received fewer events than expected, but this graph doesnt count the events that were already stored at the querier.",
                "With that adjustment, the number of responses matches our expectation.",
                "Finally, Figure 18 shows the total number of messages required for different query sizes on our testbed.",
                "While these experiments do not reveal as much about the performance range of DIMs as our simulations do, they nevertheless serve as proof-of-concept for DIMs.",
                "Our next step in the implementation is to port DIMs to the Mica motes, and integrate them into the TinyDB [17] sensor database engine on motes. 74 7.",
                "CONCLUSIONS In this paper, we have discussed the design and evaluation of a distributed data structure called DIM for efficiently resolving multi-dimensional range queries in sensor networks.",
                "Our design of DIMs relies upon a novel locality-preserving hash inspired by early work in database indexing, and is built upon GPSR.",
                "We have a working prototype, both of GPSR and DIM, and plan to conduct larger scale experiments in the future.",
                "There are several interesting future directions that we intend to pursue.",
                "One is adaptation to skewed data distributions, since these can cause storage and transmission hotspots.",
                "Unlike traditional database indices that re-balance trees upon data insertion, in sensor networks it might be feasible to re-structure the zones on a much larger timescale after obtaining a rough global estimate of the data distribution.",
                "Another direction is support for node heterogeneity in the zone construction process; nodes with larger storage space assert larger-sized zones for themselves.",
                "A third is support for efficient resolution of existential queries-whether there exists an event matching a multi-dimensional range.",
                "Acknowledgments This work benefited greatly from discussions with Fang Bian, Hui Zhang and other ENL lab members, as well as from comments provided by the reviewers and our shepherd Feng Zhao. 8.",
                "REFERENCES [1] J. Aspnes and G. Shah.",
                "Skip Graphs.",
                "In Proceedings of 14th Annual ACM-SIAM Symposium on Discrete Algorithms (SODA), Baltimore, MD, January 2003. [2] J. L. Bentley.",
                "Multidimensional Binary Search Trees Used for Associative Searching.",
                "Communicaions of the ACM, 18(9):475-484, 1975. [3] P. Bonnet, J. E. Gerhke, and P. Seshadri.",
                "Towards Sensor Database Systems.",
                "In Proceedings of the Second International Conference on Mobile Data Management, Hong Kong, January 2001. [4] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong.",
                "Freenet: A Distributed Anonymous Information Storage and Retrieval System.",
                "In Designing Privacy Enhancing Technologies: International Workshop on Design Issues in Anonymity and Unobservability.",
                "Springer, New York, 2001. [5] D. Comer.",
                "The Ubiquitous B-tree.",
                "ACM Computing Surveys, 11(2):121-137, 1979. [6] R. A. Finkel and J. L. Bentley.",
                "Quad Trees: A Data Structure for Retrieval on Composite Keys.",
                "Acta Informatica, 4:1-9, 1974. [7] D. Ganesan, D. Estrin, and J. Heidemann.",
                "DIMENSIONS: Why do we need a new Data Handling architecture for Sensor Networks?",
                "In Proceedings of the First Workshop on Hot Topics In Networks (HotNets-I), Princeton, NJ, October 2002. [8] A. Gionis, P. Indyk, and R. Motwani.",
                "Similarity Search in High Dimensions via Hashing.",
                "In Proceedings of the 25th VLDB conference, Edinburgh, Scotland, September 1999. [9] R. Govindan, J. Hellerstein, W. Hong, S. Madden, M. Franklin, and S. Shenker.",
                "The Sensor Network as a Database.",
                "Technical Report 02-771, Computer Science Department, University of Southern California, September 2002. [10] B. Greenstein, D. Estrin, R. Govindan, S. Ratnasamy, and S. Shenker.",
                "DIFS: A Distributed Index for Features in Sensor Networks.",
                "In Proceedings of 1st IEEE International Workshop on Sensor Network Protocols and Applications, Anchorage, AK, May 2003. [11] A. Guttman.",
                "R-trees: A Dynamic Index Structure for Spatial Searching.",
                "In Proceedings of the ACM SIGMOD, Boston, MA, June 1984. [12] M. Harren, J. M. Hellerstein, R. Huebsch, B. T. Loo, S. Shenker, and I. Stoica.",
                "Complex Queries in DHT-based Peer-to-Peer Networks.",
                "In P. Druschel, F. Kaashoek, and A. Rowstron, editors, Proceedings of 1st International Workshop on Peer-to-Peer Systems (IPTPS02), volume 2429 of LNCS, page 242, Cambridge, MA, March 2002.",
                "Springer-Verlag. [13] P. Indyk and R. Motwani.",
                "Approximate Nearest Neighbors: Towards Removing the Curse of Dimensionality.",
                "In Proceedings of the 30th Annual ACM Symposium on Theory of Computing, Dallas, Texas, May 1998. [14] P. Indyk, R. Motwani, P. Raghavan, and S. Vempala.",
                "Locality-preserving Hashing in Multidimensional Spaces.",
                "In Proceedings of the 29th Annual ACM symposium on Theory of Computing, pages 618 - 625, El Paso, Texas, May 1997.",
                "ACM Press. [15] C. Intanagonwiwat, R. Govindan, and D. Estrin.",
                "Directed Diffusion: A Scalable and Robust Communication Paradigm for Sensor Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [16] B. Karp and H. T. Kung.",
                "GPSR: Greedy Perimeter Stateless Routing for Wireless Networks.",
                "In Proceedings of the Sixth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom 2000), Boston, MA, August 2000. [17] S. Madden, M. Franklin, J. Hellerstein, and W. Hong.",
                "The Design of an Acquisitional Query Processor for Sensor Networks.",
                "In Proceedings of ACM SIGCMOD, San Diego, CA, June 2003. [18] S. Madden, M. J. Franklin, J. M. Hellerstein, and W. Hong.",
                "TAG: a Tiny AGregation Service for ad-hoc Sensor Networks.",
                "In Proceedings of 5th Annual Symposium on Operating Systems Design and Implementation (OSDI), Boston, MA, December 2002. [19] S. Ratnasamy, P. Francis, M. Handley, R. Karp, and S. Shenker.",
                "A Scalable Content-Addressable Network.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [20] S. Ratnasamy, B. Karp, L. Yin, F. Yu, D. Estrin, R. Govindan, and S. Shenker.",
                "GHT: A Geographic Hash Table for Data-Centric Storage.",
                "In Proceedings of the First ACM International Workshop on Wireless Sensor Networks and Applications, Atlanta, GA, September 2002. [21] H. Samet.",
                "Spatial Data Structures.",
                "In W. Kim, editor, Modern Database Systems: The Object Model, Interoperability and Beyond, pages 361-385.",
                "Addison Wesley/ACM, 1995. [22] K. Sead, A. Helmy, and R. Govindan.",
                "On the Effect of Localization Errors on Geographic Face Routing in Sensor Networks.",
                "In Under submission, 2003. [23] S. Shenker, S. Ratnasamy, B. Karp, R. Govindan, and D. Estrin.",
                "Data-Centric Storage in Sensornets.",
                "In Proc.",
                "ACM SIGCOMM Workshop on Hot Topics In Networks, Princeton, NJ, 2002. [24] I. Stoica, R. Morris, D. Karger, M. F. Kaashoek, and H. Balakrishnan.",
                "Chord: A Scalable Peer-To-Peer Lookup Service for Internet Applications.",
                "In Proceedings of the ACM SIGCOMM, San Diego, CA, August 2001. [25] F. Ye, H. Luo, J. Cheng, S. Lu, and L. Zhang.",
                "A Two-Tier Data Dissemination Model for Large-scale Wireless Sensor Networks.",
                "In Proceedings of the Eighth Annual ACM/IEEE International Conference on Mobile Computing and Networking (Mobicom02), Atlanta, GA, September 2002. 75"
            ],
            "original_annotated_samples": [],
            "translated_annotated_samples": [
                "Por ejemplo, si en una aplicación de monitoreo de hábitat, un pájaro que se cae en su nido está indicado en una cierta gama de lecturas de sensores de termopil, y una cierta gama de lecturas de micrófono, una \"consulta de rango multidimensional\" en esos atributos permite una mayor detección de confianzade la llegada de una bandada de pájaros, y puede activar un sistema de cámaras."
            ],
            "translated_text": "",
            "candidates": [
                "Consulta de rango multidimensional",
                "consulta de rango multidimensional"
            ],
            "error": []
        }
    }
}