Medidas de distancia para la recuperación basada en MPEG-7 Horst Eidenberger Universidad de Tecnología de Viena, Instituto de Tecnología de Software y Sistemas Interactivos Favoritenstrasse 9-11 - A-1040 Viena, Austria Tel. En la recuperación de información visual, la elección cuidadosa de medidas de proximidad adecuadas es un factor crucial para el éxito. La evaluación presentada en este documento tiene como objetivo demostrar que las medidas de distancia sugeridas por el grupo MPEG-7 para los descriptores visuales pueden ser superadas por medidas de propósito general. Se seleccionaron ocho descriptores visuales de MPEG-7 y se implementaron 38 medidas de distancia. Se crearon y evaluaron tres colecciones de medios, se desarrollaron indicadores de rendimiento y se realizaron más de 22500 pruebas. Además, se desarrolló un modelo de cuantificación para poder utilizar medidas de distancia basadas en predicados en datos continuos también. La evaluación muestra que las medidas de distancia recomendadas en el estándar MPEG-7 están entre las mejores, pero que otras medidas funcionan aún mejor. Categorías y Descriptores de Asignaturas H.3.3 [Almacenamiento y Recuperación de Información]: Búsqueda y Recuperación de Información - Filtrado de información, Formulación de consultas, Modelos de recuperación. Términos generales Algoritmos, Medición, Experimentación, Rendimiento, Teoría. 1. INTRODUCCIÓN El estándar MPEG-7 define, entre otros, un conjunto de descriptores para medios visuales. Cada descriptor consta de un mecanismo de extracción de características, una descripción (en formato binario y XML) y pautas que definen cómo aplicar el descriptor en diferentes tipos de medios (por ejemplo, en medios temporales). Los descriptores MPEG-7 han sido cuidadosamente diseñados para cumplir con los requisitos parcialmente complementarios de diferentes dominios de aplicación: archivo, navegación, recuperación, etc. [9]. En lo siguiente, nos ocuparemos exclusivamente de los descriptores visuales MPEG-7 en el contexto de la recuperación de medios. Los descriptores visuales MPEG-7 se dividen en cinco grupos: color, textura, forma, movimiento y otros (por ejemplo, descripción de rostros) y suman un total de 16 descriptores básicos. Para aplicaciones de recuperación, es obligatoria una regla para cada descriptor que defina cómo medir la similitud de dos descripciones. Las reglas comunes son funciones de distancia, como la distancia euclidiana y la distancia de Mahalanobis. Desafortunadamente, el estándar MPEG-7 no incluye medidas de distancia en la parte normativa, ya que no fue diseñado para ser (y no debería entenderse exclusivamente como) específico para recuperación. Sin embargo, los autores de MPEG-7 dan recomendaciones sobre qué medida de distancia usar en un descriptor particular. Estas recomendaciones se basan en un conocimiento preciso del comportamiento de los descriptores y las estructuras de descripción. En el presente estudio se implementó y aplicó un gran número de medidas de distancia exitosas de diferentes áreas (estadística, psicología, medicina, ciencias sociales y económicas, etc.) en vectores de datos de MPEG-7 para verificar si las medidas de distancia recomendadas por MPEG-7 son realmente las mejores para cualquier clase razonable de objetos multimedia. De las pruebas de MPEG-7 y las recomendaciones, no queda claro cuántas y qué medidas de distancia se han probado en los descriptores visuales y los conjuntos de datos de prueba de MPEG-7. La hipótesis es que las medidas de distancia derivadas analíticamente pueden ser buenas en general, pero solo un análisis cuantitativo es capaz de identificar la mejor medida de distancia para un método específico de extracción de características. El documento está organizado de la siguiente manera. La sección 2 proporciona un mínimo de información de fondo sobre los descriptores MPEG-7 y la medición de distancias en la recuperación de información visual (VIR, ver [3], [16]). La sección 3 proporciona una visión general de las medidas de distancia implementadas. La sección 4 describe la configuración de la prueba, incluidos los datos de la prueba y los métodos de evaluación implementados. Finalmente, la Sección 5 presenta los resultados por descriptor y sobre todos los descriptores. 2. ANTECEDENTES 2.1 MPEG-7: descriptores visuales La parte visual del estándar MPEG-7 define varios descriptores. No todos son realmente descriptores en el sentido de que extraen propiedades de los medios visuales. Algunos de ellos son simplemente estructuras para la agregación de descriptores o localización. Los descriptores básicos son Diseño de Color, Estructura de Color, Color Dominante, Color Escalable, Histograma de Bordes, Textura Homogénea, Exploración de Texturas, Forma basada en Regiones, Forma basada en Contornos, Movimiento de Cámara, Movimiento Paramétrico y Actividad de Movimiento. Otros descriptores se basan en descriptores de bajo nivel o información semántica: Color de Grupo de Cuadros/Grupo de Imágenes (basado en Color Escalable), Forma 3D (basado en información de malla 3D), Trayectoria de Movimiento (basado en segmentación de objetos) y Reconocimiento Facial (basado en extracción de rostros). Los descriptores para la agregación espaciotemporal y localización son: Coordenadas Espaciales 2D, Distribución en Cuadrícula, Localizador de Región (espacial), Series Temporales, Interpolación Temporal (temporal) y Localizador Espaciotemporal (combinado). Finalmente, existen otras estructuras para espacios de color, cuantificación de color y múltiples vistas 2D de objetos 3D. Estas estructuras adicionales permiten combinar los descriptores básicos de múltiples formas y en diferentes niveles. Pero no cambian las características de la información extraída. Por consiguiente, en el trabajo descrito en este documento no se consideraron estructuras para la agregación y localización. 2.2 Medición de similitud en datos visuales En general, la medición de similitud en información visual tiene como objetivo imitar la percepción de similitud visual humana. Desafortunadamente, la percepción humana es mucho más compleja que cualquiera de los modelos de similitud existentes (incluye percepción, reconocimiento y subjetividad). El enfoque común en la recuperación de información visual es medir la disimilitud como distancia. Tanto el objeto de consulta como el objeto candidato están representados por sus vectores de características correspondientes. La distancia entre estos objetos se mide calculando la distancia entre los dos vectores. Por consiguiente, el proceso es independiente del paradigma de consulta empleado (por ejemplo, consulta por ejemplo). El objeto de la consulta puede ser natural (por ejemplo, un objeto real) o artificial (por ejemplo, propiedades de un grupo de objetos). El objetivo del proceso de medición es expresar una relación entre los dos objetos por su distancia. La iteración para múltiples candidatos les permite definir un orden parcial sobre los candidatos y abordar aquellos en un vecindario (a definir) que sean similares al objeto de consulta. En este punto, hay que mencionar que en un entorno de múltiples descriptores, especialmente en MPEG-7, solo estamos a mitad de camino hacia una afirmación sobre la similitud. Si se utilizan múltiples descriptores (por ejemplo, un esquema de descriptores), es necesario definir una regla sobre cómo combinar todas las distancias para obtener un valor global para cada objeto. Sin embargo, la medición de la distancia es el paso inicial más importante en la medición de la similitud. Obviamente, la tarea principal de buenas medidas de distancia es reorganizar el espacio de descriptores de tal manera que los objetos multimedia con la mayor similitud estén más cerca del objeto de consulta. Si la distancia se define como mínima, el objeto de consulta siempre estará en el origen del espacio de distancias y los candidatos similares deberían formar grupos alrededor del origen que sean lo más grandes posible. En consecuencia, muchas medidas de distancia bien conocidas se basan en supuestos geométricos del espacio de descriptores (por ejemplo, La distancia euclidiana se basa en los axiomas métricos. Desafortunadamente, estas medidas no se ajustan idealmente a la percepción de similitud humana (por ejemplo, debido a la subjetividad humana). Para superar esta escasez, investigadores de diferentes áreas han desarrollado modelos alternativos que se basan principalmente en predicados (se asume que los descriptores contienen solo elementos binarios, por ejemplo. El Modelo de Contraste de Características de Tversky [17]) se ajusta mejor a la percepción humana. En las siguientes medidas de distancia de ambos grupos de enfoques se considerarán. 3. MEDIDAS DE DISTANCIA Las medidas de distancia utilizadas en este trabajo han sido recopiladas de diversas áreas (Subsección 3.1). Debido a que trabajan con datos cuantificados de manera diferente, la Subsección 3.2 esboza un modelo de unificación basado en descripciones cuantitativas. Finalmente, la Subsección 3.3 introduce las medidas de distancia, así como su origen y la idea que implementan. 3.1 Fuentes La medición de la distancia se utiliza en muchas áreas de investigación como la psicología, sociología (por ejemplo, comparando resultados de pruebas), medicina (por ejemplo, comparando parámetros de personas en pruebas), economía (por ejemplo, comparando ratios de balances), etc. Naturalmente, el carácter de los datos disponibles en estas áreas difiere significativamente. Básicamente, hay dos casos extremos de vectores de datos (y medidas de distancia): basados en predicados (todos los elementos del vector son binarios, por ejemplo, {0, 1}) y cuantitativos (todos los elementos del vector son continuos, por ejemplo, [0, 1]). Los predicados expresan la existencia de propiedades y representan información de alto nivel, mientras que los valores cuantitativos se pueden utilizar para medir y representar principalmente información de bajo nivel. Los predicados son frecuentemente utilizados en psicología, sociología y otras ciencias relacionadas con el ser humano, por lo que la mayoría de las medidas de distancia basadas en predicados fueron desarrolladas en estas áreas. Las descripciones en la recuperación de información visual son casi siempre cuantitativas (si no integran información semántica). En consecuencia, se utilizan principalmente medidas de distancia cuantitativas en la recuperación de información visual. El objetivo de este trabajo es comparar las medidas de distancia de MPEG-7 con las medidas de distancia más potentes desarrolladas en otras áreas. Dado que las descripciones de MPEG-7 son puramente cuantitativas pero algunas de las medidas de distancia más sofisticadas están definidas exclusivamente en predicados, es obligatorio un modelo que permita la aplicación de medidas de distancia basadas en predicados en datos cuantitativos. El modelo desarrollado para este propósito se presenta en la siguiente sección. 3.2 Modelo de cuantificación El objetivo del modelo de cuantificación es redefinir los operadores de conjunto que suelen utilizarse en medidas de distancia basadas en predicados en datos continuos. Los primeros en recuperación de información visual en seguir este enfoque fueron Santini y Jain, quienes intentaron aplicar el Modelo de Contraste de Características de Tversky [17] a la recuperación de imágenes basada en contenido [12], [13]. Interpretaron los datos continuos como predicados difusos y utilizaron operadores de conjuntos difusos. Desafortunadamente, su modelo presentaba varias deficiencias que describieron en [12], [13] (por ejemplo, el modelo cuantitativo solo funcionaba para una versión específica de la medida original basada en predicados). La idea principal del modelo de cuantización presentado es que los operadores de conjunto son reemplazados por funciones estadísticas. En [5] los autores pudieron demostrar que esta interpretación de los operadores de conjunto es razonable. El modelo ofrece una solución para los descriptores considerados en la evaluación. No es específico para una medida de distancia en particular, sino que se puede aplicar a cualquier medida basada en predicados. A continuación, se mostrará que el modelo no solo funciona para datos de predicado, sino también para datos cuantitativos. Cada medida que implemente el modelo puede ser utilizada como un sustituto de la medida original basada en predicados. Generalmente, las propiedades binarias de dos objetos (por ejemplo, objetos de medios) pueden existir en ambos objetos (denotado como a), en solo uno (b, c) o en ninguno de ellos (d). El operador necesario para estas relaciones son UNION, MINUS y NOT. En el modelo de cuantización se reemplazan de la siguiente manera (ver [5] para más detalles). 131 ∑     ≤ + − + ==∩= k jkikjkik kkji else xx Mif xx ssXXa 0 22, 1ε ( ) ( ) ∑ ∑ ∑     ≤ ++ −==¬∩¬=    ≤−−− ==−=    ≤−−− ==−= k jkikjkik kkji k ikjkikjk kkij k jkikjkik kkji else xx if xx MssXXd else xxMifxx ssXXc else xxMifxx ssXXb 0 22, 0 , 0 , 1 2 2 ε ε ε with: ( ) [ ] ( ) { }0\ . 0 1 . 0 1 , 2 2 1 minmax maxmin + ∈ − =     ≥      − = =     ≥      − = −= ∈= ∑ ∑ ∑ ∑ Rp ki x where else pif p M ki x where else pif p M xxM xxxwithxX i k ik i k ik ikiki µ σ σ σ ε µ µ µ ε a selecciona propiedades que están presentes en ambos vectores de datos (Xi, Xj que representan objetos de medios), b y c seleccionan propiedades que están presentes en solo uno de ellos y d selecciona propiedades que no están presentes en ninguno de los dos vectores de datos. Cada propiedad es seleccionada por el grado en que está presente (a y d: media, b y c: diferencia) y solo si la cantidad en la que está presente supera un cierto umbral (dependiendo de la media y desviación estándar sobre todos los elementos del espacio de descriptores). La implementación de estos operadores se basa en una suposición. Se asume que los elementos del vector se miden en escala de intervalo. Eso significa que cada elemento expresa que la propiedad medida está más o menos presente (0: en absoluto, M: completamente presente). Esto es cierto para la mayoría de los descriptores visuales y todos los descriptores de MPEG-7. Un origen natural, como se asume aquí (0), no es necesario. Introducir p (llamado parámetro definidor de discriminancia) para los umbrales 21, εε tiene la consecuencia positiva de que a, b, c, d pueden ser controlados a través de un solo parámetro. p es un criterio adicional para el comportamiento de una medida de distancia y determina los umbrales utilizados en los operadores. Expresa cuán precisos están presentes los elementos de datos (cuantificación) y, en consecuencia, cuán precisos deben ser investigados. p puede ser establecido por el usuario o automáticamente. Interesantes son los límites: 1. En este caso, se asume que todos los elementos (=propiedades) son continuos (alta cuantización). En consecuencia, todos los atributos de un descriptor son utilizados por los operadores. Entonces, la medida de distancia no es discriminante para las propiedades. 2. 0,0 21 →⇒→ εεp En este caso, se asume que todas las propiedades son predicados. En consecuencia, los operadores utilizan solo elementos binarios (=predicados) (cuantificación de 1 bit). La medida de distancia es altamente discriminante para las propiedades. Entre estos límites, una medida de distancia que utiliza el modelo de cuantificación es -dependiendo de p- más o menos discriminante para las propiedades. Esto significa que selecciona un subconjunto de todos los elementos de vector de descripción disponibles para la medición de distancias. Tanto para los datos de predicado como para los datos cuantitativos se puede demostrar que el modelo de cuantificación es razonable. Si los vectores de descripción consisten únicamente de elementos binarios, p debería ser utilizado de la siguiente manera (por ejemplo, p puede ser configurado automáticamente fácilmente): ( )σµεε ,min..,0,0 21 ==⇒→ pgep En este caso, a, b, c, d miden como los operadores de conjunto que reemplazan. Por ejemplo, la Tabla 1 muestra su comportamiento para dos vectores de características unidimensionales Xi y Xj. Como se puede ver, las medidas estadísticas funcionan como operadores de conjuntos. De hecho, el modelo de cuantización funciona con precisión en datos de predicados para cualquier p≠∞. Para demostrar que el modelo es adecuado para datos cuantitativos se utiliza el siguiente hecho. Es fácil demostrar que para datos de predicado algunas medidas de distancia cuantitativas degeneran en medidas basadas en predicados. Por ejemplo, la métrica L1 (métrica de Manhattan) degenera en la distancia de Hamming (de [9], sin pesos): distanciaHammingcbxxL k jkik =+≡−= ∑1 Si se puede demostrar que el modelo de cuantificación es capaz de reconstruir la medida cuantitativa a partir de la medida basada en predicados degenerada, el modelo obviamente es capaz de extender las medidas basadas en predicados al dominio cuantitativo. Esto es fácil de ilustrar. Para vectores de características puramente cuantitativas, p debe usarse de la siguiente manera (una vez más, p puede configurarse automáticamente fácilmente): 1, 21 =⇒∞→ εεp Luego, a y d se convierten en funciones continuas: ∑ ∑ + −==⇒≡≤ + + ==⇒≡≤ + − k jkik kk jkik k jkik kk jkik xx MswheresdtrueM xx xx swheresatrueM xx M 22 22 b y c pueden hacerse continuas para las siguientes expresiones: ( ) ( ) ∑ ∑ ∑ −==+⇒    ≥−− ==⇒ ≥−≡≤−−    ≥−− ==⇒ ≥−≡≤−− k jkikkk k ikjkikjk kk ikjkikjk k jkikjkik kk jkikjkik xxswherescb else xxifxx swheresc xxMxxM else xxifxx swheresb xxMxxM 0 0 0 0 0 0 Tabla 1. Modelo de cuantización en vectores de predicados. Esto significa que, para un p suficientemente alto, toda medida de distancia basada en predicados que no esté utilizando b y c o que solo esté usando b+c, b-c o c-b, puede transformarse en una medida de distancia cuantitativa continua. Por ejemplo, la distancia de Hamming (de nuevo, sin pesos): 1 Lxxxxswherescb k jkik k jkikkk =−=−==+ ∑∑ El modelo de cuantificación reconstruye con éxito la métrica L1 y no es necesario realizar ninguna modificación específica al modelo para la medida de distancia. Esto demuestra que el modelo es razonable. En lo siguiente se utilizará para ampliar medidas de distancia exitosas basadas en predicados en el dominio cuantitativo. Las principales ventajas del modelo de cuantización son: (1) es independiente del dominio de aplicación, (2) la implementación es sencilla, (3) el modelo es fácil de usar y, finalmente, (4) el nuevo parámetro p permite controlar el proceso de medición de similitud de una nueva manera (discriminancia a nivel de propiedad). 3.3 Medidas implementadas Para la evaluación descrita en este trabajo, junto con medidas basadas en predicados (basadas en el modelo de cuantización) y medidas cuantitativas, se implementaron las medidas de distancia recomendadas en el estándar MPEG-7 (en total 38 medidas de distancia diferentes). La Tabla 2 resume aquellas medidas basadas en predicados que tuvieron el mejor desempeño en la evaluación (en total se investigaron 20 medidas basadas en predicados). Para estas medidas, K es el número de predicados en los vectores de datos Xi y Xj. En P1, la suma se utiliza para la función f() de Tversky (como lo hace Tversky mismo en [17]) y α, β son pesos para los elementos b y c. En [5] los autores investigaron el Modelo de Contraste de Características de Tversky y encontraron que α=1, β=0 son los parámetros óptimos. Algunas de las medidas basadas en predicados son muy simples (por ejemplo, P2, P4) pero han sido ampliamente explotados en la investigación psicológica. La diferencia de patrones (P6) - una medida muy poderosa - se utiliza en el paquete estadístico SPSS para el análisis de clusters. P7 es un coeficiente de correlación para predicados desarrollado por Pearson. La Tabla 3 muestra las mejores medidas de distancia cuantitativa que se utilizaron. Q1 y Q2 están basados en métricas y fueron implementados como representantes de todo el grupo de distancias de Minkowski. Los "wi" son pesos. En Q5, ii σµ , son la media y la desviación estándar de los elementos del descriptor Xi. En Q6, m es 2 M (=0.5). Q3, la métrica de Canberra, es una forma normalizada de Q1. De manera similar, el coeficiente de divergencia de Clarks en Q4 es una versión normalizada de Q2. Q6 es un coeficiente de correlación más desarrollado que es invariante ante cambios de signo. Esta medida se utiliza aunque sus propiedades particulares son de poca importancia para este dominio de aplicación. Finalmente, Q8 es una medida que tiene en cuenta las diferencias entre los elementos vectoriales adyacentes. Esto lo hace estructuralmente diferente de todas las demás medidas. Obviamente, falta una medida de distancia importante. La distancia de Mahalanobis no fue considerada, porque diferentes descriptores requerirían diferentes matrices de covarianza y para algunos descriptores simplemente es imposible definir una matriz de covarianza. Si se utilizara la matriz identidad en este caso, la distancia de Mahalanobis degeneraría en una distancia de Minkowski. Además, las distancias recomendadas de MPEG-7 se implementaron con los siguientes parámetros: En la medida de distancia del descriptor de Diseño de Color, todos los pesos se establecieron en 1 (como en todas las demás medidas implementadas). En la medida a distancia del descriptor de Color Dominante se utilizaron los siguientes parámetros: 20,1,3.0,7.0 21 ==== dTww α (como se recomienda). En los descriptores de textura homogénea, todas las distancias ( )kα se establecieron en 1 y el emparejamiento se realizó de forma invariante a la rotación y escala. ¡Importante! Algunas de las medidas presentadas en esta sección son medidas de distancia, mientras que otras son medidas de similitud. Para las pruebas, es importante notar que todas las medidas de similitud fueron invertidas a medidas de distancia. 4. La Subsección 4.1 describe los descriptores (incluyendo parámetros) y las colecciones (incluyendo información de verdad de terreno) que se utilizaron en la evaluación. La subsección 4.2 discute el método de evaluación que se implementó y la subsección 4.3 describe el entorno de prueba utilizado para el proceso de evaluación. 4.1 Datos de prueba Para la evaluación se utilizaron ocho descriptores MPEG-7. Todos los descriptores de color: Diseño de color, Estructura de color, Color dominante, Color escalable, todos los descriptores de textura: Histograma de bordes, Textura homogénea, Exploración de textura y un descriptor de forma: Forma basada en regiones. Se utilizó la exploración de texturas a pesar de que el estándar MPEG-7 sugiere que no es adecuada para la recuperación. El otro descriptor de forma básico, Forma basada en contorno, no se utilizó, ya que produce descripciones estructuralmente diferentes que no pueden transformarse en vectores de datos con elementos que se miden en escalas de intervalo. Los descriptores de movimiento no fueron utilizados, ya que integran la dimensión temporal de los medios visuales y solo serían comparables si los descriptores básicos de color, textura y forma se agregaran a lo largo del tiempo. Esto no fue hecho. Finalmente, no se utilizaron descriptores de alto nivel (Localización, Reconocimiento Facial, etc., ver Subsección 2.1), porque - en opinión de los autores - el comportamiento de los descriptores básicos en objetos de medios elementales debería ser evaluado antes de poder sacar conclusiones sobre estructuras agregadas. Tabla 2. Medidas de distancia basadas en predicados. No. Las descripciones de navegación de texturas tuvieron que ser transformadas de cinco contenedores a una representación de ocho contenedores para que todos los elementos de la medida del descriptor estén en una escala de intervalo. Se utilizó una métrica de Manhattan para medir la proximidad (ver [6] para más detalles). La extracción de descriptores se realizó utilizando la implementación de referencia de MPEG-7. En el proceso de extracción, cada descriptor se aplicó a todo el contenido de cada objeto de medios y se utilizaron los siguientes parámetros de extracción. La estructura de color fue cuantizada en 32 contenedores. Para el espacio de color de color dominante se estableció en YCrCb, se utilizó una cuantificación predeterminada de 5 bits y se utilizó el valor predeterminado para la coherencia espacial. La textura homogénea se cuantificó en 32 componentes. Los valores de color escalables se cuantificaron a sizeof(int)-3 bits y se utilizaron 64 contenedores. Finalmente, la Exploración de Texturas se utilizó con cinco componentes. Estos descriptores se aplicaron en tres colecciones de medios con contenido de imágenes: el conjunto de datos Brodatz (112 imágenes, 512x512 píxeles), un subconjunto del conjunto de datos Corel (260 imágenes, 460x300 píxeles, retrato y paisaje) y un conjunto de datos con imágenes de escudos de armas (426 imágenes, 200x200 píxeles). La Figura 1 muestra ejemplos de las tres colecciones. Diseñar conjuntos de pruebas apropiados para una evaluación visual es una tarea sumamente difícil (por ejemplo, consulte el informe del TREC video 2002 [15]). Por supuesto, para identificar la mejor medida de distancia para un descriptor, debería ser probada en un número infinito de objetos de medios. Pero ese no es el objetivo de este estudio. Se evalúa si se pueden encontrar medidas de proximidad mejores que las sugeridas por el grupo MPEG-7, solo para colecciones de imágenes probables. Las colecciones de este tamaño relativamente pequeño se utilizaron en la evaluación, ya que los métodos de evaluación aplicados son invariantes al tamaño de la colección por encima de un cierto tamaño mínimo y para colecciones más pequeñas es más fácil definir una verdad de referencia de alta calidad. Sin embargo, la proporción promedio del tamaño de la verdad terrenal al tamaño de la colección es de al menos 1:7. Específicamente, no se utilizó ninguna colección del conjunto de datos MPEG-7 en la evaluación porque las evaluaciones deben mostrar qué tan bien funcionan los descriptores y las medidas de distancia recomendadas en material desconocido. Cuando se completó la extracción de descriptores, las descripciones XML resultantes se transformaron en una matriz de datos con 798 líneas (objetos multimedia) y 314 columnas (elementos descriptores). Para ser utilizable con medidas de distancia que no integran conocimiento de dominio, los elementos de esta matriz de datos fueron normalizados a [0, 1]. Para la evaluación de la distancia, se necesita la evaluación de la similitud humana junto a la matriz de datos normalizados. En este trabajo, la verdad terrenal se construye a partir de doce grupos de imágenes similares (cuatro para cada conjunto de datos). La pertenencia a un grupo fue evaluada por humanos basándose en criterios semánticos. La tabla 4 resume los doce grupos y las descripciones subyacentes. Debe notarse que algunos de estos grupos (especialmente 5, 7 y 10) son mucho más difíciles de encontrar con descriptores de bajo nivel que otros. 4.2 Método de evaluación Por lo general, la evaluación de recuperación se realiza en función de una verdad fundamental con recall y precisión (ver, por ejemplo, [3], [16]). En entornos de múltiples descriptores esto conlleva un problema, ya que los valores resultantes de recuperación y precisión están fuertemente influenciados por el método utilizado para fusionar los valores de distancia para un objeto multimedia. Aunque es casi imposible decir cuán grande fue la influencia de una sola medida de distancia en los valores resultantes de recuperación y precisión, este problema ha sido casi ignorado hasta ahora. En la Subsección 2.2 se mencionó que la tarea principal de una medida de distancia es acercar los objetos de medios relevantes lo más cerca posible al origen (donde se encuentra el objeto de consulta). Incluso en un entorno de múltiples descriptores, es entonces simple identificar los objetos similares en un espacio de gran distancia. Por consiguiente, se decidió poner en la Tabla 3. Medidas de distancia cuantitativas. No. Medida Comentario N.º Medida Comentario Q1 ∑ − k jkiki xxw Distancia de manhattan (L1) Q2 ( )∑ − k jkiki xxw Distancia euclidiana (L2) Q3 ∑ + − k jkik jkik xx xx Métrica de Canberra, Lance, Williams 1967 [8] Q4 ( ) ∑ + − k jkik jkik xx xx Coeficiente de divergencia, Clark 1952 [1] Q5 ( )( ) ( ) ( )∑ ∑ ∑ −− −− k k jjkiik k jjkiik xx xx 22 µµ µµ Coeficiente de correlación Q6       −+      −−       +−− ∑∑∑ ∑ ∑∑ k ik k jkik k ik k k jk k ikjkik xmKmxxmKmx xxmKmxx 2..2 2222 Cohen 1969 [2] Q7 ∑ ∑ ∑ k k jkik k jkik xx xx 22 Distancia angular, Gower 1967 [7] Q8 ( ) ( )( )∑ − ++ −−− 1 2 11 K k jkjkikik xxxx Índice de Meehl [10] Tabla 4. Información de verdad de campo. Colección. No hay descripción de imágenes 1 19 Patrones regulares a cuadros 2 38 Ruido blanco oscuro 3 33 Superficies parecidas a la luna Brodatz 4 35 Superficies parecidas al agua 5 73 Humanos en la naturaleza (difícil) 6 17 Imágenes con nieve (montañas, esquí) 7 76 Animales en la naturaleza (difícil) Corel 8 27 Flores grandes y coloridas 9 12 Escudos comunales bávaros 10 10 Todos los escudos bávaros (difícil) 11 18 Objetos oscuros / escudo no segmentado de luz Armas 12 14 Cargas principales en un escudo azul o rojo 134 utilizan indicadores que miden la distribución en el espacio de distancia de los candidatos similares al objeto de consulta para esta evaluación en lugar de la recuperación y precisión. Identificar grupos de objetos similares (basados en la verdad terrenal proporcionada) es relativamente fácil, ya que el espacio de distancias resultante para un descriptor y cualquier medida de distancia siempre es unidimensional. Los cúmulos se encuentran buscando desde el origen del espacio de distancia hasta el primer objeto similar, agrupando todos los objetos similares siguientes en el cúmulo, rompiendo el cúmulo con el primer objeto no similar y así sucesivamente. Para la evaluación se definieron dos indicadores. La primera mide la distancia promedio de todas las medias de los grupos al origen: distancia_promedio_grupos = ∑ ∑ (distancia_ij) / (tamaño_grupo_i), donde distancia_ij es el valor de distancia del j-ésimo elemento en el i-ésimo grupo, ∑ ∑ ∑ = (distancia_ij) / (tamaño_grupo_i), no_clusters es el número de grupos encontrados y tamaño_grupo_i es el tamaño del i-ésimo grupo. El indicador resultante se normaliza por las características de distribución de la medida de distancia (distancia_promedio). Además, se utiliza la desviación estándar. En el proceso de evaluación, esta medida resultó ser productiva y relativamente robusta frente al parámetro p del modelo de cuantificación. En la Subsección 3.2 notamos que p afecta la discriminancia de una medida de distancia basada en predicados: Cuanto menor sea el valor de p, más grandes serán los grupos resultantes porque el modelo de cuantificación es entonces más discriminante contra las propiedades y se utilizan menos elementos de la matriz de datos. Esto provoca un efecto secundario que es medido por el segundo indicador: cada vez más objetos no similares salen con exactamente el mismo valor de distancia que los objetos similares (un problema que no existe para ps grandes) y se vuelven indistinguibles de los objetos similares. Por consiguiente, son miembros (falsos) del cúmulo. Este fenómeno (conceptualmente similar al indicador de falsos negativos) fue nombrado como contaminación de clústeres y el indicador mide la contaminación promedio de clústeres: clústeres sin duplicados sin clústeres de contaminación de clústeres de tamaño i j ij i _ _ _ _ ∑ ∑ = donde no_doublesij es el número de objetos indiscernibles no similares asociados con el elemento j-ésimo del clúster i. Nota: Aunque existe cierta influencia, se pudo demostrar en [5] que no existe una correlación significativa entre el parámetro p del modelo de cuantización y la contaminación del clúster. 4.3 Entorno de prueba Como se señaló anteriormente, para generar los descriptores se utilizó la implementación de referencia de MPEG-7 en la versión 5.6 (proporcionada por la TU Munich). El procesamiento de imágenes se realizó con Adobe Photoshop y la normalización y todas las evaluaciones se hicieron con Perl. El proceso de consulta se realizó en los siguientes pasos: (1) selección aleatoria de un grupo de verdad terrenal, (2) selección aleatoria de un objeto de consulta de este grupo, (3) comparación de distancias para todos los demás objetos en el conjunto de datos, (4) agrupación del espacio de distancias resultante basado en la verdad terrenal y finalmente, (5) evaluación. Para cada combinación de conjunto de datos y medida de distancia se emitieron 250 consultas y las evaluaciones se agregaron en todos los conjuntos de datos y descriptores. La siguiente sección muestra los resultados, parcialmente sorprendentes. 5. RESULTADOS En los resultados presentados a continuación, se utilizó el primer indicador de la Subsección 4.2 para evaluar las medidas de distancia. En un primer paso, el parámetro p tuvo que ser establecido de tal manera que todas las medidas sean igualmente discriminantes. La medición de la distancia es justa si la siguiente condición se cumple para cualquier medida basada en predicados dP y cualquier medida continua dC: ( ) ( )CP dcppdcp ≈, entonces se garantiza que las medidas basadas en predicados no crean conglomerados más grandes (con un mayor número de objetos similares) a costa de una mayor contaminación del conglomerado. En más de 1000 consultas de prueba se encontró que el valor óptimo era p=1. Los resultados se organizan de la siguiente manera: La subsección 5.1 resume la Figura 1. Conjuntos de datos de prueba. Izquierda: conjunto de datos de Brodatz, centro: conjunto de datos de Corel, derecha: conjunto de datos de escudos de armas. 135 mejores medidas de distancia por descriptor, la Sección 5.2 muestra las mejores medidas de distancia en general y la Sección 5.3 señala otros resultados interesantes (por ejemplo, medidas de distancia que funcionan particularmente bien en grupos de verdad terrestre específicos). La Figura 2 muestra los resultados de evaluación para el primer indicador de la mejor medida por descriptor. Para cada descriptor se muestra la mejor medida y el rendimiento de la recomendación MPEG-7. Los resultados se agregan sobre los conjuntos de datos probados. A primera vista, queda claro que las recomendaciones de MPEG-7 son en su mayoría relativamente buenas pero nunca las mejores. Para Color Layout, la diferencia entre MP7 y la mejor medida, el índice de Meehl (Q8), es solo del 4% y la medida de MPEG-7 tiene una desviación estándar más pequeña. La razón por la que el índice de Meehl es mejor puede ser que este descriptor genera descripciones con elementos que tienen una varianza muy similar. El análisis estadístico confirmó eso (ver [6]). Para Estructura de Color, Histograma de Bordes, Textura Homogénea, Forma basada en Regiones y Color Escalable, la mejor medida por mucho es la diferencia de patrones (P6). La investigación psicológica sobre la percepción visual humana ha revelado que en muchas situaciones, las diferencias entre el objeto de consulta y un candidato pesan mucho más fuerte que las propiedades comunes. La medida de diferencia de patrones implementa esta idea de la manera más consecuente. En la opinión del autor, la razón por la que la diferencia de patrones funciona tan excepcionalmente bien en muchos descriptores se debe a este hecho. Las ventajas adicionales de la diferencia de patrones son que generalmente tiene una varianza muy baja y, debido a que es una medida basada en predicados, su capacidad discriminante (y estructura de clúster) se puede ajustar con el parámetro p. La mejor medida para el Color Dominante resultó ser el coeficiente de Divergencia de Clarks (Q4). Esta es una medida similar a la diferencia de patrones en el dominio continuo. El descriptor de exploración de texturas es un problema especial. En el estándar MPEG-7 se recomienda utilizarlo exclusivamente para la navegación. Después de probarlo para la recuperación en varias medidas de distancia, el autor respalda esta opinión. Es muy difícil encontrar una buena medida de distancia para la exploración de texturas. La métrica propuesta de Manhattan, por ejemplo, funciona muy mal. La mejor medida es basada en predicados (P7). Funciona en propiedades comunes (a, d) pero produce grupos con una contaminación de grupo muy alta. Para este descriptor, el segundo indicador es hasta ocho veces mayor que para medidas basadas en predicados en otros descriptores. 5.2 Mejores medidas generales La Figura 3 resume los resultados sobre todos los descriptores y colecciones de medios. El diagrama debería dar una indicación sobre el potencial general de las medidas de distancia investigadas para la recuperación de información visual. Se puede observar que la mejor medida general es una basada en predicados. El rendimiento superior de la diferencia de patrones (P6) demuestra que el modelo de cuantificación es un método razonable para extender las medidas de distancia basadas en predicados en el dominio continuo. El segundo mejor grupo de medidas son las recomendaciones de MPEG-7, las cuales tienen una media ligeramente más alta pero una desviación estándar más baja que la diferencia de patrones. La tercera mejor medida es el índice de Meehl (Q8), una medida desarrollada para aplicaciones psicológicas pero, debido a sus propiedades características, hecha a medida para ciertos descriptores (homogéneos). Las métricas de Minkowski también se encuentran entre las mejores medidas: la media y la varianza promedio de la métrica de Manhattan (Q1) y la métrica euclidiana (Q2) están en el rango de Q8. Por supuesto, estas medidas no funcionan especialmente bien para ninguno de los descriptores. Notablemente para una medida basada en predicados, el Modelo de Contraste de Características de Tversky (P1) también se encuentra en el grupo de medidas muy buenas (aunque no está entre las mejores) que culmina con Q5, el coeficiente de correlación. Las otras medidas tienen o bien una media significativamente más alta o una desviación estándar muy grande. Otros resultados interesantes son que las medidas de distancia que tienen un rendimiento promedio peor que otras pueden, en ciertas situaciones (por ejemplo, en contenido específico), seguir teniendo un mejor rendimiento. Para la Distribución de Color, por ejemplo, el Q7 es una medida muy buena en fotos a color. Tiene un rendimiento tan bueno como el Q8 y una desviación estándar más baja. Para imágenes artificiales, la diferencia de patrones y la distancia de Hamming producen resultados comparables también. Si la información de color está disponible en los objetos multimedia, la diferencia de patrones funciona bien en el Color Dominante (solo un 20% peor en Q4) y en caso de una verdad de terreno difícil (grupo 5, 7, 10) el índice de Meehl es tan fuerte como P6. 0,000 0,001 0,002 0,003 0,004 0,005 0,006 0,007 0,008 Q8 MP7 P6 MP7 Q4 MP7 P6 MP7 P6 MP7 P6 MP7 P6 MP7 P6 MP7 P7 Q2 Diseño de Color Estructura de Color Color Dominante Histograma de Bordes Homog. Región de textura, forma escalable, color de textura y navegación de figuras. Figura 2. Resultados por medida y descriptor. El eje horizontal muestra la mejor medida y el rendimiento de la recomendación MPEG-7 para cada descriptor. El eje vertical muestra los valores del primer indicador (un valor más pequeño = mejor estructura de clúster). Los tonos tienen el siguiente significado: negro = µ-σ (casos buenos), negro + gris oscuro = µ (promedio) y negro + gris oscuro + gris claro = µ+σ (malo). 136 6. CONCLUSIÓN La evaluación presentada en este documento tiene como objetivo probar las medidas de distancia recomendadas y encontrar mejores para los descriptores visuales básicos de MPEG-7. Se seleccionaron ocho descriptores, se implementaron 38 medidas de distancia, se crearon y evaluaron colecciones de medios, se definieron indicadores de rendimiento y se realizaron más de 22500 pruebas. Para poder utilizar medidas de distancia basadas en predicados junto con medidas cuantitativas, se definió un modelo de cuantificación que permite la aplicación de medidas basadas en predicados en datos continuos. En la evaluación, las mejores medidas de distancia general para el contenido visual, extraídas por los descriptores visuales MPEG-7, resultaron ser la medida de diferencia de patrones y el índice de Meehl (para descripciones homogéneas). Dado que estas dos medidas tienen un rendimiento significativamente mejor que las recomendaciones de MPEG-7, deberían ser probadas en colecciones grandes de contenido de imágenes y videos (por ejemplo, de [15]). La elección de la función de distancia adecuada para la medición de similitud depende del descriptor, la colección de medios consultada y el nivel semántico de la idea de similitud del usuario. Este trabajo ofrece medidas de distancia adecuadas para diversas situaciones. En consecuencia, las medidas de distancia identificadas como las mejores se implementarán en el marco de recuperación de información visual VizIR basado en MPEG-7 [4]. AGRADECIMIENTOS El autor desea agradecer a Christian Breiteneder por sus valiosos comentarios y sugerencias para mejorar. El trabajo presentado en este artículo es parte del proyecto VizIR financiado por el Fondo de Investigación Científica de Austria FWF bajo el número de subvención. P16111. REFERENCIAS [1] Clark, P.S. Una extensión del coeficiente de divergencia para su uso con múltiples caracteres. Copeia, 2 (1952), 61-64. [2] Cohen, J. 

Copeia, 2 (1952), 61-64. [2] Cohen, J. Un coeficiente de similitud de perfil invariante ante reflexión variable. Psychological Bulletin, 71 (1969), 281-284. [3] Del Bimbo, A. 

Boletín Psicológico, 71 (1969), 281-284. [3] Del Bimbo, A. Recuperación de información visual. Morgan Kaufmann Publishers, San Francisco CA, 1999. [4] Eidenberger, H., y Breiteneder, C. Un marco para la recuperación de información visual. En Actas de la Conferencia de Sistemas de Información Visual (HSinChu Taiwán, marzo de 2002), LNCS 2314, Springer Verlag, 105-116. [5] Eidenberger, H., y Breiteneder, C. Medición de similitud visual con el Modelo de Contraste de Características. En Actas de la Conferencia SPIE Almacenamiento y Recuperación para Bases de Datos de Medios (Santa Clara CA, enero de 2003), SPIE Vol. 5021, 64-76. [6] Eidenberger, H., ¿Qué tan buenas son las características visuales de MPEG-7? En las Actas de la Conferencia de Comunicaciones Visuales y Procesamiento de Imágenes SPIE (Lugano, Suiza, julio de 2003), SPIE Vol. 5150, 476-488. [7] Gower, J.G. Análisis multivariado y geometría multidimensional. El Estadístico, 17 (1967), 13-25. [8] Lance, G.N., y Williams, W.T. Programas clasificatorios de datos mixtos. Sistemas Aglomerativos de Computación Australiana. Revista, 9 (1967), 373-380. [9] Manjunath, B.S., Ohm, J.R., Vasudevan, V.V., y Yamada, A. Descriptores de color y textura. En el número especial sobre MPEG7. IEEE Transactions on Circuits and Systems for Video Technology, 11/6 (junio de 2001), 703-715. [10] Meehl, P. E. El problema es epistemológico, no estadístico: reemplace las pruebas de significancia por intervalos de confianza y cuantifique la precisión de las predicciones numéricas arriesgadas. En Harlow, L.L., Mulaik, S.A. y Steiger, J.H. (Eds.). ¿Y si no hubiera pruebas de significancia? Erlbaum, Mahwah NJ, 393-425. [11] Pearson, K. Sobre los coeficientes de semejanza racial. Biometrica, 18 (1926), 105-117. [12] Santini, S., y Jain, R. La similitud es un geómetra. Herramientas y aplicaciones multimedia, 5/3 (1997), 277-306. [13] Santini, S. y Jain, R. Medidas de similitud. IEEE Transactions on Pattern Analysis and Machine Intelligence, 21/9 (septiembre de 1999), 871-883. [14] Sint, P.P. Estructuras de similitud y medidas de similitud. Academia de Ciencias de Austria Press, Viena, Austria, 1975 (en alemán). [15] Smeaton, A.F. y Over, P. Informe de la pista de video TREC-2002. NIST Publicación Especial SP 500-251 (marzo de 2003), disponible en: http://trec.nist.gov/pubs/trec11/papers/VIDEO.OVER.pdf (última visita: 29 de julio de 2003) [16] Smeulders, A.W.M., Worring, M., Santini, S., Gupta, A., y Jain, R. Recuperación de imágenes basada en contenido al final de los primeros años. IEEE Transactions on Pattern Analysis and Machine Intelligence, 22/12 (diciembre de 2000), 1349-1380. [17] Tversky, A. Características de similitud. Revisión Psicológica, 84/4 (julio de 1977), 327-351. 0,000 0,002 0,004 0,006 0,008 0,010 0,012 0,014 0,016 0,018 0,020 P6 MP7 Q8 Q1 Q4 Q2 P2 P4 Q6 Q3 Q7 P1 Q5 P3 P5 P7 Figura 3. Resultados generales (ordenados por el primer indicador). El eje vertical muestra los valores del primer indicador (un valor más pequeño = mejor estructura de clúster). Los tonos tienen el siguiente significado: negro=µ-σ, negro + gris oscuro=µ y negro + gris oscuro + gris claro=µ+σ. 137