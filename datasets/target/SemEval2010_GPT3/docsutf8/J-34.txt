Propiedades de estabilidad de la dinámica de órdenes límite. Eyal Even-Dar ∗ Sham M. Kakade † Michael Kearns ‡ Yishay Mansour § RESUMEN Estudiamos las propiedades de estabilidad de la dinámica del mecanismo estándar de órdenes límite continuas que se utiliza en los mercados de valores modernos. Nos preguntamos si dichos mecanismos son susceptibles a los efectos mariposa: la imposición de grandes cambios en medidas comunes de la actividad del mercado mediante solo pequeñas perturbaciones en la secuencia de órdenes. Mostramos que la respuesta depende fuertemente de si el mercado está compuesto por traders absolutos (que determinan sus precios de forma independiente del estado actual del libro de órdenes) o traders relativos (que determinan sus precios en relación con la oferta y demanda actual). Demostramos que mientras el modelo de trader absoluto disfruta de propiedades de estabilidad fuertes comprobadas, el modelo de trader relativo es vulnerable a una gran inestabilidad. Nuestros resultados teóricos están respaldados por experimentos a gran escala utilizando datos de órdenes límite de INET, un gran intercambio electrónico para acciones de NASDAQ. Categorías y Descriptores de Asignaturas J.4 [Ciencias Sociales y del Comportamiento]: Economía Términos Generales Economía, Teoría 1. En los últimos años ha habido un aumento explosivo en la automatización de los mercados de valores modernos. Este aumento ha tenido lugar tanto en los intercambios, que están cada vez más informatizados y ofrecen interfaces sofisticadas para la colocación y gestión de órdenes, como en la actividad comercial en sí, que cada vez se realiza con más frecuencia mediante software. Los llamados Electronic Communication Networks (o ECNs) que dominan el comercio de acciones de NASDAQ son un ejemplo común de la automatización de los intercambios. En el ámbito del trading, los programas informáticos ahora son responsables no solo de la ejecución cuidadosa de grandes operaciones en bloque para los clientes (a veces denominadas en Wall Street como trading programático), sino también de la selección autónoma de acciones, dirección (larga o corta) y volúmenes a negociar con fines de lucro (comúnmente conocido como arbitraje estadístico). La gran mayoría de las operaciones de acciones se realizan a través del mecanismo estándar del mercado de órdenes límite. En este mecanismo, se lleva a cabo una negociación continua a través de la llegada de órdenes límite que especifican si la parte desea comprar o vender, el volumen deseado y el precio ofrecido. Las órdenes límite que llegan y que son totalmente o parcialmente ejecutables con las mejores ofertas en el otro lado se ejecutan de inmediato, con cualquier volumen no ejecutable de inmediato siendo colocado en una cola (o libro) ordenada por precio en el lado correspondiente (compra o venta). (Una descripción detallada del mecanismo de órdenes límite se proporciona en la Sección 3). Si bien los operadores siempre han podido ver los precios en la parte superior de los libros de compra y venta (conocidos como la oferta y la demanda), un desarrollo relativamente reciente en ciertos intercambios es la revelación en tiempo real de todo el libro de órdenes: la distribución completa de órdenes, precios y volúmenes en ambos lados del intercambio. Con esta revelación ha surgido la oportunidad, y cada vez más la necesidad, de modelar y explotar los datos y la dinámica de las órdenes límite. Es justo decir que la microestructura del mercado, como generalmente se conoce esta área, es un tema que despierta gran interés tanto en los mercados reales como en la literatura académica de finanzas. Las oportunidades y necesidades abarcan desde la ejecución optimizada de grandes operaciones hasta la creación de estrategias propietarias independientes que intentan obtener beneficios a partir de señales de microestructura de alta frecuencia. En este artículo investigamos un aspecto previamente no explorado pero fundamental de la microestructura de órdenes límite: las propiedades de estabilidad de la dinámica. Específicamente, estamos interesados en la siguiente pregunta natural: ¿Hasta qué punto los modelos simples de mercados de órdenes límite son susceptibles o inmunes a los efectos mariposa, es decir, la infligencia de grandes cambios en estadísticas de actividad importantes (como el número de acciones negociadas o el precio promedio por acción) mediante solo perturbaciones menores en la secuencia de órdenes? Para examinar esta pregunta, consideramos dos modelos estilizados pero naturales del proceso de llegada de órdenes límite. En el modelo de precio absoluto, los compradores y vendedores llegan con precios de órdenes límite que se determinan de forma independiente del estado actual del mercado (representado por los libros de órdenes), aunque pueden depender de toda clase de información exógena o shocks, como el tiempo, eventos de noticias, anuncios de la empresa cuyas acciones se están negociando, señales privadas o estado de los traders individuales, etc. Este proceso modela el comercio tradicional basado en fundamentos, en el que los participantes del mercado tienen cada uno una valoración inherente pero posiblemente variable para el bien que a su vez determina su precio límite. Por el contrario, en el modelo de precio relativo, los operadores expresan sus precios de órdenes límite en relación al mejor precio ofrecido en su respectivo libro (compra o venta). Por lo tanto, un comprador codificaría su precio de orden límite como un desfase ∆ (que puede ser positivo, negativo o cero) desde la oferta actual pb, que luego se traduce al precio límite pb + ∆. Nuevamente, además de depender ahora del estado de los libros de órdenes, los precios también pueden depender de todo tipo de información exógena. El modelo de precio relativo puede ser visto como un modelo que representa a los operadores que, además de posiblemente incorporar información externa fundamental sobre la acción, también pueden posicionar estratégicamente sus órdenes en relación con las otras órdenes en su lado del libro. Un ejemplo común de este tipo de comportamiento estratégico se conoce como "penny-jumping" en Wall Street, en el cual un operador que tiene interés en comprar acciones rápidamente, pero aún a un precio inferior al de realizar una orden de mercado, colocará deliberadamente su orden justo por encima de la oferta actual. Más generalmente, toda el área de optimización de ejecución moderna [9, 10, 8] ha llegado a depender en gran medida de la cuidadosa colocación de órdenes límite en relación al estado actual del libro de órdenes. Ten en cuenta que tal posicionamiento puede depender de características más complejas de los libros de órdenes que solo del bid y ask actuales, pero el modelo relativo es un punto de partida natural y simplificado. Observamos que una visión alternativa de los dos modelos es que todos los operadores se comportan de manera relativa, pero los operadores absolutos solo pueden actuar en una escala de tiempo considerablemente más lenta que los operadores relativos más rápidos. ¿En qué se diferencian estos dos modelos? Claramente, dada cualquier secuencia fija de precios de órdenes límite que llegan, podemos elegir expresar estos precios ya sea como sus valores originales (absolutos), o podemos ejecutar el proceso dinámico del libro de órdenes y transformar cada orden en una diferencia relativa con la parte superior de su libro, y obtener resultados idénticos. Las diferencias surgen cuando consideramos la pregunta de estabilidad introducida anteriormente. De manera intuitiva, en el modelo absoluto una pequeña perturbación en la secuencia de precios límite que llegan debería tener efectos limitados (aunque algunos) en la evolución posterior de los libros de órdenes, ya que los precios se determinan de forma independiente. Para el modelo relativo, esta intuición es menos clara. Parece posible que una pequeña perturbación podría (por ejemplo) modificar ligeramente la oferta actual, lo que a su vez podría modificar ligeramente el precio del próximo pedido que llegue, lo que a su vez podría modificar ligeramente el precio del pedido siguiente, y así sucesivamente, dando lugar a una secuencia amplificadora de eventos. Nuestros resultados principales demuestran que estos dos modelos tienen propiedades de estabilidad dramáticamente diferentes. Primero demostramos que para cualquier secuencia fija de precios en el modelo absoluto, la modificación de un solo pedido tiene un impacto limitado y extremadamente limitado en la evolución posterior de los libros. En particular, definimos una noción natural de distancia entre libros de órdenes y mostramos que pequeñas modificaciones pueden resultar en una distancia constante respecto a los libros originales para todos los pasos de tiempo subsiguientes. Luego demostramos que esto implica que para casi cualquier estadística estándar de la actividad del mercado - el volumen ejecutado, el precio promedio de ejecución y muchos otros - la estadística solo puede ser influenciada infinitesimalmente por pequeñas perturbaciones. Por el contrario, demostramos que el modelo relativo no posee tales propiedades de estabilidad. Después de proporcionar secuencias de precios relativos específicas (peores casos) en las que pequeñas perturbaciones generan grandes cambios en las estadísticas básicas (por ejemplo, alterando el número de acciones negociadas por un factor de dos), procedemos a demostrar que la diferencia en las propiedades de estabilidad de los dos modelos es más que meramente teórica. Utilizando datos extensos de órdenes límite de INET (una ECN importante para acciones de NASDAQ) y código de reconstrucción de libro de órdenes, investigamos las propiedades de estabilidad empírica cuando los datos se interpretan como conteniendo precios absolutos, precios relativos o mezclas de ambos. Las predicciones teóricas de estabilidad e inestabilidad son fuertemente respaldadas por los experimentos posteriores. Además de la estabilidad ser de interés fundamental en cualquier sistema dinámico importante, creemos que los resultados descritos aquí ofrecen material para reflexionar sobre los temas del impacto en el mercado y la prueba retrospectiva de estrategias de trading cuantitativo (el intento de determinar el rendimiento hipotético pasado utilizando datos históricos). Sugieren que la confianza de uno en que operar en silencio y en pequeños volúmenes tendrá un impacto mínimo en el mercado está vinculada a una creencia implícita en un modelo de precio absoluto. Nuestros resultados y el hecho de que en los mercados reales existe una gran cantidad creciente de comportamientos relativos como el penny-jumping parecerían poner en duda tales creencias. Del mismo modo, en un mundo pura o mayoritariamente de precios relativos, probar incluso estrategias de baja frecuencia y bajo volumen podría resultar en estimaciones históricas de rendimiento que no solo no están relacionadas con el rendimiento futuro (la preocupación habitual), sino que ni siquiera son medidas precisas de un pasado hipotético. El esquema del documento sigue. En la Sección 2 revisamos brevemente la extensa literatura sobre microestructura de mercado. En la Sección 3 describimos el mecanismo de orden límite y nuestros modelos formales. La Sección 4 presenta nuestros resultados teóricos más importantes, el Teorema de Modificación 1 para el modelo de precio absoluto. Este teorema se aplica en la Sección 5 para derivar una serie de propiedades de estabilidad sólida en el modelo absoluto. La sección 6 presenta ejemplos específicos que establecen la inestabilidad en el peor de los casos del modelo relativo. La sección 7 contiene los estudios de simulación que confirman en gran medida nuestros hallazgos teóricos sobre los datos del mercado de INET. 2. TRABAJO RELACIONADO Como se mencionó en la Introducción, la microestructura del mercado es un tema importante y oportuno tanto en la financiación académica como en Wall Street, y en consecuencia tiene una amplia y variada literatura reciente. Aquí solo tenemos espacio para resumir los temas principales de esta literatura y proporcionar referencias para lecturas adicionales. Hasta donde sabemos, las propiedades de estabilidad de la dinámica detallada de la microestructura de órdenes límite no han sido consideradas previamente. (Sin embargo, consulte Farmer y Joshi [6] para un ejemplo y una encuesta de otros estudios de estabilidad dinámica de precios). En un plano más teórico, existe una amplia línea de trabajo que examina lo que podría considerarse las propiedades teóricas de tipo juego de los mercados de órdenes límite. Estos trabajos modelan a los traders y creadores de mercado (quienes proporcionan liquidez al ofrecer cotizaciones de compra y venta, y obtienen beneficios de la diferencia) mediante funciones de utilidad que incorporan tolerancia al riesgo de movimientos de precios, posiciones grandes y otros factores, y examinan los precios y comportamientos de equilibrio resultantes. Los hallazgos comunes predicen impactos negativos en los precios para operaciones grandes, y efectos en los precios para grandes tenencias de inventario por parte de los creadores de mercado. Una excelente y completa encuesta de resultados en esta área se puede encontrar en [2]. Existe un cuerpo igualmente extenso de trabajo empírico sobre microestructura. Los temas principales incluyen la medición de los impactos de precios, las propiedades estadísticas de los libros de órdenes límite y los intentos de establecer el valor informativo de los libros de órdenes [4]. Una buena visión general del trabajo empírico se puede encontrar en [7]. De particular interés para nuestros intereses es [3], que estudia empíricamente la distribución de los precios de las órdenes límite que llegan en varios mercados prominentes. Este trabajo adopta una perspectiva de los precios de llegada análoga a nuestro modelo relativo, y establece una forma de ley de potencia para las distribuciones resultantes. También hay un número pequeño pero creciente de trabajos que examinan temas de microestructura de mercado desde una perspectiva de ciencias de la computación, incluidos algunos centrados en el uso de la microestructura en algoritmos para la ejecución de operaciones comerciales optimizadas. Kakade et al. [9] introdujeron la dinámica de órdenes límite en el análisis competitivo para el trading de precio promedio ponderado por volumen (VWAP) de ida y vuelta. Algunos artículos recientes han aplicado métodos de aprendizaje por refuerzo a la ejecución de operaciones comerciales utilizando las propiedades del libro de órdenes como variables de estado [1, 5, 10]. 3. PRELIMINARES DE MICROESTRUCTURA El siguiente material de antecedentes expositivos está adaptado de [9]. El mecanismo de mercado que examinamos en este documento está impulsado por el simple y estándar concepto de una orden límite. Supongamos que deseamos comprar 1000 acciones de Microsoft (MSFT). En una orden limitada, especificamos no solo el volumen deseado (1000 acciones), sino también el precio deseado. Supongamos que MSFT actualmente se está negociando a aproximadamente $24.07 por acción (ver Figura 1, que muestra una captura real de un libro de órdenes de MSFT en INET), pero solo estamos dispuestos a comprar las 1000 acciones a $24.04 por acción o menos. Podemos optar por enviar una orden con límite con esta especificación, y nuestra orden se colocará en una cola llamada libro de órdenes de compra, que está ordenado por precio, con el precio de compra no ejecutado más alto en la parte superior (a menudo referido como la oferta). Si hay múltiples órdenes límite al mismo precio, se ordenan por orden de llegada (con las órdenes más antiguas en la parte superior del libro). En el ejemplo proporcionado por la Figura 1, nuestra orden se colocaría inmediatamente después de la orden existente de 5,503 acciones a $24.04; aunque ofrecemos el mismo precio, esta orden ha llegado antes que la nuestra. De igual manera, se mantiene un libro de órdenes de venta para órdenes de límite de venta, esta vez con el precio de venta más bajo ofrecido (a menudo conocido como el ask) en la parte superior. Por lo tanto, los libros de órdenes se ordenan desde las órdenes límite más competitivas en la parte superior (altos precios de compra y bajos precios de venta) hasta las órdenes límite menos competitivas. Los precios de oferta y demanda juntos a veces se conocen como el mercado interno, y la diferencia entre ellos como el spread. Por definición, los libros de órdenes siempre consisten exclusivamente de órdenes no ejecutadas: son colas de órdenes que esperan con esperanza a que el precio se mueva en su dirección. Figura 1: Libros de órdenes de muestra de INET para MSFT. ¿Entonces, cómo se ejecutan las órdenes (parcialmente)? Si una orden de límite de compra (venta, respectivamente) llega por encima del precio de venta (por debajo del precio de compra, respectivamente), entonces la orden se empareja con las órdenes en los libros opuestos hasta que se llene el volumen de las órdenes entrantes, o no sea posible realizar más emparejamientos, en cuyo caso el volumen restante de las órdenes entrantes se coloca en los libros. Por ejemplo, supongamos que en el ejemplo de la Figura 1 llegó una orden de compra de 2000 acciones con un precio límite de $24.08. Esta orden sería parcialmente completada por las dos órdenes de venta de 500 acciones a $24.069 en los libros de venta, la orden de venta de 500 acciones a $24.07 y la orden de venta de 200 acciones a $24.08, para un total de 1700 acciones ejecutadas. Las 300 acciones restantes de la orden de compra entrante se convertirían en la nueva oferta del libro de compras a $24.08. Es importante tener en cuenta que los precios de ejecución son los precios especificados en las órdenes límite que ya están en los libros, no los precios de la orden entrante que se ejecuta de inmediato. Por lo tanto, en este ejemplo, las 1700 acciones ejecutadas estarían a diferentes precios. Ten en cuenta que esto también significa que en un intercambio de órdenes límite puro como INET, las órdenes de mercado pueden ser simuladas por órdenes límite con valores de precio extremos. En intercambios como INET, cualquier orden puede ser retirada o cancelada por la parte que la colocó en cualquier momento antes de su ejecución. Cada orden límite llega de forma atómica e instantánea: existe una estricta secuencia temporal en la que llegan las órdenes, y dos órdenes nunca pueden llegar simultáneamente. Esto da lugar a la definición del último precio de la bolsa, que es simplemente el último precio al cual la bolsa ejecutó una orden. Es esta cantidad la que generalmente se entiende cuando las personas se refieren casualmente al precio (ticker) de una acción. 3.1 Definiciones Formales Ahora proporcionamos un modelo formal para el proceso de órdenes límite descrito anteriormente. En este modelo, las órdenes límite llegan en una secuencia temporal, con cada orden especificando su precio límite y una indicación de su tipo (compra o venta). Al igual que en los intercambios reales, también permitimos la cancelación de una orden pendiente (no ejecutada) en los libros en cualquier momento antes de su ejecución. Sin pérdida de generalidad, limitamos nuestra atención a un modelo en el que cada orden es por una sola acción; los volúmenes de órdenes grandes pueden representarse mediante secuencias de 1 acción. Definición 3.1. Sea Σ = σ1, ...σn una secuencia de órdenes límite, donde cada σi tiene la forma ni, ti, vi. Aquí ni es un identificador de orden, ti es el tipo de orden (compra, venta o cancelación), y vi es el valor de la orden límite. En el caso de que ti sea cancelado, ni coincide con un pedido previamente realizado y vi es ignorado. Hemos llamado deliberadamente vi en la definición anterior el valor de la orden límite en lugar del precio, ya que nuestros dos modelos diferirán en su interpretación de vi (como absoluto o relativo). En el modelo absoluto, de hecho interpretamos vi como simplemente siendo el precio de la orden límite. En el modelo relativo, si la configuración actual del libro de órdenes es (A, B) (donde A es el libro de ventas y B el libro de compras), el precio de la orden es ask(A) + vi si ti es una venta, y bid(B) + vi si ti es una compra, donde por ask(X) y bid(X) denotamos el precio de la orden en la parte superior del libro X. (Nota: vi puede ser negativo). Nuestro principal interés en este artículo son los efectos que la modificación de un pequeño número de órdenes límite puede tener en la dinámica resultante. Para simplificar, consideramos solo modificaciones en los valores de las órdenes límite, pero nuestros resultados se generalizan a cualquier modificación. Definición 3.2. Una k-modificación de Σ es una secuencia Σ tal que para exactamente k índices i1, ..., ik vij = vij, tij = tij y nij = nij. Para cada = ij , j ∈ {1, . . . , k} σ = σ . Ahora definimos las diversas cantidades cuyas propiedades de estabilidad examinamos en los modelos absolutos y relativos. Todas estas son cantidades estándar de interés común en los mercados financieros. • volumen(Σ): Número de acciones ejecutadas (negociadas) en la secuencia Σ. • promedio(Σ): Precio promedio de ejecución. • cierre(Σ): Precio de la última ejecución (de cierre). • última oferta(Σ): Oferta al final de la secuencia. • última demanda(Σ): Demanda al final de la secuencia. 4. EL TEOREMA DE LA MODIFICACIÓN 1 En esta sección presentamos nuestro resultado técnico más importante. Se muestra que en el modelo absoluto, los efectos que la modificación de un solo pedido tiene en la evolución resultante de los libros de órdenes son extremadamente limitados. Luego aplicamos este resultado para derivar resultados de estabilidad sólida para todas las cantidades mencionadas en el modelo absoluto. A lo largo de esta sección, consideramos una secuencia de orden arbitraria Σ en el modelo absoluto, y cualquier 1-modificación Σ de Σ. En cualquier punto (índice) i en las dos secuencias utilizaremos (A1, B1) para denotar los libros de venta y compra (respectivamente) en Σ, y (A2, B2) para denotar los libros de venta y compra en Σ; por conveniencia notacional omitimos explícitamente la superíndice por el índice actual i. Pronto estableceremos que en todo momento i, (A1, B1) y (A2, B2) están muy cerca. Aunque los libros de órdenes están ordenados por precio, utilizaremos (por ejemplo) A1 ∪ {a2} = A2 para indicar que A2 contiene una orden a algún precio a2 que no está presente en A1, pero que de lo contrario A1 y A2 son idénticos; por lo tanto, eliminar la orden en a2 en A2 haría que los libros fueran iguales. De manera similar, B1 ∪ {b2} = B2 ∪ {b1} significa que B1 contiene un pedido al precio b1 que no está presente en B2, B2 contiene un pedido al precio b2 que no está presente en B1, y que de lo contrario B1 y B2 son idénticos. Usando esta notación, definimos ahora un conjunto de estados estables del sistema, donde cada estado está compuesto por los libros de órdenes de las secuencias original y modificada. Pronto demostraremos que si cambiamos solo el valor de una orden (precio), permanecemos en este conjunto para cualquier secuencia de órdenes límite. Definición 4.1. Sea ab el conjunto de todos los estados (A1, B1) y (A2, B2) tales que A1 = A2 y B1 = B2. Sea ¯ab el conjunto de estados tal que A1 ∪ {a2} = A2 ∪ {a1}, donde a1 = a2, y B1 = B2. Sea a¯b el conjunto de estados tal que B1∪{b2} = B2∪{b1}, donde b1 = b2, y A1 = A2. Sea ¯a¯b el conjunto de estados en los que A1 = A2∪{a1} y B1 = B2∪{b1}, o en los que A2 = A1 ∪ {a2} y B2 = B1 ∪ {b2}. Finalmente definimos S = ab ∪ ¯ab ∪ ¯ba ∪ ¯a¯b como el conjunto de estados estables. Teorema 4.1. (Teorema de Modificación 1) Considere cualquier secuencia de órdenes Σ y cualquier 1-modificación Σ de Σ. Entonces, los libros de órdenes (A1, B1) y (A2, B2) determinados por Σ y Σ se encuentran en el conjunto S de estados estables en todo momento. Figura 2: Diagrama que representa el conjunto S de estados estables y las posibles transiciones de movimientos en él después del cambio. La idea de la prueba de este teorema está contenida en la Figura 2, que muestra un diagrama de transición de estados etiquetado por las categorías de estados estables. Este diagrama describe todas las transiciones que pueden tener lugar después de la llegada del pedido en el que Σ y Σ difieren. Lo siguiente establece que inmediatamente después de la llegada de este orden diferente, el estado yace en S. Lema 4.2. Si en algún momento los libros actuales (A1, B1) y (A2, B2) están en el conjunto ab (y por lo tanto son idénticos), entonces modificar el precio del próximo pedido mantiene el estado en S. Demostración. Supongamos que la orden de llegada es una orden de venta y la cambiamos de a1 a a2; asumamos sin pérdida de generalidad que a1 > a2. Si ninguno de los pedidos se ejecuta de inmediato, entonces pasamos al estado ¯ab; si ambos se ejecutan, entonces permanecemos en el estado ab; y si solo se ejecuta a2, entonces pasamos al estado ¯a¯b. El análisis de una orden de compra que llega es similar. Tras la llegada de su único pedido diferente, Σ y Σ son idénticos. Ahora presentamos una secuencia de lemas que muestran 123 Ejecutado con dos órdenes No ejecutado en ambas Órdenes de compra que llegan Orden de compra que llega Orden de compra que llega Orden de compra que llega Orden de venta que llega ¯ab ab ¯a¯b Ejecutado solo con a1 (no a1 y a2) Ejecutado con a1 y a2 Figura 3: El diagrama de estado al comenzar en el estado ¯ab. Este diagrama proporciona la intuición del Lema 4.3 de que después de seguir la diferencia inicial cubierta por el Lema 4.2, el estado permanece en S para siempre en la secuencia restante (idéntica). Primero demostramos que desde el estado ¯ab permanecemos en S independientemente del próximo pedido. La intuición de este lema se demuestra en la Figura 3. Lema 4.3. Si el estado actual está en el conjunto ¯ab, entonces para cualquier orden el estado permanecerá en S. Demostración. Primero proporcionamos el análisis para el caso de una orden de venta que llega. Ten en cuenta que en ¯ab los libros comprados son idénticos (B1 = B2). Por lo tanto, la orden de venta que llega se ejecuta con la misma orden de compra en ambos libros de compra, o no se ejecuta en ninguno de los libros de compra. Para el primer caso, los libros de compra permanecen idénticos (la oferta se ejecuta en ambos) y los libros de venta permanecen sin cambios. Para el segundo caso, los libros comprados permanecen sin cambios e idénticos, y los libros vendidos tienen la nueva orden de venta agregada a ambos (y por lo tanto siguen diferenciándose por una orden). A continuación, proporcionamos un análisis del caso más sutil en el que el artículo que llega es una orden de compra. Para este caso necesitamos tener en cuenta varios escenarios diferentes. La primera es cuando la parte superior de ambos vende libros (el precio de venta) es idéntica. Entonces, independientemente de si la nueva orden de compra se ejecuta o no, el estado permanece en ¯ab (el análisis es similar al de una orden de venta que llega). Nos queda tratar el caso en el que ask(A1) y ask(A2) son diferentes. Aquí discutimos dos subcasos: (a) ask(A1) = a1 y ask(A2) = a2, y (b) ask(A1) = a1 y ask(A2) = a. Aquí a1 y a2 son como en la definición de ¯ab en la Definición 4.1, y a es algún otro precio. Para el subcaso (a), según nuestra suposición a1 < a2, entonces o bien (1) ambas órdenes se ejecutan, los libros de venta se vuelven idénticos y pasamos al estado ab; (2) ninguna orden se ejecuta y permanecemos en el estado ¯ab; o (3) solo se ejecuta la orden a1, en cuyo caso pasamos al estado ¯a¯b con A2 = A1 ∪ {a2} y B2 = B1 ∪ {b2}, donde b2 es el precio de la orden de compra que llega. Para el subcaso (b), o bien (1) la orden de compra no se ejecuta en ninguno de los libros de venta y permanecemos en el estado ¯ab; o (2) la orden de compra se ejecuta en ambos libros de venta y permanecemos en el estado ¯ab con A1 ∪ {a} = A2 ∪ {a2}; o (3) solo se ejecuta ask(A1) = a1 y nos movemos al estado ¯a¯b. Lema 4.4. Si el estado actual está en el conjunto a¯b, entonces para cualquier orden el estado permanecerá en S. Lema 4.5. Si la configuración actual está en el conjunto ¯a¯b, entonces para cualquier orden el estado permanecerá en S. Las pruebas de estos dos lemas se omiten, pero son similares en espíritu a la del Lema 4.3. El siguiente y último lema trata sobre cancelaciones. Lema 4.6. Si el estado actual del libro de órdenes se encuentra en S, entonces después de la llegada de una cancelación permanece en S. Prueba. Cuando llega una orden de cancelación, una de las siguientes posibilidades se cumple: (1) la orden todavía está en ambos conjuntos de libros, (2) no está en ninguno de ellos y (3) está solo en uno de ellos. Para los dos primeros casos es fácil ver que el efecto de cancelación es idéntico en ambos conjuntos de libros, por lo que el estado permanece inalterado. Para el caso en que la orden aparezca solo en un conjunto de libros, sin pérdida de generalidad asumimos que la cancelación cancela una orden de compra en b1. En lugar de eliminar b1 del libro, podemos cambiarlo para que tenga un precio de 0, lo que significa que esta orden de compra nunca se ejecutará y se cancelará efectivamente. Ahora, independientemente del estado en el que nos encontrábamos, b1 sigue estando solo en un libro de compras (pero con un precio diferente), por lo que permanecemos en el mismo estado en S. La prueba del Teorema 4.1 se sigue de los lemas anteriores. 5. ESTABILIDAD ABSOLUTA DEL MODELO En esta sección aplicamos el Teorema de la 1-Modificación para mostrar propiedades de estabilidad sólidas para el modelo absoluto. Comenzamos con un examen del volumen ejecutado. Lema 5.1. Sea Σ cualquier secuencia y Σ cualquier modificación de Σ. Entonces, el conjunto de órdenes ejecutadas (números de identificación) generadas por las dos secuencias difiere en un máximo de 2. Prueba. Por el Teorema 4.1 sabemos que en cada etapa los libros difieren en un máximo de dos órdenes. Ahora, dado que la unión de los IDs de las órdenes ejecutadas y los libros de órdenes siempre es idéntica para ambas secuencias, esto implica que las órdenes ejecutadas pueden diferir en un máximo de dos. Corolario 5.2. Sea Σ cualquier secuencia y Σ cualquier k-modificación de Σ. Entonces, el conjunto de órdenes ejecutadas (números de identificación) generadas por las dos secuencias difiere en un máximo de 2k. Una secuencia de órdenes Σ es una k-extensión de Σ si Σ se puede obtener al eliminar cualquier k órdenes en Σ. Lema 5.3. Sea Σ cualquier secuencia y sea Σ cualquier k-extensión de Σ. Entonces, el conjunto de órdenes ejecutadas generadas por Σ y Σ difieren en un máximo de 2k. Este lema es la clave para obtener nuestro principal resultado de volumen absoluto del modelo que se muestra a continuación. Usamos edit(Σ, Σ) para denotar la distancia de edición estándar entre las secuencias Σ y Σ, el número mínimo de sustituciones, inserciones y eliminaciones u órdenes necesarios para cambiar Σ a Σ. Teorema 5.4. Dejen Σ y Σ ser secuencias de orden de modelo absoluto. Entonces, si edit(Σ, Σ) ≤ k, el conjunto de órdenes ejecutadas generadas por Σ y Σ difieren en un máximo de 4k. En particular, |volumen(Σ) − volumen(Σ )| ≤ 4k. Prueba. Primero definimos la secuencia ˜Σ que es la intersección de Σ y Σ . Dado que Σ y Σ están separados por lo sumo k, tenemos que con k inserciones cambiamos ˜Σ a cualquiera de Σ o Σ, y por el Lema 5.3 su conjunto de órdenes ejecutadas está separado por lo sumo 2k de cada uno. Por lo tanto, el conjunto de órdenes ejecutadas en Σ y Σ está separado como máximo por 4k. El Teorema 5.4 de los Límites de Spread establece una fuerte estabilidad para el volumen ejecutado en el modelo absoluto. Ahora nos enfocamos en las cantidades que involucran precios de ejecución en lugar de solo volumen, a saber, promedio(Σ), cierre(Σ), última oferta(Σ) y última demanda(Σ). Para estos resultados, a diferencia del volumen ejecutado, una condición debe cumplirse en Σ para que ocurra la estabilidad. Esta condición se expresa en términos de una medida natural de la dispersión del mercado, o la brecha entre los compradores y vendedores. Motivamos esta condición mostrando primero que sin ella, al cambiar un orden, podemos cambiar el promedio(Σ) por cualquier valor positivo x. Lema 5.5. Existe un conjunto Σ tal que para cualquier x ≥ 0, existe una 1-modificación Σ de Σ tal que el promedio de Σ es igual al promedio de Σ más x. Prueba. Sea Σ una secuencia de órdenes alternadas de venta y compra en la que cada vendedor ofrece p y cada comprador p + x, y la primera orden es una venta. Entonces todas las ejecuciones tienen lugar en el precio de la oferta, que siempre es p, y por lo tanto el promedio(Σ) = p. Ahora supongamos que modificamos solo la primera orden de venta para que sea a un precio p+1+x. Esta orden de venta inicial nunca se ejecutará, y ahora todas las ejecuciones se realizan al precio de la oferta, que siempre es p + x. Resultados similares de inestabilidad pueden demostrarse que se aplican a las otras cantidades basadas en precios. Esto motiva la introducción de una cantidad que llamamos la segunda dispersión de los libros de órdenes, la cual se define como la diferencia entre los precios de la segunda orden en el libro de ventas y la segunda orden en el libro de compras (a diferencia de la diferencia entre la oferta y la demanda, comúnmente llamada el spread). Observamos que en una acción líquida, como las que examinamos experimentalmente en la Sección 7, la segunda dispersión suele ser bastante pequeña y de hecho casi siempre es igual a la dispersión. En esta subsección consideramos cambios en la secuencia solo después de un período de inicialización, y secuencias tales que la segunda propagación siempre está definida después del momento en que realizamos un cambio. Definimos s2(Σ) como la máxima segunda dispersión en la secuencia Σ después del cambio. Teorema 5.6. Sea Σ una secuencia y sea Σ cualquier 1modificación de Σ. Entonces 1. |últimapuja(Σ) − últimapuja(Σ )| ≤ s2(Σ) 2. |últimapregunta(Σ) − últimapregunta(Σ )| ≤ s2(Σ) donde s2(Σ) es el máximo sobre el segundo spread en Σ siguiendo la 1-modificación. Prueba. Proporcionamos la prueba para la última oferta; la prueba para la última demanda es similar. La prueba se basa en el Teorema 4.1 y considera estados en el conjunto estable S. Para los estados ab y ¯ab, tenemos que la oferta es idéntica. Sea bid(X), sb(X), ask(X), la oferta, la segunda orden de compra más alta, y la pregunta de una secuencia X. Ahora recuerda que en el estado a¯b tenemos que los libros en venta son idénticos, y que los dos libros comprados son idénticos excepto por un orden diferente. Por lo tanto, bid(Σ)+s2(Σ) ≥ sb(Σ)+s2(Σ) ≥ ask(Σ) = ask(Σ) ≥ bid(Σ). Ahora queda por acotar la oferta de Σ. Aquí utilizamos el hecho de que la oferta de la secuencia modificada es al menos la segunda orden de compra más alta en la secuencia original, debido a que los libros difieren solo en una orden. Dado que bid(Σ) ≥ sb(Σ) ≥ ask(Σ) − s2(Σ) ≥ bid(Σ) − s2(Σ), tenemos que |bid(Σ) − bid(Σ)| ≤ s2(Σ) como se deseaba. En el estado ¯a¯b tenemos que para una secuencia los libros contienen una orden de compra adicional y una orden de venta adicional. Primero supongamos que los libros que contienen los pedidos adicionales son la secuencia original Σ. Ahora, si la oferta no es la orden adicional, hemos terminado; de lo contrario, tenemos lo siguiente: oferta(Σ) ≤ demanda(Σ) ≤ sb(Σ) + s2(Σ) = oferta(Σ) + s2(Σ), donde sb(Σ) ≤ oferta(Σ) ya que el libro de compra original tiene solo una orden adicional. Ahora suponga que los libros con los pedidos adicionales son para la secuencia modificada Σ. Tenemos oferta(Σ) + s2(Σ) ≥ demanda(Σ) ≥ demanda(Σ) ≥ oferta(Σ), donde utilizamos el hecho de que demanda(Σ) ≥ demanda(Σ) ya que la secuencia modificada tiene un pedido adicional. De manera similar, tenemos que bid(Σ) ≤ bid(Σ) ya que el libro de compra modificado contiene una orden adicional. Observamos que la demostración del Teorema 5.6 realmente establece que la oferta y la demanda de las secuencias originales y modificadas están dentro de s2(Σ) en todo momento. A continuación proporcionamos un lema técnico que relaciona la propagación (primera) de la secuencia modificada con la propagación segunda de la secuencia original. Lema 5.7. Sea Σ una secuencia y sea Σ cualquier 1modificación de Σ. Entonces la dispersión de Σ está acotada por s2(Σ). Prueba. Por el Teorema de la 1-Modificación, sabemos que los libros de la secuencia modificada y la secuencia original pueden diferir en un máximo de un orden en cada libro (compra y venta). Por lo tanto, la segunda orden de compra más alta en la secuencia original siempre es a lo sumo la oferta en la secuencia modificada, y la segunda orden de venta más baja en la secuencia original siempre es al menos el precio de venta en la secuencia modificada. Estamos listos para presentar un resultado de estabilidad para el precio promedio de ejecución en el modelo absoluto. Se establece que en mercados altamente líquidos, donde el volumen ejecutado es grande y el spread es pequeño, el precio promedio es altamente estable. Teorema 5.8. Sea Σ una secuencia y sea Σ cualquier 1modificación de Σ. Entonces |promedio(Σ) − promedio(Σ )| ≤ 2(pmax + s2(Σ)) volumen(Σ) + s2(Σ) donde pmax es el precio de ejecución más alto en Σ. Prueba. La prueba demostrará que cada ejecución en Σ, aparte de la ejecución de la orden modificada y la última ejecución, tiene una ejecución correspondiente en Σ con un precio diferente en un máximo de s2(Σ), y utilizará el hecho de que pmax + s2(Σ) es un límite en el precio en Σ. Refiriéndonos a la prueba del Teorema de la Modificación 1, supongamos que estamos en el estado ¯a¯b, donde tenemos en una secuencia (que puede ser tanto Σ como Σ) una orden de compra adicional b y una orden de venta adicional a. Sin pérdida de generalidad, asumimos que la secuencia con las órdenes adicionales es Σ. Si la próxima ejecución no implica a o b, entonces claramente tenemos la misma ejecución en ambos Σ y Σ. Supongamos que implica un; hay dos posibilidades. O bien a es el orden modificado, en cuyo caso cambiamos la diferencia de precio promedio 125 por (pmax + s2(Σ))/volumen(Σ), y esto solo puede ocurrir una vez; o a fue ejecutado anteriormente en Σ y las ejecuciones involucran a un orden cuyo precio límite es a. Según el Lema 5.7, la dispersión de ambas secuencias está limitada por s2(Σ), lo que implica que el precio de la ejecución en Σ fue como máximo a + s2(Σ), mientras que la ejecución en Σ tiene un precio de a, por lo que los precios difieren en un máximo de s2(Σ). En los estados ¯ab, a¯b siempre y cuando tengamos ejecuciones concurrentes en las dos secuencias, sabemos que los precios pueden diferir en un máximo de s2(Σ). Si tenemos una ejecución solo en una secuencia, o bien la emparejamos en el estado ¯a¯b, o la cargamos con (pmax + s2(Σ))/volumen(Σ) si terminamos en el estado ¯a¯b. Si terminamos en el estado ab, ¯ab o a¯b, entonces cada ejecución en los estados ¯ab o a¯b se emparejó con una ejecución en el estado ¯a¯b. Si terminamos en el estado ¯a¯b, tenemos una ejecución que no coincide y, por lo tanto, la cobramos (pmax + s2(Σ))/volumen(Σ). A continuación, presentamos un resultado de estabilidad para el precio de cierre. Primero proporcionamos un lema técnico sobre los precios de las ejecuciones consecutivas. Lema 5.9. Sea Σ cualquier secuencia. Entonces, los precios de dos ejecuciones consecutivas en Σ difieren en un máximo de s2(Σ). Prueba. Supongamos que la primera ejecución se realiza en el tiempo t; su precio está limitado por debajo por la oferta actual y por encima por la demanda actual. Ahora, después de esta ejecución, la oferta es al menos la segunda orden de compra más alta en el momento t, si la oferta anterior fue ejecutada y no llegaron órdenes de compra más altas, y más alta en caso contrario. De manera similar, la oferta es como máximo la segunda orden de venta más baja en el tiempo t. Por lo tanto, el precio de ejecución siguiente es al menos la segunda oferta en el tiempo t y como máximo la segunda oferta en el tiempo t, que está como máximo a s2(Σ) de la oferta/demanda en el tiempo t. Lema 5.10. Sea Σ cualquier secuencia y sea Σ una modificación de Σ. Si el volumen (Σ) ≥ 2, entonces |close(Σ) − close(Σ)| ≤ s2(Σ) Prueba. Primero abordamos el caso en el que la última ejecución ocurre simultáneamente en ambas secuencias. Según el Teorema 5.6, tanto la oferta como la demanda de Σ y Σ están separadas por un máximo de s2(Σ) en todo momento t. Dado que el precio de la última ejecución es su oferta (demanda) en el momento t, hemos terminado. A continuación, nos ocupamos del caso en el que la última ejecución entre las dos secuencias ocurre solo en Σ. En este caso sabemos que o bien la ejecución anterior ocurrió simultáneamente en ambas secuencias en el tiempo t, y por lo tanto las tres ejecuciones están dentro de la segunda propagación de Σ en el tiempo t (la primera ejecución en Σ por definición, la ejecución en Σ con argumentos idénticos al caso anterior, y la tercera según el Lema 5.9). De lo contrario, la ejecución anterior ocurrió solo en Σ en el tiempo t, en cuyo caso las dos ejecuciones están dentro de la dispersión de Σ en el tiempo t (la ejecución de Σ a partir de los mismos argumentos que antes, y la ejecución en Σ debe estar dentro de su dispersión en el tiempo t). Si la última ejecución ocurre solo en Σ, sabemos que la próxima ejecución de Σ estará a lo sumo a s2(Σ) de distancia de su ejecución anterior según el Lema 5.9. Junto con el hecho de que si una ejecución ocurre solo en una secuencia implica que el orden está en la propagación de la segunda secuencia siempre y cuando las secuencias sean de 1-modificación, la prueba se completa. 5.2 Límites de propagación para k-Modificaciones Al igual que en el caso del volumen ejecutado, nos gustaría extender los resultados de estabilidad del modelo absoluto para cantidades basadas en precios al caso en el que se modifican múltiples órdenes. Aquí nuestros resultados son más débiles y dependen del k-spread, la distancia entre la k-ésima orden de compra más alta y la k-ésima orden de venta más baja, en lugar del segundo spread. (Mirando hacia la Sección 7, observamos que en datos de mercado reales para acciones líquidas, esta cantidad suele ser muy pequeña también). Usamos sk(Σ) para denotar la k-extensión. Como antes, asumimos que el k-spread siempre está definido después de un período de inicialización. Primero establecemos la siguiente generalización del Lema 5.7. Lema 5.11. Sea Σ una secuencia y sea Σ cualquier 1modificación de Σ. Para ≥ 1, si s +1(Σ) siempre está definido después del cambio, entonces s (Σ) ≤ s +1(Σ). La prueba es similar a la prueba del Lema 5.7 y se omite. Una aplicación simple de este lema es la siguiente: Sea Σ cualquier secuencia que sea una -modificación de Σ. Entonces tenemos s2(Σ) ≤ s + 2(Σ). Ahora, utilizando el lema anterior y mediante una simple inducción, podemos obtener el siguiente teorema. Teorema 5.12. Sea Σ una secuencia y sea Σ cualquier k-modificación de Σ. Entonces 1. |últimapuja(Σ) − últimapuja(Σ )| ≤ Pk =1 s +1(Σ) ≤ ksk+1(Σ) 2. |últimapregunta(Σ)−últimapregunta(Σ )| ≤ Pk =1 s +1(Σ) ≤ ksk+1(Σ) 3. |cierre(Σ) − cierre(Σ )| ≤ Pk =1 s +1(Σ) ≤ ksk+1(Σ) 4. |promedio(Σ) − promedio(Σ )| ≤ Pk =1 2(pmax +s +1(Σ)) volumen(Σ) + s +1(Σ) donde s (Σ) es el máximo sobre el -spread en Σ siguiendo la primera modificación. Observamos que si bien estos límites dependen de medidas más profundas de dispersión para modificaciones adicionales, estamos trabajando en un modelo de orden de 1 acción. Por lo tanto, en un mercado real, donde las órdenes individuales contienen cientos o miles de acciones, el k-spread incluso para k grande podría ser bastante pequeño y cercano al spread estándar de 1 en acciones líquidas. 6. INESTABILIDAD DEL MODELO RELATIVO En el modelo relativo, la suposición subyacente es que los operadores intentan aprovechar su conocimiento de los libros para colocar estratégicamente sus órdenes. Por lo tanto, si un trader desea que su orden de compra se ejecute rápidamente, puede posicionarla por encima de la oferta actual y ser la primera en la cola; si el trader es paciente y cree que la tendencia del precio va a ser a la baja, colocará órdenes más profundas en el libro de compras, y así sucesivamente. Mientras que en las secciones anteriores mostramos resultados de estabilidad para el modelo absoluto, aquí proporcionamos ejemplos simples que muestran inestabilidad en el modelo relativo para el volumen ejecutado, la última oferta, la última demanda, el precio promedio de ejecución y el último precio de ejecución. En la Sección 7 proporcionamos muchas simulaciones con datos de mercado reales que demuestran que esta inestabilidad es inherente al modelo relativo, y no se debe a construcciones artificiales. En el modelo relativo asumimos que para cada secuencia la oferta y la demanda siempre están definidas, por lo que los libros tienen una configuración inicial no vacía. Comenzamos mostrando que en el modelo relativo, incluso una sola modificación puede duplicar el número de acciones ejecutadas. Teorema 6.1. Existe una secuencia Σ y una 1-modificación Σ de Σ tal que el volumen(Σ) ≥ 2volumen(Σ). Prueba. Para concretar, asumimos que al principio la oferta es de 10 y la demanda es de 8. La secuencia Σ está compuesta por n órdenes de compra con ∆ = 0, seguidas por n órdenes de venta con ∆ = 0, y finalmente una secuencia alternante de órdenes de compra con ∆ = +1 y órdenes de venta con ∆ = −1 de longitud 2n. Dado que los libros antes de la secuencia alternante contienen n + 1 órdenes de venta a 10 y n + 1 órdenes de compra a 8, tenemos que cada par de órdenes de compra y venta en la parte alternante se empareja y se ejecuta, pero ninguna de las órdenes iniciales 2n se ejecuta, y por lo tanto el volumen(Σ) = n. Ahora cambiamos la primera orden de compra para tener ∆ = +1. Después de las primeras 2n órdenes todavía no hay ejecuciones; sin embargo, los libros son diferentes. Ahora hay n + 1 órdenes de venta a 10, n órdenes de compra a 9 y una orden de compra a 8. Ahora cada orden en la secuencia alternante se ejecuta con una de las órdenes anteriores y tenemos un volumen (Σ) = 2n. El siguiente teorema muestra que los resultados de estabilidad basados en el spread de la Sección 5.1 no se cumplen en el modelo relativo. Antes de proporcionar la prueba, damos su intuición. Al principio, el libro de ventas contiene solo dos precios que están muy separados y ambos contienen solo dos órdenes, ahora llegan varias órdenes de compra, en la secuencia original no se están ejecutando, mientras que en la secuencia modificada se ejecutarán y dejarán el libro de ventas solo con las órdenes al precio alto. Ahora llegarán muchas órdenes de venta seguidas de muchas órdenes de compra, de tal manera que en la secuencia original solo se ejecutarán a un precio bajo y en la secuencia modificada se ejecutarán a un precio alto. Teorema 6.2. Para cualquier número positivo s y x, existe una secuencia Σ tal que s2(Σ) = s y una Σ de modificación 1 de Σ tal que • |close(Σ) − close(Σ )| ≥ x • |average(Σ) − average(Σ )| ≥ x • |lastbid(Σ) − lastbid(Σ )| ≥ x • |lastask(Σ) − lastask(Σ )| ≥ x Prueba. Sin pérdida de generalidad, consideremos secuencias en las que todos los precios son valores enteros, en cuyo caso el valor más pequeño posible para la segunda diferencia es 1; proporcionamos la prueba para el caso s2(Σ) = 2, pero el caso s2(Σ) = 1 es similar. Consideramos una secuencia Σ tal que después de un período de inicialización no ha habido ejecuciones, el libro de compra tiene 2 órdenes a un precio de 10, y el libro de venta tiene dos órdenes a un precio de 12 y 2 órdenes con valor 12+y, donde y es un entero positivo que será determinado por el análisis. La secuencia original Σ es una orden de compra con ∆ = 0, seguida de dos órdenes de compra con ∆ = +1, luego 2y órdenes de venta con ∆ = 0, y luego 2y órdenes de compra con ∆ = +1. Primero notamos que s2(Σ) = 2, hay 2 ejecuciones, todas a un precio de 12, la última oferta es 11 y la última demanda es 12. A continuación analizamos una secuencia modificada. Cambiamos la primera orden de compra de ∆ = 0 a ∆ = +1. Por lo tanto, se ejecutan las próximas dos órdenes de compra con ∆ = +1, y después tenemos que la oferta es 11 y la demanda es 12 + y. Ahora las órdenes de venta de 2y se acumulan en 12+y, y después de las próximas y órdenes de compra, la oferta está en 12+y−1. Por lo tanto, al final tenemos que lastbid(Σ ) = 12 + y − 1, lastask(Σ ) = 12 + y, close(Σ ) = 12 + y, y average(Σ ) = y y+2 (12 + y) + 2 y+2 (12). Al establecer y = x + 2, obtenemos el lema para cada propiedad. Observamos que si bien esta prueba se basaba en el hecho de que hay dos órdenes consecutivas en los libros que están muy separadas, podemos proporcionar un ejemplo ligeramente más complicado en el que todas las órdenes están cerca (a lo sumo 2 de diferencia), sin embargo, un cambio resulta en diferencias significativas. 7. Estudios de simulación. Hasta ahora, los resultados presentados muestran un contraste llamativo entre los modelos de precio absoluto y relativo: mientras que el modelo absoluto goza de una estabilidad sólida demostrable sobre cualquier secuencia de eventos fija, existen al menos secuencias específicas que demuestran una gran inestabilidad en el modelo relativo. La naturaleza de peor caso de estos resultados plantea la pregunta de hasta qué punto tales diferencias podrían ocurrir realmente en los mercados reales. En esta sección proporcionamos evidencia indirecta sobre esta pregunta al presentar resultados de simulación que explotan una rica fuente de datos históricos de secuencias de órdenes límite del mercado real. Al interpretar los precios de las órdenes límite que llegan como valores absolutos, o transformándolos en diferencias con la oferta y la demanda actuales (modelo relativo), podemos realizar pequeñas modificaciones en las secuencias y examinar cómo serían diferentes varios resultados (volumen negociado, precio promedio, etc.) de lo que realmente ocurrió en el mercado. Estas simulaciones proporcionan un contraparte empírica a la teoría que hemos desarrollado. Enfatizamos que todas esas simulaciones interpretan los datos históricos reales como encajando en el modelo absoluto o relativo, y solo tienen sentido dentro de los límites de dicha interpretación. Sin embargo, consideramos que ofrecen una valiosa visión empírica sobre las propiedades de estabilidad (in) de los modernos mercados de órdenes límite de acciones, y demuestran que la creencia o esperanza en la estabilidad depende en gran medida de una interpretación de modelo absoluto. También investigamos el comportamiento empírico de mezclas de precios absolutos y relativos. 7.1 Datos Los datos históricos utilizados en nuestras simulaciones son datos de órdenes límite disponibles comercialmente de INET, la bolsa electrónica mencionada anteriormente para acciones de NASDAQ. En términos generales, estos datos consisten prácticamente en cada evento en INET relacionado con la negociación de una acción individual: cada orden límite entrante (precio, volumen y número de identificación de secuencia), cada ejecución y cada cancelación de una orden pendiente, todo con marca de tiempo en milisegundos. Es suficiente con los datos para recrear el libro de órdenes INET preciso en una acción específica en un día y hora determinados. Informaremos sobre las propiedades de estabilidad de tres acciones: Amazon, Nvidia y Qualcomm (identificadas en lo sucesivo por sus símbolos bursátiles, AMZN, NVDA y QCOM). Estos tres proporcionan cierto rango de liquidez (siendo QCOM el que tiene la mayor liquidez y NVDA la menor en INET) y otras propiedades de negociación. Observamos que los resultados cualitativos de nuestras simulaciones fueron similares para varias otras acciones que examinamos. 127 7.2 Metodología Para nuestras simulaciones utilizamos un código de reconstrucción del libro de órdenes que opera sobre los datos brutos subyacentes. El formato básico de cada experimento era el siguiente: 1. Ejecuta el código de reconstrucción del libro de órdenes en los datos originales de INET y calcula la cantidad de interés (volumen negociado, precio promedio, etc.) 2. Realiza una pequeña modificación a un solo pedido y vuelve a calcular el valor resultante de la cantidad de interés. En el caso del modelo absoluto, el Paso 2 es tan simple como modificar el orden en los datos originales y volver a ejecutar la reconstrucción del libro de órdenes. Para el modelo relativo, primero debemos preprocesar los datos en bruto y convertir sus precios a valores relativos, luego hacer la modificación y volver a ejecutar la reconstrucción del libro de órdenes en los valores relativos. El tipo de modificación que examinamos fue extremadamente pequeño en comparación con el volumen de órdenes realizadas en estas acciones: específicamente, la eliminación de una sola orden elegida al azar de la secuencia. Aunque una eliminación no es una modificación de grado 1, su distancia de edición es 1 y podemos aplicar el Teorema 5.4. Para cada día de negociación examinado, se seleccionó esta única orden eliminada entre aquellas que llegaron entre las 10 AM y las 3 PM, y las cantidades de interés fueron medidas y comparadas a las 3 PM. Estos horarios fueron elegidos para incluir la parte más activa del día de negociación, pero evitar la media hora alrededor de la apertura y cierre del mercado oficial de NASDAQ (9:30 AM y 3:30 PM respectivamente), que se sabe que tienen dinámicas diferentes a la parte central del día. Realizamos simulaciones del modelo absoluto y relativo tanto en los datos INET originales como en una versión depurada de estos datos. En el proceso de limpieza eliminamos todas las órdenes límite que fueron canceladas en el mercado real antes de su ejecución (junto con las cancelaciones mismas). La razón es que dichas cancelaciones a menudo pueden ser el primer paso en la reposición de pedidos, es decir, cancelaciones del pedido que son seguidas por la presentación de un pedido de reemplazo a un precio diferente. No eliminar pedidos cancelados permite la posibilidad de simulaciones modificadas en las que el mismo pedido 1 se ejecuta dos veces, lo que puede magnificar los efectos de inestabilidad. Una vez más, está claro que ni los datos sin procesar ni los datos limpios pueden reflejar perfectamente lo que habría sucedido bajo las órdenes eliminadas en el mercado real. Sin embargo, los resultados tanto de los datos sin procesar como de los datos limpios son cualitativamente similares. Los resultados difieren principalmente, como era de esperar, en el volumen ejecutado, donde los resultados de inestabilidad para el modelo relativo son mucho más dramáticos en los datos sin procesar. 7.3 Resultados Comenzamos con estadísticas resumidas que capturan nuestros hallazgos generales de estabilidad. Cada fila de las tablas a continuación contiene un ticker (por ejemplo, AMZN) seguido de -R (para los datos sin limpiar o crudos) o -C (para los datos con pedidos cancelados eliminados). Para cada uno de los aproximadamente 250 días de negociación en 2003, se realizaron 1000 pruebas en las que se eliminaba un pedido seleccionado al azar de la secuencia de eventos de INET. Para cada cantidad de interés (volumen ejecutado, precio promedio, precio de cierre y última oferta), mostramos tanto el valor absoluto como el modelo relativo del cambio porcentual promedio en la cantidad inducido por la eliminación. Aquí "mismo" está entre comillas ya que las dos órdenes tendrán números de identificación de secuencia diferentes, lo que hace que sea imposible detectar de manera confiable dicha actividad de reposicionamiento en los datos. Los resultados confirman de manera bastante sorprendente las conclusiones cualitativas de la teoría que hemos desarrollado. En prácticamente todos los casos (datos de acciones, datos sin procesar o limpios, y cantidad), el cambio porcentual inducido por una sola eliminación en el modelo relativo es muchas órdenes de magnitud mayor que en el modelo absoluto, lo que demuestra que de hecho pueden ocurrir efectos mariposa en un mercado de modelo relativo. Como solo un ejemplo representativo específico, observe que para QCOM en los datos limpios, el efecto relativo del modelo de solo una eliminación en el precio de cierre es superior a un punto porcentual completo. Esta es una variedad de impacto en el mercado completamente separada del tipo más tradicional y esperado generado por la negociación de un gran volumen de acciones. En la Figura 4 examinamos cómo cambia una de las cantidades, el precio de ejecución promedio, con la introducción de mayores perturbaciones en la secuencia de eventos en los dos modelos. En lugar de eliminar solo un pedido entre las 10 AM y las 3 PM, en estos experimentos se realizó un número creciente de eliminaciones elegidas al azar, y se midió el cambio porcentual en el precio promedio. Como sugiere la teoría que hemos desarrollado, para el modelo absoluto el cambio en el precio promedio crece de forma lineal con el número de eliminaciones y permanece muy pequeño (observe las escalas muy diferentes del eje y en los paneles para los modelos absoluto y relativo en la figura). Para el modelo relativo, es interesante notar que mientras que pequeños números de cambios tienen efectos grandes (a menudo causando cambios en el precio de ejecución promedio muy superiores al 0.1 por ciento), los efectos de grandes números de cambios se estabilizan bastante rápidamente y de manera consistente. Concluimos con un examen de experimentos con un modelo de mezcla. Aunque se acepte un mundo en el que los comerciantes se comporten de manera absoluta o relativa, es probable que se afirme que el mercado contiene una mezcla de ambos. Así que realizamos simulaciones en las que cada orden que llegaba en los flujos de eventos de INET se trataba como un precio absoluto con probabilidad α, y como un precio relativo con probabilidad 1-α. Los resultados representativos para el precio de ejecución promedio en este modelo de mezcla se muestran en la Figura 5 para AMZN y NVDA. Quizás como era de esperar, observamos una disminución monótona en el cambio porcentual (inestabilidad) a medida que aumenta la fracción de traders absolutos, con la mayor parte de la reducción ya realizada con la introducción de solo una pequeña población de traders absolutos. Así, incluso en un mundo de precios mayormente relativos, un 128 0 10 20 30 40 50 60 70 80 90 100 0 0.5 1 1.5 2 2.5 x 10 −3 QCOM−R junio de 2004: Número absoluto de cambios Precio promedio 0 10 20 30 40 50 60 70 80 90 100 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 QCOM−R junio de 2004: Número relativo de cambios Precio promedio Figura 4: Cambio porcentual al precio de ejecución promedio (eje y) en función del número de eliminaciones en la secuencia (eje x). El panel izquierdo es para el modelo absoluto, el panel derecho para el modelo relativo, y cada curva corresponde a un solo día de negociación de QCOM en junio de 2004. Las curvas representan promedios de 1000 pruebas. Una pequeña minoría de traders absolutos puede tener un efecto estabilizador muy grande. Se encuentra un comportamiento similar para el precio de cierre y la última oferta. 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 AMZN−R Febrero de 2004 α Precio promedio 0 0.2 0.4 0.6 0.8 1 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 NVDA−R Junio de 2004 α Precio promedio Figura 5: Cambio porcentual al precio promedio de ejecución (eje y) vs. probabilidad de tratar las órdenes INET entrantes como precios absolutos (eje x). Cada curva corresponde a un solo día de operaciones durante un mes de 2004. Las curvas representan promedios de 1000 pruebas. Para el volumen ejecutado en el modelo de mezcla, sin embargo, los hallazgos son más curiosos. En la Figura 6, mostramos cómo varía el cambio porcentual en el volumen ejecutado con la fracción absoluta de traders α, para los datos de NVDA tanto en crudo como limpios de cancelaciones. Primero observamos que para esta cantidad, a diferencia de las demás, la diferencia inducida por los datos limpios y no limpios es realmente dramática, como ya sugerido por la tabla de estadísticas resumen anterior. Pero lo más intrigante es el hecho de que la estabilidad no aumenta de forma monótona con α ni para los datos limpios ni para los no limpios. El mercado con máxima inestabilidad no es un mercado de precios relativos puros, sino que ocurre a algún valor distinto de cero para α. De hecho, no nos resultaba obvio que secuencias con esta propiedad pudieran ser construidas artificialmente, y mucho menos que ocurrieran como datos reales de mercado. Todavía no hemos encontrado una explicación satisfactoria para este fenómeno y lo dejamos para futuras investigaciones. AGRADECIMIENTOS Agradecemos a Yuriy Nevmyvaka de Lehman Brothers en Nueva York por permitirnos utilizar su código de reconstrucción del libro de órdenes de INET, y por sus valiosos comentarios sobre el trabajo presentado. El panel izquierdo es para NVDA utilizando los datos en bruto que incluyen cancelaciones, mientras que el panel derecho es con los datos limpios. Cada curva corresponde a un solo día de operaciones durante junio de 2004. Las curvas representan promedios de 1000 pruebas aquí. Yishay Mansour fue apoyado en parte por el Programa IST de la Comunidad Europea, en el marco de la Red de Excelencia PASCAL, IST-2002-506778, mediante una subvención de la Fundación Científica de Israel y un premio de la facultad de IBM. 9. REFERENCIAS [1] D. Bertsimas y A. I'm sorry, but "Lo." is not a complete sentence. Could you please provide more context or a complete sentence for me to translate into Spanish? Control óptimo de los costos de ejecución. Revista de Mercados Financieros, 1:1-50, 1998. [2] B. Biais, L. Glosten y C. Spatt. Microestructura del mercado: un estudio de microfundamentos, resultados empíricos e implicaciones políticas. Revista de Mercados Financieros, 8:217-264, 2005. [3] J.-P. Bouchaud, M. Mezard y M. Potters. Propiedades estadísticas de los libros de órdenes de acciones: resultados empíricos y modelos. Finanzas Cuantitativas, 2:251-256, 2002. [4] C. Cao, O. Hansch y X. Wang. El contenido informativo de un libro de órdenes abiertas, 2004. Reuniones de AFA 2005 en Filadelfia, Documento No. 4311 de las Reuniones de EFA en Maastricht. [5] R. Coggins, A. Blazejewski y M. Aitken. Ejecución óptima de operaciones de valores en un mercado de órdenes limitadas. En la Conferencia Internacional sobre Inteligencia Computacional para Ingeniería Financiera, páginas 371-378, marzo de 2003. [6] D. Farmer y S. Joshi. La dinámica de precios de estrategias comunes de trading. Revista de Comportamiento Económico y Organización, 29:149-171, 2002. [7] J. Hasbrouck. Microestructura de mercado empírica: Perspectivas económicas y estadísticas sobre la dinámica del comercio en los mercados de valores, 2004. Apuntes del curso, Escuela de Negocios Stern, Universidad de Nueva York. [8] R. Kissell y M. Glantz. Estrategias óptimas de trading. Amacom, 2003. [9] S. Kakade, M. Kearns, Y. Mansour y L. Ortiz. Algoritmos competitivos para VWAP y trading de órdenes límite. En Actas de la Conferencia de la ACM sobre Comercio Electrónico, páginas 189-198, 2004. [10] Y. Nevmyvaka, Y. Feng y M. Kearns. Aprendizaje por refuerzo para la ejecución de operaciones optimizada, 2006. Preimpresión. 129