Un Protocolo de Negociación Multilateral Multitema Miniar Hemaissia THALES Research & Technology Francia RD 128 F-91767 Palaiseau Cedex, Francia miniar.hemaissia@lip6.fr Amal El Fallah Seghrouchni LIP6, Universidad de París 6 8 rue du Capitaine Scott F-75015 París, Francia amal.elfallah@lip6.fr Christophe Labreuche y Juliette Mattioli THALES Research & Technology Francia RD 128 F-91767 Palaiseau Cedex, Francia RESUMEN En este artículo, presentamos un nuevo protocolo para abordar la negociación multilateral multitema en un contexto cooperativo. Consideramos las dependencias complejas entre múltiples problemas al modelar las preferencias de los agentes con una herramienta de ayuda a la toma de decisiones multicriterio, lo que también nos permite extraer información relevante sobre la evaluación de una propuesta. Esta información se utiliza en el protocolo para ayudar a acelerar la búsqueda de un consenso entre los agentes cooperativos. Además, el procedimiento de negociación se define en un contexto de gestión de crisis donde el objetivo común de nuestros agentes también se considera en las preferencias de un agente mediador. Categorías y Descriptores de Asignaturas I.2.11 [Inteligencia Artificial Distribuida]: Agentes inteligentes, Sistemas multiagente Términos Generales Teoría, Diseño, Experimentación 1. Los protocolos de negociación de múltiples temas representan un campo de estudio importante, ya que los problemas de negociación en el mundo real suelen ser complejos e implicar múltiples temas. Hasta la fecha, la mayoría de trabajos previos en esta área ([2, 3, 19, 13]) se ocuparon casi exclusivamente de negociaciones simples que involucraban temas independientes. Sin embargo, los problemas de negociación del mundo real implican dependencias complejas entre múltiples temas. Cuando alguien quiere comprar un coche, por ejemplo, el valor de un coche dado depende en gran medida de su precio, consumo, comodidad, y así sucesivamente. La adición de tales interdependencias complica en gran medida las funciones de utilidad de los agentes y las funciones de utilidad clásicas, como la suma ponderada, no son suficientes para modelar este tipo de preferencias. En [10, 9, 17, 14, 20], los autores consideran las interdependencias entre los problemas, generalmente definidas con valores booleanos, excepto para [9], mientras que podemos abordar problemas dependientes continuos y discretos gracias al poder de modelado de la integral de Choquet. En [17], los autores tratan la negociación bilateral mientras que nosotros estamos interesados en un entorno de negociación multilateral. Klein et al. [10] presentan un enfoque similar al nuestro, utilizando también un mediador e información sobre la fuerza de la aprobación o rechazo que un agente realiza durante la negociación. En nuestro protocolo, utilizamos información más precisa para mejorar las propuestas gracias a la metodología y herramientas multicriterio utilizadas para modelar las preferencias de nuestros agentes. Lin, en [14, 20], también presenta un servicio de mediación pero utilizando un algoritmo evolutivo para alcanzar soluciones óptimas y, como se explica en [4], los jugadores en los modelos evolutivos necesitan interactuar repetidamente entre sí hasta que se alcance el estado estable. A medida que el tamaño de la población aumenta, el tiempo que lleva que la población se estabilice también aumenta, lo que resulta en una computación, comunicación y sobrecarga de tiempo excesivas que pueden volverse prohibitivas, y para las negociaciones de uno a muchos y muchos a muchos, las sobrecargas aumentan a medida que aumenta el número de jugadores. En [9], los autores consideran una función de utilidad no lineal mediante el uso de restricciones en el dominio de los problemas y un servicio de mediación para encontrar una combinación de ofertas que maximice el bienestar social. Nuestro modelo de preferencia, una función de utilidad no lineal también, es más complejo que el modelo [9] ya que la integral de Choquet tiene en cuenta las interacciones y la importancia de cada criterio/asunto de decisión, no solo las dependencias entre los valores de los asuntos, para determinar la utilidad. También utilizamos un protocolo iterativo que nos permite encontrar una solución incluso cuando no es posible ninguna combinación de ofertas. En este documento, proponemos un protocolo de negociación adecuado para múltiples agentes con preferencias complejas y teniendo en cuenta, al mismo tiempo, múltiples problemas interdependientes y recomendaciones realizadas por los agentes para mejorar una propuesta. Además, las preferencias de nuestros agentes se modelan utilizando una metodología y herramientas de múltiples criterios que nos permiten tener en cuenta información sobre las mejoras que se pueden hacer a una propuesta, con el fin de ayudar a acelerar la búsqueda de un consenso entre los agentes. Por lo tanto, proponemos un protocolo de negociación que consiste en resolver nuestro problema de decisión utilizando un MAS con un modelado de ayuda a la toma de decisiones multicriterio a nivel de agente y un protocolo de negociación multilateral multilateral basado en la cooperación. Este protocolo se estudia bajo un enfoque no cooperativo y se demuestra que tiene equilibrios perfectos en subjuegos, siempre y cuando los agentes se comporten de manera racional en el sentido de von Neumann y Morgenstern. El enfoque propuesto en este documento fue primero introducido y presentado en [8]. En este artículo, presentamos nuestros primeros experimentos, con algunos resultados destacados, y un sistema multiagente más complejo con representantes para permitirnos tener un sistema más robusto. En la Sección 2, presentamos nuestra aplicación, un problema de gestión de crisis. La sección 3 trata del aspecto general del enfoque propuesto. El modelado de preferencias se describe en la sección 4, mientras que las motivaciones de nuestro protocolo se consideran en la sección 5 y el modelado de agente/multiagente en la sección 6. La sección 7 presenta el modelado formal y las propiedades de nuestro protocolo antes de presentar nuestros primeros experimentos en la sección 8. Finalmente, en la Sección 9, concluimos y presentamos el trabajo futuro. 2. ESTUDIO DE CASO Este protocolo se aplica a un problema de gestión de crisis. La gestión de crisis es un campo relativamente nuevo de la administración y está compuesta por tres tipos de actividades: prevención de crisis, preparación operativa y gestión de crisis declaradas. La prevención de crisis tiene como objetivo reducir el riesgo de crisis a un nivel aceptable y, cuando sea posible, evitar que la crisis ocurra realmente. La preparación operativa incluye una planificación estratégica avanzada, entrenamiento y simulación para garantizar la disponibilidad, movilización rápida y despliegue de recursos para hacer frente a posibles emergencias. La gestión de crisis declaradas es la respuesta a - incluyendo la evacuación, búsqueda y rescate - y la recuperación de la crisis mediante la minimización de los efectos de las crisis, limitando el impacto en la comunidad y el medio ambiente y, a largo plazo, restableciendo los sistemas de la comunidad a la normalidad. En este documento, nos enfocamos en la parte de respuesta de la gestión de la actividad de crisis declarada, y particularmente en la evacuación de las personas heridas en situaciones de desastre. Cuando se declara una crisis, se ejecutan los planes definidos durante la actividad de preparación operativa. Para desastres, se ejecutan planes maestros. Estos planes son elaborados por las autoridades con la colaboración de agencias de protección civil, policía, servicios de salud, organizaciones no gubernamentales, etc. Cuando se encuentra a una víctima, se siguen varias acciones. Primero, se asigna un equipo de rescate a la víctima, quien es examinada y se le brinda primeros auxilios en el lugar. Entonces, las víctimas pueden ser colocadas en un centro de emergencia en tierra llamado puesto médico avanzado. Para todas las víctimas, un médico clasificador, generalmente un médico de hospital, examina la gravedad de sus lesiones y clasifica a las víctimas por patología. La evacuación mediante transporte de emergencia sanitaria, si es necesario, puede tener lugar después de estos exámenes clínicos y clasificaciones. Hoy en día, para evacuar a las personas heridas, los médicos contactan al centro de llamadas de emergencia para transmitir las evaluaciones médicas de los casos más urgentes. El centro de llamadas de emergencia luego busca espacios disponibles y apropiados en los hospitales para atender a estas víctimas. Los médicos están informados de las asignaciones, por lo que pueden proceder a las evacuaciones eligiendo los transportes de salud de emergencia de acuerdo con las patologías y los modos de transporte proporcionados. En este contexto, podemos observar que la evacuación se basa en tres elementos importantes: el examen y clasificación de las víctimas, la búsqueda de una asignación y el transporte. En el caso de los atentados de Madrid del 11 de marzo de 2004, por ejemplo, algunas personas heridas no recibieron la atención médica adecuada porque, durante la búsqueda de espacio, el centro de llamadas de emergencia no consideró las limitaciones de transporte y, en particular, el tráfico. Por lo tanto, para un problema de gestión de crisis a gran escala, es necesario apoyar al centro de llamadas de emergencia y a los médicos en la asignación teniendo en cuenta los hospitales y las limitaciones y disponibilidades de transporte. ENFOQUE PROPUESTO Para aceptar una propuesta, un agente debe considerar varios aspectos, como en el caso del problema de gestión de crisis, las disponibilidades en términos de número de camas por unidad, personal médico y quirúrgico, quirófanos, entre otros. Por lo tanto, cada agente tiene sus propias preferencias en correlación con sus restricciones de recursos y otros criterios de decisión, como en el caso de estudio, el nivel de congestión de un hospital. Todos los agentes también toman decisiones teniendo en cuenta las dependencias entre estos criterios de decisión. La primera hipótesis de nuestro enfoque es que hay varias partes involucradas e impactadas por la decisión, por lo que tienen que decidir juntas de acuerdo con sus propias limitaciones y criterios de decisión. La negociación es el proceso mediante el cual un grupo que enfrenta un conflicto se comunica entre sí para intentar llegar a un acuerdo o decisión mutuamente aceptable, por lo tanto, los agentes tienen que negociar. El conflicto que debemos resolver es encontrar una solución aceptable para todas las partes utilizando un protocolo específico. En nuestro contexto, la negociación multilateral es un tipo de protocolo de negociación que es el más adecuado para este tipo de problema: este tipo de protocolo permite que los hospitales y los médicos negocien juntos. La negociación también aborda múltiples temas. Además, otra hipótesis es que nos encontramos en un contexto cooperativo donde todas las partes tienen un objetivo común que es proporcionar la mejor solución posible para todos. Esto implica el uso de un protocolo de negociación que alienta a las partes involucradas a cooperar para satisfacer sus preferencias. Teniendo en cuenta estos aspectos, un Sistema Multiagente (MAS) parece ser un método confiable en el caso de un proceso de toma de decisiones distribuido. De hecho, un MAS es una respuesta adecuada cuando la solución debe combinar, al menos, características de distribución y capacidades de razonamiento. Otra motivación para utilizar MAS radica en el hecho de que MAS es conocido por facilitar la negociación automatizada a nivel de toma de decisiones operativas en diversas aplicaciones. Por lo tanto, nuestro enfoque consiste en resolver un problema de decisión de múltiples partes utilizando un MAS con: • Las preferencias de los agentes se modelan utilizando una herramienta de ayuda a la toma de decisiones multicriterio, MYRIAD, que también nos permite considerar problemas de múltiples temas evaluando propuestas en varios criterios. • Un protocolo de negociación multilateral y multi-tema basado en la cooperación. 4. EL MODELO DE PREFERENCIA Consideramos un problema en el que un agente tiene varios criterios de decisión, un conjunto Nk = {1, . . . , nk} de criterios para cada agente k involucrado en el protocolo de negociación. Estos criterios de decisión permiten a los agentes evaluar el conjunto de temas que se negocian. Los problemas corresponden directa o indirectamente a los criterios de decisión. Sin embargo, para el ejemplo de la gestión de crisis 944 de la Sexta Conferencia Internacional. En la Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07), el problema radica en el conjunto de víctimas a despachar entre los hospitales. Estos problemas se traducen en criterios de decisión que permiten al hospital evaluar su congestión y así obtener un número actualizado de camas disponibles, equipos médicos, entre otros. Para tener en cuenta la complejidad que existe entre los criterios/asuntos, utilizamos una herramienta de ayuda a la toma de decisiones multicriterio (MCDA) llamada MYRIAD [12], desarrollada en Thales para aplicaciones de MCDA basadas en una integral de Choquet de dos aditivos que es un buen compromiso entre versatilidad y facilidad para comprender y modelar las interacciones entre los criterios de decisión [6]. El conjunto de atributos de Nk se denota por Xk1, . . . , Xknk. Todos los atributos se vuelven comparables gracias a la introducción de funciones de utilidad parciales uk i : Xk i → [0, 1]. La escala [0, 1] representa la satisfacción del agente k con respecto a los valores de los atributos. Una opción x se identifica con un elemento de Xk = Xk 1 × · · · × Xk nk, con x = (x1, . . . , xnk). Entonces, la evaluación general de x se da por Uk(x) = Hk(uk 1 (x1), . . . , uh nk (xnk )) (1) donde Hk : [0, 1]nk → [0, 1] es la función de agregación. La relación de preferencia general sobre Xk es entonces x y ⇐⇒ Uk(x) ≥ Uk(y). La integral de Choquet de dos aditivos está definida para (z1, . . . , znk ) ∈ [0, 1]nk por [7] Hk(z1, . . . , znk ) = X i∈Nk 0 @vk i − 1 2 X j=i |Ik i,j| 1 A zi + X Ik i,j >0 Ik i,j zi ∧ zj + X Ii,j <0 |Ii,j| zi ∨ zj (2) donde vk i es la importancia relativa del criterio i para el agente k e Ik i,j es la interacción entre los criterios i y j, ∧ y ∨ denotan las funciones de mínimo y máximo respectivamente. Suponga que zi < zj. Una interacción positiva entre los criterios i y j representa la complementariedad entre estos criterios (sinergia positiva) [7]. Por lo tanto, la puntuación más baja de z en el criterio i oculta en mayor medida el efecto positivo de la mejor puntuación en el criterio j en la evaluación general que el impacto de la importancia relativa de los criterios tomados independientemente de los demás. En otras palabras, la puntuación de z en el criterio j se ve penalizada por la puntuación más baja en el criterio i. Por el contrario, una interacción negativa entre los criterios i y j representa la sustituibilidad entre estos criterios (sinergia negativa) [7]. La puntuación de z en el criterio i es luego guardada por una mejor puntuación en el criterio j. En MYRIAD, también podemos obtener algunas recomendaciones correspondientes a un indicador ωC (H, x) que mide el valor para mejorar la opción x con respecto a. Hk en algunos criterios C ⊆ Nk se define como sigue: ωC (Hk, x) = Z 1 0 Hk ` (1 − τ)xC + τ, xNk\C ´ − Hk(x) EC (τ, x) dτ donde ((1−τ)xC +τ, xNk\C ) es el acto compuesto que es igual a (1 − τ)xi + τ si i ∈ C y es igual a xi si i ∈ Nk \ C. Además, EC (τ, x) es el esfuerzo para pasar del perfil x al perfil ((1 − τ)xC + τ, xNk\C). La función ωC (Hk, x) representa la mejora promedio de Hk cuando los criterios de la coalición A van desde xC hasta 1C dividida por el esfuerzo promedio necesario para esta mejora. Generalmente asumimos que EC es del orden 1, es decir, EC (τ, x) = τ P i∈C (1 − xi). La expresión de ωC (Hk, x) cuando Hk es una integral de Choquet, se encuentra en [11]. Se recomienda entonces al agente mejorar la coalición C para la cual ωC (Hk, x) es máximo. Esta recomendación es muy útil en un protocolo de negociación ya que ayuda a los agentes a saber qué hacer si desean que una oferta sea aceptada sin revelar su propio modelo de preferencias. 5. MOTIVACIONES DEL PROTOCOLO Para problemas de múltiples temas, existen dos enfoques: un enfoque de paquete completo donde los temas se negocian simultáneamente en oposición al enfoque secuencial donde los temas se negocian uno por uno. Cuando los problemas son dependientes, entonces es la mejor opción negociar simultáneamente sobre todos los problemas [5]. Por lo tanto, el paquete completo es el enfoque adoptado para que una oferta se base en el conjunto general de personas lesionadas teniendo en cuenta los demás criterios de decisión. Tenemos que considerar que todas las partes del proceso de negociación deben estar de acuerdo con la decisión, ya que todas están involucradas e impactadas por esta decisión, por lo que se requiere un acuerdo unánime en el protocolo. Además, ninguna parte puede abandonar el proceso hasta que se alcance un acuerdo, es decir, se logre un consenso. Esto tiene sentido ya que una propuesta concierne a todas las partes. Además, debemos garantizar la disponibilidad de los recursos necesarios por las partes para asegurar que una propuesta sea realista. Con este fin, la información sobre estas disponibilidades se utiliza para determinar propuestas admisibles de manera que una oferta no pueda hacerse si una de las partes no tiene suficientes recursos para ejecutarla/lograrla. Al comienzo de la negociación, cada parte proporciona sus máximas disponibilidades, lo que define las restricciones que deben cumplirse para cada oferta presentada. La negociación también debe converger rápidamente en un acuerdo unánime. Decidimos introducir en el protocolo de negociación un incentivo para cooperar teniendo en cuenta el tiempo transcurrido en la negociación. Este incentivo se define en función de una penalización dependiente del tiempo, el factor de descuento como en [18] o un umbral dependiente del tiempo. Esta penalización debe ser utilizada en la etapa de aceptar/rechazar de nuestro procedimiento de consenso. De hecho, en el caso de un factor de descuento, cada parte aceptará o rechazará una oferta evaluando la propuesta utilizando su función de utilidad deducida del factor de descuento. En el caso de un umbral dependiente del tiempo, si la evaluación es mayor o igual a este umbral, la oferta es aceptada; de lo contrario, en el siguiente período, su umbral se reduce. El uso de una sanción no es suficiente por sí solo ya que no ayuda a encontrar una solución. Se necesita información sobre las evaluaciones de las partes involucradas en la negociación. En particular, sería útil saber por qué se ha rechazado una oferta y/o qué se puede hacer para hacer una propuesta que sea aceptada. MYRIAD proporciona un análisis que determina las fallas de una opción, aquí una propuesta. En particular, proporciona este tipo de información: qué criterios de una propuesta deben mejorarse para alcanzar la evaluación general más alta posible [11]. Al utilizar esta herramienta para modelar a las partes involucradas en la negociación, la información sobre los criterios a mejorar puede ser utilizada por el mediador para elaborar las propuestas. También consideramos que la función dual se puede utilizar para tener en cuenta otro tipo de información: en qué criterios de una propuesta no es necesario realizar mejoras para que la evaluación general de la propuesta siga siendo aceptable, no disminuya. Por lo tanto, toda la información es una restricción que debe ser satisfecha en la medida de lo posible por The Sixth Intl. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07) Figura 1: Una ilustración de algún sistema. las partes para hacer una nueva propuesta. Estamos en un contexto cooperativo y revelar la opinión sobre lo que se puede mejorar no está prohibido, al contrario, es útil y recomendado aquí, ya que ayuda a llegar a un acuerdo. Por lo tanto, cuando una de las partes rechaza una oferta, se comunicará cierta información. Para facilitar y acelerar la negociación, introducimos un mediador. Esta entidad específica se encarga de hacer propuestas a las otras partes en el sistema teniendo en cuenta sus limitaciones públicas (por ejemplo, su disponibilidad) y las recomendaciones que hacen. Este mediador también puede ser considerado como el representante del interés general que podemos tener, en algunas aplicaciones, como en el problema de gestión de crisis, el médico será el mediador y también tendrá más información para considerar al hacer una oferta (por ejemplo, estado del tráfico, modo de transporte y tiempo). Cada parte en una negociación N, un negociador, también puede ser mediador de otra negociación N, convirtiéndose esta parte en el representante de N en la negociación N, como se ilustra en la figura 1, lo que también puede ayudar a reducir el tiempo de comunicación. 6. AGENTIFICACIÓN Cómo se transpone el problema en un problema de MAS es un aspecto muy importante al diseñar dicho sistema. La agentificación tiene influencia en la eficiencia de los sistemas para resolver el problema. Por lo tanto, en esta sección describimos los elementos y restricciones tenidos en cuenta durante la fase de modelado y para el propio modelo. Sin embargo, para esta aplicación de negociación, el modelado es bastante natural cuando se observan las motivaciones del protocolo de negociación y sus principales propiedades. En primer lugar, parece obvio que debería haber un agente para cada jugador de nuestro protocolo de negociación multilateral y multi-asunto. Los agentes tienen la información y preferencias de las partes involucradas. Estos agentes son: • Autónomos: deciden por sí mismos qué, cuándo y bajo qué condiciones deben realizarse las acciones; • Racionales: tienen competencia de medios-fines para ajustar sus decisiones, de acuerdo con su conocimiento, preferencias y objetivos; • Egoístas: tienen sus propios intereses que pueden entrar en conflicto con los intereses de otros agentes. Además, sus preferencias son modeladas y una propuesta es evaluada y analizada utilizando MYRIAD. Cada agente tiene información privada y puede acceder a información pública como conocimiento. De hecho, hay dos tipos de agentes: el tipo mediador para los agentes correspondientes al mediador de nuestro protocolo de negociación, el médico delegado en nuestra aplicación, y el tipo negociador para los agentes correspondientes a las otras partes, los hospitales. Los principales comportamientos que un agente de tipo mediador necesita negociar en nuestro protocolo son los siguientes: • convertir_mejoras: convierte la información proporcionada por los otros agentes involucrados en la negociación sobre las mejoras a realizar, en restricciones para la próxima propuesta a realizar; • convertir_no_disminución: convierte la información proporcionada por los otros agentes involucrados en la negociación sobre los puntos que no deben cambiarse en restricciones para la próxima propuesta a realizar; • construir_propuesta: construye una nueva propuesta de acuerdo con las restricciones obtenidas con convertir_mejoras, convertir_no_disminución y las preferencias del agente; Los principales comportamientos que un agente de tipo negociador necesita negociar en nuestro protocolo son los siguientes: • convertir_propuesta: convierte una propuesta en una opción MYRIAD del agente de acuerdo con su modelo de preferencias y sus datos privados; • convertir_mejoras_wc: convierte las recomendaciones del agente para las mejoras de una opción MYRIAD en información general sobre la propuesta; • convertir_no_disminución_wc: convierte las recomendaciones del agente sobre los criterios que no deben cambiarse en la opción MYRIAD en información general sobre la propuesta; Además de estos comportamientos, existen, para los dos tipos de agentes, comportamientos de acceso a funcionalidades de MYRIAD como las funciones de evaluación y mejora: • evaluar_opción: evalúa la opción MYRIAD obtenida utilizando el comportamiento del agente convertir_propuesta; • mejoras: obtiene las recomendaciones del agente para mejorar una propuesta de la opción MYRIAD; • no_disminución: obtiene las recomendaciones del agente para no cambiar algunos criterios de la opción MYRIAD; Por supuesto, antes de ejecutar el sistema con tales agentes, debemos haber definido el modelo de preferencias de cada parte en MYRIAD. Este modelo tiene que formar parte del agente para que pueda ser utilizado para realizar las evaluaciones y recuperar las mejoras. Además de estos comportamientos, los actos de comunicación entre los agentes son los siguientes. 1. actos de comunicación del agente mediador: 946 The Sixth Intl. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07) m1 m 1 1 m inform1 m mediador negociador aceptar-propuesta l 1 aceptar-propuesta m-l rechazar-propuesta proponer proponer Figura 2: El diagrama del protocolo en AUML, donde m es el número de agentes negociadores y l es el número de agentes que rechazan la propuesta actual. (a) proponer: envía un mensaje que contiene una propuesta a todos los agentes negociadores; (b) informar: envía un mensaje a todos los agentes negociadores para informarles que se ha llegado a un acuerdo y que contiene el resultado del consenso. 2. actos de comunicación del agente negociador: (a) aceptar-propuesta: envía un mensaje al agente mediador que contiene las recomendaciones del agente para mejorar la propuesta y obtenidas con convert_improvements_wc; (b) rechazar-propuesta: envía un mensaje al agente mediador que contiene las recomendaciones del agente sobre los criterios que no deben cambiarse y obtenidas con convert_no_decrease_wc. Tales agentes son intercambiables en caso de fallo, ya que todos tienen las mismas propiedades y representan a un usuario con su modelo de preferencias, no dependiendo del agente, sino del modelo definido en MYRIAD. Cuando los problemas y los criterios de decisión son diferentes entre sí, la información sobre la mejora de los criterios debe ser preprocesada para dar algunas instrucciones sobre las direcciones a tomar y sobre los problemas negociados. Es lo mismo para la evaluación de una propuesta: cada agente debe convertir la información sobre los temas para actualizar su información privada y obtener los valores de cada atributo de los criterios de decisión. 7. NUESTRO PROTOCOLO Formalmente, consideramos negociaciones en las que un conjunto de jugadores A = {1, 2, . . . , m} y un jugador a están negociando sobre un conjunto Q de tamaño q. El jugador a es el mediador del protocolo, el agente mediador de la agentificación. La función de utilidad/preferencia de un jugador k ∈ A ∪ {a} es Uk, definida utilizando MYRIAD, como se presenta en la Sección 4, con un conjunto Nk de criterios, Xk una opción, y así sucesivamente. Una oferta es un vector P = (P1, P2, · · · , Pm), una partición de Q, en la que Pk es la parte del jugador k de Q. Tenemos P ∈ P donde P es el conjunto de propuestas admisibles, un conjunto finito. Ten en cuenta que P se determina utilizando todas las restricciones generales de los jugadores en las propuestas y Q. Además, dejemos que ˜P denote una propuesta particular definida como la propuesta preferida. También tenemos la siguiente notación: δk es el factor de disminución del umbral del jugador k, Φk : Pk → Xk es la función del jugador k para convertir una propuesta en una opción y Ψk es la función que indica qué puntos de P deben mejorarse, con Ψk su función dual - en qué puntos no es necesaria ninguna mejora. Ψk se obtiene utilizando la función dual de ωC (Hk, x): eωC (Hk, x)= Z 1 0 Hk(x) − Hk ` τ xC , xNk\C ´ eEC (τ, x) dτ Donde eEC (τ, x) es el costo/esfuerzo para ir de (τxC , xNk\C ) a x. En el período t de nuestro procedimiento de consenso, el jugador a propone un acuerdo P. Todos los jugadores k ∈ A responden a a aceptando o rechazando P. Las respuestas se realizan de forma simultánea. Si todos los jugadores k ∈ A aceptan la oferta, el juego termina. Si algún jugador k rechaza P, entonces comienza el siguiente período t+1: el jugador a hace otra propuesta P teniendo en cuenta la información proporcionada por los jugadores y aquellos que han rechazado P aplican una penalización. Por lo tanto, nuestro protocolo de negociación puede ser el siguiente: Protocolo P1. • Al principio, establecemos el período t = 0 • a hace una propuesta P ∈ P que no ha sido propuesta antes. • Esperar a que todos los jugadores de A den su opinión Sí o No al jugador a. Si todos los jugadores están de acuerdo en P, este último es elegido. De lo contrario, t se incrementa y volvemos al punto anterior. • Si no queda ninguna oferta de P, se elegirá la oferta predeterminada ˜P. • La utilidad de los jugadores con respecto a una oferta dada disminuye con el tiempo. Más precisamente, la utilidad del jugador k ∈ A en el período t con respecto a la oferta P es Uk(Φk(Pk), t) = ft(Uk(Φk(Pk))), donde uno puede tomar, por ejemplo, ft(x) = x. (δk)t o ft(x) = x − δk.t, como función de penalización. Lema 1. El Protocolo P1 tiene al menos un equilibrio perfecto en subjuegos 1. Prueba: El Protocolo P1 es primero transformado en un juego en forma extensiva. Con este fin, se debe especificar el orden en el que los respondedores A reaccionan a la oferta P de a. Sin embargo, el orden en el que los jugadores responden no tiene influencia en el transcurso del juego y en particular en su utilidad personal. Por lo tanto, el protocolo P1 es estrictamente equivalente a un juego en el que un equilibrio perfecto en subjuegos es un equilibrio en el que las estrategias de los jugadores constituyen un equilibrio de Nash en cada subjuego del juego original [18, 16]. Un equilibrio de Nash es un conjunto de estrategias, una para cada jugador, tal que ningún jugador tiene incentivo para cambiar unilateralmente su acción [15]. El Sexto Internacional. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07) 947 en forma extensiva, considerando cualquier orden de los jugadores A. Este juego es claramente finito ya que P es finito y cada oferta solo puede ser propuesta una vez. Finalmente, P1 corresponde a un juego con información perfecta. Concluimos la prueba utilizando un resultado clásico que establece que cualquier juego finito en forma extensiva con información perfecta tiene al menos un equilibrio perfecto en subjuegos (ver, por ejemplo, [16]). Los jugadores racionales (en el sentido de von Neumann y Morgenstern) involucrados en el protocolo P1 necesariamente llegarán a un equilibrio perfecto en subjuegos. Ejemplo 1. Considera un ejemplo con A = {1, 2} y P = {P1, P2, P3} donde la oferta predeterminada es P1. Suponga que ft(x) = x − 0.1 t. Considere la siguiente tabla que muestra las utilidades en t = 0. Es fácil ver que hay un único equilibrio perfecto en subjuegos para el protocolo P1 correspondiente a estos valores. Este equilibrio consiste en las siguientes opciones: primero a propone P3; el jugador 1 rechaza esta oferta; luego a propone P2 y ambos jugadores 1 y 2 aceptan, de lo contrario se les amenaza con recibir la peor oferta P1 para ellos. Finalmente se elige la oferta P2. La opción P1 es la mejor, pero los otros dos jugadores la vetaron. Es interesante señalar que, aunque a prefiere P2 a P3, la oferta de P3 es la primera propuesta y esto hace que se acepte P2. Si a propone P2 primero, entonces el equilibrio perfecto en subjuegos en esta situación es P3. En resumen, las opciones menos preferidas deben ser propuestas primero para finalmente obtener la mejor. Pero esto implica una pérdida de tiempo. Analizando el ejemplo anterior, se observa que el resultado del juego en el equilibrio es P2, lo cual no es muy atractivo para el jugador 2. La opción P3 parece más equilibrada ya que ningún jugador la juzga mal. Podría ser considerada como una mejor solución al llegar a un consenso entre los agentes. Para introducir esta noción de equilibrio en el protocolo, introducimos una condición bajo la cual un jugador estará obligado a aceptar la propuesta, reduciendo la autonomía de los agentes pero aumentando la racionalidad y la cooperación. Más precisamente, si la utilidad de un jugador es mayor que un umbral dado, entonces se requiere la aceptación. El umbral disminuye con el tiempo, de modo que los jugadores tienen que hacer cada vez más concesiones. Por lo tanto, el protocolo queda de la siguiente manera. Protocolo P2. • Al principio establecemos el período t = 0 • a hace una propuesta P ∈ P que no ha sido propuesta antes. • Esperar a que todos los jugadores de A den su opinión Sí o No al jugador a. Un jugador k debe aceptar la oferta si Uk(Φk(Pk)) ≥ ρk(t) donde ρk(t) tiende a cero a medida que t crece. Además, existe un valor T tal que para todo t ≥ T, ρk(t) = 0. Si todos los jugadores están de acuerdo en P, este último es elegido. De lo contrario, t se incrementa y volvemos al punto anterior. • Si no queda ninguna oferta de P, se elegirá la oferta predeterminada ˜P. Se puede demostrar exactamente como en el Lema 1 que el protocolo P2 tiene al menos un equilibrio perfecto en subjuegos. Esperamos que el protocolo P2 proporcione una solución no muy alejada de P, por lo que favorece la equidad entre los jugadores. Por lo tanto, nuestro protocolo multilateral y multi-temático basado en la cooperación es el siguiente: Protocolo P. • Al principio establecemos el período t = 0 • a hace una propuesta P ∈ P que no ha sido propuesta antes, considerando Ψk(Pt) y Ψk(Pt) para todos los jugadores k ∈ A. • Esperar a que todos los jugadores de A den su opinión (Sí, Ψk(Pt)) o (No, Ψk(Pt)) al jugador a. Un jugador k debe aceptar la oferta si Uk(Φk(Pk)) ≥ ρk(t) donde ρk(t) tiende a cero a medida que t crece. Además, existe un valor T tal que para todo t ≥ T, ρk(t) = 0. Si todos los jugadores están de acuerdo en P, este último es elegido. De lo contrario, t se incrementa y volvemos al punto anterior. • Si no queda ninguna oferta de P, se elegirá la oferta predeterminada ˜P. 8. EXPERIMENTOS Desarrollamos un MAS utilizando la plataforma de agentes JADE ampliamente utilizada [1]. Este MAS está diseñado para ser lo más general posible (por ejemplo, un marco general para especializarse según la aplicación) y nos permite realizar algunos experimentos preliminares. Los experimentos tienen como objetivo verificar que nuestro enfoque brinde soluciones lo más cercanas posible a la solución de Maximin y en un número reducido de rondas, y ojalá en poco tiempo, ya que nuestro contexto es altamente cooperativo. Definimos los dos tipos de agentes y sus comportamientos como se presentan en la sección 6. Los agentes y sus comportamientos corresponden a las clases principales de nuestro prototipo, NegotiatorAgent y NegotiatorBehaviour para los agentes negociadores, y MediatorAgent y MediatorBehaviour para el agente mediador. Estas clases extienden las clases de JADE e integran MYRIAD en los agentes, reduciendo la cantidad de comunicaciones en el sistema. Algunas funcionalidades, dependiendo de la aplicación, deben implementarse de acuerdo con la aplicación mediante la extensión de estas clases. En particular, todas las partes de conversión de los agentes deben especificarse de acuerdo con la aplicación, ya que para convertir una propuesta en criterios de decisión, primero necesitamos conocer este modelo y las correlaciones entre las propuestas y este modelo. Primero, para ilustrar nuestro protocolo, presentamos un ejemplo simple de nuestro problema de despacho. En este ejemplo, tenemos tres hospitales, H1, H2 y H3. Cada hospital puede recibir víctimas que tengan una patología particular de tal manera que H1 puede recibir pacientes con la patología de quemaduras, cirugía u ortopedia, H2 puede recibir pacientes con la patología de cirugía, ortopedia o cardiología y H3 puede recibir pacientes con la patología de quemaduras o cardiología. Todos los hospitales tienen criterios de decisión similares que reflejan sus preferencias sobre el nivel de congestión que pueden enfrentar tanto en el hospital en general como en los diferentes servicios disponibles, como se explica brevemente para el hospital H1 a continuación. Para el hospital H1, el modelo de preferencia, fig. 3, está compuesto por cinco criterios. Estos criterios corresponden a las preferencias sobre las patologías que el hospital puede tratar. En el caso de 948 El Sexto Internacional. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07) Figura 3: El modelo de preferencia H1 en MYRIAD. La patología de quemaduras, el criterio correspondiente, también llamado quemadura como se muestra en la figura 3, representa las preferencias de H1 según el valor de Cburn que es la capacidad actual de quemaduras. Por lo tanto, la función de utilidad de este criterio representa una preferencia tal que mientras más pacientes haya con esta patología en el hospital, menos podrá satisfacerlos el hospital, y esto con una capacidad inicial. Además de reflejar este tipo de punto de vista, la función de agregación definida en MYRIAD introduce un veto en los criterios quemadura, cirugía, ortopedia y ERecibo, donde ERecibo es el criterio para las preferencias sobre la capacidad de recibir un número de pacientes al mismo tiempo. En este ejemplo simplificado, el médico no tiene preferencias particulares sobre el envío y el agente mediador elige una propuesta al azar en un subconjunto del conjunto de admisibilidad. Este subconjunto debe cumplir en la medida de lo posible las recomendaciones hechas por los hospitales. Para resolver este problema, en este ejemplo, decidimos resolver un problema lineal con las restricciones de disponibilidad y las recomendaciones como restricciones lineales en los valores de despacho. El conjunto de admisibilidad se obtiene resolviendo este problema lineal mediante el uso de Prolog. Además, solo se tienen en cuenta las recomendaciones sobre cómo mejorar una propuesta. El problema a resolver es entonces enviar al hospital H1, H2 y H3, el conjunto de víctimas compuesto por 5 víctimas con la patología de quemaduras, 10 con cirugía, 3 con ortopedia y 7 con cardiología. Las disponibilidades de los hospitales se presentan en la siguiente tabla. Disponible en general cirugía de quemaduras, ortopedia y cardiología. Obtenemos un sistema multiagente con el agente mediador y tres agentes del tipo negociador para los tres hospitales en el problema. El umbral de los hospitales está fijado aproximadamente en el nivel en el que una evaluación se considera buena. Para empezar, los agentes negociadores envían sus disponibilidades. El agente mediador hace una propuesta elegida al azar en el conjunto admisible obtenido con estas disponibilidades como restricciones lineales. Esta propuesta es el vector P0 = [[H1, quemaduras, 3], [H1, cirugía, 8], [H1, ortopedia, 0], [H2, cirugía, 2], [H2, ortopedia, 3], [H2, cardiología, 6], [H3, quemaduras, 2], [H3, cardiología, 1]] y el mediador envía la propuesta (P0) a H1, H2 y H3 para su aprobación. Cada agente negociador evalúa esta propuesta y responde aceptando o rechazando P0: • El agente H1 rechaza esta oferta ya que su evaluación está muy lejos del umbral (0.29, una puntuación baja) y da una recomendación para mejorar quemaduras y cirugía enviando el mensaje reject_proposal([quemaduras, cirugía]); • El agente H2 acepta esta oferta enviando el mensaje accept_proposal(), siendo la evaluación de la propuesta buena; • El agente H3 acepta P0 enviando el mensaje accept_proposal(), siendo la evaluación de la propuesta buena. Solo con las recomendaciones proporcionadas por el agente H1, el mediador puede hacer una nueva propuesta restringiendo el valor de quemaduras y cirugía. La nueva propuesta obtenida es entonces P1 = [[H1, quemaduras, 0], [H1, cirugía, 8], [H1, ortopedia, 1], [H2, cirugía, 2], [H2, ortopedia, 2], [H2, cardiología, 6], [H3, quemaduras, 5], [H3, cardiología, 1]]. El mediador envía la propuesta (P1) a los agentes negociadores. H1, H2 y H3 responden enviando el mensaje accept_proposal(), P1 siendo evaluado con una puntuación lo suficientemente alta como para ser aceptable, y también considerado como una buena propuesta al utilizar la función de explicación de MYRIAD. Se llega a un acuerdo con P1. Ten en cuenta que la evaluación de P1 por H3 ha disminuido en comparación con P0, pero no lo suficiente como para ser rechazada y que esta solución es la óptima de Pareto, P∗. Otros ejemplos han sido probados con la misma configuración: problemas en IN, tres agentes negociadores y el mismo agente mediador, sin modelo de preferencia pero seleccionando aleatoriamente la propuesta. Obtuvimos soluciones iguales o cercanas a la solución de Maximin, la distancia de la desviación estándar siendo menor a 0.0829, las evaluaciones no muy lejos de las obtenidas con P∗ y con menos de siete propuestas realizadas. Esto nos muestra que somos capaces de resolver este problema de negociación multilateral de múltiples problemas de manera simple y eficiente, con soluciones cercanas a la solución de Pareto. 9. CONCLUSIÓN Y TRABAJOS FUTUROS Este artículo presenta un nuevo protocolo para abordar negociaciones multilaterales de múltiples temas en un contexto cooperativo. La primera contribución principal es que tenemos en cuenta las complejas interdependencias entre múltiples problemas mediante el uso de un modelado de preferencias complejo. Esta contribución se refuerza mediante el uso de negociaciones de múltiples temas en un contexto multilateral. Nuestra segunda contribución es el uso de recomendaciones precisas en el protocolo para ayudar a acelerar la búsqueda de un consenso entre los agentes cooperativos y encontrar una solución óptima. También hemos demostrado que el protocolo tiene equilibrios perfectos en subjuegos y que estos equilibrios convergen hacia la solución máxima habitual. Además, probamos este protocolo en un contexto de gestión de crisis donde el objetivo de la negociación es determinar dónde evacuar a un conjunto completo de personas heridas a hospitales predefinidos. Ya hemos desarrollado un primer MAS, en particular integrando MYRIAD, para probar este protocolo con el fin de conocer más sobre su eficiencia en términos de calidad de solución y rapidez en encontrar un consenso. Este prototipo nos permitió resolver algunos ejemplos con nuestro enfoque y los resultados que obtuvimos son alentadores, ya que logramos rápidamente buenos acuerdos, cercanos a la solución de Pareto, a la luz de las restricciones iniciales del problema: las disponibilidades. Todavía tenemos que mejorar nuestro MAS teniendo en cuenta el Sexto Internacional. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07) 949 los dos tipos de recomendaciones y añadiendo un modelo de preferencias al mediador de nuestro sistema. Además, se debe realizar un estudio comparativo para evaluar el rendimiento de nuestro marco de trabajo frente a los existentes y frente a algunas variaciones en el protocolo. 10. AGRADECIMIENTO Este trabajo está parcialmente financiado por el proyecto de investigación ICIS bajo el Programa BSIK holandés (BSIK 03024). 11. REFERENCIAS [1] JADE. http://jade.tilab.com/. [2] P. Faratin, C. Sierra y N. R. Jennings. Utilizando criterios de similitud para hacer compensaciones de problemas en negociaciones automatizadas. Inteligencia Artificial, 142(2):205-237, 2003. [3] S. S. Fatima, M. Wooldridge y N. R. Jennings. Negociación óptima de múltiples temas en entornos de información incompleta. En la 3ª Conferencia Internacional Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS04), páginas 1080-1087, Nueva York, EE. UU., 2004. [4] S. S. Fatima, M. Wooldridge y N. R. Jennings. Un estudio comparativo de modelos de teoría de juegos y evolutivos de negociación para agentes de software. Revisión de Inteligencia Artificial, 23:185-203, 2005. [5] S. S. Fatima, M. Wooldridge y N. R. Jennings. Sobre procedimientos eficientes para la negociación de múltiples temas. En el 8º Taller Internacional sobre Comercio Electrónico Mediado por Agentes (AMEC06), páginas 71-84, Hakodate, Japón, 2006. [6] M. Grabisch. La aplicación de integrales difusas en la toma de decisiones multicriterio. Revista Europea de Investigación Operativa, 89:445-456, 1996. [7] M. Grabisch, T. Murofushi y M. Sugeno. Medidas y integrales difusas. Teoría y aplicaciones (volumen editado). Estudios en la Difuminación. Physica Verlag, 2000. [8] M. Hemaissia, A. El Fallah-Seghrouchni, C. Labreuche y J. Mattioli. Negociación multilateral y multi-asunto basada en la cooperación para la gestión de crisis. En el 2º Taller Internacional sobre Negociación Racional, Robusta y Segura (RRS06), páginas 77-95, Hakodate, Japón, mayo de 2006. [9] T. Ito, M. Klein y H. Hattori. Un protocolo de negociación para agentes con funciones de utilidad no lineales. En AAAI, 2006. [10] M. Klein, P. Faratin, H. Sayama y Y. Bar-Yam. Negociando contratos complejos. Grupo de Decisión y Negociación, 12:111-125, marzo de 2003. [11] C. Labreuche. Determinación de los criterios a mejorar primero para mejorar lo máximo posible la evaluación general. En IPMU 2004, páginas 609-616, Perugia, Italia, 2004. [12] C. Labreuche y F. Le Hu´ed´e. MYRIAD: un conjunto de herramientas para la toma de decisiones multicriterio (MCDA). En EUSFLAT05, páginas 204-209, Barcelona, España, 2005. [13] R. Y. K. Lau. Hacia negociaciones multiagente multi-asunto optimizadas genéticamente. En Actas de la 38ª Conferencia Internacional Anual de Ciencias de Sistemas de Hawái (HICSS05), Isla Grande, Hawái, 2005. [14] R. J. Lin. Negociación de contrato bilateral de múltiples temas para la redistribución de tareas utilizando un servicio de mediación. En Agent Mediated Electronic Commerce VI (AMEC04), Nueva York, EE. UU., 2004. [15] J. F. Nash. Juegos no cooperativos. Anales de Matemáticas, 54:286-295, 1951. [16] G. Owen. Teoría de juegos. Academic Press, Nueva York, 1995. [17] V. Robu, D. J. A. Algunos divertidos, y J. A. L. Poutré. Modelado de negociaciones complejas de múltiples temas utilizando gráficos de utilidad. En la 4ta Conferencia Internacional Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS05), páginas 280-287, 2005. [18] A. Rubinstein. Equilibrio perfecto en un modelo de negociación. Econometrica, 50:97-109, ene 1982. [19] L.-K. Soh y X. Li. Estrategia de negociación multiagente adaptativa basada en la confianza. En la 3ª Conferencia Internacional Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS04), páginas 1048-1055, Los Alamitos, CA, EE. UU., 2004. [20] H.-W. Tung y R. J. Lin. Negociación de contratos automatizada utilizando un servicio de mediación. En la 7ª Conferencia Internacional de Tecnología de Comercio Electrónico de IEEE (CEC05), páginas 374-377, Múnich, Alemania, 2005. 950 El Sexto Internacional. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07)