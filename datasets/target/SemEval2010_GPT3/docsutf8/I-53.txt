Un Método Aleatorio para el Valor de Shapley para el Juego de Votación Shaheen S. Fatima Departamento de Ciencias de la Computación, Universidad de Liverpool Liverpool L69 3BX, Reino Unido. El valor de Shapley es uno de los conceptos clave de solución para juegos de coalición. Su principal ventaja es que proporciona una solución única y justa, pero su principal problema es que, para muchos juegos de coalición, el valor de Shapley no se puede determinar en tiempo polinómico. En particular, se sabe que el problema de encontrar este valor para el juego de votación es #P-completo en el caso general. Sin embargo, en este artículo, demostramos que hay algunos juegos de votación específicos para los cuales el problema es computacionalmente manejable. Para otros juegos de votación generales, superamos el problema de la complejidad computacional presentando un nuevo método aleatorio para determinar el valor de Shapley aproximado. La complejidad temporal de este método es lineal en el número de jugadores. También demostramos, a través de estudios empíricos, que el porcentaje de error para el método propuesto siempre es inferior al 20% y, en la mayoría de los casos, inferior al 5%. Categorías y Descriptores de Asignaturas I.2.11 [Inteligencia Artificial Distribuida]: Sistemas Multiagente Términos Generales Algoritmos, Diseño, Teoría 1. FORMACIÓN DE COALICIONES, una forma clave de interacción en sistemas multiagente, es el proceso de unir a dos o más agentes para lograr objetivos que los individuos por sí solos no pueden alcanzar, o para lograrlos de manera más eficiente [1, 11, 14, 13]. A menudo, en tales situaciones, hay más de una coalición posible y la recompensa de un jugador depende de cuál se una. Dado esto, un problema clave es asegurar que ninguna de las partes en una coalición tenga algún incentivo para separarse de ella y unirse a otra coalición (es decir, las coaliciones deben ser estables). Sin embargo, en muchos casos puede haber más de una solución (es decir, una coalición estable). En tales casos, se vuelve difícil seleccionar una única solución entre las posibles, especialmente si las partes están interesadas en sí mismas (es decir, tienen preferencias diferentes sobre coaliciones estables). En este contexto, la teoría de juegos cooperativos aborda el problema de la formación de coaliciones y ofrece una serie de conceptos de solución que poseen propiedades deseables como estabilidad, división justa de ganancias conjuntas y unicidad [16, 14]. La teoría de juegos cooperativos difiere de su contraparte no cooperativa en que, para la primera, a los jugadores se les permite formar acuerdos vinculantes y, por lo tanto, hay un fuerte incentivo para trabajar juntos para recibir la mayor ganancia total. Además, a diferencia de la teoría de juegos no cooperativos, la teoría de juegos cooperativos no especifica un juego a través de una descripción del entorno estratégico (incluyendo el orden de los movimientos de los jugadores y el conjunto de acciones en cada movimiento) y los resultados de pagos, sino que, en cambio, reduce esta colección de datos a la forma coalicional donde cada coalición está representada por un único número real: no hay acciones, movimientos o pagos individuales. La principal ventaja de este enfoque, al menos en entornos de múltiples jugadores, es su utilidad práctica. Por lo tanto, muchas más situaciones de la vida real encajan más fácilmente en un juego de forma coalicional, cuya estructura es más manejable que la de un juego no cooperativo, ya sea en forma normal o extensiva, y es por esta razón que nos enfocamos en tales formas en este artículo. Dadas estas observaciones, varios investigadores de sistemas multiagentes han utilizado y ampliado soluciones cooperativas de teoría de juegos para facilitar la formación automatizada de coaliciones [20, 21, 18]. Además, en este trabajo, uno de los conceptos de solución más estudiados en profundidad es el valor de Shapley [19]. El valor de Shapley de un jugador da una indicación de sus perspectivas de jugar el juego: cuanto mayor sea el valor de Shapley, mejores serán sus perspectivas. La principal ventaja del valor de Shapley es que proporciona una solución que es a la vez única y justa (ver Sección 2.1 para una discusión de la propiedad de equidad). Sin embargo, aunque ambas son propiedades deseables, el valor de Shapley tiene una desventaja importante: para muchos juegos de coalición, no se puede determinar en tiempo polinómico. Por ejemplo, encontrar este valor para el juego de votación ponderada es, en general, #P-completo [6]. Un problema es #P-difícil si resolverlo es tan difícil como contar asignaciones satisfactorias de fórmulas de lógica proposicional [15, p442]. Dado que la #P-completitud subsume la NP-completitud, esto implica que calcular el valor de Shapley para el juego de votación ponderada será intratable en general. En otras palabras, es prácticamente inviable intentar calcular el valor de Shapley exacto. Sin embargo, el juego de votación tiene relevancia práctica para los sistemas multiagente, ya que es un medio importante para llegar a un consenso entre múltiples agentes. Por lo tanto, nuestro objetivo es superar la complejidad computacional de encontrar el valor de Shapley para este juego. Específicamente, primero demostramos que hay algunos juegos de votación específicos para los cuales el valor exacto se puede calcular en tiempo polinómico. Al identificar dichos juegos, mostramos, por primera vez, cuándo es factible encontrar el valor exacto y cuándo no lo es. Para los juegos de votación computacionalmente complejos, presentamos un nuevo método aleatorizado, siguiendo la línea de la simulación de Monte Carlo, para calcular el valor de Shapley aproximado. La complejidad computacional de este tipo de juegos suele abordarse mediante dos enfoques principales. El primero es usar funciones generadoras [3]. Este método intercambia complejidad temporal por espacio de almacenamiento. El segundo utiliza una técnica de aproximación basada en la simulación de Monte Carlo [12, 7]. Sin embargo, el método que proponemos es más general que cualquiera de estos (ver Sección 6 para más detalles). Además, ningún trabajo ha analizado previamente el error de aproximación. El error de aproximación se refiere a qué tan cerca está la aproximación del valor de Shapley real. Específicamente, es la diferencia entre el valor de Shapley real y el aproximado. Es importante determinar este error porque el rendimiento de un método de aproximación se evalúa en función de dos criterios: su complejidad temporal y su error de aproximación. Por lo tanto, nuestra contribución radica también en proporcionar, por primera vez, un análisis del error porcentual en el valor aproximado de Shapley. Este análisis se realiza de manera empírica. Nuestros experimentos muestran que el error siempre es menor al 20%, y en la mayoría de los casos es inferior al 5%. Finalmente, nuestro método tiene complejidad temporal lineal en el número de jugadores y no requiere ningún arreglo (es decir, es económico en términos tanto de tiempo de computación como de espacio de almacenamiento). Dado esto, y el hecho de que los agentes de software tienen recursos computacionales limitados y, por lo tanto, no pueden calcular el verdadero valor de Shapley, nuestros resultados son especialmente relevantes para dichos agentes con recursos limitados. El resto del documento está organizado de la siguiente manera. La sección 2 define el valor de Shapley y describe el juego de votación ponderada. En la Sección 3 describimos juegos de votación cuyo valor de Shapley se puede encontrar en tiempo polinómico. En la Sección 4, presentamos un método aleatorio para encontrar el valor aproximado de Shapley y analizamos su rendimiento en la Sección 5. La sección 6 discute la literatura relacionada. Finalmente, la Sección 7 concluye. 2. FONDO Comenzamos presentando los juegos de coalición y el valor de Shapley, y luego definimos el juego de votación ponderada. Un juego de coalición es un juego en el que grupos de jugadores (coaliciones) pueden promover un comportamiento cooperativo entre sus miembros. Por lo tanto, el juego es una competencia entre coaliciones de jugadores, en lugar de entre jugadores individuales. Dependiendo de cómo los jugadores midan la utilidad, la teoría de juegos de coalición se divide en dos partes. Si los jugadores miden la utilidad o la ganancia en las mismas unidades y hay un medio de intercambio de utilidad como pagos laterales, decimos que el juego tiene utilidad transferible; de lo contrario, tiene utilidad no transferible. Más formalmente, un juego de coalición con utilidad transferible, N, v, consiste en: 1. un conjunto finito (N = {1, 2, . . . , n}) de jugadores y 2. una función (v) que asocia a cada subconjunto no vacío S de N (es decir, una coalición) un número real v(S) (el valor de S). Para cada coalición S, el número v(S) es la ganancia total disponible para ser dividida entre los miembros de S (es decir, el conjunto de acciones conjuntas que la coalición S puede tomar consiste en todas las posibles divisiones de v(S) entre los miembros de S). Los juegos de coalición con pagos no transferibles difieren de los que tienen pagos transferibles de la siguiente manera. Para lo primero, cada coalición está asociada con un conjunto de vectores de pago que no necesariamente es el conjunto de todas las posibles divisiones de una cantidad fija. El enfoque de este documento se centra en el juego de votación ponderada (descrito en la Sección 2.1), que es un juego con pagos transferibles. Por lo tanto, en ambos casos, los jugadores solo se unirán a una coalición si esperan beneficiarse de ella. Aquí, a los jugadores se les permite formar acuerdos vinculantes, por lo que hay un fuerte incentivo para trabajar juntos y recibir la mayor ganancia total. El problema entonces es cómo dividir el pago total entre o entre los jugadores. En este contexto, Shapley [19] construyó una solución utilizando un enfoque axiomático. Shapley definió un valor para los juegos como una función que asigna a un juego (N, v), un número ϕi(N, v) para cada i en N. Esta función satisface tres axiomas [17]: 1. Simetría. Este axioma requiere que los nombres de los jugadores no jueguen ningún papel en la determinación del valor. 2. Portador. Este axioma requiere que la suma de ϕi(N, v) para todos los jugadores i en cualquier portador C sea igual a v(C). Un portador C es un subconjunto de N tal que v(S) = v(S ∩ C) para cualquier subconjunto de jugadores S ⊂ N. Aditividad. Este axioma especifica cómo deben relacionarse los valores de diferentes juegos entre sí. Se requiere que para cualquier juego ϕi(N, v) y ϕi(N, v), ϕi(N, v) + ϕi(N, v) = ϕi(N, v + v) para todo i en N. Shapley demostró que hay una función única que satisface estos tres axiomas. Shapley consideraba este valor como un índice para medir el poder de los jugadores en un juego. Al igual que un índice de precios u otros índices de mercado, el valor utiliza promedios (o promedios ponderados en algunas de sus generalizaciones) para agregar el poder de los jugadores en sus diversas oportunidades de cooperación. Alternativamente, se puede pensar en el valor de Shapley como una medida de la utilidad de jugadores neutrales al riesgo en un juego. Primero introducimos algunas notaciones y luego definimos el valor de Shapley. Sea S el conjunto N − {i} y fi : S → 2N−{i} una variable aleatoria que toma sus valores en el conjunto de todos los subconjuntos de N − {i}, y tiene la función de distribución de probabilidad (g) definida como: g(fi(S) = S) = |S|! (n − |S| − 1)! n! La variable aleatoria fi se interpreta como la elección aleatoria de una coalición a la que se une el jugador i. Entonces, el valor de Shapley de un jugador se define en términos de su contribución marginal. Por lo tanto, la contribución marginal del jugador i a la coalición S con i /∈ S es una función Δiv que se define de la siguiente manera: Δiv(S) = v(S ∪ {i}) − v(S). Así, la contribución marginal de un jugador a una coalición S es el aumento en el valor de S como resultado de que i se una a ella. DEFINICIÓN 1. El valor de Shapley (ϕi) del juego N, v para el jugador i es la expectativa (E) de su contribución marginal a una coalición que es elegida al azar: ϕi(N, v) = E[Δiv ◦ fi] (1). El valor de Shapley se interpreta de la siguiente manera. Supongamos que todos los jugadores están dispuestos en algún orden, siendo todas las disposiciones igualmente probables. Entonces ϕi(N, v) es la contribución marginal esperada, sobre todas las ordenaciones, del jugador i al conjunto de jugadores que le preceden. El método para encontrar el valor de Shapley de un jugador depende de la definición de la función de valor (v). Esta función es diferente para diferentes juegos, pero aquí nos enfocamos específicamente en el juego de votación ponderada por las razones descritas en la Sección 1.960 de la Sexta Conferencia Internacional. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07) 2.1 El juego de votación ponderada Adoptamos la definición del juego de votación dada en [6]. Por lo tanto, hay un conjunto de n jugadores que pueden, por ejemplo, representar accionistas en una empresa o miembros en un parlamento. El juego de votación ponderada es entonces un juego G = N, v en el que: v(S) = j 1 si w(S) ≥ q 0 en caso contrario para algún q ∈ IR+ y wi ∈ IRN + , donde: w(S) = X i∈S wi para cualquier coalición S. Así, wi es el número de votos que tiene el jugador i y q es el número de votos necesarios para ganar el juego (es decir, la cuota). Ten en cuenta que para este juego (denotado q; w1, . . . , wn), la contribución marginal de un jugador es cero o uno. Esto se debe a que el valor de cualquier coalición es cero o uno. Una coalición con valor cero se llama una coalición perdedora y con valor uno una coalición ganadora. Si la entrada de un jugador a una coalición cambia de perder a ganar, entonces la contribución marginal del jugador para esa coalición es uno; de lo contrario, es cero. La principal ventaja del valor de Shapley es que proporciona una solución que es a la vez única y justa. La propiedad de la unicidad es deseable porque no deja lugar a ambigüedades. La propiedad de equidad se relaciona con cómo se dividen las ganancias de la cooperación entre los miembros de una coalición. En este caso, el valor de Shapley de un jugador es proporcional a la contribución que realiza como miembro de una coalición; cuanto mayor sea su contribución, mayor será su valor. Por lo tanto, desde la perspectiva de un jugador, tanto la singularidad como la equidad son propiedades deseables. 3. JUEGOS DE VOTACIÓN CON SOLUCIONES EN TIEMPO POLINOMIAL Aquí describimos aquellos juegos de votación para los cuales el valor de Shapley puede ser determinado en tiempo polinomial. Esto se logra utilizando el enfoque de enumeración directa (es decir, enumerando todas las posibles coaliciones y encontrando la contribución marginal de un jugador a cada una de ellas). Caracterizamos dichos juegos en términos del número de jugadores y sus pesos. 3.1 Todos los jugadores tienen el mismo peso. Consideremos el juego q; j, . . . , j con m participantes. Cada partido tiene j votos. Si q ≤ j, entonces no habría necesidad de que los jugadores formen una coalición. Por otro lado, si q = mj (m = |N| es el número de jugadores), solo la gran coalición es posible. Los juegos interesantes son aquellos para los cuales la cuota (q) satisface la restricción: (j + 1) ≤ q ≤ j(m − 1). Para estos juegos, el valor de una coalición es uno si el peso de la coalición es mayor o igual a q, de lo contrario es cero. Que ϕ denote el valor de Shapley para un jugador. Considera a cualquier jugador. Este jugador puede unirse a una coalición como el miembro i-ésimo donde 1 ≤ i ≤ m. Sin embargo, la contribución marginal del jugador es de 1 solo si se une a una coalición como el miembro q/j-ésimo. En todos los demás casos, su contribución marginal es cero. Por lo tanto, el valor de Shapley para cada jugador ϕ = 1/m. Dado que ϕ requiere una operación de división, se puede encontrar en tiempo constante (es decir, O(1)). 3.2 Una sola gran fiesta Considera un juego en el que hay dos tipos de jugadores: grandes (con peso wl > ws) y pequeños (con peso ws). Hay un jugador grande y m pequeños. La cuota para este juego es q; es decir, tenemos un juego de la forma q; wl, ws, ws, . . . , ws. El número total de jugadores es (m + 1). El valor de una coalición es uno si el peso de la coalición es mayor o igual a q, de lo contrario es cero. Que ϕl denote el valor de Shapley para el jugador grande y ϕs para cada jugador pequeño. Primero consideramos ws = 1 y luego ws > 1. El valor más pequeño posible para q es wl + 1. Esto se debe a que, si q ≤ wl, entonces el partido grande puede ganar las elecciones por sí solo sin necesidad de formar una coalición. Por lo tanto, la cuota para el juego satisface la restricción wl + 1 ≤ q ≤ m + wl − 1. Además, los límites inferior y superior para wl son 2 y (q − 1) respectivamente. El límite inferior es 2 porque el peso de la gran fiesta tiene que ser mayor que cada uno de los pequeños. Además, el peso del gran partido no puede ser mayor que q, ya que en ese caso, no habría necesidad de que el gran partido forme una coalición. Recuerda que para nuestro juego de votación, la contribución marginal de un jugador a una coalición solo puede ser cero o uno. Considera la gran fiesta. Este partido puede unirse a una coalición como el i-ésimo miembro donde 1 ≤ i ≤ (m + 1). Sin embargo, la contribución marginal del partido grande es uno si se une a una coalición como el miembro i-ésimo donde (q − wl) ≤ i < q. En todos los casos restantes, su contribución marginal es cero. Por lo tanto, de los casos totales posibles (m + 1), su contribución marginal es de uno en wl casos. Por lo tanto, el valor de Shapley del partido grande es: ϕl = wl/(m + 1). De la misma manera, obtenemos el valor de Shapley del gran partido para el caso general donde ws > 1 como: ϕl = wl/ws /(m + 1). Ahora consideremos a un jugador pequeño. Sabemos que la suma de los valores de Shapley de todos los m+1 jugadores es uno. Además, dado que los partidos pequeños tienen el mismo peso, sus valores de Shapley son iguales. Por lo tanto, obtenemos: ϕs = 1 − ϕl m. Por lo tanto, tanto ϕl como ϕs se pueden calcular en tiempo constante. Esto se debe a que ambos requieren un número constante de operaciones básicas (suma, resta, multiplicación y división). De la misma manera, el valor de Shapley para un juego de votación con un único partido grande y múltiples partidos pequeños puede determinarse en tiempo constante. 3.3 Múltiples partidos grandes y pequeños Ahora consideramos un juego de votación que tiene dos tipos de jugadores: grandes y pequeños (como en la Sección 3.2), pero ahora hay múltiples partidos grandes y múltiples partidos pequeños. El conjunto de partidos consiste en ml partidos grandes y ms partidos pequeños. El peso de cada fiesta grande es wl y el de cada fiesta pequeña es ws, donde ws < wl. Mostramos la factibilidad computacional de este juego considerando los siguientes cuatro posibles escenarios: S1 q ≤ mlwl y q ≤ msws S2 q ≤ mlwl y q ≥ msws S3 q ≥ mlwl y q ≥ msws S4 q ≥ mlwl y q ≤ msws Para el primer escenario, considera un jugador grande. Para determinar el valor de Shapley para este jugador, necesitamos considerar el número de todas las posibles coaliciones que le otorgan una contribución marginal de uno. Es posible que la contribución marginal de este jugador sea uno si se une a una coalición en la que el número de jugadores grandes está entre cero y (q −1)/wl. En otras palabras, hay (q −1)/wl +1 casos de este tipo y ahora consideramos cada uno de ellos. El Sexto Internacional. Considera una coalición tal que cuando el jugador grande se une, hay i jugadores grandes y (q − iwl − 1)/ws jugadores pequeños ya en ella, y los jugadores restantes se unen después del jugador grande. Una coalición de este tipo otorga una contribución marginal a la unidad de jugador grande. Que C2 l (i, q) denote el número de todas esas coaliciones. Para empezar, considera el caso i = 0: C2 l (0, q) = C „ ms, q − 1 ws « × FACTORIAL „ q − 1 ws « × FACTORIAL „ ml + ms − q − 1 ws − 1 « donde C(y, x) denota el número de posibles combinaciones de x elementos de un conjunto de y elementos. Para i = 1, obtenemos: C2 l (1, q) = C(ml, 1) × C „ ms, q − wl − 1 ws « × FACTORIAL „ q − wl − 1 ws « × FACTORIAL „ ml + ms − q − wl − 1 ws − 1 « En general, para i > 1, obtenemos: C2 l (i, q) = C(ml, i) × C „ ms, q − iwl − 1 ws « × FACTORIAL „ q − iwl − 1 ws « × FACTORIAL „ ml + ms − q − wl − 1 ws − 1 « Por lo tanto, el valor de Shapley de los jugadores grandes es: ϕl = q−1 wlX i=0 C2 l (i, q)/FACTORIAL(ml + ms) Para un i dado, el tiempo para encontrar C2 l (i, q) es O(T) donde T = (mlms(q − iwl − 1)(ml + ms))/ws Por lo tanto, el tiempo para encontrar el valor de Shapley es O(T q/wl). De la misma manera, el valor de Shapley de un jugador pequeño es: ϕs = q−1 wsX i=0 C2 s (i, q)/FACTORIAL(ml + ms) y puede encontrarse en tiempo O(T q/ws). Asimismo, se puede demostrar que los tres escenarios restantes (S2 a S4) tienen la misma complejidad temporal. 3.4 Tres tipos de jugadores Ahora consideramos un juego de votación que tiene tres tipos de jugadores: 1, 2 y 3. El conjunto de fiestas consiste en m1 jugadores de tipo 1 (cada uno con peso w1), m2 jugadores de tipo 2 (cada uno con peso w2) y m3 jugadores de tipo 3 (cada uno con peso w3). Para este juego de votación, considera a un jugador de tipo 1. Es posible que la contribución marginal de este jugador sea uno si se une a una coalición en la que el número de jugadores de tipo 1 está entre cero y (q − 1)/w1. En otras palabras, hay (q − 1)/w1 + 1 casos de este tipo y ahora consideramos cada uno de ellos. Considera una coalición tal que cuando el jugador de tipo 1 se une, ya hay i jugadores de tipo 1 en ella. Los jugadores restantes se unen después del jugador de tipo 1. Que C3 l (i, q) denote el número de todas las coaliciones que dan una contribución marginal de uno al jugador de tipo 1 donde: C3 1 (i, q) = q−1 w1X i=0 q−iw1−1 w2X j=0 C2 1 (j, q − iw1) Por lo tanto, el valor de Shapley del jugador de tipo 1 es: ϕ1 = q−1 w1X i=0 C3 1 (i, q)/FACTORIAL(m1 + m2 + m3) La complejidad temporal de encontrar este valor es O(T q2 /w1w2) donde: T = ( 3Y i=1 mi)(q − iwl − 1)( 3X i=1 mi)/(w2 + w3) Del mismo modo, para los otros dos tipos de jugadores (2 y 3). Por lo tanto, hemos identificado juegos para los cuales el valor de Shapley exacto puede determinarse fácilmente. Sin embargo, la complejidad computacional del método de enumeración directa anterior aumenta con el número de tipos de jugadores. Para un juego de votación con más de tres tipos de jugadores, la complejidad temporal del método anterior es un polinomio de grado cuatro o superior. Para hacer frente a tales situaciones, por lo tanto, la siguiente sección presenta un método aleatorio más rápido para encontrar el valor de Shapley aproximado. 4. ENCONTRANDO EL VALOR DE SHAPLEY APROXIMADO Primero damos una breve introducción a los algoritmos aleatorizados y luego presentamos nuestro método aleatorizado para encontrar el valor de Shapley aproximado. Los algoritmos aleatorizados son el enfoque más comúnmente utilizado para encontrar soluciones aproximadas a problemas computacionalmente difíciles. Un algoritmo aleatorizado es un algoritmo que, durante algunas de sus etapas, realiza elecciones al azar [2]. Los pasos aleatorios realizados por el algoritmo implican que al ejecutar el algoritmo varias veces con la misma entrada no estamos garantizados de encontrar la misma solución. Ahora, dado que dichos algoritmos generan soluciones aproximadas, su rendimiento se evalúa en función de dos criterios: su complejidad temporal y su error de aproximación. El error de aproximación se refiere a la diferencia entre la solución exacta y su aproximación. En este contexto, presentamos un método aleatorio para encontrar el valor aproximado de Shapley y evaluamos empíricamente su error. Primero describimos el juego de votación general y luego presentamos nuestro algoritmo aleatorio. En su forma general, un juego de votación tiene más de dos tipos de jugadores. Que w_i denote el peso del jugador i. Por lo tanto, para m jugadores y para la cuota q, el juego es de la forma q; w1, w2, . . . , wm. Los pesos están especificados en términos de una función de distribución de probabilidad. Para un juego como este, queremos encontrar el valor aproximado de Shapley. Dejamos que P denote una población de jugadores. Los pesos de los jugadores en esta población están definidos por una función de distribución de probabilidad. Independientemente de la función de distribución de probabilidad real, sea μ la media del peso para la población de jugadores y ν la varianza en los pesos de los jugadores. De esta población de jugadores extraemos muestras al azar y encontramos la suma de los pesos de los jugadores en la muestra utilizando la siguiente regla de la Teoría del Muestreo (ver [8] p425): Si w1, w2, . . . , wn es una muestra aleatoria de tamaño n extraída de cualquier distribución con media μ y varianza ν, entonces la suma de la muestra tiene una distribución Normal aproximada con media nμ y varianza ν n (cuanto mayor sea n, mejor será la aproximación). 962 The Sixth Intl. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07) R-SHAPLEYVALUE (P, μ, ν, q, wi) P: Población de jugadores μ: Peso medio de la población P ν: Varianza en los pesos para la población P q: Cuota para el juego de votación wi: Peso del jugador 1. Ti ← 0; a ← q − wi; b ← q − 2. 

Ti ← 0; a ← q - wi; b ← q - 2. Para X de 1 a m, repetir lo siguiente 2.1. Selecciona una muestra aleatoria SX de tamaño X de la población P 2.2. Evaluar la contribución marginal esperada (ΔX i ) del jugador i a SX como: ΔX i ← 1√ (2πν/X) R b a e−X (x−Xμ)2 2ν dx 2.3. Ti ← Ti + ΔX i 3. 

Ti ← Ti + ΔX i 3. Evaluar el valor de Shapley del jugador i como: ϕi ← Ti/m Tabla 1: Algoritmo aleatorizado para encontrar el valor de Shapley para el jugador i. Sabemos, a partir de la Definición 1, que el valor de Shapley para un jugador es la expectativa (E) de su contribución marginal a una coalición que es elegida al azar. Utilizamos esta regla para determinar el valor de Shapley de la siguiente manera. Para el jugador i con peso wi, dejemos que ϕi denote el valor de Shapley. Que X denote el tamaño de una muestra aleatoria extraída de una población en la que los pesos de los jugadores individuales tienen cualquier distribución. La contribución marginal del jugador i a esta muestra aleatoria es uno si el peso total de los jugadores X en la muestra es mayor o igual a a = q - wi pero menor que b = q - (donde es una cantidad infinitesimalmente pequeña). De lo contrario, su contribución marginal es cero. Por lo tanto, la contribución marginal esperada del jugador i (denotada como ΔX i ) a la coalición de muestra es el área bajo la curva definida por N(Xμ, ν X ) en el intervalo [a, b]. Esta área se muestra como la región B en la Figura 1 (la línea punteada en la figura es Xμ). Por lo tanto, obtenemos: ΔX i = 1 p (2πν/X) Z b a e−X (x−Xμ)2 2ν dx (2) y el valor de Shapley es: ϕi = 1 m mX X=1 ΔX i (3). Los pasos anteriores se describen en la Tabla 1. Con más detalle, el Paso 1 realiza la inicialización. En el Paso 2, variamos X entre 1 y m y repetidamente hacemos lo siguiente. En el Paso 2.1, seleccionamos aleatoriamente una muestra SX de tamaño X de la población P. La contribución marginal del jugador a la coalición aleatoria SX se encuentra en el Paso 2.2. El promedio de la contribución marginal se encuentra en el Paso 3, y este es el valor de Shapley para el jugador i. TEOREMA 1. La complejidad temporal del método aleatorio propuesto es lineal en el número de jugadores. PRUEBA. Según la Ecuación 3, ΔX i debe ser calculado m veces. Esto se hace en el bucle for del Paso 2 en la Tabla 1. Por lo tanto, la complejidad temporal de calcular el valor de Shapley de un jugador es O(m). La siguiente sección analiza el error de aproximación para el método propuesto. 5. RENDIMIENTO DEL MÉTODO ALEATORIO Primero derivamos la fórmula para medir el error en el valor de Shapley aproximado y luego realizamos experimentos para evaluar este error en una amplia gama de configuraciones. Sin embargo, antes de hacerlo, introducimos la idea del error. El concepto de error se relaciona con una medición realizada de una cantidad que tiene un valor aceptado [22, 4]. Obviamente, no se puede determinar exactamente cuán lejos está una medición del valor aceptado; si esto fuera posible, sería factible simplemente proporcionar un valor corregido más preciso. Por lo tanto, el error tiene que ver con la incertidumbre en las mediciones sobre la que no se puede hacer nada. Si se repite una medición, los valores obtenidos serán diferentes y ninguno de los resultados puede ser preferido sobre los demás. Sin embargo, aunque no sea posible hacer nada al respecto de tal error, sí se puede caracterizar. Como se describe en la Sección 4, realizamos mediciones en muestras que se extraen al azar de una población dada (P) de jugadores. Ahora, existen errores estadísticos asociados con el muestreo que son inevitables y deben ser aceptados. Por lo tanto, si el resultado de una medición va a tener significado, no puede consistir únicamente en el valor medido. También se debe incluir una indicación de cuán precisa es el resultado. Por lo tanto, el resultado de cualquier medición física tiene dos componentes esenciales: 1. un valor numérico que proporciona la mejor estimación posible de la cantidad medida, y 2. el grado de incertidumbre asociado con este valor estimado. Por ejemplo, si la estimación de una cantidad es x y la incertidumbre es e(x), la cantidad estaría en x ± e(x). Para experimentos de muestreo, el error estándar es, con mucho, la forma más común de caracterizar la incertidumbre [22]. Dado esto, la siguiente sección define este error y lo utiliza para evaluar el rendimiento del método aleatorio propuesto. 5.1 Error de aproximación La precisión del método aleatorio anterior depende de su error de muestreo, el cual se define de la siguiente manera [22, 4]: DEFINICIÓN 2. El error de muestreo (o error estándar) se define como la desviación estándar de un conjunto de mediciones dividida por la raíz cuadrada del número de mediciones. Con este fin, sea e(σX) el error de muestreo en la suma de los pesos para una muestra de tamaño X extraída de la distribución N(Xμ, νX) donde: e(σX) = p(ν/X) / p(X) = p(ν) / X (4). Sea e(ΔXi) el error en la contribución marginal para el jugador i (dado en la Ecuación 2). Este error se obtiene propagando el error en la Ecuación 4 a la Ecuación 2. En la Ecuación 2, a y b son los límites inferior y superior para la suma de los pesos de los jugadores para The Sixth Intl. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07) 963 b C B a − e (σX ) a A )X(σeb+ Suma de pesos Z1 Z2 Figura 1: Una distribución normal para la suma de los pesos de los jugadores en una coalición de tamaño X. 40 60 80 100 0 50 100 0 5 10 15 20 25 Peso de cuota Porcentaje de error en el valor de Shapley Figura 2: Rendimiento del método aleatorio para m = 10 jugadores en una coalición de tamaño X. Dado que el error en esta suma es e(σX), los valores reales de a y b se encuentran en el intervalo a ± e(σX) y b ± e(σX) respectivamente. Por lo tanto, el error en la Ecuación 2 es la probabilidad de que la suma se encuentre entre los límites a - e(σX) y a (es decir, el área bajo la curva definida por N(Xμ, ν X) entre a - e(σX) y a, que es la región sombreada A en la Figura 1) o la probabilidad de que la suma de los pesos se encuentre entre los límites b y b+e(σX) (es decir, el área bajo la curva definida por N(Xμ, ν X) entre b y b + e(σX), que es la región sombreada C en la Figura 1). Más específicamente, el error es el máximo de estas dos probabilidades: e(ΔX i ) = 1 p (2πν/X) × MAX „Z a a−e(σX ) e−X (x−Xμ)2 2ν dx, Z b+e(σX ) b e−X (x−Xμ)2 2ν dx « Con base en el error anterior, encontramos el error en el valor de Shapley utilizando las siguientes reglas estándar de propagación de errores [22]: R1 Si x e y son dos variables aleatorias con errores e(x) y e(y) respectivamente, entonces el error en la variable aleatoria z = x + y se da por: e(z) = e(x) + e(y) R2 Si x es una variable aleatoria con error e(x) y z = kx donde 0 100 200 300 400 500 0 100 200 300 400 500 0 5 10 15 20 25 CuotaPeso Porcentajeerror en el valor de Shapley Figura 3: Rendimiento del método aleatorizado para m = 50 jugadores. la constante k no tiene error, entonces el error en z es: e(z) = |k|e(x) Utilizando las reglas anteriores, el error en el valor de Shapley (dado en la Ecuación 3) se obtiene propagando el error en la Ecuación 4 a todas las coaliciones entre los tamaños X = 1 y X = m. Sea e(ϕi) este error donde: e(ϕi) = 1 m mX X=1 e(ΔX i ) Analizamos el rendimiento de nuestro método en términos del porcentaje de error PE en el valor de Shapley aproximado, que se define de la siguiente manera: PE = 100 × e(ϕi)/ϕi (5) 5.2 Resultados Experimentales Ahora calculamos el porcentaje de error en el valor de Shapley utilizando la ecuación anterior para PE. Dado que este error depende de los parámetros del juego de votación, lo evaluamos en una variedad de configuraciones al variar sistemáticamente los parámetros del juego de votación. En particular, realizamos experimentos en el siguiente entorno. Para un jugador con peso w, el error porcentual en el valor de Shapley de un jugador depende de los siguientes cinco parámetros (ver Ecuación 3): 1. El número de fiestas (m). 2. El peso medio (μ). 3. La varianza en los pesos de los jugadores (ν). 4. La cuota para el juego de votación (q) es de 5. El peso de los jugadores dados (w). Fijamos μ = 10 y ν = 1. Esto se debe a que, para la distribución normal, μ = 10 asegura que para casi todos los jugadores el peso es positivo, y ν = 1 se utiliza con mayor frecuencia en experimentos estadísticos (ν puede ser mayor o menor pero PE aumenta en ν, ver Ecuaciones 4 y 5). Luego variamos m, q y w de la siguiente manera. Variamos m entre 5 y 100 (ya que más allá de 100 encontramos que el error es cercano a cero), para cada m variamos q entre 4μ y mμ (imponemos estos límites porque aseguran que el tamaño del 964 The Sixth Intl. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07) 0 200 400 600 800 1000 0 200 400 600 800 1000 0 5 10 15 20 25 Peso de la cuota Porcentaje de error en el valor de Shapley Figura 4: Rendimiento del método aleatorio para m = 100 jugadores. La coalición ganadora es más de uno y menos que m - ver la Sección 3 para más detalles), y para cada q, variamos w entre 1 y q−1 (porque una coalición ganadora debe contener al menos dos jugadores). Los resultados de estos experimentos se muestran en las Figuras 2, 3 y 4. Como se observa en las figuras, la PE máxima es alrededor del 20% y en la mayoría de los casos es inferior al 5%. Ahora analizamos el efecto de los tres parámetros: w, q y m en el error porcentual con más detalle. - Efecto de w. El EP depende de e(σX) porque, en la Ecuación 5, los límites de integración dependen de e(σX). El intervalo sobre el cual se realiza la primera integración en la Ecuación 5 es a − a + e(σX) = e(σX), y el intervalo sobre el cual se realiza la segunda es b + e(σX) − b = e(σX). Por lo tanto, el intervalo es el mismo para ambas integraciones y es independiente de wi. Ten en cuenta que cada una de las dos funciones que se integran en la Ecuación 5 son iguales a la función que se integra en la Ecuación 2. Solo los límites de la integración son diferentes. Además, el intervalo sobre el cual se realiza la integración para la contribución marginal de la Ecuación 2 es b − a = wi − (ver Figura 1). El error en la contribución marginal es el área de la región sombreada A (entre a − e(σX ) y a) en la Figura 1, o el área sombreada C (entre b y b + e(σX )). Según la Ecuación 5, es el máximo de estas dos áreas. Dado que e(σX) es independiente de wi, a medida que wi aumenta, e(σX) permanece invariable. Sin embargo, el área de la región no sombreada B aumenta. Por lo tanto, a medida que wi aumenta, el error en la contribución marginal disminuye y PE también disminuye. - Efecto de q. Para un q dado, el valor de Shapley para el jugador i es el que se indica en la Ecuación 3. Sabemos que, para una muestra de tamaño X, la suma de los pesos de los jugadores se distribuye normalmente con media Xμ y varianza ν/X. Dado que el 99% de una distribución normal se encuentra dentro de dos desviaciones estándar de su media [8], la contribución marginal de un jugador a una muestra de tamaño X es casi cero si: a < Xμ + 2 p ν/X o b > Xμ − 2 p ν/X. Esto se debe a que las tres regiones A, B y C (en la Figura 1) se encuentran ya sea a la derecha de Z2 o a la izquierda de Z1. Sin embargo, la contribución marginal del jugador es mayor que cero para aquellos X para los cuales se satisface la siguiente restricción: Xμ − 2 p ν/X < a < b < Xμ + 2 p ν/X. Para esta restricción, las tres regiones A, B y C se encuentran en algún lugar entre Z1 y Z2. Dado que a = q −wi y b = q −, la Ecuación 6 también se puede escribir como: Xμ − 2 p ν/X < q − wi < q − < Xμ + 2 p ν/X. El valor más pequeño de X que satisface la restricción en la Ecuación 6 aumenta estrictamente con q. A medida que X aumenta, el error en la suma de pesos en una muestra (es decir, e(σX) = p(ν)/X) disminuye. Por consiguiente, el error en la contribución marginal de un jugador (ver Ecuación 5) también disminuye. Esto implica que a medida que q aumenta, el error en la contribución marginal (y consecuentemente el error en el valor de Shapley) disminuye. - Efecto de m. Es claro a partir de la Ecuación 4 que el error e(σX) es mayor para X = 1 y disminuye con X. Por lo tanto, para valores pequeños de m, e(σ1) tiene un efecto significativo en PE. Pero a medida que m aumenta, el efecto de e(σ1) en PE disminuye y, como resultado, PE disminuye. TRABAJO RELACIONADO Para superar la complejidad computacional de encontrar el valor de Shapley, se han propuesto dos enfoques principales en la literatura. Un enfoque es utilizar funciones generadoras [3]. Este método es un procedimiento exacto que supera el problema de la complejidad temporal, pero sus requisitos de almacenamiento son sustanciales, ya que requiere matrices enormes. También tiene la limitación (no compartida por otros enfoques) de que solo se puede aplicar a juegos con pesos y cuotas enteras. El otro método utiliza una técnica de aproximación basada en la simulación de Monte Carlo. En [12], por ejemplo, el valor de Shapley se calcula considerando una muestra aleatoria de una gran población de jugadores. El método que proponemos difiere de esto en que ellos definen el valor de Shapley tratando el número de turnos de un jugador (si un jugador puede cambiar una coalición perdedora a una ganadora, entonces, para el jugador, la coalición se cuenta como un turno) como una variable aleatoria, mientras que nosotros tratamos los pesos de los jugadores como variables aleatorias. En [12], sin embargo, la pregunta sigue siendo cómo obtener el número de rondas a partir de la definición de un juego de votación y cuál es la complejidad temporal de hacer esto. Dado que el juego de votación se define en función de los pesos de los jugadores y el número de votos se obtiene a partir de estos pesos, nuestro método se corresponde más estrechamente con la definición del juego de votación. Nuestro método también difiere de [7] en que mientras [7] presenta un método para el caso en el que todos los pesos de los jugadores están distribuidos normalmente, nuestro método se aplica a cualquier tipo de distribución para estos pesos. Por lo tanto, como se indica en la Sección 1, nuestro método es más general que [3, 12, 7]. Además, a diferencia de todo el trabajo mencionado anteriormente, proporcionamos un análisis del rendimiento de nuestro método en términos del error porcentual en el valor de Shapley aproximado. Un método para encontrar el valor de Shapley también fue propuesto en [5]. Este método proporciona el valor de Shapley exacto, pero su complejidad temporal es exponencial. Además, el método solo se puede utilizar si el juego está representado en una forma específica (es decir, la representación de múltiples problemas), de lo contrario no. Finalmente, [9, 10] presentan un método de tiempo polinómico para encontrar el valor de Shapley. Este método se puede utilizar si el juego de coalición se representa como una red de contribución marginal. Además, asumen que el valor de Shapley de un componente de un juego de coalición dado es proporcionado por un oráculo, y en base a esta suposición agregan estos valores para encontrar el valor del juego en general. Por el contrario, nuestro método es independiente de The Sixth Intl. La Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07) 965 de la representación y proporciona un valor de Shapley aproximado en tiempo lineal, sin necesidad de un oráculo. 7. CONCLUSIONES Y TRABAJO FUTURO La formación de coaliciones es una forma importante de interacción en sistemas multiagentes. Un tema importante en este tipo de trabajo es que los agentes decidan cómo dividir las ganancias de la cooperación entre los miembros de una coalición. En este contexto, la teoría de juegos cooperativos ofrece un concepto de solución llamado el valor de Shapley. La principal ventaja del valor de Shapley es que proporciona una solución que es a la vez única y justa. Sin embargo, su principal problema es que, para muchos juegos de coalición, el valor de Shapley no se puede determinar en tiempo polinómico. En particular, el problema de encontrar este valor para el juego de votación es #P-completo. Aunque este problema es, en general, #P-completo, demostramos que hay algunos juegos de votación específicos para los cuales el valor de Shapley puede determinarse en tiempo polinómico y caracterizamos dichos juegos. Al hacerlo, hemos demostrado cuándo es computacionalmente factible encontrar el valor de Shapley exacto. Para otros juegos de votación complejos, presentamos un nuevo método aleatorio para determinar el valor de Shapley aproximado. La complejidad temporal del método propuesto es lineal en el número de jugadores. Analizamos el rendimiento de este método en términos del error porcentual en el valor de Shapley aproximado. Nuestros experimentos muestran que el error porcentual en el valor de Shapley es como máximo del 20%. Además, en la mayoría de los casos, el error es menor al 5%. Finalmente, analizamos el efecto de los diferentes parámetros del juego de votación en este error. Nuestro estudio muestra que el error disminuye a medida que aumenta 1. el peso de los jugadores, 2. la cuota aumenta y 3. el número de jugadores aumenta. Dado que los agentes de software tienen recursos computacionales limitados y, por lo tanto, no pueden calcular el verdadero valor de Shapley, nuestros resultados son especialmente relevantes para dichos agentes con recursos limitados. En el futuro, exploraremos el problema de determinar el valor de Shapley para otros juegos de coalición comúnmente presentes, como la economía de producción y la economía de mercado. 8. REFERENCIAS [1] R. Aumann. Puntos aceptables en juegos cooperativos n-persona en general. En Contribuciones a la Teoría de Juegos volumen IV. Princeton University Press, 1959. [2] G. Ausiello, P. Crescenzi, G. Gambosi, V. Kann, A. Marchetti-Spaccamela, y M. Protasi. Complejidad y aproximación: Problemas de optimización combinatoria y sus propiedades de aproximabilidad. Springer, 2003. [3] J. M. Bilbao, J. R. Fernandez, A. J. Losada y J. J. Lopez. Funciones generadoras para calcular índices de poder de manera eficiente. Top 8, 2:191-213, 2000. [4] P. Bork, H. Grote, D. Notz y M. Regler. Técnicas de Análisis de Datos en Experimentos de Física de Altas Energías. Cambridge University Press, 1993. [5] V. Conitzer y T. Sandholm. Calculando los valores de Shapley, manipulando esquemas de división de valor y verificando la pertenencia al núcleo en dominios de múltiples problemas. En Actas de la Conferencia Nacional de Inteligencia Artificial, páginas 219-225, San José, California, 2004. [6] X. Deng y C. H. Papadimitriou. Sobre la complejidad de los conceptos de solución cooperativa. Matemáticas de la Investigación de Operaciones, 19(2):257-266, 1994. [7] S. S. Fatima, M. Wooldridge y N. R. Jennings. Un análisis del valor de Shapley y su incertidumbre para el juego de votación. En Proc. 7th Int. Taller sobre Comercio Electrónico Mediado por Agentes, páginas 39-52, 2005. [8] A. Francis. Estadísticas de Nivel Avanzado. Stanley Thornes Publishers, 1979. [9] S. Ieong y Y. Shoham. Contribución marginal neta: Un esquema de representación compacto para juegos coalicionales. En Actas de la Sexta Conferencia de la ACM sobre Comercio Electrónico, páginas 193-202, Vancouver, Canadá, 2005. [10] S. Ieong y Y. Shoham. Juegos de coalición de múltiples atributos. En Actas de la Séptima Conferencia de la ACM sobre Comercio Electrónico, páginas 170-179, Ann Arbor, Michigan, 2006. [11] J. P. Kahan y A. Rapoport. Teorías de formación de coaliciones. Lawrence Erlbaum Associates Publishers, 1984. [12] I. Mann y L. S. Shapley. Valores para juegos grandes iv: Evaluando el colegio electoral exactamente. Informe técnico, The RAND Corporation, Santa Mónica, 1962. [13] A. Mas-Colell, M. Whinston y J. R. Green. Teoría microeconómica. Oxford University Press, 1995. [14] M. J. Osborne y A. Rubinstein. Un curso de teoría de juegos. El MIT Press, 1994. [15] C. H. Papadimitriou. Complejidad computacional. Addison Wesley Longman, 1994. [16] A. Rapoport. 

Addison Wesley Longman, 1994. [16] A. Rapoport. Teoría de juegos N-personas: Conceptos y aplicaciones. Dover Publications, Mineola, NY, 2001. [17] A. E. Roth.
Dover Publications, Mineola, NY, 2001. [17] A. E. Roth. Introducción al valor de Shapley. En A. E. Roth, editor, El valor de Shapley, páginas 1-27. Editorial de la Universidad de Cambridge, Cambridge, 1988. [18] T. Sandholm y V. Lesser. Coaliciones entre agentes limitados computacionalmente. Revista de Inteligencia Artificial, 94(1):99-137, 1997. [19] L. S. Shapley. Un valor para juegos de n personas. En A. E. Roth, editor, El valor de Shapley, páginas 31-40. Universidad de Cambridge Press, Cambridge, 1988. [20] O. Shehory y S. Kraus. Un modelo orientado al núcleo para la formación de coaliciones en entornos generales: Implementación y resultados. En Actas de la Conferencia Nacional de Inteligencia Artificial (AAAI-96), páginas 131-140, 1996. [21] O. Shehory y S. Kraus. Métodos para la asignación de tareas a través de la formación de coaliciones de agentes. Revista de Inteligencia Artificial, 101(2):165-200, 1998. [22] J. R. Taylor. Una introducción al análisis de errores: El estudio de las incertidumbres en las mediciones físicas. University Science Books, 1982. 966 La Sexta Internacional. Conferencia Conjunta sobre Agentes Autónomos y Sistemas Multiagente (AAMAS 07)